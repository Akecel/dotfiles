var Ty=Object.defineProperty;var a=(m,B)=>Ty(m,"name",{value:B,configurable:!0});(()=>{var __webpack_modules__={879:(m,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.ByteStream=void 0;class K{constructor(j){this.bytes=j,this.byteIndexCurrent=0}hasMoreBytes(){return this.byteIndexCurrent<this.bytes.length}readBytes(j){const se=this.byteIndexCurrent;return this.byteIndexCurrent+=j,this.bytes.slice(se,this.byteIndexCurrent)}readByte(){let j=this.bytes[this.byteIndexCurrent];return this.byteIndexCurrent++,j}readString(j){let se=[];const ne=this.byteIndexCurrent+j;let ue=this.byteIndexCurrent;for(;ue<ne;){const ce=this.bytes[ue++];if(ce===0)break;let z=0,H=0;for((ce&128)==0?(z=ce,H=0):(ce&224)==192?(z=ce&31,H=1):(ce&240)==224?(z=ce&15,H=2):(ce&248)==240&&(z=ce&15,H=3);H>0;)z=z<<6|this.bytes[ue++]&63,H--;se.push(String.fromCodePoint(z))}return this.byteIndexCurrent=ne,se.join("")}}a(K,"ByteStream"),B.ByteStream=K},7106:(m,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.ChunkSize=B.HeaderSizeInBytes=B.FileNameMaxLength=void 0,B.FileNameMaxLength=99,B.HeaderSizeInBytes=500,B.ChunkSize=512},5759:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.TarFile=void 0;const q=K(879),j=K(7106),se=K(4108),ne=K(3335);class ue{constructor(z){this.entries=z}static fromBytes(z){const H=new q.ByteStream(z),M=[],X=j.ChunkSize;let pe=0;for(;H.hasMoreBytes()==!0;){const Y=H.readBytes(X);let Ve=!0;for(let qe=0;qe<Y.length;qe++)if(Y[qe]!=0){Ve=!1;break}if(Ve==!0){if(pe++,pe==2)break}else{pe=0;const qe=se.TarFileEntry.fromBytes(Y,H);M.push(qe)}}let $=new ue(M);return $.consolidateLongPathEntries(),$}consolidateLongPathEntries(){var z;const H=ne.TarFileTypeFlag.Instances().LongFilePath.name,M=this.entries;for(let X=0;X<M.length;X++){const pe=M[X];if(((z=pe.header.typeFlag)===null||z===void 0?void 0:z.name)==H){const $=M[X+1];$.header.fileName=pe.dataAsBytes.reduce((Y,Ve)=>Y+=String.fromCharCode(Ve),""),$.header.fileName=$.header.fileName.replace(/\0/g,""),M.splice(X,1),X--}}}}a(ue,"TarFile"),B.TarFile=ue},4108:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.TarFileEntry=void 0;const q=K(7106),j=K(2895);class se{constructor(ue,ce){this.header=ue,this.dataAsBytes=ce}static fromBytes(ue,ce){const z=q.ChunkSize,H=j.TarFileEntryHeader.fromBytes(ue),M=H.fileSizeInBytes,pe=Math.ceil(M/z)*z,$=ce.readBytes(pe).slice(0,M);return new se(H,$)}}a(se,"TarFileEntry"),B.TarFileEntry=se},2895:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.TarFileEntryHeader=void 0;const q=K(879),j=K(3335);class se{constructor(ue,ce,z,H,M,X,pe,$,Y,Ve,qe,ot,we,Se,be,L){this.fileName=ue,this.fileMode=ce,this.userIDOfOwner=z,this.userIDOfGroup=H,this.fileSizeInBytes=M,this.timeModifiedInUnixFormat=X,this.checksum=pe,this.typeFlag=$,this.nameOfLinkedFile=Y,this.uStarIndicator=Ve,this.uStarVersion=qe,this.userNameOfOwner=ot,this.groupNameOfOwner=we,this.deviceNumberMajor=Se,this.deviceNumberMinor=be,this.filenamePrefix=L,this.fullFileName=L.length?L.endsWith("/")?L+ue:L+"/"+ue:ue}static fromBytes(ue){const ce=new q.ByteStream(ue),z=ce.readString(100).trim(),H=ce.readString(8),M=ce.readString(8),X=ce.readString(8),pe=ce.readString(12),$=ce.readBytes(12),Y=ce.readString(8),Ve=ce.readString(1),qe=ce.readString(100),ot=ce.readString(6),we=ce.readString(2),Se=ce.readString(32),be=ce.readString(32),L=ce.readString(8),he=ce.readString(8),te=ce.readString(155),Ae=ce.readBytes(12),le=parseInt(pe.trim(),8),de=parseInt(Y,8),Ce=j.TarFileTypeFlag.Instances()._All,Fe="_"+Ve,We=Ce[Fe];return new se(z,H,M,X,le,$,de,We,qe,ot,we,Se,be,L,he,te)}}a(se,"TarFileEntryHeader"),B.TarFileEntryHeader=se},3335:(m,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.TarFileTypeFlag=void 0;class K{constructor(se,ne){this.value=se,this.id="_"+this.value,this.name=ne}static Instances(){return K._instances==null&&(K._instances=new q),K._instances}}a(K,"TarFileTypeFlag"),B.TarFileTypeFlag=K;class q{constructor(){this.Normal=new K("0","Normal"),this.HardLink=new K("1","Hard Link"),this.SymbolicLink=new K("2","Symbolic Link"),this.CharacterSpecial=new K("3","Character Special"),this.BlockSpecial=new K("4","Block Special"),this.Directory=new K("5","Directory"),this.FIFO=new K("6","FIFO"),this.ContiguousFile=new K("7","Contiguous File"),this.LongFilePath=new K("L","././@LongLink"),this._All=[this.Normal,this.HardLink,this.SymbolicLink,this.CharacterSpecial,this.BlockSpecial,this.Directory,this.FIFO,this.ContiguousFile,this.LongFilePath];for(let se=0;se<this._All.length;se++){const ne=this._All[se];this._All[ne.id]=ne}}}a(q,"TarFileTypeFlag_Instances")},5790:(m,B,K)=>{"use strict";var q;q={value:!0},B.t9=q=q=q=void 0;const j=K(5759);q={enumerable:!0,get:function(){return j.TarFile}};const se=K(4108);q={enumerable:!0,get:function(){return se.TarFileEntry}};const ne=K(2895);q={enumerable:!0,get:function(){return ne.TarFileEntryHeader}},B.t9=ue=>j.TarFile.fromBytes(ue)},271:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});var q=K(7185);class j extends q.EventTarget{constructor(){super();throw new TypeError("AbortSignal cannot be constructed directly")}get aborted(){const X=ue.get(this);if(typeof X!="boolean")throw new TypeError(`Expected 'this' to be an 'AbortSignal' object, but got ${this===null?"null":typeof this}`);return X}}a(j,"AbortSignal"),q.defineEventAttribute(j.prototype,"abort");function se(){const M=Object.create(j.prototype);return q.EventTarget.call(M),ue.set(M,!1),M}a(se,"createAbortSignal");function ne(M){ue.get(M)===!1&&(ue.set(M,!0),M.dispatchEvent({type:"abort"}))}a(ne,"abortSignal");const ue=new WeakMap;Object.defineProperties(j.prototype,{aborted:{enumerable:!0}}),typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(j.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortSignal"});class ce{constructor(){z.set(this,se())}get signal(){return H(this)}abort(){ne(H(this))}}a(ce,"AbortController");const z=new WeakMap;function H(M){const X=z.get(M);if(X==null)throw new TypeError(`Expected 'this' to be an 'AbortController' object, but got ${M===null?"null":typeof M}`);return X}a(H,"getSignal"),Object.defineProperties(ce.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}}),typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ce.prototype,Symbol.toStringTag,{configurable:!0,value:"AbortController"}),B.AbortController=ce,B.AbortSignal=j,B.default=ce,m.exports=ce,m.exports.AbortController=m.exports.default=ce,m.exports.AbortSignal=j},5186:(m,B,K)=>{var q=K(3698),j=K(2505),se=K(6417),ne=Function.bind,ue=ne.bind(ne);function ce(pe,$,Y){var Ve=ue(se,null).apply(null,Y?[$,Y]:[$]);pe.api={remove:Ve},pe.remove=Ve,["before","error","after","wrap"].forEach(function(qe){var ot=Y?[$,qe,Y]:[$,qe];pe[qe]=pe.api[qe]=ue(j,null).apply(null,ot)})}a(ce,"bindApi");function z(){var pe="h",$={registry:{}},Y=q.bind(null,$,pe);return ce(Y,$,pe),Y}a(z,"HookSingular");function H(){var pe={registry:{}},$=q.bind(null,pe);return ce($,pe),$}a(H,"HookCollection");var M=!1;function X(){return M||(console.warn('[before-after-hook]: "Hook()" repurposing warning, use "Hook.Collection()". Read more: https://git.io/upgrade-before-after-hook-to-1.4'),M=!0),H()}a(X,"Hook"),X.Singular=z.bind(),X.Collection=H.bind(),m.exports=X,m.exports.Hook=X,m.exports.Singular=X.Singular,m.exports.Collection=X.Collection},2505:m=>{m.exports=B;function B(K,q,j,se){var ne=se;K.registry[j]||(K.registry[j]=[]),q==="before"&&(se=a(function(ue,ce){return Promise.resolve().then(ne.bind(null,ce)).then(ue.bind(null,ce))},"hook")),q==="after"&&(se=a(function(ue,ce){var z;return Promise.resolve().then(ue.bind(null,ce)).then(function(H){return z=H,ne(z,ce)}).then(function(){return z})},"hook")),q==="error"&&(se=a(function(ue,ce){return Promise.resolve().then(ue.bind(null,ce)).catch(function(z){return ne(z,ce)})},"hook")),K.registry[j].push({hook:se,orig:ne})}a(B,"addHook")},3698:m=>{m.exports=B;function B(K,q,j,se){if(typeof j!="function")throw new Error("method for before hook must be a function");return se||(se={}),Array.isArray(q)?q.reverse().reduce(function(ne,ue){return B.bind(null,K,ue,ne,se)},j)():Promise.resolve().then(function(){return K.registry[q]?K.registry[q].reduce(function(ne,ue){return ue.hook.bind(null,ne,se)},j)():j(se)})}a(B,"register")},6417:m=>{m.exports=B;function B(K,q,j){if(!!K.registry[q]){var se=K.registry[q].map(function(ne){return ne.orig}).indexOf(j);se!==-1&&K.registry[q].splice(se,1)}}a(B,"removeHook")},6744:(m,B,K)=>{"use strict";const q=K(3349),j=K(7529),se=K(8050),ne=K(4339),ue=a((ce,z={})=>{let H=[];if(Array.isArray(ce))for(let M of ce){let X=ue.create(M,z);Array.isArray(X)?H.push(...X):H.push(X)}else H=[].concat(ue.create(ce,z));return z&&z.expand===!0&&z.nodupes===!0&&(H=[...new Set(H)]),H},"braces");ue.parse=(ce,z={})=>ne(ce,z),ue.stringify=(ce,z={})=>q(typeof ce=="string"?ue.parse(ce,z):ce,z),ue.compile=(ce,z={})=>(typeof ce=="string"&&(ce=ue.parse(ce,z)),j(ce,z)),ue.expand=(ce,z={})=>{typeof ce=="string"&&(ce=ue.parse(ce,z));let H=se(ce,z);return z.noempty===!0&&(H=H.filter(Boolean)),z.nodupes===!0&&(H=[...new Set(H)]),H},ue.create=(ce,z={})=>ce===""||ce.length<3?[ce]:z.expand!==!0?ue.compile(ce,z):ue.expand(ce,z),m.exports=ue},7529:(m,B,K)=>{"use strict";const q=K(2664),j=K(3083),se=a((ne,ue={})=>{let ce=a((z,H={})=>{let M=j.isInvalidBrace(H),X=z.invalid===!0&&ue.escapeInvalid===!0,pe=M===!0||X===!0,$=ue.escapeInvalid===!0?"\\":"",Y="";if(z.isOpen===!0||z.isClose===!0)return $+z.value;if(z.type==="open")return pe?$+z.value:"(";if(z.type==="close")return pe?$+z.value:")";if(z.type==="comma")return z.prev.type==="comma"?"":pe?z.value:"|";if(z.value)return z.value;if(z.nodes&&z.ranges>0){let Ve=j.reduce(z.nodes),qe=q(...Ve,{...ue,wrap:!1,toRegex:!0});if(qe.length!==0)return Ve.length>1&&qe.length>1?`(${qe})`:qe}if(z.nodes)for(let Ve of z.nodes)Y+=ce(Ve,z);return Y},"walk");return ce(ne)},"compile");m.exports=se},6611:m=>{"use strict";m.exports={MAX_LENGTH:1024*64,CHAR_0:"0",CHAR_9:"9",CHAR_UPPERCASE_A:"A",CHAR_LOWERCASE_A:"a",CHAR_UPPERCASE_Z:"Z",CHAR_LOWERCASE_Z:"z",CHAR_LEFT_PARENTHESES:"(",CHAR_RIGHT_PARENTHESES:")",CHAR_ASTERISK:"*",CHAR_AMPERSAND:"&",CHAR_AT:"@",CHAR_BACKSLASH:"\\",CHAR_BACKTICK:"`",CHAR_CARRIAGE_RETURN:"\r",CHAR_CIRCUMFLEX_ACCENT:"^",CHAR_COLON:":",CHAR_COMMA:",",CHAR_DOLLAR:"$",CHAR_DOT:".",CHAR_DOUBLE_QUOTE:'"',CHAR_EQUAL:"=",CHAR_EXCLAMATION_MARK:"!",CHAR_FORM_FEED:"\f",CHAR_FORWARD_SLASH:"/",CHAR_HASH:"#",CHAR_HYPHEN_MINUS:"-",CHAR_LEFT_ANGLE_BRACKET:"<",CHAR_LEFT_CURLY_BRACE:"{",CHAR_LEFT_SQUARE_BRACKET:"[",CHAR_LINE_FEED:`
`,CHAR_NO_BREAK_SPACE:"\xA0",CHAR_PERCENT:"%",CHAR_PLUS:"+",CHAR_QUESTION_MARK:"?",CHAR_RIGHT_ANGLE_BRACKET:">",CHAR_RIGHT_CURLY_BRACE:"}",CHAR_RIGHT_SQUARE_BRACKET:"]",CHAR_SEMICOLON:";",CHAR_SINGLE_QUOTE:"'",CHAR_SPACE:" ",CHAR_TAB:"	",CHAR_UNDERSCORE:"_",CHAR_VERTICAL_LINE:"|",CHAR_ZERO_WIDTH_NOBREAK_SPACE:"\uFEFF"}},8050:(m,B,K)=>{"use strict";const q=K(2664),j=K(3349),se=K(3083),ne=a((ce="",z="",H=!1)=>{let M=[];if(ce=[].concat(ce),z=[].concat(z),!z.length)return ce;if(!ce.length)return H?se.flatten(z).map(X=>`{${X}}`):z;for(let X of ce)if(Array.isArray(X))for(let pe of X)M.push(ne(pe,z,H));else for(let pe of z)H===!0&&typeof pe=="string"&&(pe=`{${pe}}`),M.push(Array.isArray(pe)?ne(X,pe,H):X+pe);return se.flatten(M)},"append"),ue=a((ce,z={})=>{let H=z.rangeLimit===void 0?1e3:z.rangeLimit,M=a((X,pe={})=>{X.queue=[];let $=pe,Y=pe.queue;for(;$.type!=="brace"&&$.type!=="root"&&$.parent;)$=$.parent,Y=$.queue;if(X.invalid||X.dollar){Y.push(ne(Y.pop(),j(X,z)));return}if(X.type==="brace"&&X.invalid!==!0&&X.nodes.length===2){Y.push(ne(Y.pop(),["{}"]));return}if(X.nodes&&X.ranges>0){let we=se.reduce(X.nodes);if(se.exceedsLimit(...we,z.step,H))throw new RangeError("expanded array length exceeds range limit. Use options.rangeLimit to increase or disable the limit.");let Se=q(...we,z);Se.length===0&&(Se=j(X,z)),Y.push(ne(Y.pop(),Se)),X.nodes=[];return}let Ve=se.encloseBrace(X),qe=X.queue,ot=X;for(;ot.type!=="brace"&&ot.type!=="root"&&ot.parent;)ot=ot.parent,qe=ot.queue;for(let we=0;we<X.nodes.length;we++){let Se=X.nodes[we];if(Se.type==="comma"&&X.type==="brace"){we===1&&qe.push(""),qe.push("");continue}if(Se.type==="close"){Y.push(ne(Y.pop(),qe,Ve));continue}if(Se.value&&Se.type!=="open"){qe.push(ne(qe.pop(),Se.value));continue}Se.nodes&&M(Se,X)}return qe},"walk");return se.flatten(M(ce))},"expand");m.exports=ue},4339:(m,B,K)=>{"use strict";const q=K(3349),{MAX_LENGTH:j,CHAR_BACKSLASH:se,CHAR_BACKTICK:ne,CHAR_COMMA:ue,CHAR_DOT:ce,CHAR_LEFT_PARENTHESES:z,CHAR_RIGHT_PARENTHESES:H,CHAR_LEFT_CURLY_BRACE:M,CHAR_RIGHT_CURLY_BRACE:X,CHAR_LEFT_SQUARE_BRACKET:pe,CHAR_RIGHT_SQUARE_BRACKET:$,CHAR_DOUBLE_QUOTE:Y,CHAR_SINGLE_QUOTE:Ve,CHAR_NO_BREAK_SPACE:qe,CHAR_ZERO_WIDTH_NOBREAK_SPACE:ot}=K(6611),we=a((Se,be={})=>{if(typeof Se!="string")throw new TypeError("Expected a string");let L=be||{},he=typeof L.maxLength=="number"?Math.min(j,L.maxLength):j;if(Se.length>he)throw new SyntaxError(`Input length (${Se.length}), exceeds max characters (${he})`);let te={type:"root",input:Se,nodes:[]},Ae=[te],le=te,de=te,Ce=0,Fe=Se.length,We=0,Je=0,ye,Ue={};const Xe=a(()=>Se[We++],"advance"),Ke=a(Ne=>{if(Ne.type==="text"&&de.type==="dot"&&(de.type="text"),de&&de.type==="text"&&Ne.type==="text"){de.value+=Ne.value;return}return le.nodes.push(Ne),Ne.parent=le,Ne.prev=de,de=Ne,Ne},"push");for(Ke({type:"bos"});We<Fe;)if(le=Ae[Ae.length-1],ye=Xe(),!(ye===ot||ye===qe)){if(ye===se){Ke({type:"text",value:(be.keepEscaping?ye:"")+Xe()});continue}if(ye===$){Ke({type:"text",value:"\\"+ye});continue}if(ye===pe){Ce++;let Ne=!0,De;for(;We<Fe&&(De=Xe());){if(ye+=De,De===pe){Ce++;continue}if(De===se){ye+=Xe();continue}if(De===$&&(Ce--,Ce===0))break}Ke({type:"text",value:ye});continue}if(ye===z){le=Ke({type:"paren",nodes:[]}),Ae.push(le),Ke({type:"text",value:ye});continue}if(ye===H){if(le.type!=="paren"){Ke({type:"text",value:ye});continue}le=Ae.pop(),Ke({type:"text",value:ye}),le=Ae[Ae.length-1];continue}if(ye===Y||ye===Ve||ye===ne){let Ne=ye,De;for(be.keepQuotes!==!0&&(ye="");We<Fe&&(De=Xe());){if(De===se){ye+=De+Xe();continue}if(De===Ne){be.keepQuotes===!0&&(ye+=De);break}ye+=De}Ke({type:"text",value:ye});continue}if(ye===M){Je++;let Ne=de.value&&de.value.slice(-1)==="$"||le.dollar===!0;le=Ke({type:"brace",open:!0,close:!1,dollar:Ne,depth:Je,commas:0,ranges:0,nodes:[]}),Ae.push(le),Ke({type:"open",value:ye});continue}if(ye===X){if(le.type!=="brace"){Ke({type:"text",value:ye});continue}let Ne="close";le=Ae.pop(),le.close=!0,Ke({type:Ne,value:ye}),Je--,le=Ae[Ae.length-1];continue}if(ye===ue&&Je>0){if(le.ranges>0){le.ranges=0;let Ne=le.nodes.shift();le.nodes=[Ne,{type:"text",value:q(le)}]}Ke({type:"comma",value:ye}),le.commas++;continue}if(ye===ce&&Je>0&&le.commas===0){let Ne=le.nodes;if(Je===0||Ne.length===0){Ke({type:"text",value:ye});continue}if(de.type==="dot"){if(le.range=[],de.value+=ye,de.type="range",le.nodes.length!==3&&le.nodes.length!==5){le.invalid=!0,le.ranges=0,de.type="text";continue}le.ranges++,le.args=[];continue}if(de.type==="range"){Ne.pop();let De=Ne[Ne.length-1];De.value+=de.value+ye,de=De,le.ranges--;continue}Ke({type:"dot",value:ye});continue}Ke({type:"text",value:ye})}do if(le=Ae.pop(),le.type!=="root"){le.nodes.forEach(pt=>{pt.nodes||(pt.type==="open"&&(pt.isOpen=!0),pt.type==="close"&&(pt.isClose=!0),pt.nodes||(pt.type="text"),pt.invalid=!0)});let Ne=Ae[Ae.length-1],De=Ne.nodes.indexOf(le);Ne.nodes.splice(De,1,...le.nodes)}while(Ae.length>0);return Ke({type:"eos"}),te},"parse");m.exports=we},3349:(m,B,K)=>{"use strict";const q=K(3083);m.exports=(j,se={})=>{let ne=a((ue,ce={})=>{let z=se.escapeInvalid&&q.isInvalidBrace(ce),H=ue.invalid===!0&&se.escapeInvalid===!0,M="";if(ue.value)return(z||H)&&q.isOpenOrClose(ue)?"\\"+ue.value:ue.value;if(ue.value)return ue.value;if(ue.nodes)for(let X of ue.nodes)M+=ne(X);return M},"stringify");return ne(j)}},3083:(m,B)=>{"use strict";B.isInteger=K=>typeof K=="number"?Number.isInteger(K):typeof K=="string"&&K.trim()!==""?Number.isInteger(Number(K)):!1,B.find=(K,q)=>K.nodes.find(j=>j.type===q),B.exceedsLimit=(K,q,j=1,se)=>se===!1||!B.isInteger(K)||!B.isInteger(q)?!1:(Number(q)-Number(K))/Number(j)>=se,B.escapeNode=(K,q=0,j)=>{let se=K.nodes[q];!se||(j&&se.type===j||se.type==="open"||se.type==="close")&&se.escaped!==!0&&(se.value="\\"+se.value,se.escaped=!0)},B.encloseBrace=K=>K.type!=="brace"?!1:K.commas>>0+K.ranges>>0==0?(K.invalid=!0,!0):!1,B.isInvalidBrace=K=>K.type!=="brace"?!1:K.invalid===!0||K.dollar?!0:K.commas>>0+K.ranges>>0==0||K.open!==!0||K.close!==!0?(K.invalid=!0,!0):!1,B.isOpenOrClose=K=>K.type==="open"||K.type==="close"?!0:K.open===!0||K.close===!0,B.reduce=K=>K.reduce((q,j)=>(j.type==="text"&&q.push(j.value),j.type==="range"&&(j.type="text"),q),[]),B.flatten=(...K)=>{const q=[],j=a(se=>{for(let ne=0;ne<se.length;ne++){let ue=se[ne];Array.isArray(ue)?j(ue,q):ue!==void 0&&q.push(ue)}return q},"flat");return j(K),q}},6724:()=>{},7185:(m,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});const K=new WeakMap,q=new WeakMap;function j(le){const de=K.get(le);return console.assert(de!=null,"'this' is expected an Event object, but got",le),de}a(j,"pd");function se(le){if(le.passiveListener!=null){typeof console!="undefined"&&typeof console.error=="function"&&console.error("Unable to preventDefault inside passive event listener invocation.",le.passiveListener);return}!le.event.cancelable||(le.canceled=!0,typeof le.event.preventDefault=="function"&&le.event.preventDefault())}a(se,"setCancelFlag");function ne(le,de){K.set(this,{eventTarget:le,event:de,eventPhase:2,currentTarget:le,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:de.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});const Ce=Object.keys(de);for(let Fe=0;Fe<Ce.length;++Fe){const We=Ce[Fe];We in this||Object.defineProperty(this,We,ue(We))}}a(ne,"Event"),ne.prototype={get type(){return j(this).event.type},get target(){return j(this).eventTarget},get currentTarget(){return j(this).currentTarget},composedPath(){const le=j(this).currentTarget;return le==null?[]:[le]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return j(this).eventPhase},stopPropagation(){const le=j(this);le.stopped=!0,typeof le.event.stopPropagation=="function"&&le.event.stopPropagation()},stopImmediatePropagation(){const le=j(this);le.stopped=!0,le.immediateStopped=!0,typeof le.event.stopImmediatePropagation=="function"&&le.event.stopImmediatePropagation()},get bubbles(){return Boolean(j(this).event.bubbles)},get cancelable(){return Boolean(j(this).event.cancelable)},preventDefault(){se(j(this))},get defaultPrevented(){return j(this).canceled},get composed(){return Boolean(j(this).event.composed)},get timeStamp(){return j(this).timeStamp},get srcElement(){return j(this).eventTarget},get cancelBubble(){return j(this).stopped},set cancelBubble(le){if(!le)return;const de=j(this);de.stopped=!0,typeof de.event.cancelBubble=="boolean"&&(de.event.cancelBubble=!0)},get returnValue(){return!j(this).canceled},set returnValue(le){le||se(j(this))},initEvent(){}},Object.defineProperty(ne.prototype,"constructor",{value:ne,configurable:!0,writable:!0}),typeof window!="undefined"&&typeof window.Event!="undefined"&&(Object.setPrototypeOf(ne.prototype,window.Event.prototype),q.set(window.Event.prototype,ne));function ue(le){return{get(){return j(this).event[le]},set(de){j(this).event[le]=de},configurable:!0,enumerable:!0}}a(ue,"defineRedirectDescriptor");function ce(le){return{value(){const de=j(this).event;return de[le].apply(de,arguments)},configurable:!0,enumerable:!0}}a(ce,"defineCallDescriptor");function z(le,de){const Ce=Object.keys(de);if(Ce.length===0)return le;function Fe(We,Je){le.call(this,We,Je)}a(Fe,"CustomEvent"),Fe.prototype=Object.create(le.prototype,{constructor:{value:Fe,configurable:!0,writable:!0}});for(let We=0;We<Ce.length;++We){const Je=Ce[We];if(!(Je in le.prototype)){const Ue=typeof Object.getOwnPropertyDescriptor(de,Je).value=="function";Object.defineProperty(Fe.prototype,Je,Ue?ce(Je):ue(Je))}}return Fe}a(z,"defineWrapper");function H(le){if(le==null||le===Object.prototype)return ne;let de=q.get(le);return de==null&&(de=z(H(Object.getPrototypeOf(le)),le),q.set(le,de)),de}a(H,"getWrapper");function M(le,de){const Ce=H(Object.getPrototypeOf(de));return new Ce(le,de)}a(M,"wrapEvent");function X(le){return j(le).immediateStopped}a(X,"isStopped");function pe(le,de){j(le).eventPhase=de}a(pe,"setEventPhase");function $(le,de){j(le).currentTarget=de}a($,"setCurrentTarget");function Y(le,de){j(le).passiveListener=de}a(Y,"setPassiveListener");const Ve=new WeakMap,qe=1,ot=2,we=3;function Se(le){return le!==null&&typeof le=="object"}a(Se,"isObject");function be(le){const de=Ve.get(le);if(de==null)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return de}a(be,"getListeners");function L(le){return{get(){let Ce=be(this).get(le);for(;Ce!=null;){if(Ce.listenerType===we)return Ce.listener;Ce=Ce.next}return null},set(de){typeof de!="function"&&!Se(de)&&(de=null);const Ce=be(this);let Fe=null,We=Ce.get(le);for(;We!=null;)We.listenerType===we?Fe!==null?Fe.next=We.next:We.next!==null?Ce.set(le,We.next):Ce.delete(le):Fe=We,We=We.next;if(de!==null){const Je={listener:de,listenerType:we,passive:!1,once:!1,next:null};Fe===null?Ce.set(le,Je):Fe.next=Je}},configurable:!0,enumerable:!0}}a(L,"defineEventAttributeDescriptor");function he(le,de){Object.defineProperty(le,`on${de}`,L(de))}a(he,"defineEventAttribute");function te(le){function de(){Ae.call(this)}a(de,"CustomEventTarget"),de.prototype=Object.create(Ae.prototype,{constructor:{value:de,configurable:!0,writable:!0}});for(let Ce=0;Ce<le.length;++Ce)he(de.prototype,le[Ce]);return de}a(te,"defineCustomEventTarget");function Ae(){if(this instanceof Ae){Ve.set(this,new Map);return}if(arguments.length===1&&Array.isArray(arguments[0]))return te(arguments[0]);if(arguments.length>0){const le=new Array(arguments.length);for(let de=0;de<arguments.length;++de)le[de]=arguments[de];return te(le)}throw new TypeError("Cannot call a class as a function")}a(Ae,"EventTarget"),Ae.prototype={addEventListener(le,de,Ce){if(de==null)return;if(typeof de!="function"&&!Se(de))throw new TypeError("'listener' should be a function or an object.");const Fe=be(this),We=Se(Ce),ye=Boolean(We?Ce.capture:Ce)?qe:ot,Ue={listener:de,listenerType:ye,passive:We&&Boolean(Ce.passive),once:We&&Boolean(Ce.once),next:null};let Xe=Fe.get(le);if(Xe===void 0){Fe.set(le,Ue);return}let Ke=null;for(;Xe!=null;){if(Xe.listener===de&&Xe.listenerType===ye)return;Ke=Xe,Xe=Xe.next}Ke.next=Ue},removeEventListener(le,de,Ce){if(de==null)return;const Fe=be(this),Je=(Se(Ce)?Boolean(Ce.capture):Boolean(Ce))?qe:ot;let ye=null,Ue=Fe.get(le);for(;Ue!=null;){if(Ue.listener===de&&Ue.listenerType===Je){ye!==null?ye.next=Ue.next:Ue.next!==null?Fe.set(le,Ue.next):Fe.delete(le);return}ye=Ue,Ue=Ue.next}},dispatchEvent(le){if(le==null||typeof le.type!="string")throw new TypeError('"event.type" should be a string.');const de=be(this),Ce=le.type;let Fe=de.get(Ce);if(Fe==null)return!0;const We=M(this,le);let Je=null;for(;Fe!=null;){if(Fe.once?Je!==null?Je.next=Fe.next:Fe.next!==null?de.set(Ce,Fe.next):de.delete(Ce):Je=Fe,Y(We,Fe.passive?Fe.listener:null),typeof Fe.listener=="function")try{Fe.listener.call(this,We)}catch(ye){typeof console!="undefined"&&typeof console.error=="function"&&console.error(ye)}else Fe.listenerType!==we&&typeof Fe.listener.handleEvent=="function"&&Fe.listener.handleEvent(We);if(X(We))break;Fe=Fe.next}return Y(We,null),pe(We,0),$(We,null),!We.defaultPrevented}},Object.defineProperty(Ae.prototype,"constructor",{value:Ae,configurable:!0,writable:!0}),typeof window!="undefined"&&typeof window.EventTarget!="undefined"&&Object.setPrototypeOf(Ae.prototype,window.EventTarget.prototype),B.defineEventAttribute=he,B.EventTarget=Ae,B.default=Ae,m.exports=Ae,m.exports.EventTarget=m.exports.default=Ae,m.exports.defineEventAttribute=he},1:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";const Token=__webpack_require__(3416),strtok3=__webpack_require__(5849),{stringToBytes,tarHeaderChecksumMatches,uint32SyncSafeToken}=__webpack_require__(6188),supported=__webpack_require__(9898),minimumBytes=4100;async function fromStream(m){const B=await strtok3.fromStream(m);try{return await fromTokenizer(B)}finally{await B.close()}}a(fromStream,"fromStream");async function fromBuffer(m){if(!(m instanceof Uint8Array||m instanceof ArrayBuffer||Buffer.isBuffer(m)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof m}\``);const B=m instanceof Buffer?m:Buffer.from(m);if(!(B&&B.length>1))return;const K=strtok3.fromBuffer(B);return fromTokenizer(K)}a(fromBuffer,"fromBuffer");function _check(m,B,K){K={offset:0,...K};for(const[q,j]of B.entries())if(K.mask){if(j!==(K.mask[q]&m[q+K.offset]))return!1}else if(j!==m[q+K.offset])return!1;return!0}a(_check,"_check");async function fromTokenizer(m){try{return _fromTokenizer(m)}catch(B){if(!(B instanceof strtok3.EndOfStreamError))throw B}}a(fromTokenizer,"fromTokenizer");async function _fromTokenizer(m){let B=Buffer.alloc(minimumBytes);const K=12,q=a((se,ne)=>_check(B,se,ne),"check"),j=a((se,ne)=>q(stringToBytes(se),ne),"checkString");if(m.fileInfo.size||(m.fileInfo.size=Number.MAX_SAFE_INTEGER),await m.peekBuffer(B,{length:K,mayBeLess:!0}),q([66,77]))return{ext:"bmp",mime:"image/bmp"};if(q([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(q([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(q([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(q([37,33]))return await m.peekBuffer(B,{length:24,mayBeLess:!0}),j("PS-Adobe-",{offset:2})&&j(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(q([31,160])||q([31,157]))return{ext:"Z",mime:"application/x-compress"};if(q([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(q([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(q([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(q([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(j("ID3")){await m.ignore(6);const se=await m.readToken(uint32SyncSafeToken);return m.position+se>m.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await m.ignore(se),fromTokenizer(m))}if(j("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((B[0]===67||B[0]===70)&&q([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(q([71,73,70]))return{ext:"gif",mime:"image/gif"};if(j("FLIF"))return{ext:"flif",mime:"image/flif"};if(j("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(j("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(j("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(j("FORM"))return{ext:"aif",mime:"audio/aiff"};if(j("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(q([80,75,3,4])){try{for(;m.position+30<m.fileInfo.size;){await m.readBuffer(B,{length:30});const se={compressedSize:B.readUInt32LE(18),uncompressedSize:B.readUInt32LE(22),filenameLength:B.readUInt16LE(26),extraFieldLength:B.readUInt16LE(28)};if(se.filename=await m.readToken(new Token.StringType(se.filenameLength,"utf-8")),await m.ignore(se.extraFieldLength),se.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(se.filename.endsWith(".rels")||se.filename.endsWith(".xml"))switch(se.filename.split("/")[0]){case"_rels":break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};default:break}if(se.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(se.filename.startsWith("3D/")&&se.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(se.filename==="mimetype"&&se.compressedSize===se.uncompressedSize)switch(await m.readToken(new Token.StringType(se.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};default:}if(se.compressedSize===0){let ne=-1;for(;ne<0&&m.position<m.fileInfo.size;)await m.peekBuffer(B,{mayBeLess:!0}),ne=B.indexOf("504B0304",0,"hex"),await m.ignore(ne>=0?ne:B.length)}else await m.ignore(se.compressedSize)}}catch(se){if(!(se instanceof strtok3.EndOfStreamError))throw se}return{ext:"zip",mime:"application/zip"}}if(j("OggS")){await m.ignore(28);const se=Buffer.alloc(8);return await m.readBuffer(se),_check(se,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:_check(se,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(se,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(se,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(se,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(se,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(q([80,75])&&(B[2]===3||B[2]===5||B[2]===7)&&(B[3]===4||B[3]===6||B[3]===8))return{ext:"zip",mime:"application/zip"};if(j("ftyp",{offset:4})&&(B[8]&96)!=0){const se=B.toString("binary",8,12).replace("\0"," ").trim();switch(se){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return se.startsWith("3g")?se.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(j("MThd"))return{ext:"mid",mime:"audio/midi"};if(j("wOFF")&&(q([0,1,0,0],{offset:4})||j("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(j("wOF2")&&(q([0,1,0,0],{offset:4})||j("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(q([212,195,178,161])||q([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(j("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(j("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(j("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(q([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(j("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(j("%PDF")){await m.ignore(1350);const se=10*1024*1024,ne=Buffer.alloc(Math.min(se,m.fileInfo.size));return await m.readBuffer(ne,{mayBeLess:!0}),ne.includes(Buffer.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(q([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(q([73,73,42,0]))return j("CR",{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:q([28,0,254,0],{offset:8})||q([31,0,11,0],{offset:8})?{ext:"nef",mime:"image/x-nikon-nef"}:q([8,0,0,0],{offset:4})&&(q([45,0,254,0],{offset:8})||q([39,0,254,0],{offset:8}))?{ext:"dng",mime:"image/x-adobe-dng"}:(B=Buffer.alloc(24),await m.peekBuffer(B),(q([16,251,134,1],{offset:4})||q([8,0,0,0],{offset:4}))&&q([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9})?{ext:"arw",mime:"image/x-sony-arw"}:{ext:"tif",mime:"image/tiff"});if(q([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(j("MAC "))return{ext:"ape",mime:"audio/ape"};if(q([26,69,223,163])){async function se(){const H=await m.peekNumber(Token.UINT8);let M=128,X=0;for(;(H&M)==0;)++X,M>>=1;const pe=Buffer.alloc(X+1);return await m.readBuffer(pe),pe}a(se,"readField");async function ne(){const H=await se(),M=await se();M[0]^=128>>M.length-1;const X=Math.min(6,M.length);return{id:H.readUIntBE(0,H.length),len:M.readUIntBE(M.length-X,X)}}a(ne,"readElement");async function ue(H,M){for(;M>0;){const X=await ne();if(X.id===17026)return m.readToken(new Token.StringType(X.len,"utf-8"));await m.ignore(X.len),--M}}a(ue,"readChildren");const ce=await ne();switch(await ue(1,ce.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(q([82,73,70,70])){if(q([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(q([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(q([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(j("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(q([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(j("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(j("MSCF")||j("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(q([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(q([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(q([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(q([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(j("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(j("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(q([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(j("IMPM"))return{ext:"it",mime:"audio/x-it"};if(j("-lh0-",{offset:2})||j("-lh1-",{offset:2})||j("-lh2-",{offset:2})||j("-lh3-",{offset:2})||j("-lh4-",{offset:2})||j("-lh5-",{offset:2})||j("-lh6-",{offset:2})||j("-lh7-",{offset:2})||j("-lzs-",{offset:2})||j("-lz4-",{offset:2})||j("-lz5-",{offset:2})||j("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(q([0,0,1,186])){if(q([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(q([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(j("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(q([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(j("<?xml "))return{ext:"xml",mime:"application/xml"};if(q([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(q([82,97,114,33,26,7])&&(B[6]===0||B[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(j("solid "))return{ext:"stl",mime:"model/stl"};if(j("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(j("!<arch>"))return await m.ignore(8),await m.readToken(new Token.StringType(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(q([137,80,78,71,13,10,26,10])){await m.ignore(8);async function se(){return{length:await m.readToken(Token.INT32_BE),type:await m.readToken(new Token.StringType(4,"binary"))}}a(se,"readChunkHeader");do{const ne=await se();if(ne.length<0)return;switch(ne.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await m.ignore(ne.length+4)}}while(m.position+8<m.fileInfo.size);return{ext:"png",mime:"image/png"}}if(q([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(q([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(q([102,114,101,101],{offset:4})||q([109,100,97,116],{offset:4})||q([109,111,111,118],{offset:4})||q([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(q([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(j("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(q([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(q([48,38,178,117,142,102,207,17,166,217])){async function se(){const ne=Buffer.alloc(16);return await m.readBuffer(ne),{id:ne,size:Number(await m.readToken(Token.UINT64_LE))}}for(a(se,"readHeader"),await m.ignore(30);m.position+24<m.fileInfo.size;){const ne=await se();let ue=ne.size-24;if(_check(ne.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const ce=Buffer.alloc(16);if(ue-=await m.readBuffer(ce),_check(ce,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check(ce,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await m.ignore(ue)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(q([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((q([126,16,4])||q([126,24,4]))&&q([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(q([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(q([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await m.ignore(20),await m.readToken(new Token.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(q([255,10])||q([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(q([0,0,1,186])||q([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(q([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(q([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(q([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(q([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await m.peekBuffer(B,{length:Math.min(256,m.fileInfo.size),mayBeLess:!0}),j("BEGIN:")){if(j("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(j("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(j("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(j("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(j("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(q([4,0,0,0])&&B.length>=16){const se=B.readUInt32LE(12);if(se>12&&B.length>=se+16)try{const ne=B.slice(16,se+16).toString();if(JSON.parse(ne).files)return{ext:"asar",mime:"application/x-asar"}}catch(ne){}}if(q([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(j("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(q([71],{offset:4})&&(q([71],{offset:192})||q([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(q([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(q([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(q([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(q([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(q([76,80],{offset:34})&&(q([0,0,1],{offset:8})||q([1,0,2],{offset:8})||q([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(q([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await m.peekBuffer(B,{length:Math.min(512,m.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(B))return{ext:"tar",mime:"application/x-tar"};if(q([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(j("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(B.length>=2&&q([255,224],{offset:0,mask:[255,224]})){if(q([16],{offset:1,mask:[22]}))return q([8],{offset:1,mask:[8]})?{ext:"aac",mime:"audio/aac"}:{ext:"aac",mime:"audio/aac"};if(q([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(q([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(q([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}a(_fromTokenizer,"_fromTokenizer");const stream=a(readableStream=>new Promise((resolve,reject)=>{const stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",async()=>{const m=new stream.PassThrough;let B;stream.pipeline?B=stream.pipeline(readableStream,m,()=>{}):B=readableStream.pipe(m);const K=readableStream.read(minimumBytes)||readableStream.read()||Buffer.alloc(0);try{const q=await fromBuffer(K);m.fileType=q}catch(q){reject(q)}resolve(B)})}),"stream"),fileType={fromStream,fromTokenizer,fromBuffer,stream};Object.defineProperty(fileType,"extensions",{get(){return new Set(supported.extensions)}}),Object.defineProperty(fileType,"mimeTypes",{get(){return new Set(supported.mimeTypes)}}),module.exports=fileType},7769:(m,B,K)=>{"use strict";const q=K(6597),j=K(1);async function se(ue){const ce=await q.fromFile(ue);try{return await j.fromTokenizer(ce)}finally{await ce.close()}}a(se,"fromFile");const ne={fromFile:se};Object.assign(ne,j),Object.defineProperty(ne,"extensions",{get(){return j.extensions}}),Object.defineProperty(ne,"mimeTypes",{get(){return j.mimeTypes}}),m.exports=ne},9898:m=>{"use strict";m.exports={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]}},6188:(m,B)=>{"use strict";B.stringToBytes=K=>[...K].map(q=>q.charCodeAt(0)),B.tarHeaderChecksumMatches=(K,q=0)=>{const j=parseInt(K.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(j))return!1;let se=8*32;for(let ne=q;ne<q+148;ne++)se+=K[ne];for(let ne=q+156;ne<q+512;ne++)se+=K[ne];return j===se},B.uint32SyncSafeToken={get:(K,q)=>K[q+3]&127|K[q+2]<<7|K[q+1]<<14|K[q]<<21,len:4}},2664:(m,B,K)=>{"use strict";/*!
 * fill-range <https://github.com/jonschlinkert/fill-range>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Licensed under the MIT License.
 */const q=K(3837),j=K(5702),se=a(L=>L!==null&&typeof L=="object"&&!Array.isArray(L),"isObject"),ne=a(L=>he=>L===!0?Number(he):String(he),"transform"),ue=a(L=>typeof L=="number"||typeof L=="string"&&L!=="","isValidValue"),ce=a(L=>Number.isInteger(+L),"isNumber"),z=a(L=>{let he=`${L}`,te=-1;if(he[0]==="-"&&(he=he.slice(1)),he==="0")return!1;for(;he[++te]==="0";);return te>0},"zeros"),H=a((L,he,te)=>typeof L=="string"||typeof he=="string"?!0:te.stringify===!0,"stringify"),M=a((L,he,te)=>{if(he>0){let Ae=L[0]==="-"?"-":"";Ae&&(L=L.slice(1)),L=Ae+L.padStart(Ae?he-1:he,"0")}return te===!1?String(L):L},"pad"),X=a((L,he)=>{let te=L[0]==="-"?"-":"";for(te&&(L=L.slice(1),he--);L.length<he;)L="0"+L;return te?"-"+L:L},"toMaxLen"),pe=a((L,he)=>{L.negatives.sort((Ce,Fe)=>Ce<Fe?-1:Ce>Fe?1:0),L.positives.sort((Ce,Fe)=>Ce<Fe?-1:Ce>Fe?1:0);let te=he.capture?"":"?:",Ae="",le="",de;return L.positives.length&&(Ae=L.positives.join("|")),L.negatives.length&&(le=`-(${te}${L.negatives.join("|")})`),Ae&&le?de=`${Ae}|${le}`:de=Ae||le,he.wrap?`(${te}${de})`:de},"toSequence"),$=a((L,he,te,Ae)=>{if(te)return j(L,he,{wrap:!1,...Ae});let le=String.fromCharCode(L);if(L===he)return le;let de=String.fromCharCode(he);return`[${le}-${de}]`},"toRange"),Y=a((L,he,te)=>{if(Array.isArray(L)){let Ae=te.wrap===!0,le=te.capture?"":"?:";return Ae?`(${le}${L.join("|")})`:L.join("|")}return j(L,he,te)},"toRegex"),Ve=a((...L)=>new RangeError("Invalid range arguments: "+q.inspect(...L)),"rangeError"),qe=a((L,he,te)=>{if(te.strictRanges===!0)throw Ve([L,he]);return[]},"invalidRange"),ot=a((L,he)=>{if(he.strictRanges===!0)throw new TypeError(`Expected step "${L}" to be a number`);return[]},"invalidStep"),we=a((L,he,te=1,Ae={})=>{let le=Number(L),de=Number(he);if(!Number.isInteger(le)||!Number.isInteger(de)){if(Ae.strictRanges===!0)throw Ve([L,he]);return[]}le===0&&(le=0),de===0&&(de=0);let Ce=le>de,Fe=String(L),We=String(he),Je=String(te);te=Math.max(Math.abs(te),1);let ye=z(Fe)||z(We)||z(Je),Ue=ye?Math.max(Fe.length,We.length,Je.length):0,Xe=ye===!1&&H(L,he,Ae)===!1,Ke=Ae.transform||ne(Xe);if(Ae.toRegex&&te===1)return $(X(L,Ue),X(he,Ue),!0,Ae);let Ne={negatives:[],positives:[]},De=a(xe=>Ne[xe<0?"negatives":"positives"].push(Math.abs(xe)),"push"),pt=[],Rt=0;for(;Ce?le>=de:le<=de;)Ae.toRegex===!0&&te>1?De(le):pt.push(M(Ke(le,Rt),Ue,Xe)),le=Ce?le-te:le+te,Rt++;return Ae.toRegex===!0?te>1?pe(Ne,Ae):Y(pt,null,{wrap:!1,...Ae}):pt},"fillNumbers"),Se=a((L,he,te=1,Ae={})=>{if(!ce(L)&&L.length>1||!ce(he)&&he.length>1)return qe(L,he,Ae);let le=Ae.transform||(Xe=>String.fromCharCode(Xe)),de=`${L}`.charCodeAt(0),Ce=`${he}`.charCodeAt(0),Fe=de>Ce,We=Math.min(de,Ce),Je=Math.max(de,Ce);if(Ae.toRegex&&te===1)return $(We,Je,!1,Ae);let ye=[],Ue=0;for(;Fe?de>=Ce:de<=Ce;)ye.push(le(de,Ue)),de=Fe?de-te:de+te,Ue++;return Ae.toRegex===!0?Y(ye,null,{wrap:!1,options:Ae}):ye},"fillLetters"),be=a((L,he,te,Ae={})=>{if(he==null&&ue(L))return[L];if(!ue(L)||!ue(he))return qe(L,he,Ae);if(typeof te=="function")return be(L,he,1,{transform:te});if(se(te))return be(L,he,0,te);let le={...Ae};return le.capture===!0&&(le.wrap=!0),te=te||le.step||1,ce(te)?ce(L)&&ce(he)?we(L,he,te,le):Se(L,he,Math.max(Math.abs(te),1),le):te!=null&&!se(te)?ot(te,le):be(L,he,1,te)},"fill");m.exports=be},7360:function(m,B){var K,q,j;(function(se,ne){q=[],K=ne,j=typeof K=="function"?K.apply(B,q):K,j!==void 0&&(m.exports=j)})(this,a(function(){function ne(we){var Se={single:function(be,L,he){if(!be||(Ve(be)||(be=Se.getPreparedSearch(be)),!L))return null;Ve(L)||(L=Se.getPrepared(L));var te=he&&he.allowTypo!==void 0?he.allowTypo:we&&we.allowTypo!==void 0?we.allowTypo:!0,Ae=te?Se.algorithm:Se.algorithmNoTypo;return Ae(be,L,be[0])},go:function(be,L,he){if(!be)return H;be=Se.prepareSearch(be);var te=be[0],Ae=he&&he.threshold||we&&we.threshold||-9007199254740991,le=he&&he.limit||we&&we.limit||9007199254740991,de=he&&he.allowTypo!==void 0?he.allowTypo:we&&we.allowTypo!==void 0?we.allowTypo:!0,Ce=de?Se.algorithm:Se.algorithmNoTypo,Fe=0,We=0,Je=L.length;if(he&&he.keys)for(var ye=he.scoreFn||$,Ue=he.keys,Xe=Ue.length,Ke=Je-1;Ke>=0;--Ke){for(var Ne=L[Ke],De=new Array(Xe),pt=Xe-1;pt>=0;--pt){var Rt=Ue[pt],xe=Y(Ne,Rt);if(!xe){De[pt]=null;continue}Ve(xe)||(xe=Se.getPrepared(xe)),De[pt]=Ce(be,xe,te)}De.obj=Ne;var Pt=ye(De);Pt!==null&&(Pt<Ae||(De.score=Pt,Fe<le?(ot.add(De),++Fe):(++We,Pt>ot.peek().score&&ot.replaceTop(De))))}else if(he&&he.key)for(var Rt=he.key,Ke=Je-1;Ke>=0;--Ke){var Ne=L[Ke],xe=Y(Ne,Rt);if(!!xe){Ve(xe)||(xe=Se.getPrepared(xe));var ut=Ce(be,xe,te);ut!==null&&(ut.score<Ae||(ut={target:ut.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:ut.score,indexes:ut.indexes,obj:Ne},Fe<le?(ot.add(ut),++Fe):(++We,ut.score>ot.peek().score&&ot.replaceTop(ut))))}}else for(var Ke=Je-1;Ke>=0;--Ke){var xe=L[Ke];if(!!xe){Ve(xe)||(xe=Se.getPrepared(xe));var ut=Ce(be,xe,te);ut!==null&&(ut.score<Ae||(Fe<le?(ot.add(ut),++Fe):(++We,ut.score>ot.peek().score&&ot.replaceTop(ut))))}}if(Fe===0)return H;for(var It=new Array(Fe),Ke=Fe-1;Ke>=0;--Ke)It[Ke]=ot.poll();return It.total=Fe+We,It},goAsync:function(be,L,he){var te=!1,Ae=new Promise(function(le,de){if(!be)return le(H);be=Se.prepareSearch(be);var Ce=be[0],Fe=qe(),We=L.length-1,Je=he&&he.threshold||we&&we.threshold||-9007199254740991,ye=he&&he.limit||we&&we.limit||9007199254740991,Ue=he&&he.allowTypo!==void 0?he.allowTypo:we&&we.allowTypo!==void 0?we.allowTypo:!0,Xe=Ue?Se.algorithm:Se.algorithmNoTypo,Ke=0,Ne=0;function De(){if(te)return de("canceled");var pt=Date.now();if(he&&he.keys)for(var Rt=he.scoreFn||$,xe=he.keys,Pt=xe.length;We>=0;--We){for(var ut=L[We],It=new Array(Pt),Be=Pt-1;Be>=0;--Be){var Me=xe[Be],vt=Y(ut,Me);if(!vt){It[Be]=null;continue}Ve(vt)||(vt=Se.getPrepared(vt)),It[Be]=Xe(be,vt,Ce)}It.obj=ut;var Ct=Rt(It);if(Ct!==null&&!(Ct<Je)&&(It.score=Ct,Ke<ye?(Fe.add(It),++Ke):(++Ne,Ct>Fe.peek().score&&Fe.replaceTop(It)),We%1e3==0&&Date.now()-pt>=10)){ue?setImmediate(De):setTimeout(De);return}}else if(he&&he.key)for(var Me=he.key;We>=0;--We){var ut=L[We],vt=Y(ut,Me);if(!!vt){Ve(vt)||(vt=Se.getPrepared(vt));var Ut=Xe(be,vt,Ce);if(Ut!==null&&!(Ut.score<Je)&&(Ut={target:Ut.target,_targetLowerCodes:null,_nextBeginningIndexes:null,score:Ut.score,indexes:Ut.indexes,obj:ut},Ke<ye?(Fe.add(Ut),++Ke):(++Ne,Ut.score>Fe.peek().score&&Fe.replaceTop(Ut)),We%1e3==0&&Date.now()-pt>=10)){ue?setImmediate(De):setTimeout(De);return}}}else for(;We>=0;--We){var vt=L[We];if(!!vt){Ve(vt)||(vt=Se.getPrepared(vt));var Ut=Xe(be,vt,Ce);if(Ut!==null&&!(Ut.score<Je)&&(Ke<ye?(Fe.add(Ut),++Ke):(++Ne,Ut.score>Fe.peek().score&&Fe.replaceTop(Ut)),We%1e3==0&&Date.now()-pt>=10)){ue?setImmediate(De):setTimeout(De);return}}}if(Ke===0)return le(H);for(var wr=new Array(Ke),Wt=Ke-1;Wt>=0;--Wt)wr[Wt]=Fe.poll();wr.total=Ke+Ne,le(wr)}a(De,"step"),ue?setImmediate(De):De()});return Ae.cancel=function(){te=!0},Ae},highlight:function(be,L,he){if(be===null)return null;L===void 0&&(L="<b>"),he===void 0&&(he="</b>");for(var te="",Ae=0,le=!1,de=be.target,Ce=de.length,Fe=be.indexes,We=0;We<Ce;++We){var Je=de[We];if(Fe[Ae]===We){if(++Ae,le||(le=!0,te+=L),Ae===Fe.length){te+=Je+he+de.substr(We+1);break}}else le&&(le=!1,te+=he);te+=Je}return te},prepare:function(be){if(!!be)return{target:be,_targetLowerCodes:Se.prepareLowerCodes(be),_nextBeginningIndexes:null,score:null,indexes:null,obj:null}},prepareSlow:function(be){if(!!be)return{target:be,_targetLowerCodes:Se.prepareLowerCodes(be),_nextBeginningIndexes:Se.prepareNextBeginningIndexes(be),score:null,indexes:null,obj:null}},prepareSearch:function(be){if(!!be)return Se.prepareLowerCodes(be)},getPrepared:function(be){if(be.length>999)return Se.prepare(be);var L=ce.get(be);return L!==void 0||(L=Se.prepare(be),ce.set(be,L)),L},getPreparedSearch:function(be){if(be.length>999)return Se.prepareSearch(be);var L=z.get(be);return L!==void 0||(L=Se.prepareSearch(be),z.set(be,L)),L},algorithm:function(be,L,he){for(var te=L._targetLowerCodes,Ae=be.length,le=te.length,de=0,Ce=0,Fe=0,We=0;;){var Je=he===te[Ce];if(Je){if(M[We++]=Ce,++de,de===Ae)break;he=be[Fe===0?de:Fe===de?de+1:Fe===de-1?de-1:de]}if(++Ce,Ce>=le)for(;;){if(de<=1)return null;if(Fe===0){--de;var ye=be[de];if(he===ye)continue;Fe=de}else{if(Fe===1)return null;--Fe,de=Fe,he=be[de+1];var ye=be[de];if(he===ye)continue}We=de,Ce=M[We-1]+1;break}}var de=0,Ue=0,Xe=!1,Ke=0,Ne=L._nextBeginningIndexes;Ne===null&&(Ne=L._nextBeginningIndexes=Se.prepareNextBeginningIndexes(L.target));var De=Ce=M[0]===0?0:Ne[M[0]-1];if(Ce!==le)for(;;)if(Ce>=le){if(de<=0){if(++Ue,Ue>Ae-2)break;if(be[Ue]===be[Ue+1])continue;Ce=De;continue}--de;var pt=X[--Ke];Ce=Ne[pt]}else{var Je=be[Ue===0?de:Ue===de?de+1:Ue===de-1?de-1:de]===te[Ce];if(Je){if(X[Ke++]=Ce,++de,de===Ae){Xe=!0;break}++Ce}else Ce=Ne[Ce]}{if(Xe)var Rt=X,xe=Ke;else var Rt=M,xe=We;for(var Pt=0,ut=-1,It=0;It<Ae;++It){var Ce=Rt[It];ut!==Ce-1&&(Pt-=Ce),ut=Ce}Xe?Ue!==0&&(Pt+=-20):(Pt*=1e3,Fe!==0&&(Pt+=-20)),Pt-=le-Ae,L.score=Pt,L.indexes=new Array(xe);for(var It=xe-1;It>=0;--It)L.indexes[It]=Rt[It];return L}},algorithmNoTypo:function(be,L,he){for(var te=L._targetLowerCodes,Ae=be.length,le=te.length,de=0,Ce=0,Fe=0;;){var We=he===te[Ce];if(We){if(M[Fe++]=Ce,++de,de===Ae)break;he=be[de]}if(++Ce,Ce>=le)return null}var de=0,Je=!1,ye=0,Ue=L._nextBeginningIndexes;Ue===null&&(Ue=L._nextBeginningIndexes=Se.prepareNextBeginningIndexes(L.target));var Xe=Ce=M[0]===0?0:Ue[M[0]-1];if(Ce!==le)for(;;)if(Ce>=le){if(de<=0)break;--de;var Ke=X[--ye];Ce=Ue[Ke]}else{var We=be[de]===te[Ce];if(We){if(X[ye++]=Ce,++de,de===Ae){Je=!0;break}++Ce}else Ce=Ue[Ce]}{if(Je)var Ne=X,De=ye;else var Ne=M,De=Fe;for(var pt=0,Rt=-1,xe=0;xe<Ae;++xe){var Ce=Ne[xe];Rt!==Ce-1&&(pt-=Ce),Rt=Ce}Je||(pt*=1e3),pt-=le-Ae,L.score=pt,L.indexes=new Array(De);for(var xe=De-1;xe>=0;--xe)L.indexes[xe]=Ne[xe];return L}},prepareLowerCodes:function(be){for(var L=be.length,he=[],te=be.toLowerCase(),Ae=0;Ae<L;++Ae)he[Ae]=te.charCodeAt(Ae);return he},prepareBeginningIndexes:function(be){for(var L=be.length,he=[],te=0,Ae=!1,le=!1,de=0;de<L;++de){var Ce=be.charCodeAt(de),Fe=Ce>=65&&Ce<=90,We=Fe||Ce>=97&&Ce<=122||Ce>=48&&Ce<=57,Je=Fe&&!Ae||!le||!We;Ae=Fe,le=We,Je&&(he[te++]=de)}return he},prepareNextBeginningIndexes:function(be){for(var L=be.length,he=Se.prepareBeginningIndexes(be),te=[],Ae=he[0],le=0,de=0;de<L;++de)Ae>de?te[de]=Ae:(Ae=he[++le],te[de]=Ae===void 0?L:Ae);return te},cleanup:pe,new:ne};return Se}a(ne,"fuzzysortNew");var ue=typeof window=="undefined",ce=new Map,z=new Map,H=[];H.total=0;var M=[],X=[];function pe(){ce.clear(),z.clear(),M=[],X=[]}a(pe,"cleanup");function $(we){for(var Se=-9007199254740991,be=we.length-1;be>=0;--be){var L=we[be];if(L!==null){var he=L.score;he>Se&&(Se=he)}}return Se===-9007199254740991?null:Se}a($,"defaultScoreFn");function Y(we,Se){var be=we[Se];if(be!==void 0)return be;var L=Se;Array.isArray(Se)||(L=Se.split("."));for(var he=L.length,te=-1;we&&++te<he;)we=we[L[te]];return we}a(Y,"getValue");function Ve(we){return typeof we=="object"}a(Ve,"isObj");var qe=a(function(){var we=[],Se=0,be={};function L(){for(var he=0,te=we[he],Ae=1;Ae<Se;){var le=Ae+1;he=Ae,le<Se&&we[le].score<we[Ae].score&&(he=le),we[he-1>>1]=we[he],Ae=1+(he<<1)}for(var de=he-1>>1;he>0&&te.score<we[de].score;de=(he=de)-1>>1)we[he]=we[de];we[he]=te}return a(L,"n"),be.add=function(he){var te=Se;we[Se++]=he;for(var Ae=te-1>>1;te>0&&he.score<we[Ae].score;Ae=(te=Ae)-1>>1)we[te]=we[Ae];we[te]=he},be.poll=function(){if(Se!==0){var he=we[0];return we[0]=we[--Se],L(),he}},be.peek=function(he){if(Se!==0)return we[0]},be.replaceTop=function(he){we[0]=he,L()},be},"fastpriorityqueue"),ot=qe();return ne()},"UMD"))},645:(m,B)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */B.read=function(K,q,j,se,ne){var ue,ce,z=ne*8-se-1,H=(1<<z)-1,M=H>>1,X=-7,pe=j?ne-1:0,$=j?-1:1,Y=K[q+pe];for(pe+=$,ue=Y&(1<<-X)-1,Y>>=-X,X+=z;X>0;ue=ue*256+K[q+pe],pe+=$,X-=8);for(ce=ue&(1<<-X)-1,ue>>=-X,X+=se;X>0;ce=ce*256+K[q+pe],pe+=$,X-=8);if(ue===0)ue=1-M;else{if(ue===H)return ce?NaN:(Y?-1:1)*(1/0);ce=ce+Math.pow(2,se),ue=ue-M}return(Y?-1:1)*ce*Math.pow(2,ue-se)},B.write=function(K,q,j,se,ne,ue){var ce,z,H,M=ue*8-ne-1,X=(1<<M)-1,pe=X>>1,$=ne===23?Math.pow(2,-24)-Math.pow(2,-77):0,Y=se?0:ue-1,Ve=se?1:-1,qe=q<0||q===0&&1/q<0?1:0;for(q=Math.abs(q),isNaN(q)||q===1/0?(z=isNaN(q)?1:0,ce=X):(ce=Math.floor(Math.log(q)/Math.LN2),q*(H=Math.pow(2,-ce))<1&&(ce--,H*=2),ce+pe>=1?q+=$/H:q+=$*Math.pow(2,1-pe),q*H>=2&&(ce++,H/=2),ce+pe>=X?(z=0,ce=X):ce+pe>=1?(z=(q*H-1)*Math.pow(2,ne),ce=ce+pe):(z=q*Math.pow(2,pe-1)*Math.pow(2,ne),ce=0));ne>=8;K[j+Y]=z&255,Y+=Ve,z/=256,ne-=8);for(ce=ce<<ne|z,M+=ne;M>0;K[j+Y]=ce&255,Y+=Ve,ce/=256,M-=8);K[j+Y-Ve]|=qe*128}},9924:m=>{"use strict";/*!
 * is-number <https://github.com/jonschlinkert/is-number>
 *
 * Copyright (c) 2014-present, Jon Schlinkert.
 * Released under the MIT License.
 */m.exports=function(B){return typeof B=="number"?B-B==0:typeof B=="string"&&B.trim()!==""?Number.isFinite?Number.isFinite(+B):isFinite(+B):!1}},2307:(m,B,K)=>{m=K.nmd(m);var q=200,j="__lodash_hash_undefined__",se=1,ne=2,ue=9007199254740991,ce="[object Arguments]",z="[object Array]",H="[object AsyncFunction]",M="[object Boolean]",X="[object Date]",pe="[object Error]",$="[object Function]",Y="[object GeneratorFunction]",Ve="[object Map]",qe="[object Number]",ot="[object Null]",we="[object Object]",Se="[object Promise]",be="[object Proxy]",L="[object RegExp]",he="[object Set]",te="[object String]",Ae="[object Symbol]",le="[object Undefined]",de="[object WeakMap]",Ce="[object ArrayBuffer]",Fe="[object DataView]",We="[object Float32Array]",Je="[object Float64Array]",ye="[object Int8Array]",Ue="[object Int16Array]",Xe="[object Int32Array]",Ke="[object Uint8Array]",Ne="[object Uint8ClampedArray]",De="[object Uint16Array]",pt="[object Uint32Array]",Rt=/[\\^$.*+?()[\]{}|]/g,xe=/^\[object .+?Constructor\]$/,Pt=/^(?:0|[1-9]\d*)$/,ut={};ut[We]=ut[Je]=ut[ye]=ut[Ue]=ut[Xe]=ut[Ke]=ut[Ne]=ut[De]=ut[pt]=!0,ut[ce]=ut[z]=ut[Ce]=ut[M]=ut[Fe]=ut[X]=ut[pe]=ut[$]=ut[Ve]=ut[qe]=ut[we]=ut[L]=ut[he]=ut[te]=ut[de]=!1;var It=typeof global=="object"&&global&&global.Object===Object&&global,Be=typeof self=="object"&&self&&self.Object===Object&&self,Me=It||Be||Function("return this")(),vt=B&&!B.nodeType&&B,Ct=vt&&!0&&m&&!m.nodeType&&m,Ut=Ct&&Ct.exports===vt,wr=Ut&&It.process,Wt=function(){try{return wr&&wr.binding&&wr.binding("util")}catch(J){}}(),ur=Wt&&Wt.isTypedArray;function Ur(J,_e){for(var Ge=-1,gt=J==null?0:J.length,hr=0,$t=[];++Ge<gt;){var br=J[Ge];_e(br,Ge,J)&&($t[hr++]=br)}return $t}a(Ur,"arrayFilter");function nn(J,_e){for(var Ge=-1,gt=_e.length,hr=J.length;++Ge<gt;)J[hr+Ge]=_e[Ge];return J}a(nn,"arrayPush");function kr(J,_e){for(var Ge=-1,gt=J==null?0:J.length;++Ge<gt;)if(_e(J[Ge],Ge,J))return!0;return!1}a(kr,"arraySome");function yt(J,_e){for(var Ge=-1,gt=Array(J);++Ge<J;)gt[Ge]=_e(Ge);return gt}a(yt,"baseTimes");function et(J){return function(_e){return J(_e)}}a(et,"baseUnary");function Pi(J,_e){return J.has(_e)}a(Pi,"cacheHas");function st(J,_e){return J==null?void 0:J[_e]}a(st,"getValue");function Nt(J){var _e=-1,Ge=Array(J.size);return J.forEach(function(gt,hr){Ge[++_e]=[hr,gt]}),Ge}a(Nt,"mapToArray");function nt(J,_e){return function(Ge){return J(_e(Ge))}}a(nt,"overArg");function ft(J){var _e=-1,Ge=Array(J.size);return J.forEach(function(gt){Ge[++_e]=gt}),Ge}a(ft,"setToArray");var Zt=Array.prototype,er=Function.prototype,Jt=Object.prototype,yn=Me["__core-js_shared__"],pi=er.toString,on=Jt.hasOwnProperty,za=function(){var J=/[^.]+$/.exec(yn&&yn.keys&&yn.keys.IE_PROTO||"");return J?"Symbol(src)_1."+J:""}(),Wa=Jt.toString,ro=RegExp("^"+pi.call(on).replace(Rt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),sr=Ut?Me.Buffer:void 0,Di=Me.Symbol,na=Me.Uint8Array,ia=Jt.propertyIsEnumerable,Qs=Zt.splice,Lr=Di?Di.toStringTag:void 0,gi=Object.getOwnPropertySymbols,So=sr?sr.isBuffer:void 0,Ga=nt(Object.keys,Object),An=_i(Me,"DataView"),lt=_i(Me,"Map"),ki=_i(Me,"Promise"),no=_i(Me,"Set"),Eo=_i(Me,"WeakMap"),Ni=_i(Object,"create"),Ys=ei(An),Zs=ei(lt),Js=ei(ki),an=ei(no),dr=ei(Eo),Xt=Di?Di.prototype:void 0,_n=Xt?Xt.valueOf:void 0;function mi(J){var _e=-1,Ge=J==null?0:J.length;for(this.clear();++_e<Ge;){var gt=J[_e];this.set(gt[0],gt[1])}}a(mi,"Hash");function Va(){this.__data__=Ni?Ni(null):{},this.size=0}a(Va,"hashClear");function ec(J){var _e=this.has(J)&&delete this.__data__[J];return this.size-=_e?1:0,_e}a(ec,"hashDelete");function dl(J){var _e=this.__data__;if(Ni){var Ge=_e[J];return Ge===j?void 0:Ge}return on.call(_e,J)?_e[J]:void 0}a(dl,"hashGet");function Ka(J){var _e=this.__data__;return Ni?_e[J]!==void 0:on.call(_e,J)}a(Ka,"hashHas");function Xa(J,_e){var Ge=this.__data__;return this.size+=this.has(J)?0:1,Ge[J]=Ni&&_e===void 0?j:_e,this}a(Xa,"hashSet"),mi.prototype.clear=Va,mi.prototype.delete=ec,mi.prototype.get=dl,mi.prototype.has=Ka,mi.prototype.set=Xa;function Rn(J){var _e=-1,Ge=J==null?0:J.length;for(this.clear();++_e<Ge;){var gt=J[_e];this.set(gt[0],gt[1])}}a(Rn,"ListCache");function io(){this.__data__=[],this.size=0}a(io,"listCacheClear");function hl(J){var _e=this.__data__,Ge=yi(_e,J);if(Ge<0)return!1;var gt=_e.length-1;return Ge==gt?_e.pop():Qs.call(_e,Ge,1),--this.size,!0}a(hl,"listCacheDelete");function fl(J){var _e=this.__data__,Ge=yi(_e,J);return Ge<0?void 0:_e[Ge][1]}a(fl,"listCacheGet");function xo(J){return yi(this.__data__,J)>-1}a(xo,"listCacheHas");function Qa(J,_e){var Ge=this.__data__,gt=yi(Ge,J);return gt<0?(++this.size,Ge.push([J,_e])):Ge[gt][1]=_e,this}a(Qa,"listCacheSet"),Rn.prototype.clear=io,Rn.prototype.delete=hl,Rn.prototype.get=fl,Rn.prototype.has=xo,Rn.prototype.set=Qa;function vi(J){var _e=-1,Ge=J==null?0:J.length;for(this.clear();++_e<Ge;){var gt=J[_e];this.set(gt[0],gt[1])}}a(vi,"MapCache");function Ya(){this.size=0,this.__data__={hash:new mi,map:new(lt||Rn),string:new mi}}a(Ya,"mapCacheClear");function pl(J){var _e=ua(this,J).delete(J);return this.size-=_e?1:0,_e}a(pl,"mapCacheDelete");function Za(J){return ua(this,J).get(J)}a(Za,"mapCacheGet");function gl(J){return ua(this,J).has(J)}a(gl,"mapCacheHas");function Kr(J,_e){var Ge=ua(this,J),gt=Ge.size;return Ge.set(J,_e),this.size+=Ge.size==gt?0:1,this}a(Kr,"mapCacheSet"),vi.prototype.clear=Ya,vi.prototype.delete=pl,vi.prototype.get=Za,vi.prototype.has=gl,vi.prototype.set=Kr;function dn(J){var _e=-1,Ge=J==null?0:J.length;for(this.__data__=new vi;++_e<Ge;)this.add(J[_e])}a(dn,"SetCache");function Ja(J){return this.__data__.set(J,j),this}a(Ja,"setCacheAdd");function es(J){return this.__data__.has(J)}a(es,"setCacheHas"),dn.prototype.add=dn.prototype.push=Ja,dn.prototype.has=es;function Jn(J){var _e=this.__data__=new Rn(J);this.size=_e.size}a(Jn,"Stack");function oa(){this.__data__=new Rn,this.size=0}a(oa,"stackClear");function tc(J){var _e=this.__data__,Ge=_e.delete(J);return this.size=_e.size,Ge}a(tc,"stackDelete");function rc(J){return this.__data__.get(J)}a(rc,"stackGet");function Mi(J){return this.__data__.has(J)}a(Mi,"stackHas");function ml(J,_e){var Ge=this.__data__;if(Ge instanceof Rn){var gt=Ge.__data__;if(!lt||gt.length<q-1)return gt.push([J,_e]),this.size=++Ge.size,this;Ge=this.__data__=new vi(gt)}return Ge.set(J,_e),this.size=Ge.size,this}a(ml,"stackSet"),Jn.prototype.clear=oa,Jn.prototype.delete=tc,Jn.prototype.get=rc,Jn.prototype.has=Mi,Jn.prototype.set=ml;function aa(J,_e){var Ge=Ro(J),gt=!Ge&&wi(J),hr=!Ge&&!gt&&Io(J),$t=!Ge&&!gt&&!hr&&us(J),br=Ge||gt||hr||$t,Rr=br?yt(J.length,String):[],Or=Rr.length;for(var fr in J)(_e||on.call(J,fr))&&!(br&&(fr=="length"||hr&&(fr=="offset"||fr=="parent")||$t&&(fr=="buffer"||fr=="byteLength"||fr=="byteOffset")||as(fr,Or)))&&Rr.push(fr);return Rr}a(aa,"arrayLikeKeys");function yi(J,_e){for(var Ge=J.length;Ge--;)if(da(J[Ge][0],_e))return Ge;return-1}a(yi,"assocIndexOf");function nc(J,_e,Ge){var gt=_e(J);return Ro(J)?gt:nn(gt,Ge(J))}a(nc,"baseGetAllKeys");function In(J){return J==null?J===void 0?le:ot:Lr&&Lr in Object(J)?os(J):Ao(J)}a(In,"baseGetTag");function ts(J){return bi(J)&&In(J)==ce}a(ts,"baseIsArguments");function sa(J,_e,Ge,gt,hr){return J===_e?!0:J==null||_e==null||!bi(J)&&!bi(_e)?J!==J&&_e!==_e:rs(J,_e,Ge,gt,sa,hr)}a(sa,"baseIsEqual");function rs(J,_e,Ge,gt,hr,$t){var br=Ro(J),Rr=Ro(_e),Or=br?z:Un(J),fr=Rr?z:Un(_e);Or=Or==ce?we:Or,fr=fr==ce?we:fr;var sn=Or==we,fn=fr==we,$r=Or==fr;if($r&&Io(J)){if(!Io(_e))return!1;br=!0,sn=!1}if($r&&!sn)return $t||($t=new Jn),br||us(J)?Co(J,_e,Ge,gt,hr,$t):oc(J,_e,Or,Ge,gt,hr,$t);if(!(Ge&se)){var nr=sn&&on.call(J,"__wrapped__"),Xr=fn&&on.call(_e,"__wrapped__");if(nr||Xr){var ti=nr?J.value():J,On=Xr?_e.value():_e;return $t||($t=new Jn),hr(ti,On,Ge,gt,$t)}}return $r?($t||($t=new Jn),ca(J,_e,Ge,gt,hr,$t)):!1}a(rs,"baseIsEqualDeep");function ns(J){if(!ls(J)||sc(J))return!1;var _e=cc(J)?ro:xe;return _e.test(ei(J))}a(ns,"baseIsNative");function is(J){return bi(J)&&lc(J.length)&&!!ut[In(J)]}a(is,"baseIsTypedArray");function ic(J){if(!ss(J))return Ga(J);var _e=[];for(var Ge in Object(J))on.call(J,Ge)&&Ge!="constructor"&&_e.push(Ge);return _e}a(ic,"baseKeys");function Co(J,_e,Ge,gt,hr,$t){var br=Ge&se,Rr=J.length,Or=_e.length;if(Rr!=Or&&!(br&&Or>Rr))return!1;var fr=$t.get(J);if(fr&&$t.get(_e))return fr==_e;var sn=-1,fn=!0,$r=Ge&ne?new dn:void 0;for($t.set(J,_e),$t.set(_e,J);++sn<Rr;){var nr=J[sn],Xr=_e[sn];if(gt)var ti=br?gt(Xr,nr,sn,_e,J,$t):gt(nr,Xr,sn,J,_e,$t);if(ti!==void 0){if(ti)continue;fn=!1;break}if($r){if(!kr(_e,function(On,wn){if(!Pi($r,wn)&&(nr===On||hr(nr,On,Ge,gt,$t)))return $r.push(wn)})){fn=!1;break}}else if(!(nr===Xr||hr(nr,Xr,Ge,gt,$t))){fn=!1;break}}return $t.delete(J),$t.delete(_e),fn}a(Co,"equalArrays");function oc(J,_e,Ge,gt,hr,$t,br){switch(Ge){case Fe:if(J.byteLength!=_e.byteLength||J.byteOffset!=_e.byteOffset)return!1;J=J.buffer,_e=_e.buffer;case Ce:return!(J.byteLength!=_e.byteLength||!$t(new na(J),new na(_e)));case M:case X:case qe:return da(+J,+_e);case pe:return J.name==_e.name&&J.message==_e.message;case L:case te:return J==_e+"";case Ve:var Rr=Nt;case he:var Or=gt&se;if(Rr||(Rr=ft),J.size!=_e.size&&!Or)return!1;var fr=br.get(J);if(fr)return fr==_e;gt|=ne,br.set(J,_e);var sn=Co(Rr(J),Rr(_e),gt,hr,$t,br);return br.delete(J),sn;case Ae:if(_n)return _n.call(J)==_n.call(_e)}return!1}a(oc,"equalByTag");function ca(J,_e,Ge,gt,hr,$t){var br=Ge&se,Rr=la(J),Or=Rr.length,fr=la(_e),sn=fr.length;if(Or!=sn&&!br)return!1;for(var fn=Or;fn--;){var $r=Rr[fn];if(!(br?$r in _e:on.call(_e,$r)))return!1}var nr=$t.get(J);if(nr&&$t.get(_e))return nr==_e;var Xr=!0;$t.set(J,_e),$t.set(_e,J);for(var ti=br;++fn<Or;){$r=Rr[fn];var On=J[$r],wn=_e[$r];if(gt)var fa=br?gt(wn,On,$r,_e,J,$t):gt(On,wn,$r,J,_e,$t);if(!(fa===void 0?On===wn||hr(On,wn,Ge,gt,$t):fa)){Xr=!1;break}ti||(ti=$r=="constructor")}if(Xr&&!ti){var ri=J.constructor,Do=_e.constructor;ri!=Do&&"constructor"in J&&"constructor"in _e&&!(typeof ri=="function"&&ri instanceof ri&&typeof Do=="function"&&Do instanceof Do)&&(Xr=!1)}return $t.delete(J),$t.delete(_e),Xr}a(ca,"equalObjects");function la(J){return nc(J,Oo,To)}a(la,"getAllKeys");function ua(J,_e){var Ge=J.__data__;return ac(_e)?Ge[typeof _e=="string"?"string":"hash"]:Ge.map}a(ua,"getMapData");function _i(J,_e){var Ge=st(J,_e);return ns(Ge)?Ge:void 0}a(_i,"getNative");function os(J){var _e=on.call(J,Lr),Ge=J[Lr];try{J[Lr]=void 0;var gt=!0}catch($t){}var hr=Wa.call(J);return gt&&(_e?J[Lr]=Ge:delete J[Lr]),hr}a(os,"getRawTag");var To=gi?function(J){return J==null?[]:(J=Object(J),Ur(gi(J),function(_e){return ia.call(J,_e)}))}:Po,Un=In;(An&&Un(new An(new ArrayBuffer(1)))!=Fe||lt&&Un(new lt)!=Ve||ki&&Un(ki.resolve())!=Se||no&&Un(new no)!=he||Eo&&Un(new Eo)!=de)&&(Un=a(function(J){var _e=In(J),Ge=_e==we?J.constructor:void 0,gt=Ge?ei(Ge):"";if(gt)switch(gt){case Ys:return Fe;case Zs:return Ve;case Js:return Se;case an:return he;case dr:return de}return _e},"getTag"));function as(J,_e){return _e=_e==null?ue:_e,!!_e&&(typeof J=="number"||Pt.test(J))&&J>-1&&J%1==0&&J<_e}a(as,"isIndex");function ac(J){var _e=typeof J;return _e=="string"||_e=="number"||_e=="symbol"||_e=="boolean"?J!=="__proto__":J===null}a(ac,"isKeyable");function sc(J){return!!za&&za in J}a(sc,"isMasked");function ss(J){var _e=J&&J.constructor,Ge=typeof _e=="function"&&_e.prototype||Jt;return J===Ge}a(ss,"isPrototype");function Ao(J){return Wa.call(J)}a(Ao,"objectToString");function ei(J){if(J!=null){try{return pi.call(J)}catch(_e){}try{return J+""}catch(_e){}}return""}a(ei,"toSource");function da(J,_e){return J===_e||J!==J&&_e!==_e}a(da,"eq");var wi=ts(function(){return arguments}())?ts:function(J){return bi(J)&&on.call(J,"callee")&&!ia.call(J,"callee")},Ro=Array.isArray;function cs(J){return J!=null&&lc(J.length)&&!cc(J)}a(cs,"isArrayLike");var Io=So||hn;function ha(J,_e){return sa(J,_e)}a(ha,"isEqual");function cc(J){if(!ls(J))return!1;var _e=In(J);return _e==$||_e==Y||_e==H||_e==be}a(cc,"isFunction");function lc(J){return typeof J=="number"&&J>-1&&J%1==0&&J<=ue}a(lc,"isLength");function ls(J){var _e=typeof J;return J!=null&&(_e=="object"||_e=="function")}a(ls,"isObject");function bi(J){return J!=null&&typeof J=="object"}a(bi,"isObjectLike");var us=ur?et(ur):is;function Oo(J){return cs(J)?aa(J):ic(J)}a(Oo,"keys");function Po(){return[]}a(Po,"stubArray");function hn(){return!1}a(hn,"stubFalse"),m.exports=ha},850:(m,B,K)=>{"use strict";const q=K(3837),j=K(6744),se=K(9444),ne=K(8702),ue=a(z=>z===""||z==="./","isEmptyString"),ce=a((z,H,M)=>{H=[].concat(H),z=[].concat(z);let X=new Set,pe=new Set,$=new Set,Y=0,Ve=a(we=>{$.add(we.output),M&&M.onResult&&M.onResult(we)},"onResult");for(let we=0;we<H.length;we++){let Se=se(String(H[we]),{...M,onResult:Ve},!0),be=Se.state.negated||Se.state.negatedExtglob;be&&Y++;for(let L of z){let he=Se(L,!0);!(be?!he.isMatch:he.isMatch)||(be?X.add(he.output):(X.delete(he.output),pe.add(he.output)))}}let ot=(Y===H.length?[...$]:[...pe]).filter(we=>!X.has(we));if(M&&ot.length===0){if(M.failglob===!0)throw new Error(`No matches found for "${H.join(", ")}"`);if(M.nonull===!0||M.nullglob===!0)return M.unescape?H.map(we=>we.replace(/\\/g,"")):H}return ot},"micromatch");ce.match=ce,ce.matcher=(z,H)=>se(z,H),ce.isMatch=(z,H,M)=>se(H,M)(z),ce.any=ce.isMatch,ce.not=(z,H,M={})=>{H=[].concat(H).map(String);let X=new Set,pe=[],Y=ce(z,H,{...M,onResult:a(Ve=>{M.onResult&&M.onResult(Ve),pe.push(Ve.output)},"onResult")});for(let Ve of pe)Y.includes(Ve)||X.add(Ve);return[...X]},ce.contains=(z,H,M)=>{if(typeof z!="string")throw new TypeError(`Expected a string: "${q.inspect(z)}"`);if(Array.isArray(H))return H.some(X=>ce.contains(z,X,M));if(typeof H=="string"){if(ue(z)||ue(H))return!1;if(z.includes(H)||z.startsWith("./")&&z.slice(2).includes(H))return!0}return ce.isMatch(z,H,{...M,contains:!0})},ce.matchKeys=(z,H,M)=>{if(!ne.isObject(z))throw new TypeError("Expected the first argument to be an object");let X=ce(Object.keys(z),H,M),pe={};for(let $ of X)pe[$]=z[$];return pe},ce.some=(z,H,M)=>{let X=[].concat(z);for(let pe of[].concat(H)){let $=se(String(pe),M);if(X.some(Y=>$(Y)))return!0}return!1},ce.every=(z,H,M)=>{let X=[].concat(z);for(let pe of[].concat(H)){let $=se(String(pe),M);if(!X.every(Y=>$(Y)))return!1}return!0},ce.all=(z,H,M)=>{if(typeof z!="string")throw new TypeError(`Expected a string: "${q.inspect(z)}"`);return[].concat(H).every(X=>se(X,M)(z))},ce.capture=(z,H,M)=>{let X=ne.isWindows(M),$=se.makeRe(String(z),{...M,capture:!0}).exec(X?ne.toPosixSlashes(H):H);if($)return $.slice(1).map(Y=>Y===void 0?"":Y)},ce.makeRe=(...z)=>se.makeRe(...z),ce.scan=(...z)=>se.scan(...z),ce.parse=(z,H)=>{let M=[];for(let X of[].concat(z||[]))for(let pe of j(String(X),H))M.push(se.parse(pe,H));return M},ce.braces=(z,H)=>{if(typeof z!="string")throw new TypeError("Expected a string");return H&&H.nobrace===!0||!/\{.*\}/.test(z)?[z]:j(z,H)},ce.braceExpand=(z,H)=>{if(typeof z!="string")throw new TypeError("Expected a string");return ce.braces(z,{...H,expand:!0})},m.exports=ce},778:(m,B,K)=>{var q=K(2479);m.exports=q(j),m.exports.strict=q(se),j.proto=j(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return j(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return se(this)},configurable:!0})});function j(ne){var ue=a(function(){return ue.called?ue.value:(ue.called=!0,ue.value=ne.apply(this,arguments))},"f");return ue.called=!1,ue}a(j,"once");function se(ne){var ue=a(function(){if(ue.called)throw new Error(ue.onceError);return ue.called=!0,ue.value=ne.apply(this,arguments)},"f"),ce=ne.name||"Function wrapped with `once`";return ue.onceError=ce+" shouldn't be called more than once",ue.called=!1,ue}a(se,"onceStrict")},7279:(m,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.EndOfStreamError=B.defaultMessages=void 0,B.defaultMessages="End-Of-Stream";class K extends Error{constructor(){super(B.defaultMessages)}}a(K,"EndOfStreamError"),B.EndOfStreamError=K},5167:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.StreamReader=B.EndOfStreamError=void 0;const q=K(7279);var j=K(7279);Object.defineProperty(B,"EndOfStreamError",{enumerable:!0,get:function(){return j.EndOfStreamError}});class se{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise((z,H)=>{this.reject=H,this.resolve=z})}}a(se,"Deferred");const ne=1*1024*1024;class ue{constructor(z){if(this.s=z,this.request=null,this.endOfStream=!1,this.peekQueue=[],!z.read||!z.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",()=>this.reject(new q.EndOfStreamError)),this.s.once("error",H=>this.reject(H)),this.s.once("close",()=>this.reject(new Error("Stream closed")))}async peek(z,H,M){const X=await this.read(z,H,M);return this.peekQueue.push(z.subarray(H,H+X)),X}async read(z,H,M){if(M===0)return 0;if(this.peekQueue.length===0&&this.endOfStream)throw new q.EndOfStreamError;let X=M,pe=0;for(;this.peekQueue.length>0&&X>0;){const $=this.peekQueue.pop();if(!$)throw new Error("peekData should be defined");const Y=Math.min($.length,X);z.set($.subarray(0,Y),H+pe),pe+=Y,X-=Y,Y<$.length&&this.peekQueue.push($.subarray(Y))}for(;X>0&&!this.endOfStream;){const $=Math.min(X,ne),Y=await this._read(z,H+pe,$);if(pe+=Y,Y<$)break;X-=Y}return pe}async _read(z,H,M){if(this.request)throw new Error("Concurrent read operation?");const X=this.s.read(M);return X?(z.set(X,H),X.length):(this.request={buffer:z,offset:H,length:M,deferred:new se},this.s.once("readable",()=>{this.tryRead()}),this.request.deferred.promise)}tryRead(){if(!this.request)throw new Error("this.request should be defined");const z=this.s.read(this.request.length);z?(this.request.buffer.set(z,this.request.offset),this.request.deferred.resolve(z.length),this.request=null):this.s.once("readable",()=>{this.tryRead()})}reject(z){this.endOfStream=!0,this.request&&(this.request.deferred.reject(z),this.request=null)}}a(ue,"StreamReader"),B.StreamReader=ue},9444:(m,B,K)=>{"use strict";m.exports=K(6087)},1006:(m,B,K)=>{"use strict";const q=K(1017),j="\\\\/",se=`[^${j}]`,ne="\\.",ue="\\+",ce="\\?",z="\\/",H="(?=.)",M="[^/]",X=`(?:${z}|$)`,pe=`(?:^|${z})`,$=`${ne}{1,2}${X}`,Y=`(?!${ne})`,Ve=`(?!${pe}${$})`,qe=`(?!${ne}{0,1}${X})`,ot=`(?!${$})`,we=`[^.${z}]`,Se=`${M}*?`,be={DOT_LITERAL:ne,PLUS_LITERAL:ue,QMARK_LITERAL:ce,SLASH_LITERAL:z,ONE_CHAR:H,QMARK:M,END_ANCHOR:X,DOTS_SLASH:$,NO_DOT:Y,NO_DOTS:Ve,NO_DOT_SLASH:qe,NO_DOTS_SLASH:ot,QMARK_NO_DOT:we,STAR:Se,START_ANCHOR:pe},L={...be,SLASH_LITERAL:`[${j}]`,QMARK:se,STAR:`${se}*?`,DOTS_SLASH:`${ne}{1,2}(?:[${j}]|$)`,NO_DOT:`(?!${ne})`,NO_DOTS:`(?!(?:^|[${j}])${ne}{1,2}(?:[${j}]|$))`,NO_DOT_SLASH:`(?!${ne}{0,1}(?:[${j}]|$))`,NO_DOTS_SLASH:`(?!${ne}{1,2}(?:[${j}]|$))`,QMARK_NO_DOT:`[^.${j}]`,START_ANCHOR:`(?:^|[${j}])`,END_ANCHOR:`(?:[${j}]|$)`},he={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};m.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:he,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:q.sep,extglobChars(te){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${te.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(te){return te===!0?L:be}}},3376:(m,B,K)=>{"use strict";const q=K(1006),j=K(8702),{MAX_LENGTH:se,POSIX_REGEX_SOURCE:ne,REGEX_NON_SPECIAL_CHARS:ue,REGEX_SPECIAL_CHARS_BACKREF:ce,REPLACEMENTS:z}=q,H=a((pe,$)=>{if(typeof $.expandRange=="function")return $.expandRange(...pe,$);pe.sort();const Y=`[${pe.join("-")}]`;try{new RegExp(Y)}catch(Ve){return pe.map(qe=>j.escapeRegex(qe)).join("..")}return Y},"expandRange"),M=a((pe,$)=>`Missing ${pe}: "${$}" - use "\\\\${$}" to match literal characters`,"syntaxError"),X=a((pe,$)=>{if(typeof pe!="string")throw new TypeError("Expected a string");pe=z[pe]||pe;const Y={...$},Ve=typeof Y.maxLength=="number"?Math.min(se,Y.maxLength):se;let qe=pe.length;if(qe>Ve)throw new SyntaxError(`Input length: ${qe}, exceeds maximum allowed length: ${Ve}`);const ot={type:"bos",value:"",output:Y.prepend||""},we=[ot],Se=Y.capture?"":"?:",be=j.isWindows($),L=q.globChars(be),he=q.extglobChars(L),{DOT_LITERAL:te,PLUS_LITERAL:Ae,SLASH_LITERAL:le,ONE_CHAR:de,DOTS_SLASH:Ce,NO_DOT:Fe,NO_DOT_SLASH:We,NO_DOTS_SLASH:Je,QMARK:ye,QMARK_NO_DOT:Ue,STAR:Xe,START_ANCHOR:Ke}=L,Ne=a(st=>`(${Se}(?:(?!${Ke}${st.dot?Ce:te}).)*?)`,"globstar"),De=Y.dot?"":Fe,pt=Y.dot?ye:Ue;let Rt=Y.bash===!0?Ne(Y):Xe;Y.capture&&(Rt=`(${Rt})`),typeof Y.noext=="boolean"&&(Y.noextglob=Y.noext);const xe={input:pe,index:-1,start:0,dot:Y.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:we};pe=j.removePrefix(pe,xe),qe=pe.length;const Pt=[],ut=[],It=[];let Be=ot,Me;const vt=a(()=>xe.index===qe-1,"eos"),Ct=xe.peek=(st=1)=>pe[xe.index+st],Ut=xe.advance=()=>pe[++xe.index]||"",wr=a(()=>pe.slice(xe.index+1),"remaining"),Wt=a((st="",Nt=0)=>{xe.consumed+=st,xe.index+=Nt},"consume"),ur=a(st=>{xe.output+=st.output!=null?st.output:st.value,Wt(st.value)},"append"),Ur=a(()=>{let st=1;for(;Ct()==="!"&&(Ct(2)!=="("||Ct(3)==="?");)Ut(),xe.start++,st++;return st%2==0?!1:(xe.negated=!0,xe.start++,!0)},"negate"),nn=a(st=>{xe[st]++,It.push(st)},"increment"),kr=a(st=>{xe[st]--,It.pop()},"decrement"),yt=a(st=>{if(Be.type==="globstar"){const Nt=xe.braces>0&&(st.type==="comma"||st.type==="brace"),nt=st.extglob===!0||Pt.length&&(st.type==="pipe"||st.type==="paren");st.type!=="slash"&&st.type!=="paren"&&!Nt&&!nt&&(xe.output=xe.output.slice(0,-Be.output.length),Be.type="star",Be.value="*",Be.output=Rt,xe.output+=Be.output)}if(Pt.length&&st.type!=="paren"&&(Pt[Pt.length-1].inner+=st.value),(st.value||st.output)&&ur(st),Be&&Be.type==="text"&&st.type==="text"){Be.value+=st.value,Be.output=(Be.output||"")+st.value;return}st.prev=Be,we.push(st),Be=st},"push"),et=a((st,Nt)=>{const nt={...he[Nt],conditions:1,inner:""};nt.prev=Be,nt.parens=xe.parens,nt.output=xe.output;const ft=(Y.capture?"(":"")+nt.open;nn("parens"),yt({type:st,value:Nt,output:xe.output?"":de}),yt({type:"paren",extglob:!0,value:Ut(),output:ft}),Pt.push(nt)},"extglobOpen"),Pi=a(st=>{let Nt=st.close+(Y.capture?")":""),nt;if(st.type==="negate"){let ft=Rt;st.inner&&st.inner.length>1&&st.inner.includes("/")&&(ft=Ne(Y)),(ft!==Rt||vt()||/^\)+$/.test(wr()))&&(Nt=st.close=`)$))${ft}`),st.inner.includes("*")&&(nt=wr())&&/^\.[^\\/.]+$/.test(nt)&&(Nt=st.close=`)${nt})${ft})`),st.prev.type==="bos"&&(xe.negatedExtglob=!0)}yt({type:"paren",extglob:!0,value:Me,output:Nt}),kr("parens")},"extglobClose");if(Y.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(pe)){let st=!1,Nt=pe.replace(ce,(nt,ft,Zt,er,Jt,yn)=>er==="\\"?(st=!0,nt):er==="?"?ft?ft+er+(Jt?ye.repeat(Jt.length):""):yn===0?pt+(Jt?ye.repeat(Jt.length):""):ye.repeat(Zt.length):er==="."?te.repeat(Zt.length):er==="*"?ft?ft+er+(Jt?Rt:""):Rt:ft?nt:`\\${nt}`);return st===!0&&(Y.unescape===!0?Nt=Nt.replace(/\\/g,""):Nt=Nt.replace(/\\+/g,nt=>nt.length%2==0?"\\\\":nt?"\\":"")),Nt===pe&&Y.contains===!0?(xe.output=pe,xe):(xe.output=j.wrapOutput(Nt,xe,$),xe)}for(;!vt();){if(Me=Ut(),Me==="\0")continue;if(Me==="\\"){const nt=Ct();if(nt==="/"&&Y.bash!==!0||nt==="."||nt===";")continue;if(!nt){Me+="\\",yt({type:"text",value:Me});continue}const ft=/^\\+/.exec(wr());let Zt=0;if(ft&&ft[0].length>2&&(Zt=ft[0].length,xe.index+=Zt,Zt%2!=0&&(Me+="\\")),Y.unescape===!0?Me=Ut():Me+=Ut(),xe.brackets===0){yt({type:"text",value:Me});continue}}if(xe.brackets>0&&(Me!=="]"||Be.value==="["||Be.value==="[^")){if(Y.posix!==!1&&Me===":"){const nt=Be.value.slice(1);if(nt.includes("[")&&(Be.posix=!0,nt.includes(":"))){const ft=Be.value.lastIndexOf("["),Zt=Be.value.slice(0,ft),er=Be.value.slice(ft+2),Jt=ne[er];if(Jt){Be.value=Zt+Jt,xe.backtrack=!0,Ut(),!ot.output&&we.indexOf(Be)===1&&(ot.output=de);continue}}}(Me==="["&&Ct()!==":"||Me==="-"&&Ct()==="]")&&(Me=`\\${Me}`),Me==="]"&&(Be.value==="["||Be.value==="[^")&&(Me=`\\${Me}`),Y.posix===!0&&Me==="!"&&Be.value==="["&&(Me="^"),Be.value+=Me,ur({value:Me});continue}if(xe.quotes===1&&Me!=='"'){Me=j.escapeRegex(Me),Be.value+=Me,ur({value:Me});continue}if(Me==='"'){xe.quotes=xe.quotes===1?0:1,Y.keepQuotes===!0&&yt({type:"text",value:Me});continue}if(Me==="("){nn("parens"),yt({type:"paren",value:Me});continue}if(Me===")"){if(xe.parens===0&&Y.strictBrackets===!0)throw new SyntaxError(M("opening","("));const nt=Pt[Pt.length-1];if(nt&&xe.parens===nt.parens+1){Pi(Pt.pop());continue}yt({type:"paren",value:Me,output:xe.parens?")":"\\)"}),kr("parens");continue}if(Me==="["){if(Y.nobracket===!0||!wr().includes("]")){if(Y.nobracket!==!0&&Y.strictBrackets===!0)throw new SyntaxError(M("closing","]"));Me=`\\${Me}`}else nn("brackets");yt({type:"bracket",value:Me});continue}if(Me==="]"){if(Y.nobracket===!0||Be&&Be.type==="bracket"&&Be.value.length===1){yt({type:"text",value:Me,output:`\\${Me}`});continue}if(xe.brackets===0){if(Y.strictBrackets===!0)throw new SyntaxError(M("opening","["));yt({type:"text",value:Me,output:`\\${Me}`});continue}kr("brackets");const nt=Be.value.slice(1);if(Be.posix!==!0&&nt[0]==="^"&&!nt.includes("/")&&(Me=`/${Me}`),Be.value+=Me,ur({value:Me}),Y.literalBrackets===!1||j.hasRegexChars(nt))continue;const ft=j.escapeRegex(Be.value);if(xe.output=xe.output.slice(0,-Be.value.length),Y.literalBrackets===!0){xe.output+=ft,Be.value=ft;continue}Be.value=`(${Se}${ft}|${Be.value})`,xe.output+=Be.value;continue}if(Me==="{"&&Y.nobrace!==!0){nn("braces");const nt={type:"brace",value:Me,output:"(",outputIndex:xe.output.length,tokensIndex:xe.tokens.length};ut.push(nt),yt(nt);continue}if(Me==="}"){const nt=ut[ut.length-1];if(Y.nobrace===!0||!nt){yt({type:"text",value:Me,output:Me});continue}let ft=")";if(nt.dots===!0){const Zt=we.slice(),er=[];for(let Jt=Zt.length-1;Jt>=0&&(we.pop(),Zt[Jt].type!=="brace");Jt--)Zt[Jt].type!=="dots"&&er.unshift(Zt[Jt].value);ft=H(er,Y),xe.backtrack=!0}if(nt.comma!==!0&&nt.dots!==!0){const Zt=xe.output.slice(0,nt.outputIndex),er=xe.tokens.slice(nt.tokensIndex);nt.value=nt.output="\\{",Me=ft="\\}",xe.output=Zt;for(const Jt of er)xe.output+=Jt.output||Jt.value}yt({type:"brace",value:Me,output:ft}),kr("braces"),ut.pop();continue}if(Me==="|"){Pt.length>0&&Pt[Pt.length-1].conditions++,yt({type:"text",value:Me});continue}if(Me===","){let nt=Me;const ft=ut[ut.length-1];ft&&It[It.length-1]==="braces"&&(ft.comma=!0,nt="|"),yt({type:"comma",value:Me,output:nt});continue}if(Me==="/"){if(Be.type==="dot"&&xe.index===xe.start+1){xe.start=xe.index+1,xe.consumed="",xe.output="",we.pop(),Be=ot;continue}yt({type:"slash",value:Me,output:le});continue}if(Me==="."){if(xe.braces>0&&Be.type==="dot"){Be.value==="."&&(Be.output=te);const nt=ut[ut.length-1];Be.type="dots",Be.output+=Me,Be.value+=Me,nt.dots=!0;continue}if(xe.braces+xe.parens===0&&Be.type!=="bos"&&Be.type!=="slash"){yt({type:"text",value:Me,output:te});continue}yt({type:"dot",value:Me,output:te});continue}if(Me==="?"){if(!(Be&&Be.value==="(")&&Y.noextglob!==!0&&Ct()==="("&&Ct(2)!=="?"){et("qmark",Me);continue}if(Be&&Be.type==="paren"){const ft=Ct();let Zt=Me;if(ft==="<"&&!j.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(Be.value==="("&&!/[!=<:]/.test(ft)||ft==="<"&&!/<([!=]|\w+>)/.test(wr()))&&(Zt=`\\${Me}`),yt({type:"text",value:Me,output:Zt});continue}if(Y.dot!==!0&&(Be.type==="slash"||Be.type==="bos")){yt({type:"qmark",value:Me,output:Ue});continue}yt({type:"qmark",value:Me,output:ye});continue}if(Me==="!"){if(Y.noextglob!==!0&&Ct()==="("&&(Ct(2)!=="?"||!/[!=<:]/.test(Ct(3)))){et("negate",Me);continue}if(Y.nonegate!==!0&&xe.index===0){Ur();continue}}if(Me==="+"){if(Y.noextglob!==!0&&Ct()==="("&&Ct(2)!=="?"){et("plus",Me);continue}if(Be&&Be.value==="("||Y.regex===!1){yt({type:"plus",value:Me,output:Ae});continue}if(Be&&(Be.type==="bracket"||Be.type==="paren"||Be.type==="brace")||xe.parens>0){yt({type:"plus",value:Me});continue}yt({type:"plus",value:Ae});continue}if(Me==="@"){if(Y.noextglob!==!0&&Ct()==="("&&Ct(2)!=="?"){yt({type:"at",extglob:!0,value:Me,output:""});continue}yt({type:"text",value:Me});continue}if(Me!=="*"){(Me==="$"||Me==="^")&&(Me=`\\${Me}`);const nt=ue.exec(wr());nt&&(Me+=nt[0],xe.index+=nt[0].length),yt({type:"text",value:Me});continue}if(Be&&(Be.type==="globstar"||Be.star===!0)){Be.type="star",Be.star=!0,Be.value+=Me,Be.output=Rt,xe.backtrack=!0,xe.globstar=!0,Wt(Me);continue}let st=wr();if(Y.noextglob!==!0&&/^\([^?]/.test(st)){et("star",Me);continue}if(Be.type==="star"){if(Y.noglobstar===!0){Wt(Me);continue}const nt=Be.prev,ft=nt.prev,Zt=nt.type==="slash"||nt.type==="bos",er=ft&&(ft.type==="star"||ft.type==="globstar");if(Y.bash===!0&&(!Zt||st[0]&&st[0]!=="/")){yt({type:"star",value:Me,output:""});continue}const Jt=xe.braces>0&&(nt.type==="comma"||nt.type==="brace"),yn=Pt.length&&(nt.type==="pipe"||nt.type==="paren");if(!Zt&&nt.type!=="paren"&&!Jt&&!yn){yt({type:"star",value:Me,output:""});continue}for(;st.slice(0,3)==="/**";){const pi=pe[xe.index+4];if(pi&&pi!=="/")break;st=st.slice(3),Wt("/**",3)}if(nt.type==="bos"&&vt()){Be.type="globstar",Be.value+=Me,Be.output=Ne(Y),xe.output=Be.output,xe.globstar=!0,Wt(Me);continue}if(nt.type==="slash"&&nt.prev.type!=="bos"&&!er&&vt()){xe.output=xe.output.slice(0,-(nt.output+Be.output).length),nt.output=`(?:${nt.output}`,Be.type="globstar",Be.output=Ne(Y)+(Y.strictSlashes?")":"|$)"),Be.value+=Me,xe.globstar=!0,xe.output+=nt.output+Be.output,Wt(Me);continue}if(nt.type==="slash"&&nt.prev.type!=="bos"&&st[0]==="/"){const pi=st[1]!==void 0?"|$":"";xe.output=xe.output.slice(0,-(nt.output+Be.output).length),nt.output=`(?:${nt.output}`,Be.type="globstar",Be.output=`${Ne(Y)}${le}|${le}${pi})`,Be.value+=Me,xe.output+=nt.output+Be.output,xe.globstar=!0,Wt(Me+Ut()),yt({type:"slash",value:"/",output:""});continue}if(nt.type==="bos"&&st[0]==="/"){Be.type="globstar",Be.value+=Me,Be.output=`(?:^|${le}|${Ne(Y)}${le})`,xe.output=Be.output,xe.globstar=!0,Wt(Me+Ut()),yt({type:"slash",value:"/",output:""});continue}xe.output=xe.output.slice(0,-Be.output.length),Be.type="globstar",Be.output=Ne(Y),Be.value+=Me,xe.output+=Be.output,xe.globstar=!0,Wt(Me);continue}const Nt={type:"star",value:Me,output:Rt};if(Y.bash===!0){Nt.output=".*?",(Be.type==="bos"||Be.type==="slash")&&(Nt.output=De+Nt.output),yt(Nt);continue}if(Be&&(Be.type==="bracket"||Be.type==="paren")&&Y.regex===!0){Nt.output=Me,yt(Nt);continue}(xe.index===xe.start||Be.type==="slash"||Be.type==="dot")&&(Be.type==="dot"?(xe.output+=We,Be.output+=We):Y.dot===!0?(xe.output+=Je,Be.output+=Je):(xe.output+=De,Be.output+=De),Ct()!=="*"&&(xe.output+=de,Be.output+=de)),yt(Nt)}for(;xe.brackets>0;){if(Y.strictBrackets===!0)throw new SyntaxError(M("closing","]"));xe.output=j.escapeLast(xe.output,"["),kr("brackets")}for(;xe.parens>0;){if(Y.strictBrackets===!0)throw new SyntaxError(M("closing",")"));xe.output=j.escapeLast(xe.output,"("),kr("parens")}for(;xe.braces>0;){if(Y.strictBrackets===!0)throw new SyntaxError(M("closing","}"));xe.output=j.escapeLast(xe.output,"{"),kr("braces")}if(Y.strictSlashes!==!0&&(Be.type==="star"||Be.type==="bracket")&&yt({type:"maybe_slash",value:"",output:`${le}?`}),xe.backtrack===!0){xe.output="";for(const st of xe.tokens)xe.output+=st.output!=null?st.output:st.value,st.suffix&&(xe.output+=st.suffix)}return xe},"parse");X.fastpaths=(pe,$)=>{const Y={...$},Ve=typeof Y.maxLength=="number"?Math.min(se,Y.maxLength):se,qe=pe.length;if(qe>Ve)throw new SyntaxError(`Input length: ${qe}, exceeds maximum allowed length: ${Ve}`);pe=z[pe]||pe;const ot=j.isWindows($),{DOT_LITERAL:we,SLASH_LITERAL:Se,ONE_CHAR:be,DOTS_SLASH:L,NO_DOT:he,NO_DOTS:te,NO_DOTS_SLASH:Ae,STAR:le,START_ANCHOR:de}=q.globChars(ot),Ce=Y.dot?te:he,Fe=Y.dot?Ae:he,We=Y.capture?"":"?:",Je={negated:!1,prefix:""};let ye=Y.bash===!0?".*?":le;Y.capture&&(ye=`(${ye})`);const Ue=a(De=>De.noglobstar===!0?ye:`(${We}(?:(?!${de}${De.dot?L:we}).)*?)`,"globstar"),Xe=a(De=>{switch(De){case"*":return`${Ce}${be}${ye}`;case".*":return`${we}${be}${ye}`;case"*.*":return`${Ce}${ye}${we}${be}${ye}`;case"*/*":return`${Ce}${ye}${Se}${be}${Fe}${ye}`;case"**":return Ce+Ue(Y);case"**/*":return`(?:${Ce}${Ue(Y)}${Se})?${Fe}${be}${ye}`;case"**/*.*":return`(?:${Ce}${Ue(Y)}${Se})?${Fe}${ye}${we}${be}${ye}`;case"**/.*":return`(?:${Ce}${Ue(Y)}${Se})?${we}${be}${ye}`;default:{const pt=/^(.*?)\.(\w+)$/.exec(De);if(!pt)return;const Rt=Xe(pt[1]);return Rt?Rt+we+pt[2]:void 0}}},"create"),Ke=j.removePrefix(pe,Je);let Ne=Xe(Ke);return Ne&&Y.strictSlashes!==!0&&(Ne+=`${Se}?`),Ne},m.exports=X},6087:(m,B,K)=>{"use strict";const q=K(1017),j=K(3921),se=K(3376),ne=K(8702),ue=K(1006),ce=a(H=>H&&typeof H=="object"&&!Array.isArray(H),"isObject"),z=a((H,M,X=!1)=>{if(Array.isArray(H)){const Se=H.map(L=>z(L,M,X));return a(L=>{for(const he of Se){const te=he(L);if(te)return te}return!1},"arrayMatcher")}const pe=ce(H)&&H.tokens&&H.input;if(H===""||typeof H!="string"&&!pe)throw new TypeError("Expected pattern to be a non-empty string");const $=M||{},Y=ne.isWindows(M),Ve=pe?z.compileRe(H,M):z.makeRe(H,M,!1,!0),qe=Ve.state;delete Ve.state;let ot=a(()=>!1,"isIgnored");if($.ignore){const Se={...M,ignore:null,onMatch:null,onResult:null};ot=z($.ignore,Se,X)}const we=a((Se,be=!1)=>{const{isMatch:L,match:he,output:te}=z.test(Se,Ve,M,{glob:H,posix:Y}),Ae={glob:H,state:qe,regex:Ve,posix:Y,input:Se,output:te,match:he,isMatch:L};return typeof $.onResult=="function"&&$.onResult(Ae),L===!1?(Ae.isMatch=!1,be?Ae:!1):ot(Se)?(typeof $.onIgnore=="function"&&$.onIgnore(Ae),Ae.isMatch=!1,be?Ae:!1):(typeof $.onMatch=="function"&&$.onMatch(Ae),be?Ae:!0)},"matcher");return X&&(we.state=qe),we},"picomatch");z.test=(H,M,X,{glob:pe,posix:$}={})=>{if(typeof H!="string")throw new TypeError("Expected input to be a string");if(H==="")return{isMatch:!1,output:""};const Y=X||{},Ve=Y.format||($?ne.toPosixSlashes:null);let qe=H===pe,ot=qe&&Ve?Ve(H):H;return qe===!1&&(ot=Ve?Ve(H):H,qe=ot===pe),(qe===!1||Y.capture===!0)&&(Y.matchBase===!0||Y.basename===!0?qe=z.matchBase(H,M,X,$):qe=M.exec(ot)),{isMatch:Boolean(qe),match:qe,output:ot}},z.matchBase=(H,M,X,pe=ne.isWindows(X))=>(M instanceof RegExp?M:z.makeRe(M,X)).test(q.basename(H)),z.isMatch=(H,M,X)=>z(M,X)(H),z.parse=(H,M)=>Array.isArray(H)?H.map(X=>z.parse(X,M)):se(H,{...M,fastpaths:!1}),z.scan=(H,M)=>j(H,M),z.compileRe=(H,M,X=!1,pe=!1)=>{if(X===!0)return H.output;const $=M||{},Y=$.contains?"":"^",Ve=$.contains?"":"$";let qe=`${Y}(?:${H.output})${Ve}`;H&&H.negated===!0&&(qe=`^(?!${qe}).*$`);const ot=z.toRegex(qe,M);return pe===!0&&(ot.state=H),ot},z.makeRe=(H,M={},X=!1,pe=!1)=>{if(!H||typeof H!="string")throw new TypeError("Expected a non-empty string");let $={negated:!1,fastpaths:!0};return M.fastpaths!==!1&&(H[0]==="."||H[0]==="*")&&($.output=se.fastpaths(H,M)),$.output||($=se(H,M)),z.compileRe($,M,X,pe)},z.toRegex=(H,M)=>{try{const X=M||{};return new RegExp(H,X.flags||(X.nocase?"i":""))}catch(X){if(M&&M.debug===!0)throw X;return/$^/}},z.constants=ue,m.exports=z},3921:(m,B,K)=>{"use strict";const q=K(8702),{CHAR_ASTERISK:j,CHAR_AT:se,CHAR_BACKWARD_SLASH:ne,CHAR_COMMA:ue,CHAR_DOT:ce,CHAR_EXCLAMATION_MARK:z,CHAR_FORWARD_SLASH:H,CHAR_LEFT_CURLY_BRACE:M,CHAR_LEFT_PARENTHESES:X,CHAR_LEFT_SQUARE_BRACKET:pe,CHAR_PLUS:$,CHAR_QUESTION_MARK:Y,CHAR_RIGHT_CURLY_BRACE:Ve,CHAR_RIGHT_PARENTHESES:qe,CHAR_RIGHT_SQUARE_BRACKET:ot}=K(1006),we=a(L=>L===H||L===ne,"isPathSeparator"),Se=a(L=>{L.isPrefix!==!0&&(L.depth=L.isGlobstar?1/0:1)},"depth"),be=a((L,he)=>{const te=he||{},Ae=L.length-1,le=te.parts===!0||te.scanToEnd===!0,de=[],Ce=[],Fe=[];let We=L,Je=-1,ye=0,Ue=0,Xe=!1,Ke=!1,Ne=!1,De=!1,pt=!1,Rt=!1,xe=!1,Pt=!1,ut=!1,It=!1,Be=0,Me,vt,Ct={value:"",depth:0,isGlob:!1};const Ut=a(()=>Je>=Ae,"eos"),wr=a(()=>We.charCodeAt(Je+1),"peek"),Wt=a(()=>(Me=vt,We.charCodeAt(++Je)),"advance");for(;Je<Ae;){vt=Wt();let yt;if(vt===ne){xe=Ct.backslashes=!0,vt=Wt(),vt===M&&(Rt=!0);continue}if(Rt===!0||vt===M){for(Be++;Ut()!==!0&&(vt=Wt());){if(vt===ne){xe=Ct.backslashes=!0,Wt();continue}if(vt===M){Be++;continue}if(Rt!==!0&&vt===ce&&(vt=Wt())===ce){if(Xe=Ct.isBrace=!0,Ne=Ct.isGlob=!0,It=!0,le===!0)continue;break}if(Rt!==!0&&vt===ue){if(Xe=Ct.isBrace=!0,Ne=Ct.isGlob=!0,It=!0,le===!0)continue;break}if(vt===Ve&&(Be--,Be===0)){Rt=!1,Xe=Ct.isBrace=!0,It=!0;break}}if(le===!0)continue;break}if(vt===H){if(de.push(Je),Ce.push(Ct),Ct={value:"",depth:0,isGlob:!1},It===!0)continue;if(Me===ce&&Je===ye+1){ye+=2;continue}Ue=Je+1;continue}if(te.noext!==!0&&(vt===$||vt===se||vt===j||vt===Y||vt===z)===!0&&wr()===X){if(Ne=Ct.isGlob=!0,De=Ct.isExtglob=!0,It=!0,vt===z&&Je===ye&&(ut=!0),le===!0){for(;Ut()!==!0&&(vt=Wt());){if(vt===ne){xe=Ct.backslashes=!0,vt=Wt();continue}if(vt===qe){Ne=Ct.isGlob=!0,It=!0;break}}continue}break}if(vt===j){if(Me===j&&(pt=Ct.isGlobstar=!0),Ne=Ct.isGlob=!0,It=!0,le===!0)continue;break}if(vt===Y){if(Ne=Ct.isGlob=!0,It=!0,le===!0)continue;break}if(vt===pe){for(;Ut()!==!0&&(yt=Wt());){if(yt===ne){xe=Ct.backslashes=!0,Wt();continue}if(yt===ot){Ke=Ct.isBracket=!0,Ne=Ct.isGlob=!0,It=!0;break}}if(le===!0)continue;break}if(te.nonegate!==!0&&vt===z&&Je===ye){Pt=Ct.negated=!0,ye++;continue}if(te.noparen!==!0&&vt===X){if(Ne=Ct.isGlob=!0,le===!0){for(;Ut()!==!0&&(vt=Wt());){if(vt===X){xe=Ct.backslashes=!0,vt=Wt();continue}if(vt===qe){It=!0;break}}continue}break}if(Ne===!0){if(It=!0,le===!0)continue;break}}te.noext===!0&&(De=!1,Ne=!1);let ur=We,Ur="",nn="";ye>0&&(Ur=We.slice(0,ye),We=We.slice(ye),Ue-=ye),ur&&Ne===!0&&Ue>0?(ur=We.slice(0,Ue),nn=We.slice(Ue)):Ne===!0?(ur="",nn=We):ur=We,ur&&ur!==""&&ur!=="/"&&ur!==We&&we(ur.charCodeAt(ur.length-1))&&(ur=ur.slice(0,-1)),te.unescape===!0&&(nn&&(nn=q.removeBackslashes(nn)),ur&&xe===!0&&(ur=q.removeBackslashes(ur)));const kr={prefix:Ur,input:L,start:ye,base:ur,glob:nn,isBrace:Xe,isBracket:Ke,isGlob:Ne,isExtglob:De,isGlobstar:pt,negated:Pt,negatedExtglob:ut};if(te.tokens===!0&&(kr.maxDepth=0,we(vt)||Ce.push(Ct),kr.tokens=Ce),te.parts===!0||te.tokens===!0){let yt;for(let et=0;et<de.length;et++){const Pi=yt?yt+1:ye,st=de[et],Nt=L.slice(Pi,st);te.tokens&&(et===0&&ye!==0?(Ce[et].isPrefix=!0,Ce[et].value=Ur):Ce[et].value=Nt,Se(Ce[et]),kr.maxDepth+=Ce[et].depth),(et!==0||Nt!=="")&&Fe.push(Nt),yt=st}if(yt&&yt+1<L.length){const et=L.slice(yt+1);Fe.push(et),te.tokens&&(Ce[Ce.length-1].value=et,Se(Ce[Ce.length-1]),kr.maxDepth+=Ce[Ce.length-1].depth)}kr.slashes=de,kr.parts=Fe}return kr},"scan");m.exports=be},8702:(m,B,K)=>{"use strict";const q=K(1017),j=process.platform==="win32",{REGEX_BACKSLASH:se,REGEX_REMOVE_BACKSLASH:ne,REGEX_SPECIAL_CHARS:ue,REGEX_SPECIAL_CHARS_GLOBAL:ce}=K(1006);B.isObject=z=>z!==null&&typeof z=="object"&&!Array.isArray(z),B.hasRegexChars=z=>ue.test(z),B.isRegexChar=z=>z.length===1&&B.hasRegexChars(z),B.escapeRegex=z=>z.replace(ce,"\\$1"),B.toPosixSlashes=z=>z.replace(se,"/"),B.removeBackslashes=z=>z.replace(ne,H=>H==="\\"?"":H),B.supportsLookbehinds=()=>{const z=process.version.slice(1).split(".").map(Number);return z.length===3&&z[0]>=9||z[0]===8&&z[1]>=10},B.isWindows=z=>z&&typeof z.windows=="boolean"?z.windows:j===!0||q.sep==="\\",B.escapeLast=(z,H,M)=>{const X=z.lastIndexOf(H,M);return X===-1?z:z[X-1]==="\\"?B.escapeLast(z,H,X-1):`${z.slice(0,X)}\\${z.slice(X)}`},B.removePrefix=(z,H={})=>{let M=z;return M.startsWith("./")&&(M=M.slice(2),H.prefix="./"),M},B.wrapOutput=(z,H={},M={})=>{const X=M.contains?"":"^",pe=M.contains?"":"$";let $=`${X}(?:${z})${pe}`;return H.negated===!0&&($=`(?:^(?!${$}).*$)`),$}},842:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.AbstractTokenizer=void 0;const q=K(5167);class j{constructor(ne){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=ne||{}}async readToken(ne,ue=this.position){const ce=Buffer.alloc(ne.len);if(await this.readBuffer(ce,{position:ue})<ne.len)throw new q.EndOfStreamError;return ne.get(ce,0)}async peekToken(ne,ue=this.position){const ce=Buffer.alloc(ne.len);if(await this.peekBuffer(ce,{position:ue})<ne.len)throw new q.EndOfStreamError;return ne.get(ce,0)}async readNumber(ne){if(await this.readBuffer(this.numBuffer,{length:ne.len})<ne.len)throw new q.EndOfStreamError;return ne.get(this.numBuffer,0)}async peekNumber(ne){if(await this.peekBuffer(this.numBuffer,{length:ne.len})<ne.len)throw new q.EndOfStreamError;return ne.get(this.numBuffer,0)}async ignore(ne){if(this.fileInfo.size!==void 0){const ue=this.fileInfo.size-this.position;if(ne>ue)return this.position+=ue,ue}return this.position+=ne,ne}async close(){}normalizeOptions(ne,ue){if(ue&&ue.position!==void 0&&ue.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return ue?{mayBeLess:ue.mayBeLess===!0,offset:ue.offset?ue.offset:0,length:ue.length?ue.length:ne.length-(ue.offset?ue.offset:0),position:ue.position?ue.position:this.position}:{mayBeLess:!1,offset:0,length:ne.length,position:this.position}}}a(j,"AbstractTokenizer"),B.AbstractTokenizer=j},1945:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.BufferTokenizer=void 0;const q=K(5167),j=K(842);class se extends j.AbstractTokenizer{constructor(ue,ce){super(ce);this.uint8Array=ue,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:ue.length}async readBuffer(ue,ce){if(ce&&ce.position){if(ce.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=ce.position}const z=await this.peekBuffer(ue,ce);return this.position+=z,z}async peekBuffer(ue,ce){const z=this.normalizeOptions(ue,ce),H=Math.min(this.uint8Array.length-z.position,z.length);if(!z.mayBeLess&&H<z.length)throw new q.EndOfStreamError;return ue.set(this.uint8Array.subarray(z.position,z.position+H),z.offset),H}async close(){}}a(se,"BufferTokenizer"),B.BufferTokenizer=se},7859:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.fromFile=B.FileTokenizer=void 0;const q=K(842),j=K(5167),se=K(7209);class ne extends q.AbstractTokenizer{constructor(z,H){super(H);this.fd=z}async readBuffer(z,H){const M=this.normalizeOptions(z,H);this.position=M.position;const X=await se.read(this.fd,z,M.offset,M.length,M.position);if(this.position+=X.bytesRead,X.bytesRead<M.length&&(!H||!H.mayBeLess))throw new j.EndOfStreamError;return X.bytesRead}async peekBuffer(z,H){const M=this.normalizeOptions(z,H),X=await se.read(this.fd,z,M.offset,M.length,M.position);if(!M.mayBeLess&&X.bytesRead<M.length)throw new j.EndOfStreamError;return X.bytesRead}async close(){return se.close(this.fd)}}a(ne,"FileTokenizer"),B.FileTokenizer=ne;async function ue(ce){const z=await se.stat(ce);if(!z.isFile)throw new Error(`File not a file: ${ce}`);const H=await se.open(ce,"r");return new ne(H,{path:ce,size:z.size})}a(ue,"fromFile"),B.fromFile=ue},7209:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.readFile=B.writeFileSync=B.writeFile=B.read=B.open=B.close=B.stat=B.createReadStream=B.pathExists=void 0;const q=K(7147);B.pathExists=q.existsSync,B.createReadStream=q.createReadStream;async function j(M){return new Promise((X,pe)=>{q.stat(M,($,Y)=>{$?pe($):X(Y)})})}a(j,"stat"),B.stat=j;async function se(M){return new Promise((X,pe)=>{q.close(M,$=>{$?pe($):X()})})}a(se,"close"),B.close=se;async function ne(M,X){return new Promise((pe,$)=>{q.open(M,X,(Y,Ve)=>{Y?$(Y):pe(Ve)})})}a(ne,"open"),B.open=ne;async function ue(M,X,pe,$,Y){return new Promise((Ve,qe)=>{q.read(M,X,pe,$,Y,(ot,we,Se)=>{ot?qe(ot):Ve({bytesRead:we,buffer:Se})})})}a(ue,"read"),B.read=ue;async function ce(M,X){return new Promise((pe,$)=>{q.writeFile(M,X,Y=>{Y?$(Y):pe()})})}a(ce,"writeFile"),B.writeFile=ce;function z(M,X){q.writeFileSync(M,X)}a(z,"writeFileSync"),B.writeFileSync=z;async function H(M){return new Promise((X,pe)=>{q.readFile(M,($,Y)=>{$?pe($):X(Y)})})}a(H,"readFile"),B.readFile=H},599:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.ReadStreamTokenizer=void 0;const q=K(842),j=K(5167),se=256e3;class ne extends q.AbstractTokenizer{constructor(ce,z){super(z);this.streamReader=new j.StreamReader(ce)}async getFileInfo(){return this.fileInfo}async readBuffer(ce,z){const H=this.normalizeOptions(ce,z),M=H.position-this.position;if(M>0)return await this.ignore(M),this.readBuffer(ce,z);if(M<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(H.length===0)return 0;const X=await this.streamReader.read(ce,H.offset,H.length);if(this.position+=X,(!z||!z.mayBeLess)&&X<H.length)throw new j.EndOfStreamError;return X}async peekBuffer(ce,z){const H=this.normalizeOptions(ce,z);let M=0;if(H.position){const X=H.position-this.position;if(X>0){const pe=new Uint8Array(H.length+X);return M=await this.peekBuffer(pe,{mayBeLess:H.mayBeLess}),ce.set(pe.subarray(X),H.offset),M-X}else if(X<0)throw new Error("Cannot peek from a negative offset in a stream")}if(H.length>0){try{M=await this.streamReader.peek(ce,H.offset,H.length)}catch(X){if(z&&z.mayBeLess&&X instanceof j.EndOfStreamError)return 0;throw X}if(!H.mayBeLess&&M<H.length)throw new j.EndOfStreamError}return M}async ignore(ce){const z=Math.min(se,ce),H=new Uint8Array(z);let M=0;for(;M<ce;){const X=ce-M,pe=await this.readBuffer(H,{length:Math.min(z,X)});if(pe<0)return pe;M+=pe}return M}}a(ne,"ReadStreamTokenizer"),B.ReadStreamTokenizer=ne},5849:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.fromBuffer=B.fromStream=B.EndOfStreamError=void 0;const q=K(599),j=K(1945);var se=K(5167);Object.defineProperty(B,"EndOfStreamError",{enumerable:!0,get:function(){return se.EndOfStreamError}});function ne(ce,z){return z=z||{},new q.ReadStreamTokenizer(ce,z)}a(ne,"fromStream"),B.fromStream=ne;function ue(ce,z){return new j.BufferTokenizer(ce,z)}a(ue,"fromBuffer"),B.fromBuffer=ue},6597:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.fromStream=B.fromBuffer=B.EndOfStreamError=B.fromFile=void 0;const q=K(7209),j=K(5849);var se=K(7859);Object.defineProperty(B,"fromFile",{enumerable:!0,get:function(){return se.fromFile}});var ne=K(5849);Object.defineProperty(B,"EndOfStreamError",{enumerable:!0,get:function(){return ne.EndOfStreamError}}),Object.defineProperty(B,"fromBuffer",{enumerable:!0,get:function(){return ne.fromBuffer}});async function ue(ce,z){if(z=z||{},ce.path){const H=await q.stat(ce.path);z.path=ce.path,z.size=H.size}return j.fromStream(ce,z)}a(ue,"fromStream"),B.fromStream=ue},5702:(m,B,K)=>{"use strict";/*!
 * to-regex-range <https://github.com/micromatch/to-regex-range>
 *
 * Copyright (c) 2015-present, Jon Schlinkert.
 * Released under the MIT License.
 */const q=K(9924),j=a((we,Se,be)=>{if(q(we)===!1)throw new TypeError("toRegexRange: expected the first argument to be a number");if(Se===void 0||we===Se)return String(we);if(q(Se)===!1)throw new TypeError("toRegexRange: expected the second argument to be a number.");let L={relaxZeros:!0,...be};typeof L.strictZeros=="boolean"&&(L.relaxZeros=L.strictZeros===!1);let he=String(L.relaxZeros),te=String(L.shorthand),Ae=String(L.capture),le=String(L.wrap),de=we+":"+Se+"="+he+te+Ae+le;if(j.cache.hasOwnProperty(de))return j.cache[de].result;let Ce=Math.min(we,Se),Fe=Math.max(we,Se);if(Math.abs(Ce-Fe)===1){let Xe=we+"|"+Se;return L.capture?`(${Xe})`:L.wrap===!1?Xe:`(?:${Xe})`}let We=qe(we)||qe(Se),Je={min:we,max:Se,a:Ce,b:Fe},ye=[],Ue=[];if(We&&(Je.isPadded=We,Je.maxLen=String(Je.max).length),Ce<0){let Xe=Fe<0?Math.abs(Fe):1;Ue=ce(Xe,Math.abs(Ce),Je,L),Ce=Je.a=0}return Fe>=0&&(ye=ce(Ce,Fe,Je,L)),Je.negatives=Ue,Je.positives=ye,Je.result=se(Ue,ye,L),L.capture===!0?Je.result=`(${Je.result})`:L.wrap!==!1&&ye.length+Ue.length>1&&(Je.result=`(?:${Je.result})`),j.cache[de]=Je,Je.result},"toRegexRange");function se(we,Se,be){let L=z(we,Se,"-",!1,be)||[],he=z(Se,we,"",!1,be)||[],te=z(we,Se,"-?",!0,be)||[];return L.concat(te).concat(he).join("|")}a(se,"collatePatterns");function ne(we,Se){let be=1,L=1,he=pe(we,be),te=new Set([Se]);for(;we<=he&&he<=Se;)te.add(he),be+=1,he=pe(we,be);for(he=$(Se+1,L)-1;we<he&&he<=Se;)te.add(he),L+=1,he=$(Se+1,L)-1;return te=[...te],te.sort(M),te}a(ne,"splitToRanges");function ue(we,Se,be){if(we===Se)return{pattern:we,count:[],digits:0};let L=H(we,Se),he=L.length,te="",Ae=0;for(let le=0;le<he;le++){let[de,Ce]=L[le];de===Ce?te+=de:de!=="0"||Ce!=="9"?te+=Ve(de,Ce,be):Ae++}return Ae&&(te+=be.shorthand===!0?"\\d":"[0-9]"),{pattern:te,count:[Ae],digits:he}}a(ue,"rangeToPattern");function ce(we,Se,be,L){let he=ne(we,Se),te=[],Ae=we,le;for(let de=0;de<he.length;de++){let Ce=he[de],Fe=ue(String(Ae),String(Ce),L),We="";if(!be.isPadded&&le&&le.pattern===Fe.pattern){le.count.length>1&&le.count.pop(),le.count.push(Fe.count[0]),le.string=le.pattern+Y(le.count),Ae=Ce+1;continue}be.isPadded&&(We=ot(Ce,be,L)),Fe.string=We+Fe.pattern+Y(Fe.count),te.push(Fe),Ae=Ce+1,le=Fe}return te}a(ce,"splitToPatterns");function z(we,Se,be,L,he){let te=[];for(let Ae of we){let{string:le}=Ae;!L&&!X(Se,"string",le)&&te.push(be+le),L&&X(Se,"string",le)&&te.push(be+le)}return te}a(z,"filterPatterns");function H(we,Se){let be=[];for(let L=0;L<we.length;L++)be.push([we[L],Se[L]]);return be}a(H,"zip");function M(we,Se){return we>Se?1:Se>we?-1:0}a(M,"compare");function X(we,Se,be){return we.some(L=>L[Se]===be)}a(X,"contains");function pe(we,Se){return Number(String(we).slice(0,-Se)+"9".repeat(Se))}a(pe,"countNines");function $(we,Se){return we-we%Math.pow(10,Se)}a($,"countZeros");function Y(we){let[Se=0,be=""]=we;return be||Se>1?`{${Se+(be?","+be:"")}}`:""}a(Y,"toQuantifier");function Ve(we,Se,be){return`[${we}${Se-we==1?"":"-"}${Se}]`}a(Ve,"toCharacterClass");function qe(we){return/^-?(0+)\d/.test(we)}a(qe,"hasPadding");function ot(we,Se,be){if(!Se.isPadded)return we;let L=Math.abs(Se.maxLen-String(we).length),he=be.relaxZeros!==!1;switch(L){case 0:return"";case 1:return he?"0?":"0";case 2:return he?"0{0,2}":"00";default:return he?`0{0,${L}}`:`0{${L}}`}}a(ot,"padZeros"),j.cache={},j.clearCache=()=>j.cache={},m.exports=j},3416:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.AnsiStringType=B.StringType=B.BufferType=B.Uint8ArrayType=B.IgnoreType=B.Float80_LE=B.Float80_BE=B.Float64_LE=B.Float64_BE=B.Float32_LE=B.Float32_BE=B.Float16_LE=B.Float16_BE=B.INT64_BE=B.UINT64_BE=B.INT64_LE=B.UINT64_LE=B.INT32_LE=B.INT32_BE=B.INT24_BE=B.INT24_LE=B.INT16_LE=B.INT16_BE=B.INT8=B.UINT32_BE=B.UINT32_LE=B.UINT24_BE=B.UINT24_LE=B.UINT16_BE=B.UINT16_LE=B.UINT8=void 0;const q=K(645);function j(H){return new DataView(H.buffer,H.byteOffset)}a(j,"dv"),B.UINT8={len:1,get(H,M){return j(H).getUint8(M)},put(H,M,X){return j(H).setUint8(M,X),M+1}},B.UINT16_LE={len:2,get(H,M){return j(H).getUint16(M,!0)},put(H,M,X){return j(H).setUint16(M,X,!0),M+2}},B.UINT16_BE={len:2,get(H,M){return j(H).getUint16(M)},put(H,M,X){return j(H).setUint16(M,X),M+2}},B.UINT24_LE={len:3,get(H,M){const X=j(H);return X.getUint8(M)+(X.getUint16(M+1,!0)<<8)},put(H,M,X){const pe=j(H);return pe.setUint8(M,X&255),pe.setUint16(M+1,X>>8,!0),M+3}},B.UINT24_BE={len:3,get(H,M){const X=j(H);return(X.getUint16(M)<<8)+X.getUint8(M+2)},put(H,M,X){const pe=j(H);return pe.setUint16(M,X>>8),pe.setUint8(M+2,X&255),M+3}},B.UINT32_LE={len:4,get(H,M){return j(H).getUint32(M,!0)},put(H,M,X){return j(H).setUint32(M,X,!0),M+4}},B.UINT32_BE={len:4,get(H,M){return j(H).getUint32(M)},put(H,M,X){return j(H).setUint32(M,X),M+4}},B.INT8={len:1,get(H,M){return j(H).getInt8(M)},put(H,M,X){return j(H).setInt8(M,X),M+2}},B.INT16_BE={len:2,get(H,M){return j(H).getInt16(M)},put(H,M,X){return j(H).setInt16(M,X),M+2}},B.INT16_LE={len:2,get(H,M){return j(H).getInt16(M,!0)},put(H,M,X){return j(H).setInt16(M,X,!0),M+2}},B.INT24_LE={len:3,get(H,M){const X=B.UINT24_LE.get(H,M);return X>8388607?X-16777216:X},put(H,M,X){const pe=j(H);return pe.setUint8(M,X&255),pe.setUint16(M+1,X>>8,!0),M+3}},B.INT24_BE={len:3,get(H,M){const X=B.UINT24_BE.get(H,M);return X>8388607?X-16777216:X},put(H,M,X){const pe=j(H);return pe.setUint16(M,X>>8),pe.setUint8(M+2,X&255),M+3}},B.INT32_BE={len:4,get(H,M){return j(H).getInt32(M)},put(H,M,X){return j(H).setInt32(M,X),M+4}},B.INT32_LE={len:4,get(H,M){return j(H).getInt32(M,!0)},put(H,M,X){return j(H).setInt32(M,X,!0),M+4}},B.UINT64_LE={len:8,get(H,M){return j(H).getBigUint64(M,!0)},put(H,M,X){return j(H).setBigUint64(M,X,!0),M+8}},B.INT64_LE={len:8,get(H,M){return j(H).getBigInt64(M,!0)},put(H,M,X){return j(H).setBigInt64(M,X,!0),M+8}},B.UINT64_BE={len:8,get(H,M){return j(H).getBigUint64(M)},put(H,M,X){return j(H).setBigUint64(M,X),M+8}},B.INT64_BE={len:8,get(H,M){return j(H).getBigInt64(M)},put(H,M,X){return j(H).setBigInt64(M,X),M+8}},B.Float16_BE={len:2,get(H,M){return q.read(H,M,!1,10,this.len)},put(H,M,X){return q.write(H,X,M,!1,10,this.len),M+this.len}},B.Float16_LE={len:2,get(H,M){return q.read(H,M,!0,10,this.len)},put(H,M,X){return q.write(H,X,M,!0,10,this.len),M+this.len}},B.Float32_BE={len:4,get(H,M){return j(H).getFloat32(M)},put(H,M,X){return j(H).setFloat32(M,X),M+4}},B.Float32_LE={len:4,get(H,M){return j(H).getFloat32(M,!0)},put(H,M,X){return j(H).setFloat32(M,X,!0),M+4}},B.Float64_BE={len:8,get(H,M){return j(H).getFloat64(M)},put(H,M,X){return j(H).setFloat64(M,X),M+8}},B.Float64_LE={len:8,get(H,M){return j(H).getFloat64(M,!0)},put(H,M,X){return j(H).setFloat64(M,X,!0),M+8}},B.Float80_BE={len:10,get(H,M){return q.read(H,M,!1,63,this.len)},put(H,M,X){return q.write(H,X,M,!1,63,this.len),M+this.len}},B.Float80_LE={len:10,get(H,M){return q.read(H,M,!0,63,this.len)},put(H,M,X){return q.write(H,X,M,!0,63,this.len),M+this.len}};class se{constructor(M){this.len=M}get(M,X){}}a(se,"IgnoreType"),B.IgnoreType=se;class ne{constructor(M){this.len=M}get(M,X){return M.subarray(X,X+this.len)}}a(ne,"Uint8ArrayType"),B.Uint8ArrayType=ne;class ue{constructor(M){this.len=M}get(M,X){return M.slice(X,X+this.len)}}a(ue,"BufferType"),B.BufferType=ue;class ce{constructor(M,X){this.len=M,this.encoding=X}get(M,X){return Buffer.from(M).toString(this.encoding,X,X+this.len)}}a(ce,"StringType"),B.StringType=ce;class z{constructor(M){this.len=M}static decode(M,X,pe){let $="";for(let Y=X;Y<pe;++Y)$+=z.codePointToString(z.singleByteDecoder(M[Y]));return $}static inRange(M,X,pe){return X<=M&&M<=pe}static codePointToString(M){return M<=65535?String.fromCharCode(M):(M-=65536,String.fromCharCode((M>>10)+55296,(M&1023)+56320))}static singleByteDecoder(M){if(z.inRange(M,0,127))return M;const X=z.windows1252[M-128];if(X===null)throw Error("invaliding encoding");return X}get(M,X=0){return z.decode(M,X,X+this.len)}}a(z,"AnsiStringType"),B.AnsiStringType=z,z.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},8361:(m,B,K)=>{var q=Object.create,j=Object.defineProperty,se=Object.getOwnPropertyDescriptor,ne=Object.getOwnPropertyNames,ue=Object.getOwnPropertySymbols,ce=Object.getPrototypeOf,z=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable,M=a((s,A,f)=>A in s?j(s,A,{enumerable:!0,configurable:!0,writable:!0,value:f}):s[A]=f,"ml"),X=a((s,A)=>{for(var f in A||(A={}))z.call(A,f)&&M(s,f,A[f]);if(ue)for(var f of ue(A))H.call(A,f)&&M(s,f,A[f]);return s},"zt"),pe=a(s=>j(s,"__esModule",{value:!0}),"El"),$=a((s,A)=>()=>(A||s((A={exports:{}}).exports,A),A.exports),"l"),Y=a((s,A)=>{pe(s);for(var f in A)j(s,f,{get:A[f],enumerable:!0})},"jE"),Ve=a((s,A,f)=>{if(A&&typeof A=="object"||typeof A=="function")for(let w of ne(A))!z.call(s,w)&&w!=="default"&&j(s,w,{get:()=>A[w],enumerable:!(f=se(A,w))||f.enumerable});return s},"HE"),qe=a(s=>Ve(pe(j(s!=null?q(ce(s)):{},"default",s&&s.__esModule&&"default"in s?{get:()=>s.default,enumerable:!0}:{value:s,enumerable:!0})),s),"jn"),ot=$((s,A)=>{"use strict";var f=function(){function w(){}return a(w,"e"),w.info=function(x){for(var g=[],u=1;u<arguments.length;u++)g[u-1]=arguments[u];w.enableDebug&&console.info(w.TAG+x,g)},w.warn=function(x){for(var g=[],u=1;u<arguments.length;u++)g[u-1]=arguments[u];w.disableWarnings||console.warn(w.TAG+x,g)},w.enableDebug=!1,w.disableWarnings=!1,w.disableErrors=!1,w.TAG="ApplicationInsights:",w}();A.exports=f}),we=$(s=>{"use strict";var A=s&&s.__assign||function(){return A=Object.assign||function(g){for(var u,h=1,v=arguments.length;h<v;h++){u=arguments[h];for(var _ in u)Object.prototype.hasOwnProperty.call(u,_)&&(g[_]=u[_])}return g},A.apply(this,arguments)};Object.defineProperty(s,"__esModule",{value:!0}),s.AsyncScopeManager=s.OpenTelemetryScopeManagerWrapper=void 0;var f=$i(),w=K(2361),x=function(){function g(){}return a(g,"e"),g.prototype.active=function(){var u=this,h=f.CorrelationContextManager.getCurrentContext();return A(A({},h),{getValue:function(v){return u._activeSymbol?v===u._activeSymbol?h:!1:(u._activeSymbol=v,h)},setValue:function(){}})},g.prototype.with=function(u,h){var v=u.parentSpanId,_=u.name,b=g._spanToContext(u,v,_);return f.CorrelationContextManager.runWithContext(b,h)()},g.prototype.bind=function(u){return typeof u=="function"?f.CorrelationContextManager.wrapCallback(u):(u instanceof w.EventEmitter&&f.CorrelationContextManager.wrapEmitter(u),u)},g.prototype.enable=function(){return f.CorrelationContextManager.enable(),this},g.prototype.disable=function(){return f.CorrelationContextManager.disable(),this},g._spanToContext=function(u,h,v){var _=h?"|"+u.spanContext().traceId+"."+h+".":u.spanContext().traceId,b=A(A({},u.spanContext()),{traceFlags:u.spanContext().traceFlags}),y=f.CorrelationContextManager.spanToContextObject(b,_,v);return y},g}();s.OpenTelemetryScopeManagerWrapper=x,s.AsyncScopeManager=new x}),Se=$((s,A)=>{s=A.exports=Gt;var f;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?f=a(function(){var ee=Array.prototype.slice.call(arguments,0);ee.unshift("SEMVER"),console.log.apply(console,ee)},"N"):f=a(function(){},"N"),s.SEMVER_SPEC_VERSION="2.0.0";var w=256,x=Number.MAX_SAFE_INTEGER||9007199254740991,g=16,u=s.re=[],h=s.src=[],v=0,_=v++;h[_]="0|[1-9]\\d*";var b=v++;h[b]="[0-9]+";var y=v++;h[y]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var E=v++;h[E]="("+h[_]+")\\.("+h[_]+")\\.("+h[_]+")";var C=v++;h[C]="("+h[b]+")\\.("+h[b]+")\\.("+h[b]+")";var T=v++;h[T]="(?:"+h[_]+"|"+h[y]+")";var R=v++;h[R]="(?:"+h[b]+"|"+h[y]+")";var D=v++;h[D]="(?:-("+h[T]+"(?:\\."+h[T]+")*))";var k=v++;h[k]="(?:-?("+h[R]+"(?:\\."+h[R]+")*))";var G=v++;h[G]="[0-9A-Za-z-]+";var Z=v++;h[Z]="(?:\\+("+h[G]+"(?:\\."+h[G]+")*))";var Q=v++,fe="v?"+h[E]+h[D]+"?"+h[Z]+"?";h[Q]="^"+fe+"$";var Ee="[v=\\s]*"+h[C]+h[k]+"?"+h[Z]+"?",Pe=v++;h[Pe]="^"+Ee+"$";var He=v++;h[He]="((?:<|>)?=?)";var Qe=v++;h[Qe]=h[b]+"|x|X|\\*";var tt=v++;h[tt]=h[_]+"|x|X|\\*";var mt=v++;h[mt]="[v=\\s]*("+h[tt]+")(?:\\.("+h[tt]+")(?:\\.("+h[tt]+")(?:"+h[D]+")?"+h[Z]+"?)?)?";var bt=v++;h[bt]="[v=\\s]*("+h[Qe]+")(?:\\.("+h[Qe]+")(?:\\.("+h[Qe]+")(?:"+h[k]+")?"+h[Z]+"?)?)?";var jt=v++;h[jt]="^"+h[He]+"\\s*"+h[mt]+"$";var Bt=v++;h[Bt]="^"+h[He]+"\\s*"+h[bt]+"$";var Tr=v++;h[Tr]="(?:^|[^\\d])(\\d{1,"+g+"})(?:\\.(\\d{1,"+g+"}))?(?:\\.(\\d{1,"+g+"}))?(?:$|[^\\d])";var Mt=v++;h[Mt]="(?:~>?)";var Ze=v++;h[Ze]="(\\s*)"+h[Mt]+"\\s+",u[Ze]=new RegExp(h[Ze],"g");var ht="$1~",dt=v++;h[dt]="^"+h[Mt]+h[mt]+"$";var xt=v++;h[xt]="^"+h[Mt]+h[bt]+"$";var Lt=v++;h[Lt]="(?:\\^)";var qt=v++;h[qt]="(\\s*)"+h[Lt]+"\\s+",u[qt]=new RegExp(h[qt],"g");var Tt="$1^",Qt=v++;h[Qt]="^"+h[Lt]+h[mt]+"$";var Dr=v++;h[Dr]="^"+h[Lt]+h[bt]+"$";var vr=v++;h[vr]="^"+h[He]+"\\s*("+Ee+")$|^$";var yr=v++;h[yr]="^"+h[He]+"\\s*("+fe+")$|^$";var ir=v++;h[ir]="(\\s*)"+h[He]+"\\s*("+Ee+"|"+h[mt]+")",u[ir]=new RegExp(h[ir],"g");var Fr="$1$2$3",mn=v++;h[mn]="^\\s*("+h[mt]+")\\s+-\\s+("+h[mt]+")\\s*$";var Ot=v++;h[Ot]="^\\s*("+h[bt]+")\\s+-\\s+("+h[bt]+")\\s*$";var At=v++;for(h[At]="(<|>)?=?\\s*\\*",ar=0;ar<v;ar++)f(ar,h[ar]),u[ar]||(u[ar]=new RegExp(h[ar]));var ar;s.parse=Nr;function Nr(ee,me){if((!me||typeof me!="object")&&(me={loose:!!me,includePrerelease:!1}),ee instanceof Gt)return ee;if(typeof ee!="string"||ee.length>w)return null;var Te=me.loose?u[Pe]:u[Q];if(!Te.test(ee))return null;try{return new Gt(ee,me)}catch(rt){return null}}a(Nr,"Qt"),s.valid=_a;function _a(ee,me){var Te=Nr(ee,me);return Te?Te.version:null}a(_a,"$E"),s.clean=Sc;function Sc(ee,me){var Te=Nr(ee.trim().replace(/^[=v]+/,""),me);return Te?Te.version:null}a(Sc,"zE"),s.SemVer=Gt;function Gt(ee,me){if((!me||typeof me!="object")&&(me={loose:!!me,includePrerelease:!1}),ee instanceof Gt){if(ee.loose===me.loose)return ee;ee=ee.version}else if(typeof ee!="string")throw new TypeError("Invalid Version: "+ee);if(ee.length>w)throw new TypeError("version is longer than "+w+" characters");if(!(this instanceof Gt))return new Gt(ee,me);f("SemVer",ee,me),this.options=me,this.loose=!!me.loose;var Te=ee.trim().match(me.loose?u[Pe]:u[Q]);if(!Te)throw new TypeError("Invalid Version: "+ee);if(this.raw=ee,this.major=+Te[1],this.minor=+Te[2],this.patch=+Te[3],this.major>x||this.major<0)throw new TypeError("Invalid major version");if(this.minor>x||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>x||this.patch<0)throw new TypeError("Invalid patch version");Te[4]?this.prerelease=Te[4].split(".").map(function(rt){if(/^[0-9]+$/.test(rt)){var ct=+rt;if(ct>=0&&ct<x)return ct}return rt}):this.prerelease=[],this.build=Te[5]?Te[5].split("."):[],this.format()}a(Gt,"b"),Gt.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},Gt.prototype.toString=function(){return this.version},Gt.prototype.compare=function(ee){return f("SemVer.compare",this.version,this.options,ee),ee instanceof Gt||(ee=new Gt(ee,this.options)),this.compareMain(ee)||this.comparePre(ee)},Gt.prototype.compareMain=function(ee){return ee instanceof Gt||(ee=new Gt(ee,this.options)),ai(this.major,ee.major)||ai(this.minor,ee.minor)||ai(this.patch,ee.patch)},Gt.prototype.comparePre=function(ee){if(ee instanceof Gt||(ee=new Gt(ee,this.options)),this.prerelease.length&&!ee.prerelease.length)return-1;if(!this.prerelease.length&&ee.prerelease.length)return 1;if(!this.prerelease.length&&!ee.prerelease.length)return 0;var me=0;do{var Te=this.prerelease[me],rt=ee.prerelease[me];if(f("prerelease compare",me,Te,rt),Te===void 0&&rt===void 0)return 0;if(rt===void 0)return 1;if(Te===void 0)return-1;if(Te!==rt)return ai(Te,rt)}while(++me)},Gt.prototype.inc=function(ee,me){switch(ee){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",me);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",me);break;case"prepatch":this.prerelease.length=0,this.inc("patch",me),this.inc("pre",me);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",me),this.inc("pre",me);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var Te=this.prerelease.length;--Te>=0;)typeof this.prerelease[Te]=="number"&&(this.prerelease[Te]++,Te=-2);Te===-1&&this.prerelease.push(0)}me&&(this.prerelease[0]===me?isNaN(this.prerelease[1])&&(this.prerelease=[me,0]):this.prerelease=[me,0]);break;default:throw new Error("invalid increment argument: "+ee)}return this.format(),this.raw=this.version,this},s.inc=wa;function wa(ee,me,Te,rt){typeof Te=="string"&&(rt=Te,Te=void 0);try{return new Gt(ee,Te).inc(me,rt).version}catch(ct){return null}}a(wa,"KE"),s.diff=Ec;function Ec(ee,me){if(so(ee,me))return null;var Te=Nr(ee),rt=Nr(me),ct="";if(Te.prerelease.length||rt.prerelease.length){ct="pre";var _t="prerelease"}for(var Et in Te)if((Et==="major"||Et==="minor"||Et==="patch")&&Te[Et]!==rt[Et])return ct+Et;return _t}a(Ec,"XE"),s.compareIdentifiers=ai;var ao=/^[0-9]+$/;function ai(ee,me){var Te=ao.test(ee),rt=ao.test(me);return Te&&rt&&(ee=+ee,me=+me),ee===me?0:Te&&!rt?-1:rt&&!Te?1:ee<me?-1:1}a(ai,"Lr"),s.rcompareIdentifiers=si;function si(ee,me){return ai(me,ee)}a(si,"YE"),s.major=Dn;function Dn(ee,me){return new Gt(ee,me).major}a(Dn,"QE"),s.minor=Sn;function Sn(ee,me){return new Gt(ee,me).minor}a(Sn,"WE"),s.patch=Bi;function Bi(ee,me){return new Gt(ee,me).patch}a(Bi,"ZE"),s.compare=kn;function kn(ee,me,Te){return new Gt(ee,Te).compare(new Gt(me,Te))}a(kn,"at"),s.compareLoose=xc;function xc(ee,me){return kn(ee,me,!0)}a(xc,"JE"),s.rcompare=xi;function xi(ee,me,Te){return kn(me,ee,Te)}a(xi,"ey"),s.sort=gs;function gs(ee,me){return ee.sort(function(Te,rt){return s.compare(Te,rt,me)})}a(gs,"ty"),s.rsort=ms;function ms(ee,me){return ee.sort(function(Te,rt){return s.rcompare(Te,rt,me)})}a(ms,"ry"),s.gt=Hi;function Hi(ee,me,Te){return kn(ee,me,Te)>0}a(Hi,"Gn"),s.lt=Ui;function Ui(ee,me,Te){return kn(ee,me,Te)<0}a(Ui,"Wi"),s.eq=so;function so(ee,me,Te){return kn(ee,me,Te)===0}a(so,"To"),s.neq=ba;function ba(ee,me,Te){return kn(ee,me,Te)!==0}a(ba,"ql"),s.gte=Bo;function Bo(ee,me,Te){return kn(ee,me,Te)>=0}a(Bo,"So"),s.lte=qr;function qr(ee,me,Te){return kn(ee,me,Te)<=0}a(qr,"Ao"),s.cmp=Ci;function Ci(ee,me,Te,rt){switch(me){case"===":return typeof ee=="object"&&(ee=ee.version),typeof Te=="object"&&(Te=Te.version),ee===Te;case"!==":return typeof ee=="object"&&(ee=ee.version),typeof Te=="object"&&(Te=Te.version),ee!==Te;case"":case"=":case"==":return so(ee,Te,rt);case"!=":return ba(ee,Te,rt);case">":return Hi(ee,Te,rt);case">=":return Bo(ee,Te,rt);case"<":return Ui(ee,Te,rt);case"<=":return qr(ee,Te,rt);default:throw new TypeError("Invalid operator: "+me)}}a(Ci,"Zi"),s.Comparator=Zr;function Zr(ee,me){if((!me||typeof me!="object")&&(me={loose:!!me,includePrerelease:!1}),ee instanceof Zr){if(ee.loose===!!me.loose)return ee;ee=ee.value}if(!(this instanceof Zr))return new Zr(ee,me);f("comparator",ee,me),this.options=me,this.loose=!!me.loose,this.parse(ee),this.semver===ci?this.value="":this.value=this.operator+this.semver.version,f("comp",this)}a(Zr,"Ne");var ci={};Zr.prototype.parse=function(ee){var me=this.options.loose?u[vr]:u[yr],Te=ee.match(me);if(!Te)throw new TypeError("Invalid comparator: "+ee);this.operator=Te[1],this.operator==="="&&(this.operator=""),Te[2]?this.semver=new Gt(Te[2],this.options.loose):this.semver=ci},Zr.prototype.toString=function(){return this.value},Zr.prototype.test=function(ee){return f("Comparator.test",ee,this.options.loose),this.semver===ci?!0:(typeof ee=="string"&&(ee=new Gt(ee,this.options)),Ci(ee,this.operator,this.semver,this.options))},Zr.prototype.intersects=function(ee,me){if(!(ee instanceof Zr))throw new TypeError("a Comparator is required");(!me||typeof me!="object")&&(me={loose:!!me,includePrerelease:!1});var Te;if(this.operator==="")return Te=new pr(ee.value,me),Ir(this.value,Te,me);if(ee.operator==="")return Te=new pr(this.value,me),Ir(ee.semver,Te,me);var rt=(this.operator===">="||this.operator===">")&&(ee.operator===">="||ee.operator===">"),ct=(this.operator==="<="||this.operator==="<")&&(ee.operator==="<="||ee.operator==="<"),_t=this.semver.version===ee.semver.version,Et=(this.operator===">="||this.operator==="<=")&&(ee.operator===">="||ee.operator==="<="),zt=Ci(this.semver,"<",ee.semver,me)&&(this.operator===">="||this.operator===">")&&(ee.operator==="<="||ee.operator==="<"),Ft=Ci(this.semver,">",ee.semver,me)&&(this.operator==="<="||this.operator==="<")&&(ee.operator===">="||ee.operator===">");return rt||ct||_t&&Et||zt||Ft},s.Range=pr;function pr(ee,me){if((!me||typeof me!="object")&&(me={loose:!!me,includePrerelease:!1}),ee instanceof pr)return ee.loose===!!me.loose&&ee.includePrerelease===!!me.includePrerelease?ee:new pr(ee.raw,me);if(ee instanceof Zr)return new pr(ee.value,me);if(!(this instanceof pr))return new pr(ee,me);if(this.options=me,this.loose=!!me.loose,this.includePrerelease=!!me.includePrerelease,this.raw=ee,this.set=ee.split(/\s*\|\|\s*/).map(function(Te){return this.parseRange(Te.trim())},this).filter(function(Te){return Te.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+ee);this.format()}a(pr,"U"),pr.prototype.format=function(){return this.range=this.set.map(function(ee){return ee.join(" ").trim()}).join("||").trim(),this.range},pr.prototype.toString=function(){return this.range},pr.prototype.parseRange=function(ee){var me=this.options.loose;ee=ee.trim();var Te=me?u[Ot]:u[mn];ee=ee.replace(Te,uo),f("hyphen replace",ee),ee=ee.replace(u[ir],Fr),f("comparator trim",ee,u[ir]),ee=ee.replace(u[Ze],ht),ee=ee.replace(u[qt],Tt),ee=ee.split(/\s+/).join(" ");var rt=me?u[vr]:u[yr],ct=ee.split(" ").map(function(_t){return ji(_t,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(ct=ct.filter(function(_t){return!!_t.match(rt)})),ct=ct.map(function(_t){return new Zr(_t,this.options)},this),ct},pr.prototype.intersects=function(ee,me){if(!(ee instanceof pr))throw new TypeError("a Range is required");return this.set.some(function(Te){return Te.every(function(rt){return ee.set.some(function(ct){return ct.every(function(_t){return rt.intersects(_t,me)})})})})},s.toComparators=co;function co(ee,me){return new pr(ee,me).set.map(function(Te){return Te.map(function(rt){return rt.value}).join(" ").trim().split(" ")})}a(co,"ny");function ji(ee,me){return f("comp",ee,me),ee=Ea(ee,me),f("caret",ee),ee=St(ee,me),f("tildes",ee),ee=vs(ee,me),f("xrange",ee),ee=Nn(ee,me),f("stars",ee),ee}a(ji,"iy");function zr(ee){return!ee||ee.toLowerCase()==="x"||ee==="*"}a(zr,"ge");function St(ee,me){return ee.trim().split(/\s+/).map(function(Te){return Sa(Te,me)}).join(" ")}a(St,"ay");function Sa(ee,me){var Te=me.loose?u[xt]:u[dt];return ee.replace(Te,function(rt,ct,_t,Et,zt){f("tilde",ee,rt,ct,_t,Et,zt);var Ft;return zr(ct)?Ft="":zr(_t)?Ft=">="+ct+".0.0 <"+(+ct+1)+".0.0":zr(Et)?Ft=">="+ct+"."+_t+".0 <"+ct+"."+(+_t+1)+".0":zt?(f("replaceTilde pr",zt),Ft=">="+ct+"."+_t+"."+Et+"-"+zt+" <"+ct+"."+(+_t+1)+".0"):Ft=">="+ct+"."+_t+"."+Et+" <"+ct+"."+(+_t+1)+".0",f("tilde return",Ft),Ft})}a(Sa,"sy");function Ea(ee,me){return ee.trim().split(/\s+/).map(function(Te){return lo(Te,me)}).join(" ")}a(Ea,"oy");function lo(ee,me){f("caret",ee,me);var Te=me.loose?u[Dr]:u[Qt];return ee.replace(Te,function(rt,ct,_t,Et,zt){f("caret",ee,rt,ct,_t,Et,zt);var Ft;return zr(ct)?Ft="":zr(_t)?Ft=">="+ct+".0.0 <"+(+ct+1)+".0.0":zr(Et)?ct==="0"?Ft=">="+ct+"."+_t+".0 <"+ct+"."+(+_t+1)+".0":Ft=">="+ct+"."+_t+".0 <"+(+ct+1)+".0.0":zt?(f("replaceCaret pr",zt),ct==="0"?_t==="0"?Ft=">="+ct+"."+_t+"."+Et+"-"+zt+" <"+ct+"."+_t+"."+(+Et+1):Ft=">="+ct+"."+_t+"."+Et+"-"+zt+" <"+ct+"."+(+_t+1)+".0":Ft=">="+ct+"."+_t+"."+Et+"-"+zt+" <"+(+ct+1)+".0.0"):(f("no pr"),ct==="0"?_t==="0"?Ft=">="+ct+"."+_t+"."+Et+" <"+ct+"."+_t+"."+(+Et+1):Ft=">="+ct+"."+_t+"."+Et+" <"+ct+"."+(+_t+1)+".0":Ft=">="+ct+"."+_t+"."+Et+" <"+(+ct+1)+".0.0"),f("caret return",Ft),Ft})}a(lo,"uy");function vs(ee,me){return f("replaceXRanges",ee,me),ee.split(/\s+/).map(function(Te){return ys(Te,me)}).join(" ")}a(vs,"cy");function ys(ee,me){ee=ee.trim();var Te=me.loose?u[Bt]:u[jt];return ee.replace(Te,function(rt,ct,_t,Et,zt,Ft){f("xRange",ee,rt,ct,_t,Et,zt,Ft);var En=zr(_t),Br=En||zr(Et),_r=Br||zr(zt),rr=_r;return ct==="="&&rr&&(ct=""),En?ct===">"||ct==="<"?rt="<0.0.0":rt="*":ct&&rr?(Br&&(Et=0),zt=0,ct===">"?(ct=">=",Br?(_t=+_t+1,Et=0,zt=0):(Et=+Et+1,zt=0)):ct==="<="&&(ct="<",Br?_t=+_t+1:Et=+Et+1),rt=ct+_t+"."+Et+"."+zt):Br?rt=">="+_t+".0.0 <"+(+_t+1)+".0.0":_r&&(rt=">="+_t+"."+Et+".0 <"+_t+"."+(+Et+1)+".0"),f("xRange return",rt),rt})}a(ys,"ly");function Nn(ee,me){return f("replaceStars",ee,me),ee.trim().replace(u[At],"")}a(Nn,"py");function uo(ee,me,Te,rt,ct,_t,Et,zt,Ft,En,Br,_r,rr){return zr(Te)?me="":zr(rt)?me=">="+Te+".0.0":zr(ct)?me=">="+Te+"."+rt+".0":me=">="+me,zr(Ft)?zt="":zr(En)?zt="<"+(+Ft+1)+".0.0":zr(Br)?zt="<"+Ft+"."+(+En+1)+".0":_r?zt="<="+Ft+"."+En+"."+Br+"-"+_r:zt="<="+zt,(me+" "+zt).trim()}a(uo,"fy"),pr.prototype.test=function(ee){if(!ee)return!1;typeof ee=="string"&&(ee=new Gt(ee,this.options));for(var me=0;me<this.set.length;me++)if(_s(this.set[me],ee,this.options))return!0;return!1};function _s(ee,me,Te){for(var rt=0;rt<ee.length;rt++)if(!ee[rt].test(me))return!1;if(me.prerelease.length&&!Te.includePrerelease){for(rt=0;rt<ee.length;rt++)if(f(ee[rt].semver),ee[rt].semver!==ci&&ee[rt].semver.prerelease.length>0){var ct=ee[rt].semver;if(ct.major===me.major&&ct.minor===me.minor&&ct.patch===me.patch)return!0}return!1}return!0}a(_s,"dy"),s.satisfies=Ir;function Ir(ee,me,Te){try{me=new pr(me,Te)}catch(rt){return!1}return me.test(ee)}a(Ir,"Ji"),s.maxSatisfying=ws;function ws(ee,me,Te){var rt=null,ct=null;try{var _t=new pr(me,Te)}catch(Et){return null}return ee.forEach(function(Et){_t.test(Et)&&(!rt||ct.compare(Et)===-1)&&(rt=Et,ct=new Gt(rt,Te))}),rt}a(ws,"hy"),s.minSatisfying=Kn;function Kn(ee,me,Te){var rt=null,ct=null;try{var _t=new pr(me,Te)}catch(Et){return null}return ee.forEach(function(Et){_t.test(Et)&&(!rt||ct.compare(Et)===1)&&(rt=Et,ct=new Gt(rt,Te))}),rt}a(Kn,"_y"),s.minVersion=qi;function qi(ee,me){ee=new pr(ee,me);var Te=new Gt("0.0.0");if(ee.test(Te)||(Te=new Gt("0.0.0-0"),ee.test(Te)))return Te;Te=null;for(var rt=0;rt<ee.set.length;++rt){var ct=ee.set[rt];ct.forEach(function(_t){var Et=new Gt(_t.semver.version);switch(_t.operator){case">":Et.prerelease.length===0?Et.patch++:Et.prerelease.push(0),Et.raw=Et.format();case"":case">=":(!Te||Hi(Te,Et))&&(Te=Et);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+_t.operator)}})}return Te&&ee.test(Te)?Te:null}a(qi,"gy"),s.validRange=Xn;function Xn(ee,me){try{return new pr(ee,me).range||"*"}catch(Te){return null}}a(Xn,"vy"),s.ltr=bs;function bs(ee,me,Te){return xa(ee,me,"<",Te)}a(bs,"my"),s.gtr=Ss;function Ss(ee,me,Te){return xa(ee,me,">",Te)}a(Ss,"Ey"),s.outside=xa;function xa(ee,me,Te,rt){ee=new Gt(ee,rt),me=new pr(me,rt);var ct,_t,Et,zt,Ft;switch(Te){case">":ct=Hi,_t=qr,Et=Ui,zt=">",Ft=">=";break;case"<":ct=Ui,_t=Bo,Et=Hi,zt="<",Ft="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Ir(ee,me,rt))return!1;for(var En=0;En<me.set.length;++En){var Br=me.set[En],_r=null,rr=null;if(Br.forEach(function(Mn){Mn.semver===ci&&(Mn=new Zr(">=0.0.0")),_r=_r||Mn,rr=rr||Mn,ct(Mn.semver,_r.semver,rt)?_r=Mn:Et(Mn.semver,rr.semver,rt)&&(rr=Mn)}),_r.operator===zt||_r.operator===Ft||(!rr.operator||rr.operator===zt)&&_t(ee,rr.semver)||rr.operator===Ft&&Et(ee,rr.semver))return!1}return!0}a(xa,"bo"),s.prerelease=Ca;function Ca(ee,me){var Te=Nr(ee,me);return Te&&Te.prerelease.length?Te.prerelease:null}a(Ca,"yy"),s.intersects=vn;function vn(ee,me,Te){return ee=new pr(ee,Te),me=new pr(me,Te),ee.intersects(me)}a(vn,"Ty"),s.coerce=Ti;function Ti(ee){if(ee instanceof Gt)return ee;if(typeof ee!="string")return null;var me=ee.match(u[Tr]);return me==null?null:Nr(me[1]+"."+(me[2]||"0")+"."+(me[3]||"0"))}a(Ti,"Sy")}),be=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.makePatchingRequire=void 0;var A=K(1017),f=Se(),w=K(8188),x=Object.keys(process.binding("natives")),g=w.prototype.require;function u(h){var v={};return function(_){var b=g.apply(this,arguments);if(h[_]){var y=w._resolveFilename(_,this);if(v.hasOwnProperty(y))return v[y];var E=void 0;if(x.indexOf(_)<0)try{E=g.call(this,A.join(_,"package.json")).version}catch(G){return b}else E=process.version.substring(1);var C=E.indexOf("-");C>=0&&(E=E.substring(0,C));for(var T=b,R=0,D=h[_];R<D.length;R++){var k=D[R];f.satisfies(E,k.versionSpecifier)&&(T=k.patch(T,y))}return v[y]=T}return b}}a(u,"Cy"),s.makePatchingRequire=u}),L=$((s,A)=>{A.exports={name:"diagnostic-channel",version:"1.0.0",main:"./dist/src/channel.js",types:"./dist/src/channel.d.ts",scripts:{build:"tsc",lint:"tslint -c tslint.json -p tsconfig.json",clean:"rimraf ./dist",test:"mocha ./dist/tests/**/*.js"},homepage:"https://github.com/Microsoft/node-diagnostic-channel",bugs:{url:"https://github.com/Microsoft/node-diagnostic-channel/issues"},repository:{type:"git",url:"https://github.com/Microsoft/node-diagnostic-channel.git"},description:"Provides a context-saving pub/sub channel to connect diagnostic event publishers and subscribers",dependencies:{semver:"^5.3.0"},devDependencies:{"@types/mocha":"^2.2.40","@types/node":"~8.0.0",mocha:"^3.2.0",rimraf:"^2.6.1",tslint:"^5.0.0",typescript:"4.1.2"},files:["dist/src/**/*.d.ts","dist/src/**/*.js","LICENSE","README.md","package.json"],license:"MIT"}}),he=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.channel=s.makePatchingRequire=void 0;var A=be(),f=be();Object.defineProperty(s,"makePatchingRequire",{enumerable:!0,get:function(){return f.makePatchingRequire}});var w=a(function(u){return!0},"Bl"),x=function(){function u(){this.version=L().version,this.subscribers={},this.contextPreservationFunction=function(h){return h},this.knownPatches={},this.currentlyPublishing=!1}return a(u,"e"),u.prototype.shouldPublish=function(h){var v=this.subscribers[h];return v?v.some(function(_){var b=_.filter;return!b||b(!1)}):!1},u.prototype.publish=function(h,v){if(!this.currentlyPublishing){var _=this.subscribers[h];if(_){var b={timestamp:Date.now(),data:v};this.currentlyPublishing=!0,_.forEach(function(y){var E=y.listener,C=y.filter;try{C&&C(!0)&&E(b)}catch(T){}}),this.currentlyPublishing=!1}}},u.prototype.subscribe=function(h,v,_){_===void 0&&(_=w),this.subscribers[h]||(this.subscribers[h]=[]),this.subscribers[h].push({listener:v,filter:_})},u.prototype.unsubscribe=function(h,v,_){_===void 0&&(_=w);var b=this.subscribers[h];if(b){for(var y=0;y<b.length;++y)if(b[y].listener===v&&b[y].filter===_)return b.splice(y,1),!0}return!1},u.prototype.reset=function(){var h=this;this.subscribers={},this.contextPreservationFunction=function(v){return v},Object.getOwnPropertyNames(this.knownPatches).forEach(function(v){return delete h.knownPatches[v]})},u.prototype.bindToContext=function(h){return this.contextPreservationFunction(h)},u.prototype.addContextPreservation=function(h){var v=this.contextPreservationFunction;this.contextPreservationFunction=function(_){return h(v(_))}},u.prototype.registerMonkeyPatch=function(h,v){this.knownPatches[h]||(this.knownPatches[h]=[]),this.knownPatches[h].push(v)},u.prototype.getPatchesObject=function(){return this.knownPatches},u}();global.diagnosticsSource||(global.diagnosticsSource=new x,g=K(8188),g.prototype.require=A.makePatchingRequire(global.diagnosticsSource.getPatchesObject()));var g;s.channel=global.diagnosticsSource}),te=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Ae=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.BaggageImpl=void 0;var A=function(){function f(w){this._entries=w?new Map(w):new Map}return a(f,"e"),f.prototype.getEntry=function(w){var x=this._entries.get(w);if(x)return Object.assign({},x)},f.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(w){var x=w[0],g=w[1];return[x,g]})},f.prototype.setEntry=function(w,x){var g=new f(this._entries);return g._entries.set(w,x),g},f.prototype.removeEntry=function(w){var x=new f(this._entries);return x._entries.delete(w),x},f.prototype.removeEntries=function(){for(var w=[],x=0;x<arguments.length;x++)w[x]=arguments[x];for(var g=new f(this._entries),u=0,h=w;u<h.length;u++){var v=h[u];g._entries.delete(v)}return g},f.prototype.clear=function(){return new f},f}();s.BaggageImpl=A}),le=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.baggageEntryMetadataSymbol=void 0,s.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")}),de=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.baggageEntryMetadataFromString=s.createBaggage=void 0;var A=sr(),f=Ae(),w=le();function x(u){return u===void 0&&(u={}),new f.BaggageImpl(new Map(Object.entries(u)))}a(x,"Ly"),s.createBaggage=x;function g(u){return typeof u!="string"&&(A.diag.error("Cannot create baggage metadata from unknown type: "+typeof u),u=""),{__TYPE__:w.baggageEntryMetadataSymbol,toString:function(){return u}}}a(g,"qy"),s.baggageEntryMetadataFromString=g}),Ce=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Fe=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),We=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.DiagConsoleLogger=void 0;var A=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],f=function(){function w(){function x(u){return function(){var h=arguments;if(console){var v=console[u];if(typeof v!="function"&&(v=console.log),typeof v=="function")return v.apply(console,h)}}}a(x,"t");for(var g=0;g<A.length;g++)this[A[g].n]=x(A[g].c)}return a(w,"e"),w}();s.DiagConsoleLogger=f}),Je=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.DiagLogLevel=void 0;var A;(function(f){f[f.NONE=0]="NONE",f[f.ERROR=30]="ERROR",f[f.WARN=50]="WARN",f[f.INFO=60]="INFO",f[f.DEBUG=70]="DEBUG",f[f.VERBOSE=80]="VERBOSE",f[f.ALL=9999]="ALL"})(A=s.DiagLogLevel||(s.DiagLogLevel={}))}),ye=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(We(),s),f(Je(),s)}),Ue=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.defaultTextMapSetter=s.defaultTextMapGetter=void 0,s.defaultTextMapGetter={get:function(A,f){if(A!=null)return A[f]},keys:function(A){return A==null?[]:Object.keys(A)}},s.defaultTextMapSetter={set:function(A,f,w){A!=null&&(A[f]=w)}}}),Xe=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Ke=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Ne=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.ROOT_CONTEXT=s.createContextKey=void 0;function A(w){return Symbol.for(w)}a(A,"Uy"),s.createContextKey=A;var f=function(){function w(x){var g=this;g._currentContext=x?new Map(x):new Map,g.getValue=function(u){return g._currentContext.get(u)},g.setValue=function(u,h){var v=new w(g._currentContext);return v._currentContext.set(u,h),v},g.deleteValue=function(u){var h=new w(g._currentContext);return h._currentContext.delete(u),h}}return a(w,"e"),w}();s.ROOT_CONTEXT=new f}),De=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.TraceFlags=void 0;var A;(function(f){f[f.NONE=0]="NONE",f[f.SAMPLED=1]="SAMPLED"})(A=s.TraceFlags||(s.TraceFlags={}))}),pt=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.wrapSpanContext=s.isSpanContextValid=s.isValidSpanId=s.isValidTraceId=s.INVALID_SPAN_CONTEXT=s.INVALID_TRACEID=s.INVALID_SPANID=void 0;var A=Rt(),f=De(),w=/^([0-9a-f]{32})$/i,x=/^[0-9a-f]{16}$/i;s.INVALID_SPANID="0000000000000000",s.INVALID_TRACEID="00000000000000000000000000000000",s.INVALID_SPAN_CONTEXT={traceId:s.INVALID_TRACEID,spanId:s.INVALID_SPANID,traceFlags:f.TraceFlags.NONE};function g(_){return w.test(_)&&_!==s.INVALID_TRACEID}a(g,"ip"),s.isValidTraceId=g;function u(_){return x.test(_)&&_!==s.INVALID_SPANID}a(u,"ap"),s.isValidSpanId=u;function h(_){return g(_.traceId)&&u(_.spanId)}a(h,"Ky"),s.isSpanContextValid=h;function v(_){return new A.NonRecordingSpan(_)}a(v,"Xy"),s.wrapSpanContext=v}),Rt=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.NonRecordingSpan=void 0;var A=pt(),f=function(){function w(x){x===void 0&&(x=A.INVALID_SPAN_CONTEXT),this._spanContext=x}return a(w,"e"),w.prototype.spanContext=function(){return this._spanContext},w.prototype.setAttribute=function(x,g){return this},w.prototype.setAttributes=function(x){return this},w.prototype.addEvent=function(x,g){return this},w.prototype.setStatus=function(x){return this},w.prototype.updateName=function(x){return this},w.prototype.end=function(x){},w.prototype.isRecording=function(){return!1},w.prototype.recordException=function(x,g){},w}();s.NonRecordingSpan=f}),xe=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.getSpanContext=s.setSpanContext=s.deleteSpan=s.setSpan=s.getSpan=void 0;var A=Ne(),f=Rt(),w=A.createContextKey("OpenTelemetry Context Key SPAN");function x(_){return _.getValue(w)||void 0}a(x,"sp"),s.getSpan=x;function g(_,b){return _.setValue(w,b)}a(g,"op"),s.setSpan=g;function u(_){return _.deleteValue(w)}a(u,"Jy"),s.deleteSpan=u;function h(_,b){return g(_,new f.NonRecordingSpan(b))}a(h,"eT"),s.setSpanContext=h;function v(_){var b;return(b=x(_))===null||b===void 0?void 0:b.spanContext()}a(v,"tT"),s.getSpanContext=v}),Pt=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.NoopTracer=void 0;var A=sr(),f=xe(),w=Rt(),x=pt(),g=function(){function h(){}return a(h,"e"),h.prototype.startSpan=function(v,_,b){var y=Boolean(_==null?void 0:_.root);if(y)return new w.NonRecordingSpan;var E=b&&f.getSpanContext(b);return u(E)&&x.isSpanContextValid(E)?new w.NonRecordingSpan(E):new w.NonRecordingSpan},h.prototype.startActiveSpan=function(v,_,b,y){var E,C,T;if(!(arguments.length<2)){arguments.length===2?T=_:arguments.length===3?(E=_,T=b):(E=_,C=b,T=y);var R=C!=null?C:A.context.active(),D=this.startSpan(v,E,R),k=f.setSpan(R,D);return A.context.with(k,T,void 0,D)}},h}();s.NoopTracer=g;function u(h){return typeof h=="object"&&typeof h.spanId=="string"&&typeof h.traceId=="string"&&typeof h.traceFlags=="number"}a(u,"iT")}),ut=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.ProxyTracer=void 0;var A=Pt(),f=function(){function w(x,g,u){this._provider=x,this.name=g,this.version=u}return a(w,"e"),w.prototype.startSpan=function(x,g,u){return this._getTracer().startSpan(x,g,u)},w.prototype.startActiveSpan=function(x,g,u,h){var v=this._getTracer();return Reflect.apply(v.startActiveSpan,v,arguments)},w.prototype._getTracer=function(){if(this._delegate)return this._delegate;var x=this._provider.getDelegateTracer(this.name,this.version);return x?(this._delegate=x,this._delegate):new A.NoopTracer},w}();s.ProxyTracer=f}),It=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.NoopTracerProvider=void 0;var A=Pt(),f=function(){function w(){}return a(w,"e"),w.prototype.getTracer=function(x,g){return new A.NoopTracer},w}();s.NoopTracerProvider=f}),Be=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.ProxyTracerProvider=void 0;var A=ut(),f=It(),w=new f.NoopTracerProvider,x=function(){function g(){}return a(g,"e"),g.prototype.getTracer=function(u,h){var v;return(v=this.getDelegateTracer(u,h))!==null&&v!==void 0?v:new A.ProxyTracer(this,u,h)},g.prototype.getDelegate=function(){var u;return(u=this._delegate)!==null&&u!==void 0?u:w},g.prototype.setDelegate=function(u){this._delegate=u},g.prototype.getDelegateTracer=function(u,h){var v;return(v=this._delegate)===null||v===void 0?void 0:v.getTracer(u,h)},g}();s.ProxyTracerProvider=x}),Me=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),vt=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.SamplingDecision=void 0;var A;(function(f){f[f.NOT_RECORD=0]="NOT_RECORD",f[f.RECORD=1]="RECORD",f[f.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(A=s.SamplingDecision||(s.SamplingDecision={}))}),Ct=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Ut=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.SpanKind=void 0;var A;(function(f){f[f.INTERNAL=0]="INTERNAL",f[f.SERVER=1]="SERVER",f[f.CLIENT=2]="CLIENT",f[f.PRODUCER=3]="PRODUCER",f[f.CONSUMER=4]="CONSUMER"})(A=s.SpanKind||(s.SpanKind={}))}),wr=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Wt=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),ur=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.SpanStatusCode=void 0;var A;(function(f){f[f.UNSET=0]="UNSET",f[f.OK=1]="OK",f[f.ERROR=2]="ERROR"})(A=s.SpanStatusCode||(s.SpanStatusCode={}))}),Ur=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),nn=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),kr=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),yt=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),et=$(s=>{"use strict";var A=s&&s.__spreadArray||function(x,g){for(var u=0,h=g.length,v=x.length;u<h;u++,v++)x[v]=g[u];return x};Object.defineProperty(s,"__esModule",{value:!0}),s.NoopContextManager=void 0;var f=Ne(),w=function(){function x(){}return a(x,"e"),x.prototype.active=function(){return f.ROOT_CONTEXT},x.prototype.with=function(g,u,h){for(var v=[],_=3;_<arguments.length;_++)v[_-3]=arguments[_];return u.call.apply(u,A([h],v))},x.prototype.bind=function(g,u){return u},x.prototype.enable=function(){return this},x.prototype.disable=function(){return this},x}();s.NoopContextManager=w}),Pi=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s._globalThis=void 0,s._globalThis=typeof globalThis=="object"?globalThis:global}),st=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(Pi(),s)}),Nt=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(st(),s)}),nt=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.VERSION=void 0,s.VERSION="1.0.1"}),ft=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.isCompatible=s._makeCompatibilityCheck=void 0;var A=nt(),f=/^(\d+)\.(\d+)\.(\d+)(?:-(.*))?$/;function w(x){var g=new Set([x]),u=new Set,h=x.match(f);if(!h)return function(){return!1};var v={major:+h[1],minor:+h[2],patch:+h[3]};function _(y){return u.add(y),!1}a(_,"a");function b(y){return g.add(y),!0}return a(b,"s"),function(y){if(g.has(y))return!0;if(u.has(y))return!1;var E=y.match(f);if(!E)return _(y);var C={major:+E[1],minor:+E[2],patch:+E[3]};return v.major!==C.major?_(y):v.major===0?v.minor===C.minor&&v.patch<=C.patch?b(y):_(y):v.minor<=C.minor?b(y):_(y)}}a(w,"Lp"),s._makeCompatibilityCheck=w,s.isCompatible=w(A.VERSION)}),Zt=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.unregisterGlobal=s.getGlobal=s.registerGlobal=void 0;var A=Nt(),f=nt(),w=ft(),x=f.VERSION.split(".")[0],g=Symbol.for("opentelemetry.js.api."+x),u=A._globalThis;function h(b,y,E,C){var T;C===void 0&&(C=!1);var R=u[g]=(T=u[g])!==null&&T!==void 0?T:{version:f.VERSION};if(!C&&R[b]){var D=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+b);return E.error(D.stack||D.message),!1}if(R.version!==f.VERSION){var D=new Error("@opentelemetry/api: All API registration versions must match");return E.error(D.stack||D.message),!1}return R[b]=y,E.debug("@opentelemetry/api: Registered a global for "+b+" v"+f.VERSION+"."),!0}a(h,"OT"),s.registerGlobal=h;function v(b){var y,E,C=(y=u[g])===null||y===void 0?void 0:y.version;if(!(!C||!w.isCompatible(C)))return(E=u[g])===null||E===void 0?void 0:E[b]}a(v,"PT"),s.getGlobal=v;function _(b,y){y.debug("@opentelemetry/api: Unregistering a global for "+b+" v"+f.VERSION+".");var E=u[g];E&&delete E[b]}a(_,"RT"),s.unregisterGlobal=_}),er=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.DiagComponentLogger=void 0;var A=Zt(),f=function(){function x(g){this._namespace=g.namespace||"DiagComponentLogger"}return a(x,"e"),x.prototype.debug=function(){for(var g=[],u=0;u<arguments.length;u++)g[u]=arguments[u];return w("debug",this._namespace,g)},x.prototype.error=function(){for(var g=[],u=0;u<arguments.length;u++)g[u]=arguments[u];return w("error",this._namespace,g)},x.prototype.info=function(){for(var g=[],u=0;u<arguments.length;u++)g[u]=arguments[u];return w("info",this._namespace,g)},x.prototype.warn=function(){for(var g=[],u=0;u<arguments.length;u++)g[u]=arguments[u];return w("warn",this._namespace,g)},x.prototype.verbose=function(){for(var g=[],u=0;u<arguments.length;u++)g[u]=arguments[u];return w("verbose",this._namespace,g)},x}();s.DiagComponentLogger=f;function w(x,g,u){var h=A.getGlobal("diag");if(h)return u.unshift(g),h[x].apply(h,u)}a(w,"ei")}),Jt=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.createLogLevelDiagLogger=void 0;var A=Je();function f(w,x){w<A.DiagLogLevel.NONE?w=A.DiagLogLevel.NONE:w>A.DiagLogLevel.ALL&&(w=A.DiagLogLevel.ALL),x=x||{};function g(u,h){var v=x[u];return typeof v=="function"&&w>=h?v.bind(x):function(){}}return a(g,"r"),{error:g("error",A.DiagLogLevel.ERROR),warn:g("warn",A.DiagLogLevel.WARN),info:g("info",A.DiagLogLevel.INFO),debug:g("debug",A.DiagLogLevel.DEBUG),verbose:g("verbose",A.DiagLogLevel.VERBOSE)}}a(f,"wT"),s.createLogLevelDiagLogger=f}),yn=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.DiagAPI=void 0;var A=er(),f=Jt(),w=Je(),x=Zt(),g="diag",u=function(){function h(){function v(b){return function(){var y=x.getGlobal("diag");if(y)return y[b].apply(y,arguments)}}a(v,"t");var _=this;_.setLogger=function(b,y){var E,C;if(y===void 0&&(y=w.DiagLogLevel.INFO),b===_){var T=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return _.error((E=T.stack)!==null&&E!==void 0?E:T.message),!1}var R=x.getGlobal("diag"),D=f.createLogLevelDiagLogger(y,b);if(R){var k=(C=new Error().stack)!==null&&C!==void 0?C:"<failed to generate stacktrace>";R.warn("Current logger will be overwritten from "+k),D.warn("Current logger will overwrite one already registered from "+k)}return x.registerGlobal("diag",D,_,!0)},_.disable=function(){x.unregisterGlobal(g,_)},_.createComponentLogger=function(b){return new A.DiagComponentLogger(b)},_.verbose=v("verbose"),_.debug=v("debug"),_.info=v("info"),_.warn=v("warn"),_.error=v("error")}return a(h,"e"),h.instance=function(){return this._instance||(this._instance=new h),this._instance},h}();s.DiagAPI=u}),pi=$(s=>{"use strict";var A=s&&s.__spreadArray||function(v,_){for(var b=0,y=_.length,E=v.length;b<y;b++,E++)v[E]=_[b];return v};Object.defineProperty(s,"__esModule",{value:!0}),s.ContextAPI=void 0;var f=et(),w=Zt(),x=yn(),g="context",u=new f.NoopContextManager,h=function(){function v(){}return a(v,"e"),v.getInstance=function(){return this._instance||(this._instance=new v),this._instance},v.prototype.setGlobalContextManager=function(_){return w.registerGlobal(g,_,x.DiagAPI.instance())},v.prototype.active=function(){return this._getContextManager().active()},v.prototype.with=function(_,b,y){for(var E,C=[],T=3;T<arguments.length;T++)C[T-3]=arguments[T];return(E=this._getContextManager()).with.apply(E,A([_,b,y],C))},v.prototype.bind=function(_,b){return this._getContextManager().bind(_,b)},v.prototype._getContextManager=function(){return w.getGlobal(g)||u},v.prototype.disable=function(){this._getContextManager().disable(),w.unregisterGlobal(g,x.DiagAPI.instance())},v}();s.ContextAPI=h}),on=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.TraceAPI=void 0;var A=Zt(),f=Be(),w=pt(),x=xe(),g=yn(),u="trace",h=function(){function v(){this._proxyTracerProvider=new f.ProxyTracerProvider,this.wrapSpanContext=w.wrapSpanContext,this.isSpanContextValid=w.isSpanContextValid,this.deleteSpan=x.deleteSpan,this.getSpan=x.getSpan,this.getSpanContext=x.getSpanContext,this.setSpan=x.setSpan,this.setSpanContext=x.setSpanContext}return a(v,"e"),v.getInstance=function(){return this._instance||(this._instance=new v),this._instance},v.prototype.setGlobalTracerProvider=function(_){return this._proxyTracerProvider.setDelegate(_),A.registerGlobal(u,this._proxyTracerProvider,g.DiagAPI.instance())},v.prototype.getTracerProvider=function(){return A.getGlobal(u)||this._proxyTracerProvider},v.prototype.getTracer=function(_,b){return this.getTracerProvider().getTracer(_,b)},v.prototype.disable=function(){A.unregisterGlobal(u,g.DiagAPI.instance()),this._proxyTracerProvider=new f.ProxyTracerProvider},v}();s.TraceAPI=h}),za=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.NoopTextMapPropagator=void 0;var A=function(){function f(){}return a(f,"e"),f.prototype.inject=function(w,x){},f.prototype.extract=function(w,x){return w},f.prototype.fields=function(){return[]},f}();s.NoopTextMapPropagator=A}),Wa=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.deleteBaggage=s.setBaggage=s.getBaggage=void 0;var A=Ne(),f=A.createContextKey("OpenTelemetry Baggage Key");function w(u){return u.getValue(f)||void 0}a(w,"$T"),s.getBaggage=w;function x(u,h){return u.setValue(f,h)}a(x,"zT"),s.setBaggage=x;function g(u){return u.deleteValue(f)}a(g,"KT"),s.deleteBaggage=g}),ro=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.PropagationAPI=void 0;var A=Zt(),f=za(),w=Ue(),x=Wa(),g=de(),u=yn(),h="propagation",v=new f.NoopTextMapPropagator,_=function(){function b(){this.createBaggage=g.createBaggage,this.getBaggage=x.getBaggage,this.setBaggage=x.setBaggage,this.deleteBaggage=x.deleteBaggage}return a(b,"e"),b.getInstance=function(){return this._instance||(this._instance=new b),this._instance},b.prototype.setGlobalPropagator=function(y){return A.registerGlobal(h,y,u.DiagAPI.instance())},b.prototype.inject=function(y,E,C){return C===void 0&&(C=w.defaultTextMapSetter),this._getGlobalPropagator().inject(y,E,C)},b.prototype.extract=function(y,E,C){return C===void 0&&(C=w.defaultTextMapGetter),this._getGlobalPropagator().extract(y,E,C)},b.prototype.fields=function(){return this._getGlobalPropagator().fields()},b.prototype.disable=function(){A.unregisterGlobal(h,u.DiagAPI.instance())},b.prototype._getGlobalPropagator=function(){return A.getGlobal(h)||v},b}();s.PropagationAPI=_}),sr=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(_,b,y,E){E===void 0&&(E=y),Object.defineProperty(_,E,{enumerable:!0,get:function(){return b[y]}})}:function(_,b,y,E){E===void 0&&(E=y),_[E]=b[y]}),f=s&&s.__exportStar||function(_,b){for(var y in _)y!=="default"&&!Object.prototype.hasOwnProperty.call(b,y)&&A(b,_,y)};Object.defineProperty(s,"__esModule",{value:!0}),s.diag=s.propagation=s.trace=s.context=s.isValidSpanId=s.isValidTraceId=s.isSpanContextValid=s.INVALID_SPAN_CONTEXT=s.INVALID_TRACEID=s.INVALID_SPANID=s.baggageEntryMetadataFromString=void 0,f(te(),s);var w=de();Object.defineProperty(s,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return w.baggageEntryMetadataFromString}}),f(Ce(),s),f(Fe(),s),f(ye(),s),f(Ue(),s),f(Xe(),s),f(Ke(),s),f(ut(),s),f(Be(),s),f(Me(),s),f(vt(),s),f(Ct(),s),f(Ut(),s),f(wr(),s),f(Wt(),s),f(ur(),s),f(De(),s),f(Ur(),s),f(nn(),s),f(kr(),s);var x=pt();Object.defineProperty(s,"INVALID_SPANID",{enumerable:!0,get:function(){return x.INVALID_SPANID}}),Object.defineProperty(s,"INVALID_TRACEID",{enumerable:!0,get:function(){return x.INVALID_TRACEID}}),Object.defineProperty(s,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return x.INVALID_SPAN_CONTEXT}}),Object.defineProperty(s,"isSpanContextValid",{enumerable:!0,get:function(){return x.isSpanContextValid}}),Object.defineProperty(s,"isValidTraceId",{enumerable:!0,get:function(){return x.isValidTraceId}}),Object.defineProperty(s,"isValidSpanId",{enumerable:!0,get:function(){return x.isValidSpanId}}),f(Ne(),s),f(yt(),s);var g=pi();s.context=g.ContextAPI.getInstance();var u=on();s.trace=u.TraceAPI.getInstance();var h=ro();s.propagation=h.PropagationAPI.getInstance();var v=yn();s.diag=v.DiagAPI.instance(),s.default={trace:s.trace,context:s.context,propagation:s.propagation,diag:s.diag}}),Di=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.isTracingSuppressed=s.unsuppressTracing=s.suppressTracing=void 0;var A=sr(),f=A.createContextKey("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function w(u){return u.setValue(f,!0)}a(w,"aS"),s.suppressTracing=w;function x(u){return u.deleteValue(f)}a(x,"sS"),s.unsuppressTracing=x;function g(u){return u.getValue(f)===!0}a(g,"oS"),s.isTracingSuppressed=g}),na=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.BAGGAGE_MAX_TOTAL_LENGTH=s.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS=s.BAGGAGE_MAX_NAME_VALUE_PAIRS=s.BAGGAGE_HEADER=s.BAGGAGE_ITEMS_SEPARATOR=s.BAGGAGE_PROPERTIES_SEPARATOR=s.BAGGAGE_KEY_PAIR_SEPARATOR=void 0,s.BAGGAGE_KEY_PAIR_SEPARATOR="=",s.BAGGAGE_PROPERTIES_SEPARATOR=";",s.BAGGAGE_ITEMS_SEPARATOR=",",s.BAGGAGE_HEADER="baggage",s.BAGGAGE_MAX_NAME_VALUE_PAIRS=180,s.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS=4096,s.BAGGAGE_MAX_TOTAL_LENGTH=8192}),ia=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.parseKeyPairsIntoRecord=s.parsePairKeyValue=s.getKeyPairs=s.serializeKeyPairs=void 0;var A=sr(),f=na(),w=a(h=>h.reduce((v,_)=>{let b=`${v}${v!==""?f.BAGGAGE_ITEMS_SEPARATOR:""}${_}`;return b.length>f.BAGGAGE_MAX_TOTAL_LENGTH?v:b},""),"cS");s.serializeKeyPairs=w;var x=a(h=>h.getAllEntries().map(([v,_])=>`${encodeURIComponent(v)}=${encodeURIComponent(_.value)}`),"lS");s.getKeyPairs=x;var g=a(h=>{let v=h.split(f.BAGGAGE_PROPERTIES_SEPARATOR);if(v.length<=0)return;let _=v.shift();if(!_)return;let b=_.split(f.BAGGAGE_KEY_PAIR_SEPARATOR);if(b.length!==2)return;let y=decodeURIComponent(b[0].trim()),E=decodeURIComponent(b[1].trim()),C;return v.length>0&&(C=A.baggageEntryMetadataFromString(v.join(f.BAGGAGE_PROPERTIES_SEPARATOR))),{key:y,value:E,metadata:C}},"pS");s.parsePairKeyValue=g;var u=a(h=>typeof h!="string"||h.length===0?{}:h.split(f.BAGGAGE_ITEMS_SEPARATOR).map(v=>s.parsePairKeyValue(v)).filter(v=>v!==void 0&&v.value.length>0).reduce((v,_)=>(v[_.key]=_.value,v),{}),"fS");s.parseKeyPairsIntoRecord=u}),Qs=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.HttpBaggagePropagator=void 0;var A=sr(),f=Di(),w=na(),x=ia(),g=a(class{inject(u,h,v){let _=A.propagation.getBaggage(u);if(!_||f.isTracingSuppressed(u))return;let b=x.getKeyPairs(_).filter(E=>E.length<=w.BAGGAGE_MAX_PER_NAME_VALUE_PAIRS).slice(0,w.BAGGAGE_MAX_NAME_VALUE_PAIRS),y=x.serializeKeyPairs(b);y.length>0&&v.set(h,w.BAGGAGE_HEADER,y)}extract(u,h,v){let _=v.get(h,w.BAGGAGE_HEADER);if(!_)return u;let b={};return _.length===0||(_.split(w.BAGGAGE_ITEMS_SEPARATOR).forEach(y=>{let E=x.parsePairKeyValue(y);if(E){let C={value:E.value};E.metadata&&(C.metadata=E.metadata),b[E.key]=C}}),Object.entries(b).length===0)?u:A.propagation.setBaggage(u,A.propagation.createBaggage(b))}fields(){return[w.BAGGAGE_HEADER]}},"Qp");s.HttpBaggagePropagator=g}),Lr=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.isAttributeValue=s.sanitizeAttributes=void 0;function A(g){let u={};if(g==null||typeof g!="object")return u;for(let[h,v]of Object.entries(g))f(v)&&(Array.isArray(v)?u[h]=v.slice():u[h]=v);return u}a(A,"hS"),s.sanitizeAttributes=A;function f(g){return g==null?!0:Array.isArray(g)?w(g):x(g)}a(f,"Zp"),s.isAttributeValue=f;function w(g){let u;for(let h of g)if(h!=null){if(!u){if(x(h)){u=typeof h;continue}return!1}if(typeof h!==u)return!1}return!0}a(w,"_S");function x(g){switch(typeof g){case"number":return!0;case"boolean":return!0;case"string":return!0}return!1}a(x,"Jp")}),gi=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.loggingErrorHandler=void 0;var A=sr();function f(){return g=>{A.diag.error(w(g))}}a(f,"vS"),s.loggingErrorHandler=f;function w(g){return typeof g=="string"?g:JSON.stringify(x(g))}a(w,"mS");function x(g){let u={},h=g;for(;h!==null;)Object.getOwnPropertyNames(h).forEach(v=>{if(u[v])return;let _=h[v];_&&(u[v]=String(_))}),h=Object.getPrototypeOf(h);return u}a(x,"ES")}),So=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.globalErrorHandler=s.setGlobalErrorHandler=void 0;var A=gi(),f=A.loggingErrorHandler();function w(g){f=g}a(w,"TS"),s.setGlobalErrorHandler=w;var x=a(g=>{try{f(g)}catch(u){}},"SS");s.globalErrorHandler=x}),Ga=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.TracesSamplerValues=void 0;var A;(function(f){f.AlwaysOff="always_off",f.AlwaysOn="always_on",f.ParentBasedAlwaysOff="parentbased_always_off",f.ParentBasedAlwaysOn="parentbased_always_on",f.ParentBasedTraceIdRatio="parentbased_traceidratio",f.TraceIdRatio="traceidratio"})(A=s.TracesSamplerValues||(s.TracesSamplerValues={}))}),An=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.parseEnvironment=s.DEFAULT_ENVIRONMENT=void 0;var A=sr(),f=Ga(),w=",",x=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT"];function g(C){return x.indexOf(C)>-1}a(g,"OS");var u=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];function h(C){return u.indexOf(C)>-1}a(h,"RS"),s.DEFAULT_ENVIRONMENT={CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:A.DiagLogLevel.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:128,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_TRACES_EXPORTER:"none",OTEL_TRACES_SAMPLER:f.TracesSamplerValues.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:""};function v(C,T,R,D=-1/0,k=1/0){if(typeof R[C]!="undefined"){let G=Number(R[C]);isNaN(G)||(G<D?T[C]=D:G>k?T[C]=k:T[C]=G)}}a(v,"NS");function _(C,T,R,D=w){let k=R[C];typeof k=="string"&&(T[C]=k.split(D).map(G=>G.trim()))}a(_,"DS");var b={ALL:A.DiagLogLevel.ALL,VERBOSE:A.DiagLogLevel.VERBOSE,DEBUG:A.DiagLogLevel.DEBUG,INFO:A.DiagLogLevel.INFO,WARN:A.DiagLogLevel.WARN,ERROR:A.DiagLogLevel.ERROR,NONE:A.DiagLogLevel.NONE};function y(C,T,R){let D=R[C];if(typeof D=="string"){let k=b[D.toUpperCase()];k!=null&&(T[C]=k)}}a(y,"MS");function E(C){let T={};for(let R in s.DEFAULT_ENVIRONMENT){let D=R;switch(D){case"OTEL_LOG_LEVEL":y(D,T,C);break;default:if(g(D))v(D,T,C);else if(h(D))_(D,T,C);else{let k=C[D];typeof k!="undefined"&&k!==null&&(T[D]=String(k))}}}return T}a(E,"xS"),s.parseEnvironment=E}),lt=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.getEnv=void 0;var A=K(2037),f=An();function w(){let x=f.parseEnvironment(process.env);return Object.assign({HOSTNAME:A.hostname()},f.DEFAULT_ENVIRONMENT,x)}a(w,"qS"),s.getEnv=w}),ki=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.hexToBase64=void 0;function A(f){let w=f.length,x="";for(let g=0;g<w;g+=2){let u=f.substring(g,g+2),h=parseInt(u,16);x+=String.fromCharCode(h)}return Buffer.from(x,"ascii").toString("base64")}a(A,"kS"),s.hexToBase64=A}),no=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.RandomIdGenerator=void 0;var A=8,f=16,w=a(class{constructor(){this.generateTraceId=g(f),this.generateSpanId=g(A)}},"of");s.RandomIdGenerator=w;var x=Buffer.allocUnsafe(f);function g(u){return function(){for(let h=0;h<u/4;h++)x.writeUInt32BE(Math.random()*2**32>>>0,h*4);for(let h=0;h<u&&!(x[h]>0);h++)h===u-1&&(x[u-1]=1);return x.toString("hex",0,u)}}a(g,"uf")}),Eo=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.otperformance=void 0;var A=K(4074);s.otperformance=A.performance}),Ni=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.VERSION=void 0,s.VERSION="0.23.0"}),Ys=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.RpcGrpcStatusCodeValues=s.MessagingOperationValues=s.MessagingDestinationKindValues=s.HttpFlavorValues=s.NetTransportValues=s.FaasInvokedProviderValues=s.FaasDocumentOperationValues=s.FaasTriggerValues=s.DbCassandraConsistencyLevelValues=s.DbSystemValues=s.SemanticAttributes=void 0,s.SemanticAttributes={DB_SYSTEM:"db.system",DB_CONNECTION_STRING:"db.connection_string",DB_USER:"db.user",DB_JDBC_DRIVER_CLASSNAME:"db.jdbc.driver_classname",DB_NAME:"db.name",DB_STATEMENT:"db.statement",DB_OPERATION:"db.operation",DB_MSSQL_INSTANCE_NAME:"db.mssql.instance_name",DB_CASSANDRA_KEYSPACE:"db.cassandra.keyspace",DB_CASSANDRA_PAGE_SIZE:"db.cassandra.page_size",DB_CASSANDRA_CONSISTENCY_LEVEL:"db.cassandra.consistency_level",DB_CASSANDRA_TABLE:"db.cassandra.table",DB_CASSANDRA_IDEMPOTENCE:"db.cassandra.idempotence",DB_CASSANDRA_SPECULATIVE_EXECUTION_COUNT:"db.cassandra.speculative_execution_count",DB_CASSANDRA_COORDINATOR_ID:"db.cassandra.coordinator.id",DB_CASSANDRA_COORDINATOR_DC:"db.cassandra.coordinator.dc",DB_HBASE_NAMESPACE:"db.hbase.namespace",DB_REDIS_DATABASE_INDEX:"db.redis.database_index",DB_MONGODB_COLLECTION:"db.mongodb.collection",DB_SQL_TABLE:"db.sql.table",EXCEPTION_TYPE:"exception.type",EXCEPTION_MESSAGE:"exception.message",EXCEPTION_STACKTRACE:"exception.stacktrace",EXCEPTION_ESCAPED:"exception.escaped",FAAS_TRIGGER:"faas.trigger",FAAS_EXECUTION:"faas.execution",FAAS_DOCUMENT_COLLECTION:"faas.document.collection",FAAS_DOCUMENT_OPERATION:"faas.document.operation",FAAS_DOCUMENT_TIME:"faas.document.time",FAAS_DOCUMENT_NAME:"faas.document.name",FAAS_TIME:"faas.time",FAAS_CRON:"faas.cron",FAAS_COLDSTART:"faas.coldstart",FAAS_INVOKED_NAME:"faas.invoked_name",FAAS_INVOKED_PROVIDER:"faas.invoked_provider",FAAS_INVOKED_REGION:"faas.invoked_region",NET_TRANSPORT:"net.transport",NET_PEER_IP:"net.peer.ip",NET_PEER_PORT:"net.peer.port",NET_PEER_NAME:"net.peer.name",NET_HOST_IP:"net.host.ip",NET_HOST_PORT:"net.host.port",NET_HOST_NAME:"net.host.name",PEER_SERVICE:"peer.service",ENDUSER_ID:"enduser.id",ENDUSER_ROLE:"enduser.role",ENDUSER_SCOPE:"enduser.scope",THREAD_ID:"thread.id",THREAD_NAME:"thread.name",CODE_FUNCTION:"code.function",CODE_NAMESPACE:"code.namespace",CODE_FILEPATH:"code.filepath",CODE_LINENO:"code.lineno",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_TARGET:"http.target",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_STATUS_CODE:"http.status_code",HTTP_FLAVOR:"http.flavor",HTTP_USER_AGENT:"http.user_agent",HTTP_REQUEST_CONTENT_LENGTH:"http.request_content_length",HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED:"http.request_content_length_uncompressed",HTTP_RESPONSE_CONTENT_LENGTH:"http.response_content_length",HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED:"http.response_content_length_uncompressed",HTTP_SERVER_NAME:"http.server_name",HTTP_ROUTE:"http.route",HTTP_CLIENT_IP:"http.client_ip",AWS_DYNAMODB_TABLE_NAMES:"aws.dynamodb.table_names",AWS_DYNAMODB_CONSUMED_CAPACITY:"aws.dynamodb.consumed_capacity",AWS_DYNAMODB_ITEM_COLLECTION_METRICS:"aws.dynamodb.item_collection_metrics",AWS_DYNAMODB_PROVISIONED_READ_CAPACITY:"aws.dynamodb.provisioned_read_capacity",AWS_DYNAMODB_PROVISIONED_WRITE_CAPACITY:"aws.dynamodb.provisioned_write_capacity",AWS_DYNAMODB_CONSISTENT_READ:"aws.dynamodb.consistent_read",AWS_DYNAMODB_PROJECTION:"aws.dynamodb.projection",AWS_DYNAMODB_LIMIT:"aws.dynamodb.limit",AWS_DYNAMODB_ATTRIBUTES_TO_GET:"aws.dynamodb.attributes_to_get",AWS_DYNAMODB_INDEX_NAME:"aws.dynamodb.index_name",AWS_DYNAMODB_SELECT:"aws.dynamodb.select",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEXES:"aws.dynamodb.global_secondary_indexes",AWS_DYNAMODB_LOCAL_SECONDARY_INDEXES:"aws.dynamodb.local_secondary_indexes",AWS_DYNAMODB_EXCLUSIVE_START_TABLE:"aws.dynamodb.exclusive_start_table",AWS_DYNAMODB_TABLE_COUNT:"aws.dynamodb.table_count",AWS_DYNAMODB_SCAN_FORWARD:"aws.dynamodb.scan_forward",AWS_DYNAMODB_SEGMENT:"aws.dynamodb.segment",AWS_DYNAMODB_TOTAL_SEGMENTS:"aws.dynamodb.total_segments",AWS_DYNAMODB_COUNT:"aws.dynamodb.count",AWS_DYNAMODB_SCANNED_COUNT:"aws.dynamodb.scanned_count",AWS_DYNAMODB_ATTRIBUTE_DEFINITIONS:"aws.dynamodb.attribute_definitions",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEX_UPDATES:"aws.dynamodb.global_secondary_index_updates",MESSAGING_SYSTEM:"messaging.system",MESSAGING_DESTINATION:"messaging.destination",MESSAGING_DESTINATION_KIND:"messaging.destination_kind",MESSAGING_TEMP_DESTINATION:"messaging.temp_destination",MESSAGING_PROTOCOL:"messaging.protocol",MESSAGING_PROTOCOL_VERSION:"messaging.protocol_version",MESSAGING_URL:"messaging.url",MESSAGING_MESSAGE_ID:"messaging.message_id",MESSAGING_CONVERSATION_ID:"messaging.conversation_id",MESSAGING_MESSAGE_PAYLOAD_SIZE_BYTES:"messaging.message_payload_size_bytes",MESSAGING_MESSAGE_PAYLOAD_COMPRESSED_SIZE_BYTES:"messaging.message_payload_compressed_size_bytes",MESSAGING_OPERATION:"messaging.operation",MESSAGING_RABBITMQ_ROUTING_KEY:"messaging.rabbitmq.routing_key",MESSAGING_KAFKA_MESSAGE_KEY:"messaging.kafka.message_key",MESSAGING_KAFKA_CONSUMER_GROUP:"messaging.kafka.consumer_group",MESSAGING_KAFKA_CLIENT_ID:"messaging.kafka.client_id",MESSAGING_KAFKA_PARTITION:"messaging.kafka.partition",MESSAGING_KAFKA_TOMBSTONE:"messaging.kafka.tombstone",RPC_SYSTEM:"rpc.system",RPC_SERVICE:"rpc.service",RPC_METHOD:"rpc.method",RPC_GRPC_STATUS_CODE:"rpc.grpc.status_code",RPC_JSONRPC_VERSION:"rpc.jsonrpc.version",RPC_JSONRPC_METHOD:"rpc.jsonrpc.method",RPC_JSONRPC_REQUEST_ID:"rpc.jsonrpc.request_id",RPC_JSONRPC_ERROR_CODE:"rpc.jsonrpc.error_code",RPC_JSONRPC_ERROR_MESSAGE:"rpc.jsonrpc.error_message"};var A;(function(y){y.OTHER_SQL="other_sql",y.MSSQL="mssql",y.MYSQL="mysql",y.ORACLE="oracle",y.DB2="db2",y.POSTGRESQL="postgresql",y.REDSHIFT="redshift",y.HIVE="hive",y.CLOUDSCAPE="cloudscape",y.HSQLDB="hsqldb",y.PROGRESS="progress",y.MAXDB="maxdb",y.HANADB="hanadb",y.INGRES="ingres",y.FIRSTSQL="firstsql",y.EDB="edb",y.CACHE="cache",y.ADABAS="adabas",y.FIREBIRD="firebird",y.DERBY="derby",y.FILEMAKER="filemaker",y.INFORMIX="informix",y.INSTANTDB="instantdb",y.INTERBASE="interbase",y.MARIADB="mariadb",y.NETEZZA="netezza",y.PERVASIVE="pervasive",y.POINTBASE="pointbase",y.SQLITE="sqlite",y.SYBASE="sybase",y.TERADATA="teradata",y.VERTICA="vertica",y.H2="h2",y.COLDFUSION="coldfusion",y.CASSANDRA="cassandra",y.HBASE="hbase",y.MONGODB="mongodb",y.REDIS="redis",y.COUCHBASE="couchbase",y.COUCHDB="couchdb",y.COSMOSDB="cosmosdb",y.DYNAMODB="dynamodb",y.NEO4J="neo4j",y.GEODE="geode",y.ELASTICSEARCH="elasticsearch",y.MEMCACHED="memcached",y.COCKROACHDB="cockroachdb"})(A=s.DbSystemValues||(s.DbSystemValues={}));var f;(function(y){y.ALL="all",y.EACH_QUORUM="each_quorum",y.QUORUM="quorum",y.LOCAL_QUORUM="local_quorum",y.ONE="one",y.TWO="two",y.THREE="three",y.LOCAL_ONE="local_one",y.ANY="any",y.SERIAL="serial",y.LOCAL_SERIAL="local_serial"})(f=s.DbCassandraConsistencyLevelValues||(s.DbCassandraConsistencyLevelValues={}));var w;(function(y){y.DATASOURCE="datasource",y.HTTP="http",y.PUBSUB="pubsub",y.TIMER="timer",y.OTHER="other"})(w=s.FaasTriggerValues||(s.FaasTriggerValues={}));var x;(function(y){y.INSERT="insert",y.EDIT="edit",y.DELETE="delete"})(x=s.FaasDocumentOperationValues||(s.FaasDocumentOperationValues={}));var g;(function(y){y.AWS="aws",y.AZURE="azure",y.GCP="gcp"})(g=s.FaasInvokedProviderValues||(s.FaasInvokedProviderValues={}));var u;(function(y){y.IP_TCP="ip_tcp",y.IP_UDP="ip_udp",y.IP="ip",y.UNIX="unix",y.PIPE="pipe",y.INPROC="inproc",y.OTHER="other"})(u=s.NetTransportValues||(s.NetTransportValues={}));var h;(function(y){y.HTTP_1_0="1.0",y.HTTP_1_1="1.1",y.HTTP_2_0="2.0",y.SPDY="SPDY",y.QUIC="QUIC"})(h=s.HttpFlavorValues||(s.HttpFlavorValues={}));var v;(function(y){y.QUEUE="queue",y.TOPIC="topic"})(v=s.MessagingDestinationKindValues||(s.MessagingDestinationKindValues={}));var _;(function(y){y.RECEIVE="receive",y.PROCESS="process"})(_=s.MessagingOperationValues||(s.MessagingOperationValues={}));var b;(function(y){y[y.OK=0]="OK",y[y.CANCELLED=1]="CANCELLED",y[y.UNKNOWN=2]="UNKNOWN",y[y.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",y[y.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",y[y.NOT_FOUND=5]="NOT_FOUND",y[y.ALREADY_EXISTS=6]="ALREADY_EXISTS",y[y.PERMISSION_DENIED=7]="PERMISSION_DENIED",y[y.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",y[y.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",y[y.ABORTED=10]="ABORTED",y[y.OUT_OF_RANGE=11]="OUT_OF_RANGE",y[y.UNIMPLEMENTED=12]="UNIMPLEMENTED",y[y.INTERNAL=13]="INTERNAL",y[y.UNAVAILABLE=14]="UNAVAILABLE",y[y.DATA_LOSS=15]="DATA_LOSS",y[y.UNAUTHENTICATED=16]="UNAUTHENTICATED"})(b=s.RpcGrpcStatusCodeValues||(s.RpcGrpcStatusCodeValues={}))}),Zs=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(Ys(),s)}),Js=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.TelemetrySdkLanguageValues=s.OsTypeValues=s.HostArchValues=s.AwsEcsLaunchtypeValues=s.CloudPlatformValues=s.CloudProviderValues=s.ResourceAttributes=void 0,s.ResourceAttributes={CLOUD_PROVIDER:"cloud.provider",CLOUD_ACCOUNT_ID:"cloud.account.id",CLOUD_REGION:"cloud.region",CLOUD_AVAILABILITY_ZONE:"cloud.availability_zone",CLOUD_PLATFORM:"cloud.platform",AWS_ECS_CONTAINER_ARN:"aws.ecs.container.arn",AWS_ECS_CLUSTER_ARN:"aws.ecs.cluster.arn",AWS_ECS_LAUNCHTYPE:"aws.ecs.launchtype",AWS_ECS_TASK_ARN:"aws.ecs.task.arn",AWS_ECS_TASK_FAMILY:"aws.ecs.task.family",AWS_ECS_TASK_REVISION:"aws.ecs.task.revision",AWS_EKS_CLUSTER_ARN:"aws.eks.cluster.arn",AWS_LOG_GROUP_NAMES:"aws.log.group.names",AWS_LOG_GROUP_ARNS:"aws.log.group.arns",AWS_LOG_STREAM_NAMES:"aws.log.stream.names",AWS_LOG_STREAM_ARNS:"aws.log.stream.arns",CONTAINER_NAME:"container.name",CONTAINER_ID:"container.id",CONTAINER_RUNTIME:"container.runtime",CONTAINER_IMAGE_NAME:"container.image.name",CONTAINER_IMAGE_TAG:"container.image.tag",DEPLOYMENT_ENVIRONMENT:"deployment.environment",DEVICE_ID:"device.id",DEVICE_MODEL_IDENTIFIER:"device.model.identifier",DEVICE_MODEL_NAME:"device.model.name",FAAS_NAME:"faas.name",FAAS_ID:"faas.id",FAAS_VERSION:"faas.version",FAAS_INSTANCE:"faas.instance",FAAS_MAX_MEMORY:"faas.max_memory",HOST_ID:"host.id",HOST_NAME:"host.name",HOST_TYPE:"host.type",HOST_ARCH:"host.arch",HOST_IMAGE_NAME:"host.image.name",HOST_IMAGE_ID:"host.image.id",HOST_IMAGE_VERSION:"host.image.version",K8S_CLUSTER_NAME:"k8s.cluster.name",K8S_NODE_NAME:"k8s.node.name",K8S_NODE_UID:"k8s.node.uid",K8S_NAMESPACE_NAME:"k8s.namespace.name",K8S_POD_UID:"k8s.pod.uid",K8S_POD_NAME:"k8s.pod.name",K8S_CONTAINER_NAME:"k8s.container.name",K8S_REPLICASET_UID:"k8s.replicaset.uid",K8S_REPLICASET_NAME:"k8s.replicaset.name",K8S_DEPLOYMENT_UID:"k8s.deployment.uid",K8S_DEPLOYMENT_NAME:"k8s.deployment.name",K8S_STATEFULSET_UID:"k8s.statefulset.uid",K8S_STATEFULSET_NAME:"k8s.statefulset.name",K8S_DAEMONSET_UID:"k8s.daemonset.uid",K8S_DAEMONSET_NAME:"k8s.daemonset.name",K8S_JOB_UID:"k8s.job.uid",K8S_JOB_NAME:"k8s.job.name",K8S_CRONJOB_UID:"k8s.cronjob.uid",K8S_CRONJOB_NAME:"k8s.cronjob.name",OS_TYPE:"os.type",OS_DESCRIPTION:"os.description",OS_NAME:"os.name",OS_VERSION:"os.version",PROCESS_PID:"process.pid",PROCESS_EXECUTABLE_NAME:"process.executable.name",PROCESS_EXECUTABLE_PATH:"process.executable.path",PROCESS_COMMAND:"process.command",PROCESS_COMMAND_LINE:"process.command_line",PROCESS_COMMAND_ARGS:"process.command_args",PROCESS_OWNER:"process.owner",PROCESS_RUNTIME_NAME:"process.runtime.name",PROCESS_RUNTIME_VERSION:"process.runtime.version",PROCESS_RUNTIME_DESCRIPTION:"process.runtime.description",SERVICE_NAME:"service.name",SERVICE_NAMESPACE:"service.namespace",SERVICE_INSTANCE_ID:"service.instance.id",SERVICE_VERSION:"service.version",TELEMETRY_SDK_NAME:"telemetry.sdk.name",TELEMETRY_SDK_LANGUAGE:"telemetry.sdk.language",TELEMETRY_SDK_VERSION:"telemetry.sdk.version",TELEMETRY_AUTO_VERSION:"telemetry.auto.version",WEBENGINE_NAME:"webengine.name",WEBENGINE_VERSION:"webengine.version",WEBENGINE_DESCRIPTION:"webengine.description"};var A;(function(h){h.AWS="aws",h.AZURE="azure",h.GCP="gcp"})(A=s.CloudProviderValues||(s.CloudProviderValues={}));var f;(function(h){h.AWS_EC2="aws_ec2",h.AWS_ECS="aws_ecs",h.AWS_EKS="aws_eks",h.AWS_LAMBDA="aws_lambda",h.AWS_ELASTIC_BEANSTALK="aws_elastic_beanstalk",h.AZURE_VM="azure_vm",h.AZURE_CONTAINER_INSTANCES="azure_container_instances",h.AZURE_AKS="azure_aks",h.AZURE_FUNCTIONS="azure_functions",h.AZURE_APP_SERVICE="azure_app_service",h.GCP_COMPUTE_ENGINE="gcp_compute_engine",h.GCP_CLOUD_RUN="gcp_cloud_run",h.GCP_KUBERNETES_ENGINE="gcp_kubernetes_engine",h.GCP_CLOUD_FUNCTIONS="gcp_cloud_functions",h.GCP_APP_ENGINE="gcp_app_engine"})(f=s.CloudPlatformValues||(s.CloudPlatformValues={}));var w;(function(h){h.EC2="ec2",h.FARGATE="fargate"})(w=s.AwsEcsLaunchtypeValues||(s.AwsEcsLaunchtypeValues={}));var x;(function(h){h.AMD64="amd64",h.ARM32="arm32",h.ARM64="arm64",h.IA64="ia64",h.PPC32="ppc32",h.PPC64="ppc64",h.X86="x86"})(x=s.HostArchValues||(s.HostArchValues={}));var g;(function(h){h.WINDOWS="windows",h.LINUX="linux",h.DARWIN="darwin",h.FREEBSD="freebsd",h.NETBSD="netbsd",h.OPENBSD="openbsd",h.DRAGONFLYBSD="dragonflybsd",h.HPUX="hpux",h.AIX="aix",h.SOLARIS="solaris",h.Z_OS="z_os"})(g=s.OsTypeValues||(s.OsTypeValues={}));var u;(function(h){h.CPP="cpp",h.DOTNET="dotnet",h.ERLANG="erlang",h.GO="go",h.JAVA="java",h.NODEJS="nodejs",h.PHP="php",h.PYTHON="python",h.RUBY="ruby",h.WEBJS="webjs"})(u=s.TelemetrySdkLanguageValues||(s.TelemetrySdkLanguageValues={}))}),an=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(Js(),s)}),dr=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(Zs(),s),f(an(),s)}),Xt=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.SDK_INFO=void 0;var A=Ni(),f=dr();s.SDK_INFO={[f.ResourceAttributes.TELEMETRY_SDK_NAME]:"opentelemetry",[f.ResourceAttributes.PROCESS_RUNTIME_NAME]:"node",[f.ResourceAttributes.TELEMETRY_SDK_LANGUAGE]:f.TelemetrySdkLanguageValues.NODEJS,[f.ResourceAttributes.TELEMETRY_SDK_VERSION]:A.VERSION}}),_n=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.unrefTimer=void 0;function A(f){f.unref()}a(A,"uA"),s.unrefTimer=A}),mi=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(lt(),s),f(ki(),s),f(no(),s),f(Eo(),s),f(Xt(),s),f(_n(),s)}),Va=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(mi(),s)}),ec=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.isTimeInput=s.isTimeInputHrTime=s.hrTimeToMicroseconds=s.hrTimeToMilliseconds=s.hrTimeToNanoseconds=s.hrTimeToTimeStamp=s.hrTimeDuration=s.timeInputToHrTime=s.hrTime=void 0;var A=Va(),f=9,w=Math.pow(10,f);function x(R){let D=R/1e3,k=Math.trunc(D),G=Number((D-k).toFixed(f))*w;return[k,G]}a(x,"Ma");function g(){let R=A.otperformance.timeOrigin;if(typeof R!="number"){let D=A.otperformance;R=D.timing&&D.timing.fetchStart}return R}a(g,"Ef");function u(R){let D=x(g()),k=x(typeof R=="number"?R:A.otperformance.now()),G=D[0]+k[0],Z=D[1]+k[1];return Z>w&&(Z-=w,G+=1),[G,Z]}a(u,"yf"),s.hrTime=u;function h(R){if(C(R))return R;if(typeof R=="number")return R<g()?u(R):x(R);if(R instanceof Date)return x(R.getTime());throw TypeError("Invalid input type")}a(h,"fA"),s.timeInputToHrTime=h;function v(R,D){let k=D[0]-R[0],G=D[1]-R[1];return G<0&&(k-=1,G+=w),[k,G]}a(v,"dA"),s.hrTimeDuration=v;function _(R){let D=f,k=`${"0".repeat(D)}${R[1]}Z`,G=k.substr(k.length-D-1);return new Date(R[0]*1e3).toISOString().replace("000Z",G)}a(_,"hA"),s.hrTimeToTimeStamp=_;function b(R){return R[0]*w+R[1]}a(b,"_A"),s.hrTimeToNanoseconds=b;function y(R){return Math.round(R[0]*1e3+R[1]/1e6)}a(y,"gA"),s.hrTimeToMilliseconds=y;function E(R){return Math.round(R[0]*1e6+R[1]/1e3)}a(E,"vA"),s.hrTimeToMicroseconds=E;function C(R){return Array.isArray(R)&&R.length===2&&typeof R[0]=="number"&&typeof R[1]=="number"}a(C,"nu"),s.isTimeInputHrTime=C;function T(R){return C(R)||typeof R=="number"||R instanceof Date}a(T,"mA"),s.isTimeInput=T}),dl=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Ka=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.ExportResultCode=void 0;var A;(function(f){f[f.SUCCESS=0]="SUCCESS",f[f.FAILED=1]="FAILED"})(A=s.ExportResultCode||(s.ExportResultCode={}))}),Xa=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.CompositePropagator=void 0;var A=sr(),f=a(class{constructor(w={}){var x;this._propagators=(x=w.propagators)!==null&&x!==void 0?x:[],this._fields=Array.from(new Set(this._propagators.map(g=>typeof g.fields=="function"?g.fields():[]).reduce((g,u)=>g.concat(u),[])))}inject(w,x,g){for(let u of this._propagators)try{u.inject(w,x,g)}catch(h){A.diag.warn(`Failed to inject with ${u.constructor.name}. Err: ${h.message}`)}}extract(w,x,g){return this._propagators.reduce((u,h)=>{try{return h.extract(u,x,g)}catch(v){A.diag.warn(`Failed to inject with ${h.constructor.name}. Err: ${v.message}`)}return u},w)}fields(){return this._fields.slice()}},"Cf");s.CompositePropagator=f}),Rn=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.validateValue=s.validateKey=void 0;var A="[_0-9a-z-*/]",f=`[a-z]${A}{0,255}`,w=`[a-z0-9]${A}{0,240}@[a-z]${A}{0,13}`,x=new RegExp(`^(?:${f}|${w})$`),g=/^[ -~]{0,255}[!-~]$/,u=/,|=/;function h(_){return x.test(_)}a(h,"IA"),s.validateKey=h;function v(_){return g.test(_)&&!u.test(_)}a(v,"CA"),s.validateValue=v}),io=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.TraceState=void 0;var A=Rn(),f=32,w=512,x=",",g="=",u=a(class{constructor(h){this._internalState=new Map,h&&this._parse(h)}set(h,v){let _=this._clone();return _._internalState.has(h)&&_._internalState.delete(h),_._internalState.set(h,v),_}unset(h){let v=this._clone();return v._internalState.delete(h),v}get(h){return this._internalState.get(h)}serialize(){return this._keys().reduce((h,v)=>(h.push(v+g+this.get(v)),h),[]).join(x)}_parse(h){h.length>w||(this._internalState=h.split(x).reverse().reduce((v,_)=>{let b=_.trim(),y=b.indexOf(g);if(y!==-1){let E=b.slice(0,y),C=b.slice(y+1,_.length);A.validateKey(E)&&A.validateValue(C)&&v.set(E,C)}return v},new Map),this._internalState.size>f&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,f))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let h=new u;return h._internalState=new Map(this._internalState),h}},"La");s.TraceState=u}),hl=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.HttpTraceContextPropagator=s.parseTraceParent=s.TRACE_STATE_HEADER=s.TRACE_PARENT_HEADER=void 0;var A=sr(),f=Di(),w=io();s.TRACE_PARENT_HEADER="traceparent",s.TRACE_STATE_HEADER="tracestate";var x="00",g="(?!ff)[\\da-f]{2}",u="(?![0]{32})[\\da-f]{32}",h="(?![0]{16})[\\da-f]{16}",v="[\\da-f]{2}",_=new RegExp(`^\\s?(${g})-(${u})-(${h})-(${v})(-.*)?\\s?$`);function b(E){let C=_.exec(E);return!C||C[1]==="00"&&C[5]?null:{traceId:C[2],spanId:C[3],traceFlags:parseInt(C[4],16)}}a(b,"Mf"),s.parseTraceParent=b;var y=a(class{inject(E,C,T){let R=A.trace.getSpanContext(E);if(!R||f.isTracingSuppressed(E)||!A.isSpanContextValid(R))return;let D=`${x}-${R.traceId}-${R.spanId}-0${Number(R.traceFlags||A.TraceFlags.NONE).toString(16)}`;T.set(C,s.TRACE_PARENT_HEADER,D),R.traceState&&T.set(C,s.TRACE_STATE_HEADER,R.traceState.serialize())}extract(E,C,T){let R=T.get(C,s.TRACE_PARENT_HEADER);if(!R)return E;let D=Array.isArray(R)?R[0]:R;if(typeof D!="string")return E;let k=b(D);if(!k)return E;k.isRemote=!0;let G=T.get(C,s.TRACE_STATE_HEADER);if(G){let Z=Array.isArray(G)?G.join(","):G;k.traceState=new w.TraceState(typeof Z=="string"?Z:void 0)}return A.trace.setSpanContext(E,k)}fields(){return[s.TRACE_PARENT_HEADER,s.TRACE_STATE_HEADER]}},"xf");s.HttpTraceContextPropagator=y}),fl=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),xo=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.getRPCMetadata=s.deleteRPCMetadata=s.setRPCMetadata=s.RPCType=void 0;var A=sr(),f=A.createContextKey("OpenTelemetry SDK Context Key RPC_METADATA"),w;(function(h){h.HTTP="http"})(w=s.RPCType||(s.RPCType={}));function x(h,v){return h.setValue(f,v)}a(x,"jA"),s.setRPCMetadata=x;function g(h){return h.deleteValue(f)}a(g,"HA"),s.deleteRPCMetadata=g;function u(h){return h.getValue(f)}a(u,"UA"),s.getRPCMetadata=u}),Qa=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.AlwaysOffSampler=void 0;var A=sr(),f=a(class{shouldSample(){return{decision:A.SamplingDecision.NOT_RECORD}}toString(){return"AlwaysOffSampler"}},"Hf");s.AlwaysOffSampler=f}),vi=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.AlwaysOnSampler=void 0;var A=sr(),f=a(class{shouldSample(){return{decision:A.SamplingDecision.RECORD_AND_SAMPLED}}toString(){return"AlwaysOnSampler"}},"Uf");s.AlwaysOnSampler=f}),Ya=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.ParentBasedSampler=void 0;var A=sr(),f=So(),w=Qa(),x=vi(),g=a(class{constructor(u){var h,v,_,b;this._root=u.root,this._root||(f.globalErrorHandler(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new x.AlwaysOnSampler),this._remoteParentSampled=(h=u.remoteParentSampled)!==null&&h!==void 0?h:new x.AlwaysOnSampler,this._remoteParentNotSampled=(v=u.remoteParentNotSampled)!==null&&v!==void 0?v:new w.AlwaysOffSampler,this._localParentSampled=(_=u.localParentSampled)!==null&&_!==void 0?_:new x.AlwaysOnSampler,this._localParentNotSampled=(b=u.localParentNotSampled)!==null&&b!==void 0?b:new w.AlwaysOffSampler}shouldSample(u,h,v,_,b,y){let E=A.trace.getSpanContext(u);return!E||!A.isSpanContextValid(E)?this._root.shouldSample(u,h,v,_,b,y):E.isRemote?E.traceFlags&A.TraceFlags.SAMPLED?this._remoteParentSampled.shouldSample(u,h,v,_,b,y):this._remoteParentNotSampled.shouldSample(u,h,v,_,b,y):E.traceFlags&A.TraceFlags.SAMPLED?this._localParentSampled.shouldSample(u,h,v,_,b,y):this._localParentNotSampled.shouldSample(u,h,v,_,b,y)}toString(){return`ParentBased{root=${this._root.toString()}, remoteParentSampled=${this._remoteParentSampled.toString()}, remoteParentNotSampled=${this._remoteParentNotSampled.toString()}, localParentSampled=${this._localParentSampled.toString()}, localParentNotSampled=${this._localParentNotSampled.toString()}}`}},"Gf");s.ParentBasedSampler=g}),pl=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.TraceIdRatioBasedSampler=void 0;var A=sr(),f=a(class{constructor(w=0){this._ratio=w,this._ratio=this._normalize(w),this._upperBound=Math.floor(this._ratio*4294967295)}shouldSample(w,x){return{decision:A.isValidTraceId(x)&&this._accumulate(x)<this._upperBound?A.SamplingDecision.RECORD_AND_SAMPLED:A.SamplingDecision.NOT_RECORD}}toString(){return`TraceIdRatioBased{${this._ratio}}`}_normalize(w){return typeof w!="number"||isNaN(w)?0:w>=1?1:w<=0?0:w}_accumulate(w){let x=0;for(let g=0;g<w.length/8;g++){let u=g*8,h=parseInt(w.slice(u,u+8),16);x=(x^h)>>>0}return x}},"Vf");s.TraceIdRatioBasedSampler=f}),Za=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.isUrlIgnored=s.urlMatches=void 0;function A(w,x){return typeof x=="string"?w===x:x.test(w)}a(A,"zf"),s.urlMatches=A;function f(w,x){if(!x)return!1;for(let g of x)if(A(w,g))return!0;return!1}a(f,"VA"),s.isUrlIgnored=f}),gl=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.isWrapped=void 0;function A(f){return typeof f=="function"&&typeof f.__original=="function"&&typeof f.__unwrap=="function"&&f.__wrapped===!0}a(A,"$A"),s.isWrapped=A}),Kr=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),s.baggageUtils=void 0,f(Qs(),s),f(Lr(),s),f(So(),s),f(gi(),s),f(ec(),s),f(dl(),s),f(Ka(),s),f(Ni(),s),s.baggageUtils=ia(),f(Va(),s),f(Xa(),s),f(hl(),s),f(fl(),s),f(xo(),s),f(Qa(),s),f(vi(),s),f(Ya(),s),f(pl(),s),f(Di(),s),f(io(),s),f(An(),s),f(Ga(),s),f(Za(),s),f(gl(),s),f(Ni(),s)}),dn=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.ExceptionEventName=void 0,s.ExceptionEventName="exception"}),Ja=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.Span=void 0;var A=sr(),f=Kr(),w=dr(),x=dn(),g=a(class{constructor(u,h,v,_,b,y,E=[],C=f.hrTime()){this.attributes={},this.links=[],this.events=[],this.status={code:A.SpanStatusCode.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=v,this._spanContext=_,this.parentSpanId=y,this.kind=b,this.links=E,this.startTime=f.timeInputToHrTime(C),this.resource=u.resource,this.instrumentationLibrary=u.instrumentationLibrary,this._spanLimits=u.getSpanLimits(),this._spanProcessor=u.getActiveSpanProcessor(),this._spanProcessor.onStart(this,h)}spanContext(){return this._spanContext}setAttribute(u,h){return h==null||this._isSpanEnded()?this:u.length===0?(A.diag.warn(`Invalid attribute key: ${u}`),this):f.isAttributeValue(h)?Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,u)?this:(this.attributes[u]=h,this):(A.diag.warn(`Invalid attribute value set for key: ${u}`),this)}setAttributes(u){for(let[h,v]of Object.entries(u))this.setAttribute(h,v);return this}addEvent(u,h,v){return this._isSpanEnded()?this:(this.events.length>=this._spanLimits.eventCountLimit&&(A.diag.warn("Dropping extra events."),this.events.shift()),f.isTimeInput(h)&&(typeof v=="undefined"&&(v=h),h=void 0),typeof v=="undefined"&&(v=f.hrTime()),this.events.push({name:u,attributes:h,time:f.timeInputToHrTime(v)}),this)}setStatus(u){return this._isSpanEnded()?this:(this.status=u,this)}updateName(u){return this._isSpanEnded()?this:(this.name=u,this)}end(u=f.hrTime()){if(this._isSpanEnded()){A.diag.error("You can only call end() on a span once.");return}this._ended=!0,this.endTime=f.timeInputToHrTime(u),this._duration=f.hrTimeDuration(this.startTime,this.endTime),this._duration[0]<0&&A.diag.warn("Inconsistent start and end time, startTime > endTime",this.startTime,this.endTime),this._spanProcessor.onEnd(this)}isRecording(){return this._ended===!1}recordException(u,h=f.hrTime()){let v={};typeof u=="string"?v[w.SemanticAttributes.EXCEPTION_MESSAGE]=u:u&&(u.code?v[w.SemanticAttributes.EXCEPTION_TYPE]=u.code.toString():u.name&&(v[w.SemanticAttributes.EXCEPTION_TYPE]=u.name),u.message&&(v[w.SemanticAttributes.EXCEPTION_MESSAGE]=u.message),u.stack&&(v[w.SemanticAttributes.EXCEPTION_STACKTRACE]=u.stack)),v[w.SemanticAttributes.EXCEPTION_TYPE]||v[w.SemanticAttributes.EXCEPTION_MESSAGE]?this.addEvent(x.ExceptionEventName,v,h):A.diag.warn(`Failed to record an exception ${u}`)}get duration(){return this._duration}get ended(){return this._ended}_isSpanEnded(){return this._ended&&A.diag.warn("Can not execute the operation on ended Span {traceId: %s, spanId: %s}",this._spanContext.traceId,this._spanContext.spanId),this._ended}},"Qf");s.Span=g}),es=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.buildSamplerFromEnv=s.DEFAULT_CONFIG=void 0;var A=sr(),f=Kr(),w=f.getEnv(),x=f.TracesSamplerValues.AlwaysOn;s.DEFAULT_CONFIG={sampler:g(w),forceFlushTimeoutMillis:3e4,spanLimits:{attributeCountLimit:f.getEnv().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:f.getEnv().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:f.getEnv().OTEL_SPAN_EVENT_COUNT_LIMIT}};function g(v=f.getEnv()){switch(v.OTEL_TRACES_SAMPLER){case f.TracesSamplerValues.AlwaysOn:return new f.AlwaysOnSampler;case f.TracesSamplerValues.AlwaysOff:return new f.AlwaysOffSampler;case f.TracesSamplerValues.ParentBasedAlwaysOn:return new f.ParentBasedSampler({root:new f.AlwaysOnSampler});case f.TracesSamplerValues.ParentBasedAlwaysOff:return new f.ParentBasedSampler({root:new f.AlwaysOffSampler});case f.TracesSamplerValues.TraceIdRatio:return new f.TraceIdRatioBasedSampler(h(v));case f.TracesSamplerValues.ParentBasedTraceIdRatio:return new f.ParentBasedSampler({root:new f.TraceIdRatioBasedSampler(h(v))});default:return A.diag.error(`OTEL_TRACES_SAMPLER value "${v.OTEL_TRACES_SAMPLER} invalid, defaulting to ${x}".`),new f.AlwaysOnSampler}}a(g,"Wf"),s.buildSamplerFromEnv=g;var u=1;function h(v){if(v.OTEL_TRACES_SAMPLER_ARG===void 0||v.OTEL_TRACES_SAMPLER_ARG==="")return A.diag.error(`OTEL_TRACES_SAMPLER_ARG is blank, defaulting to ${u}.`),u;let _=Number(v.OTEL_TRACES_SAMPLER_ARG);return isNaN(_)?(A.diag.error(`OTEL_TRACES_SAMPLER_ARG=${v.OTEL_TRACES_SAMPLER_ARG} was given, but it is invalid, defaulting to ${u}.`),u):_<0||_>1?(A.diag.error(`OTEL_TRACES_SAMPLER_ARG=${v.OTEL_TRACES_SAMPLER_ARG} was given, but it is out of range ([0..1]), defaulting to ${u}.`),u):_}a(h,"Zf")}),Jn=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.mergeConfig=void 0;var A=es();function f(w){let x={sampler:A.buildSamplerFromEnv()},g=Object.assign({},A.DEFAULT_CONFIG,x,w);return g.spanLimits=Object.assign({},A.DEFAULT_CONFIG.spanLimits,w.spanLimits||{}),g}a(f,"QA"),s.mergeConfig=f}),oa=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.Tracer=void 0;var A=sr(),f=Kr(),w=Ja(),x=Jn(),g=a(class{constructor(h,v,_){this._tracerProvider=_;let b=x.mergeConfig(v);this._sampler=b.sampler,this._spanLimits=b.spanLimits,this._idGenerator=v.idGenerator||new f.RandomIdGenerator,this.resource=_.resource,this.instrumentationLibrary=h}startSpan(h,v={},_=A.context.active()){var b,y;if(f.isTracingSuppressed(_))return A.diag.debug("Instrumentation suppressed, returning Noop Span"),A.trace.wrapSpanContext(A.INVALID_SPAN_CONTEXT);let E=u(v,_),C=this._idGenerator.generateSpanId(),T,R,D;!E||!A.trace.isSpanContextValid(E)?T=this._idGenerator.generateTraceId():(T=E.traceId,R=E.traceState,D=E.spanId);let k=(b=v.kind)!==null&&b!==void 0?b:A.SpanKind.INTERNAL,G=(y=v.links)!==null&&y!==void 0?y:[],Z=f.sanitizeAttributes(v.attributes),Q=this._sampler.shouldSample(v.root?A.trace.setSpanContext(_,A.INVALID_SPAN_CONTEXT):_,T,h,k,Z,G),fe=Q.decision===A.SamplingDecision.RECORD_AND_SAMPLED?A.TraceFlags.SAMPLED:A.TraceFlags.NONE,Ee={traceId:T,spanId:C,traceFlags:fe,traceState:R};if(Q.decision===A.SamplingDecision.NOT_RECORD)return A.diag.debug("Recording is off, propagating context in a non-recording span"),A.trace.wrapSpanContext(Ee);let Pe=new w.Span(this,_,h,Ee,k,D,G,v.startTime);return Pe.setAttributes(Object.assign(Z,Q.attributes)),Pe}startActiveSpan(h,v,_,b){let y,E,C;if(arguments.length<2)return;arguments.length===2?C=v:arguments.length===3?(y=v,C=_):(y=v,E=_,C=b);let T=E!=null?E:A.context.active(),R=this.startSpan(h,y,T),D=A.trace.setSpan(T,R);return A.context.with(D,C,void 0,R)}getSpanLimits(){return this._spanLimits}getActiveSpanProcessor(){return this._tracerProvider.getActiveSpanProcessor()}},"ed");s.Tracer=g;function u(h,v){if(!h.root)return A.trace.getSpanContext(v)}a(u,"JA")}),tc=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.defaultServiceName=void 0;function A(){return`unknown_service:${process.argv0}`}a(A,"eb"),s.defaultServiceName=A}),rc=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.detectResources=void 0;var A=In(),f=sr(),w=K(3837),x=a(async(u={})=>{let h=Object.assign(u),v=await Promise.all((h.detectors||[]).map(async _=>{try{let b=await _.detect(h);return f.diag.debug(`${_.constructor.name} found resource.`,b),b}catch(b){return f.diag.debug(`${_.constructor.name} failed: ${b.message}`),A.Resource.empty()}}));return g(v),v.reduce((_,b)=>_.merge(b),A.Resource.empty())},"rb");s.detectResources=x;var g=a(u=>{u.forEach(h=>{if(Object.keys(h.attributes).length>0){let v=w.inspect(h.attributes,{depth:2,breakLength:1/0,sorted:!0,compact:!1});f.diag.verbose(v)}})},"nb")}),Mi=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.envDetector=void 0;var A=sr(),f=Kr(),w=dr(),x=rs(),g=a(class{constructor(){this._MAX_LENGTH=255,this._COMMA_SEPARATOR=",",this._LABEL_KEY_VALUE_SPLITTER="=",this._ERROR_MESSAGE_INVALID_CHARS="should be a ASCII string with a length greater than 0 and not exceed "+this._MAX_LENGTH+" characters.",this._ERROR_MESSAGE_INVALID_VALUE="should be a ASCII string with a length not exceed "+this._MAX_LENGTH+" characters."}async detect(u){let h={},v=f.getEnv(),_=v.OTEL_RESOURCE_ATTRIBUTES,b=v.OTEL_SERVICE_NAME;if(_)try{let y=this._parseResourceAttributes(_);Object.assign(h,y)}catch(y){A.diag.debug(`EnvDetector failed: ${y.message}`)}return b&&(h[w.ResourceAttributes.SERVICE_NAME]=b),new x.Resource(h)}_parseResourceAttributes(u){if(!u)return{};let h={},v=u.split(this._COMMA_SEPARATOR,-1);for(let _ of v){let b=_.split(this._LABEL_KEY_VALUE_SPLITTER,-1);if(b.length!==2)continue;let[y,E]=b;if(y=y.trim(),E=E.trim().split('^"|"$').join(""),!this._isValidAndNotEmpty(y))throw new Error(`Attribute key ${this._ERROR_MESSAGE_INVALID_CHARS}`);if(!this._isValid(E))throw new Error(`Attribute value ${this._ERROR_MESSAGE_INVALID_VALUE}`);h[y]=E}return h}_isValid(u){return u.length<=this._MAX_LENGTH&&this._isPrintableString(u)}_isPrintableString(u){for(let h=0;h<u.length;h++){let v=u.charAt(h);if(v<=" "||v>="~")return!1}return!0}_isValidAndNotEmpty(u){return u.length>0&&this._isValid(u)}},"ad");s.envDetector=new g}),ml=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.processDetector=void 0;var A=sr(),f=dr(),w=rs(),x=a(class{async detect(g){let u={[f.ResourceAttributes.PROCESS_PID]:process.pid,[f.ResourceAttributes.PROCESS_EXECUTABLE_NAME]:process.title||"",[f.ResourceAttributes.PROCESS_COMMAND]:process.argv[1]||"",[f.ResourceAttributes.PROCESS_COMMAND_LINE]:process.argv.join(" ")||""};return this._getResourceAttributes(u,g)}_getResourceAttributes(g,u){return g[f.ResourceAttributes.PROCESS_EXECUTABLE_NAME]===""||g[f.ResourceAttributes.PROCESS_EXECUTABLE_PATH]===""||g[f.ResourceAttributes.PROCESS_COMMAND]===""||g[f.ResourceAttributes.PROCESS_COMMAND_LINE]===""?(A.diag.debug("ProcessDetector failed: Unable to find required process resources. "),w.Resource.empty()):new w.Resource(Object.assign({},g))}},"ud");s.processDetector=new x}),aa=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(Mi(),s),f(ml(),s)}),yi=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(tc(),s),f(rc(),s),f(aa(),s)}),nc=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(yi(),s)}),In=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.Resource=void 0;var A=dr(),f=Kr(),w=nc(),x=a(class{constructor(g){this.attributes=g}static empty(){return x.EMPTY}static default(){return new x({[A.ResourceAttributes.SERVICE_NAME]:w.defaultServiceName(),[A.ResourceAttributes.TELEMETRY_SDK_LANGUAGE]:f.SDK_INFO[A.ResourceAttributes.TELEMETRY_SDK_LANGUAGE],[A.ResourceAttributes.TELEMETRY_SDK_NAME]:f.SDK_INFO[A.ResourceAttributes.TELEMETRY_SDK_NAME],[A.ResourceAttributes.TELEMETRY_SDK_VERSION]:f.SDK_INFO[A.ResourceAttributes.TELEMETRY_SDK_VERSION]})}merge(g){if(!g||!Object.keys(g.attributes).length)return this;let u=Object.assign({},this.attributes,g.attributes);return new x(u)}},"wt");s.Resource=x,x.EMPTY=new x({})}),ts=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),sa=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),rs=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(In(),s),f(nc(),s),f(ts(),s),f(sa(),s)}),ns=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.MultiSpanProcessor=void 0;var A=Kr(),f=a(class{constructor(w){this._spanProcessors=w}forceFlush(){let w=[];for(let x of this._spanProcessors)w.push(x.forceFlush());return new Promise(x=>{Promise.all(w).then(()=>{x()}).catch(g=>{A.globalErrorHandler(g||new Error("MultiSpanProcessor: forceFlush failed")),x()})})}onStart(w,x){for(let g of this._spanProcessors)g.onStart(w,x)}onEnd(w){for(let x of this._spanProcessors)x.onEnd(w)}shutdown(){let w=[];for(let x of this._spanProcessors)w.push(x.shutdown());return new Promise((x,g)=>{Promise.all(w).then(()=>{x()},g)})}},"vd");s.MultiSpanProcessor=f}),is=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.NoopSpanProcessor=void 0;var A=a(class{onStart(f,w){}onEnd(f){}shutdown(){return Promise.resolve()}forceFlush(){return Promise.resolve()}},"Ed");s.NoopSpanProcessor=A}),ic=$((s,A)=>{var f=200,w="__lodash_hash_undefined__",x=800,g=16,u=9007199254740991,h="[object Arguments]",v="[object Array]",_="[object AsyncFunction]",b="[object Boolean]",y="[object Date]",E="[object Error]",C="[object Function]",T="[object GeneratorFunction]",R="[object Map]",D="[object Number]",k="[object Null]",G="[object Object]",Z="[object Proxy]",Q="[object RegExp]",fe="[object Set]",Ee="[object String]",Pe="[object Undefined]",He="[object WeakMap]",Qe="[object ArrayBuffer]",tt="[object DataView]",mt="[object Float32Array]",bt="[object Float64Array]",jt="[object Int8Array]",Bt="[object Int16Array]",Tr="[object Int32Array]",Mt="[object Uint8Array]",Ze="[object Uint8ClampedArray]",ht="[object Uint16Array]",dt="[object Uint32Array]",xt=/[\\^$.*+?()[\]{}|]/g,Lt=/^\[object .+?Constructor\]$/,qt=/^(?:0|[1-9]\d*)$/,Tt={};Tt[mt]=Tt[bt]=Tt[jt]=Tt[Bt]=Tt[Tr]=Tt[Mt]=Tt[Ze]=Tt[ht]=Tt[dt]=!0,Tt[h]=Tt[v]=Tt[Qe]=Tt[b]=Tt[tt]=Tt[y]=Tt[E]=Tt[C]=Tt[R]=Tt[D]=Tt[G]=Tt[Q]=Tt[fe]=Tt[Ee]=Tt[He]=!1;var Qt=typeof global=="object"&&global&&global.Object===Object&&global,Dr=typeof self=="object"&&self&&self.Object===Object&&self,vr=Qt||Dr||Function("return this")(),yr=typeof s=="object"&&s&&!s.nodeType&&s,ir=yr&&typeof A=="object"&&A&&!A.nodeType&&A,Fr=ir&&ir.exports===yr,mn=Fr&&Qt.process,Ot=function(){try{var re=ir&&ir.require&&ir.require("util").types;return re||mn&&mn.binding&&mn.binding("util")}catch(ve){}}(),At=Ot&&Ot.isTypedArray;function ar(re,ve,Oe){switch(Oe.length){case 0:return re.call(ve);case 1:return re.call(ve,Oe[0]);case 2:return re.call(ve,Oe[0],Oe[1]);case 3:return re.call(ve,Oe[0],Oe[1],Oe[2])}return re.apply(ve,Oe)}a(ar,"Yb");function Nr(re,ve){for(var Oe=-1,wt=Array(re);++Oe<re;)wt[Oe]=ve(Oe);return wt}a(Nr,"Qb");function _a(re){return function(ve){return re(ve)}}a(_a,"Wb");function Sc(re,ve){return re==null?void 0:re[ve]}a(Sc,"Zb");function Gt(re,ve){return function(Oe){return re(ve(Oe))}}a(Gt,"Jb");var wa=Array.prototype,Ec=Function.prototype,ao=Object.prototype,ai=vr["__core-js_shared__"],si=Ec.toString,Dn=ao.hasOwnProperty,Sn=function(){var re=/[^.]+$/.exec(ai&&ai.keys&&ai.keys.IE_PROTO||"");return re?"Symbol(src)_1."+re:""}(),Bi=ao.toString,kn=si.call(Object),xc=RegExp("^"+si.call(Dn).replace(xt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xi=Fr?vr.Buffer:void 0,gs=vr.Symbol,ms=vr.Uint8Array,Hi=xi?xi.allocUnsafe:void 0,Ui=Gt(Object.getPrototypeOf,Object),so=Object.create,ba=ao.propertyIsEnumerable,Bo=wa.splice,qr=gs?gs.toStringTag:void 0,Ci=function(){try{var re=zi(Object,"defineProperty");return re({},"",{}),re}catch(ve){}}(),Zr=xi?xi.isBuffer:void 0,ci=Math.max,pr=Date.now,co=zi(vr,"Map"),ji=zi(Object,"create"),zr=function(){function re(){}return a(re,"e"),function(ve){if(!Gi(ve))return{};if(so)return so(ve);re.prototype=ve;var Oe=new re;return re.prototype=void 0,Oe}}();function St(re){var ve=-1,Oe=re==null?0:re.length;for(this.clear();++ve<Oe;){var wt=re[ve];this.set(wt[0],wt[1])}}a(St,"or");function Sa(){this.__data__=ji?ji(null):{},this.size=0}a(Sa,"cI");function Ea(re){var ve=this.has(re)&&delete this.__data__[re];return this.size-=ve?1:0,ve}a(Ea,"lI");function lo(re){var ve=this.__data__;if(ji){var Oe=ve[re];return Oe===w?void 0:Oe}return Dn.call(ve,re)?ve[re]:void 0}a(lo,"pI");function vs(re){var ve=this.__data__;return ji?ve[re]!==void 0:Dn.call(ve,re)}a(vs,"fI");function ys(re,ve){var Oe=this.__data__;return this.size+=this.has(re)?0:1,Oe[re]=ji&&ve===void 0?w:ve,this}a(ys,"dI"),St.prototype.clear=Sa,St.prototype.delete=Ea,St.prototype.get=lo,St.prototype.has=vs,St.prototype.set=ys;function Nn(re){var ve=-1,Oe=re==null?0:re.length;for(this.clear();++ve<Oe;){var wt=re[ve];this.set(wt[0],wt[1])}}a(Nn,"ct");function uo(){this.__data__=[],this.size=0}a(uo,"hI");function _s(re){var ve=this.__data__,Oe=zt(ve,re);if(Oe<0)return!1;var wt=ve.length-1;return Oe==wt?ve.pop():Bo.call(ve,Oe,1),--this.size,!0}a(_s,"_I");function Ir(re){var ve=this.__data__,Oe=zt(ve,re);return Oe<0?void 0:ve[Oe][1]}a(Ir,"gI");function ws(re){return zt(this.__data__,re)>-1}a(ws,"vI");function Kn(re,ve){var Oe=this.__data__,wt=zt(Oe,re);return wt<0?(++this.size,Oe.push([re,ve])):Oe[wt][1]=ve,this}a(Kn,"mI"),Nn.prototype.clear=uo,Nn.prototype.delete=_s,Nn.prototype.get=Ir,Nn.prototype.has=ws,Nn.prototype.set=Kn;function qi(re){var ve=-1,Oe=re==null?0:re.length;for(this.clear();++ve<Oe;){var wt=re[ve];this.set(wt[0],wt[1])}}a(qi,"tn");function Xn(){this.size=0,this.__data__={hash:new St,map:new(co||Nn),string:new St}}a(Xn,"EI");function bs(re){var ve=Qn(this,re).delete(re);return this.size-=ve?1:0,ve}a(bs,"yI");function Ss(re){return Qn(this,re).get(re)}a(Ss,"TI");function xa(re){return Qn(this,re).has(re)}a(xa,"SI");function Ca(re,ve){var Oe=Qn(this,re),wt=Oe.size;return Oe.set(re,ve),this.size+=Oe.size==wt?0:1,this}a(Ca,"AI"),qi.prototype.clear=Xn,qi.prototype.delete=bs,qi.prototype.get=Ss,qi.prototype.has=xa,qi.prototype.set=Ca;function vn(re){var ve=this.__data__=new Nn(re);this.size=ve.size}a(vn,"rn");function Ti(){this.__data__=new Nn,this.size=0}a(Ti,"bI");function ee(re){var ve=this.__data__,Oe=ve.delete(re);return this.size=ve.size,Oe}a(ee,"II");function me(re){return this.__data__.get(re)}a(me,"CI");function Te(re){return this.__data__.has(re)}a(Te,"OI");function rt(re,ve){var Oe=this.__data__;if(Oe instanceof Nn){var wt=Oe.__data__;if(!co||wt.length<f-1)return wt.push([re,ve]),this.size=++Oe.size,this;Oe=this.__data__=new qi(wt)}return Oe.set(re,ve),this.size=Oe.size,this}a(rt,"PI"),vn.prototype.clear=Ti,vn.prototype.delete=ee,vn.prototype.get=me,vn.prototype.has=Te,vn.prototype.set=rt;function ct(re,ve){var Oe=Ps(re),wt=!Oe&&Ra(re),Kt=!Oe&&!wt&&Ac(re),lr=!Oe&&!wt&&!Kt&&Ic(re),gr=Oe||wt||Kt||lr,Vt=gr?Nr(re.length,String):[],Er=Vt.length;for(var xn in re)(ve||Dn.call(re,xn))&&!(gr&&(xn=="length"||Kt&&(xn=="offset"||xn=="parent")||lr&&(xn=="buffer"||xn=="byteLength"||xn=="byteOffset")||Uo(xn,Er)))&&Vt.push(xn);return Vt}a(ct,"RI");function _t(re,ve,Oe){(Oe!==void 0&&!Ln(re[ve],Oe)||Oe===void 0&&!(ve in re))&&Ft(re,ve,Oe)}a(_t,"Au");function Et(re,ve,Oe){var wt=re[ve];(!(Dn.call(re,ve)&&Ln(wt,Oe))||Oe===void 0&&!(ve in re))&&Ft(re,ve,Oe)}a(Et,"NI");function zt(re,ve){for(var Oe=re.length;Oe--;)if(Ln(re[Oe][0],ve))return Oe;return-1}a(zt,"us");function Ft(re,ve,Oe){ve=="__proto__"&&Ci?Ci(re,ve,{configurable:!0,enumerable:!0,value:Oe,writable:!0}):re[ve]=Oe}a(Ft,"bu");var En=Aa();function Br(re){return re==null?re===void 0?Pe:k:qr&&qr in Object(re)?Jr(re):kl(re)}a(Br,"cs");function _r(re){return Vi(re)&&Br(re)==h}a(_r,"Hd");function rr(re){if(!Gi(re)||zo(re))return!1;var ve=ks(re)?xc:Lt;return ve.test(Ml(re))}a(rr,"wI");function Mn(re){return Vi(re)&&Rc(re.length)&&!!Tt[Br(re)]}a(Mn,"MI");function Es(re){if(!Gi(re))return Rs(re);var ve=As(re),Oe=[];for(var wt in re)wt=="constructor"&&(ve||!Dn.call(re,wt))||Oe.push(wt);return Oe}a(Es,"xI");function xs(re,ve,Oe,wt,Kt){re!==ve&&En(ve,function(lr,gr){if(Kt||(Kt=new vn),Gi(lr))Ol(re,ve,gr,Oe,xs,wt,Kt);else{var Vt=wt?wt(Is(re,gr),lr,gr+"",re,ve,Kt):void 0;Vt===void 0&&(Vt=lr),_t(re,gr,Vt)}},Wo)}a(xs,"Ud");function Ol(re,ve,Oe,wt,Kt,lr,gr){var Vt=Is(re,Oe),Er=Is(ve,Oe),xn=gr.get(Er);if(xn){_t(re,Oe,xn);return}var Cn=lr?lr(Vt,Er,Oe+"",re,ve,gr):void 0,Le=Cn===void 0;if(Le){var ho=Ps(Er),Ia=!ho&&Ac(Er),Pc=!ho&&!Ia&&Ic(Er);Cn=Er,ho||Ia||Pc?Ps(Vt)?Cn=Vt:Ll(Vt)?Cn=Cs(Vt):Ia?(Le=!1,Cn=Dl(Er,!0)):Pc?(Le=!1,Cn=Ho(Er,!0)):Cn=[]:$l(Er)||Ra(Er)?(Cn=Vt,Ra(Vt)?Cn=Fl(Vt):(!Gi(Vt)||ks(Vt))&&(Cn=Wi(Er))):Le=!1}Le&&(gr.set(Er,Cn),Kt(Cn,Er,wt,lr,gr),gr.delete(Er)),_t(re,Oe,Cn)}a(Ol,"LI");function Pl(re,ve){return Nl(ah(re,ve,Ns),re+"")}a(Pl,"qI");var Ta=Ci?function(re,ve){return Ci(re,"toString",{configurable:!0,enumerable:!1,value:Oc(ve),writable:!0})}:Ns;function Dl(re,ve){if(ve)return re.slice();var Oe=re.length,wt=Hi?Hi(Oe):new re.constructor(Oe);return re.copy(wt),wt}a(Dl,"jI");function Cc(re){var ve=new re.constructor(re.byteLength);return new ms(ve).set(new ms(re)),ve}a(Cc,"HI");function Ho(re,ve){var Oe=ve?Cc(re.buffer):re.buffer;return new re.constructor(Oe,re.byteOffset,re.length)}a(Ho,"UI");function Cs(re,ve){var Oe=-1,wt=re.length;for(ve||(ve=Array(wt));++Oe<wt;)ve[Oe]=re[Oe];return ve}a(Cs,"BI");function Tc(re,ve,Oe,wt){var Kt=!Oe;Oe||(Oe={});for(var lr=-1,gr=ve.length;++lr<gr;){var Vt=ve[lr],Er=wt?wt(Oe[Vt],re[Vt],Vt,Oe,re):void 0;Er===void 0&&(Er=re[Vt]),Kt?Ft(Oe,Vt,Er):Et(Oe,Vt,Er)}return Oe}a(Tc,"GI");function Ts(re){return Pl(function(ve,Oe){var wt=-1,Kt=Oe.length,lr=Kt>1?Oe[Kt-1]:void 0,gr=Kt>2?Oe[2]:void 0;for(lr=re.length>3&&typeof lr=="function"?(Kt--,lr):void 0,gr&&jo(Oe[0],Oe[1],gr)&&(lr=Kt<3?void 0:lr,Kt=1),ve=Object(ve);++wt<Kt;){var Vt=Oe[wt];Vt&&re(ve,Vt,wt,lr)}return ve})}a(Ts,"FI");function Aa(re){return function(ve,Oe,wt){for(var Kt=-1,lr=Object(ve),gr=wt(ve),Vt=gr.length;Vt--;){var Er=gr[re?Vt:++Kt];if(Oe(lr[Er],Er,lr)===!1)break}return ve}}a(Aa,"VI");function Qn(re,ve){var Oe=re.__data__;return qo(ve)?Oe[typeof ve=="string"?"string":"hash"]:Oe.map}a(Qn,"ls");function zi(re,ve){var Oe=Sc(re,ve);return rr(Oe)?Oe:void 0}a(zi,"Iu");function Jr(re){var ve=Dn.call(re,qr),Oe=re[qr];try{re[qr]=void 0;var wt=!0}catch(lr){}var Kt=Bi.call(re);return wt&&(ve?re[qr]=Oe:delete re[qr]),Kt}a(Jr,"$I");function Wi(re){return typeof re.constructor=="function"&&!As(re)?zr(Ui(re)):{}}a(Wi,"zI");function Uo(re,ve){var Oe=typeof re;return ve=ve==null?u:ve,!!ve&&(Oe=="number"||Oe!="symbol"&&qt.test(re))&&re>-1&&re%1==0&&re<ve}a(Uo,"Bd");function jo(re,ve,Oe){if(!Gi(Oe))return!1;var wt=typeof ve;return(wt=="number"?Ds(Oe)&&Uo(ve,Oe.length):wt=="string"&&ve in Oe)?Ln(Oe[ve],re):!1}a(jo,"KI");function qo(re){var ve=typeof re;return ve=="string"||ve=="number"||ve=="symbol"||ve=="boolean"?re!=="__proto__":re===null}a(qo,"XI");function zo(re){return!!Sn&&Sn in re}a(zo,"YI");function As(re){var ve=re&&re.constructor,Oe=typeof ve=="function"&&ve.prototype||ao;return re===Oe}a(As,"Gd");function Rs(re){var ve=[];if(re!=null)for(var Oe in Object(re))ve.push(Oe);return ve}a(Rs,"QI");function kl(re){return Bi.call(re)}a(kl,"WI");function ah(re,ve,Oe){return ve=ci(ve===void 0?re.length-1:ve,0),function(){for(var wt=arguments,Kt=-1,lr=ci(wt.length-ve,0),gr=Array(lr);++Kt<lr;)gr[Kt]=wt[ve+Kt];Kt=-1;for(var Vt=Array(ve+1);++Kt<ve;)Vt[Kt]=wt[Kt];return Vt[ve]=Oe(gr),ar(re,this,Vt)}}a(ah,"ZI");function Is(re,ve){if(!(ve==="constructor"&&typeof re[ve]=="function")&&ve!="__proto__")return re[ve]}a(Is,"Cu");var Nl=Os(Ta);function Os(re){var ve=0,Oe=0;return function(){var wt=pr(),Kt=g-(wt-Oe);if(Oe=wt,Kt>0){if(++ve>=x)return arguments[0]}else ve=0;return re.apply(void 0,arguments)}}a(Os,"eC");function Ml(re){if(re!=null){try{return si.call(re)}catch(ve){}try{return re+""}catch(ve){}}return""}a(Ml,"tC");function Ln(re,ve){return re===ve||re!==re&&ve!==ve}a(Ln,"ps");var Ra=_r(function(){return arguments}())?_r:function(re){return Vi(re)&&Dn.call(re,"callee")&&!ba.call(re,"callee")},Ps=Array.isArray;function Ds(re){return re!=null&&Rc(re.length)&&!ks(re)}a(Ds,"Ru");function Ll(re){return Vi(re)&&Ds(re)}a(Ll,"rC");var Ac=Zr||Hl;function ks(re){if(!Gi(re))return!1;var ve=Br(re);return ve==C||ve==T||ve==_||ve==Z}a(ks,"Nu");function Rc(re){return typeof re=="number"&&re>-1&&re%1==0&&re<=u}a(Rc,"Vd");function Gi(re){var ve=typeof re;return re!=null&&(ve=="object"||ve=="function")}a(Gi,"ur");function Vi(re){return re!=null&&typeof re=="object"}a(Vi,"li");function $l(re){if(!Vi(re)||Br(re)!=G)return!1;var ve=Ui(re);if(ve===null)return!0;var Oe=Dn.call(ve,"constructor")&&ve.constructor;return typeof Oe=="function"&&Oe instanceof Oe&&si.call(Oe)==kn}a($l,"nC");var Ic=At?_a(At):Mn;function Fl(re){return Tc(re,Wo(re))}a(Fl,"iC");function Wo(re){return Ds(re)?ct(re,!0):Es(re)}a(Wo,"zd");var Bl=Ts(function(re,ve,Oe){xs(re,ve,Oe)});function Oc(re){return function(){return re}}a(Oc,"sC");function Ns(re){return re}a(Ns,"Kd");function Hl(){return!1}a(Hl,"oC"),A.exports=Bl}),Co=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.BatchSpanProcessorBase=void 0;var A=sr(),f=Kr(),w=a(class{constructor(x,g){this._exporter=x,this._finishedSpans=[],this._isShutdown=!1,this._shuttingDownPromise=Promise.resolve();let u=f.getEnv();this._maxExportBatchSize=typeof(g==null?void 0:g.maxExportBatchSize)=="number"?g.maxExportBatchSize:u.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize=typeof(g==null?void 0:g.maxQueueSize)=="number"?g.maxQueueSize:u.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis=typeof(g==null?void 0:g.scheduledDelayMillis)=="number"?g.scheduledDelayMillis:u.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis=typeof(g==null?void 0:g.exportTimeoutMillis)=="number"?g.exportTimeoutMillis:u.OTEL_BSP_EXPORT_TIMEOUT}forceFlush(){return this._isShutdown?this._shuttingDownPromise:this._flushAll()}onStart(x){}onEnd(x){this._isShutdown||this._addToBuffer(x)}shutdown(){return this._isShutdown?this._shuttingDownPromise:(this._isShutdown=!0,this._shuttingDownPromise=new Promise((x,g)=>{Promise.resolve().then(()=>this.onShutdown()).then(()=>this._flushAll()).then(()=>this._exporter.shutdown()).then(x).catch(u=>{g(u)})}),this._shuttingDownPromise)}_addToBuffer(x){this._finishedSpans.length>=this._maxQueueSize||(this._finishedSpans.push(x),this._maybeStartTimer())}_flushAll(){return new Promise((x,g)=>{let u=[],h=Math.ceil(this._finishedSpans.length/this._maxExportBatchSize);for(let v=0,_=h;v<_;v++)u.push(this._flushOneBatch());Promise.all(u).then(()=>{x()}).catch(g)})}_flushOneBatch(){return this._clearTimer(),this._finishedSpans.length===0?Promise.resolve():new Promise((x,g)=>{let u=setTimeout(()=>{g(new Error("Timeout"))},this._exportTimeoutMillis);A.context.with(f.suppressTracing(A.context.active()),()=>{this._exporter.export(this._finishedSpans.splice(0,this._maxExportBatchSize),h=>{var v;clearTimeout(u),h.code===f.ExportResultCode.SUCCESS?x():g((v=h.error)!==null&&v!==void 0?v:new Error("BatchSpanProcessor: span export failed"))})})})}_maybeStartTimer(){this._timer===void 0&&(this._timer=setTimeout(()=>{this._flushOneBatch().then(()=>{this._finishedSpans.length>0&&(this._clearTimer(),this._maybeStartTimer())}).catch(x=>{f.globalErrorHandler(x)})},this._scheduledDelayMillis),f.unrefTimer(this._timer))}_clearTimer(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)}},"Qd");s.BatchSpanProcessorBase=w}),oc=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.BatchSpanProcessor=void 0;var A=Co(),f=a(class extends A.BatchSpanProcessorBase{onShutdown(){}},"Zd");s.BatchSpanProcessor=f}),ca=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(oc(),s)}),la=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(ca(),s)}),ua=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.BasicTracerProvider=s.ForceFlushState=void 0;var A=sr(),f=Kr(),w=rs(),x=Ao(),g=es(),u=ns(),h=is(),v=ic(),_=la(),b;(function(E){E[E.resolved=0]="resolved",E[E.timeout=1]="timeout",E[E.error=2]="error",E[E.unresolved=3]="unresolved"})(b=s.ForceFlushState||(s.ForceFlushState={}));var y=a(class{constructor(E={}){var C;this._registeredSpanProcessors=[],this._tracers=new Map;let T=v({},g.DEFAULT_CONFIG,E);this.resource=(C=T.resource)!==null&&C!==void 0?C:w.Resource.empty(),this.resource=w.Resource.default().merge(this.resource),this._config=Object.assign({},T,{resource:this.resource});let R=this._buildExporterFromEnv();if(R!==void 0){let D=new _.BatchSpanProcessor(R);this.activeSpanProcessor=D}else this.activeSpanProcessor=new h.NoopSpanProcessor}getTracer(E,C){let T=`${E}@${C||""}`;return this._tracers.has(T)||this._tracers.set(T,new x.Tracer({name:E,version:C},this._config,this)),this._tracers.get(T)}addSpanProcessor(E){this._registeredSpanProcessors.length===0&&this.activeSpanProcessor.shutdown().catch(C=>A.diag.error("Error while trying to shutdown current span processor",C)),this._registeredSpanProcessors.push(E),this.activeSpanProcessor=new u.MultiSpanProcessor(this._registeredSpanProcessors)}getActiveSpanProcessor(){return this.activeSpanProcessor}register(E={}){A.trace.setGlobalTracerProvider(this),E.propagator===void 0&&(E.propagator=this._buildPropagatorFromEnv()),E.contextManager&&A.context.setGlobalContextManager(E.contextManager),E.propagator&&A.propagation.setGlobalPropagator(E.propagator)}forceFlush(){let E=this._config.forceFlushTimeoutMillis,C=this._registeredSpanProcessors.map(T=>new Promise(R=>{let D,k=setTimeout(()=>{R(new Error(`Span processor did not completed within timeout period of ${E} ms`)),D=b.timeout},E);T.forceFlush().then(()=>{clearTimeout(k),D!==b.timeout&&(D=b.resolved,R(D))}).catch(G=>{clearTimeout(k),D=b.error,R(G)})}));return new Promise((T,R)=>{Promise.all(C).then(D=>{let k=D.filter(G=>G!==b.resolved);k.length>0?R(k):T()}).catch(D=>R([D]))})}shutdown(){return this.activeSpanProcessor.shutdown()}_getPropagator(E){var C;return(C=y._registeredPropagators.get(E))===null||C===void 0?void 0:C()}_getSpanExporter(E){var C;return(C=y._registeredExporters.get(E))===null||C===void 0?void 0:C()}_buildPropagatorFromEnv(){let E=Array.from(new Set(f.getEnv().OTEL_PROPAGATORS)),C=E.map(T=>{let R=this._getPropagator(T);return R||A.diag.warn(`Propagator "${T}" requested through environment variable is unavailable.`),R}).reduce((T,R)=>(R&&T.push(R),T),[]);if(C.length!==0)return E.length===1?C[0]:new f.CompositePropagator({propagators:C})}_buildExporterFromEnv(){let E=f.getEnv().OTEL_TRACES_EXPORTER;if(E==="none")return;let C=this._getSpanExporter(E);return C||A.diag.error(`Exporter "${E}" requested through environment variable is unavailable.`),C}},"pr");s.BasicTracerProvider=y,y._registeredPropagators=new Map([["tracecontext",()=>new f.HttpTraceContextPropagator],["baggage",()=>new f.HttpBaggagePropagator]]),y._registeredExporters=new Map}),_i=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.ConsoleSpanExporter=void 0;var A=Kr(),f=a(class{export(w,x){return this._sendSpans(w,x)}shutdown(){return this._sendSpans([]),Promise.resolve()}_exportInfo(w){return{traceId:w.spanContext().traceId,parentId:w.parentSpanId,name:w.name,id:w.spanContext().spanId,kind:w.kind,timestamp:A.hrTimeToMicroseconds(w.startTime),duration:A.hrTimeToMicroseconds(w.duration),attributes:w.attributes,status:w.status,events:w.events}}_sendSpans(w,x){for(let g of w)console.log(this._exportInfo(g));if(x)return x({code:A.ExportResultCode.SUCCESS})}},"nh");s.ConsoleSpanExporter=f}),os=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.InMemorySpanExporter=void 0;var A=Kr(),f=a(class{constructor(){this._finishedSpans=[],this._stopped=!1}export(w,x){if(this._stopped)return x({code:A.ExportResultCode.FAILED,error:new Error("Exporter has been stopped")});this._finishedSpans.push(...w),setTimeout(()=>x({code:A.ExportResultCode.SUCCESS}),0)}shutdown(){return this._stopped=!0,this._finishedSpans=[],Promise.resolve()}reset(){this._finishedSpans=[]}getFinishedSpans(){return this._finishedSpans}},"sh");s.InMemorySpanExporter=f}),To=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Un=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.SimpleSpanProcessor=void 0;var A=sr(),f=Kr(),w=a(class{constructor(x){this._exporter=x,this._isShutdown=!1,this._shuttingDownPromise=Promise.resolve()}forceFlush(){return Promise.resolve()}onStart(x){}onEnd(x){this._isShutdown||A.context.with(f.suppressTracing(A.context.active()),()=>{this._exporter.export([x],g=>{var u;g.code!==f.ExportResultCode.SUCCESS&&f.globalErrorHandler((u=g.error)!==null&&u!==void 0?u:new Error(`SimpleSpanProcessor: span export failed (status ${g})`))})})}shutdown(){return this._isShutdown?this._shuttingDownPromise:(this._isShutdown=!0,this._shuttingDownPromise=new Promise((x,g)=>{Promise.resolve().then(()=>this._exporter.shutdown()).then(x).catch(u=>{g(u)})}),this._shuttingDownPromise)}},"ph");s.SimpleSpanProcessor=w}),as=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),ac=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),sc=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),ss=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Ao=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(oa(),s),f(ua(),s),f(la(),s),f(_i(),s),f(os(),s),f(To(),s),f(Un(),s),f(as(),s),f(is(),s),f(Ja(),s),f(ac(),s),f(sc(),s),f(ss(),s)}),ei=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.azureCoreTracing=s.AzureMonitorSymbol=void 0;var A=he();s.AzureMonitorSymbol="Azure_Monitor_Tracer";var f=!1,w=a(function(g){if(f)return g;try{var u=Ao(),h=sr(),v=new u.BasicTracerProvider,_=v.getTracer("applicationinsights tracer"),b=g.setTracer;g.setTracer=function(y){var E=y.startSpan;y.startSpan=function(C,T,R){var D=E.call(this,C,T,R),k=D.end;return D.end=function(){var G=k.apply(this,arguments);return A.channel.publish("azure-coretracing",D),G},D},y[s.AzureMonitorSymbol]=!0,b.call(this,y)},h.trace.getSpan(h.context.active()),g.setTracer(_),f=!0}catch(y){}return g},"yC");s.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:w};function x(){A.channel.registerMonkeyPatch("@azure/core-tracing",s.azureCoreTracing)}a(x,"TC"),s.enable=x}),da=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.bunyan=void 0;var A=he(),f=a(function(x){var g=x.prototype._emit;return x.prototype._emit=function(u,h){var v=g.apply(this,arguments);if(!h){var _=v;_||(_=g.call(this,u,!0)),A.channel.publish("bunyan",{level:u.level,result:_})}return v},x},"SC");s.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:f};function w(){A.channel.registerMonkeyPatch("bunyan",s.bunyan)}a(w,"AC"),s.enable=w}),wi=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.console=void 0;var A=he(),f=K(2781),w=a(function(g){var u=new f.Writable,h=new f.Writable;u.write=function(T){if(!T)return!0;var R=T.toString();return A.channel.publish("console",{message:R}),!0},h.write=function(T){if(!T)return!0;var R=T.toString();return A.channel.publish("console",{message:R,stderr:!0}),!0};for(var v=new g.Console(u,h),_=["log","info","warn","error","dir","time","timeEnd","trace","assert"],b=function(T){var R=g[T];R&&(g[T]=function(){if(v[T])try{v[T].apply(v,arguments)}catch(D){}return R.apply(g,arguments)})},y=0,E=_;y<E.length;y++){var C=E[y];b(C)}return g},"bC");s.console={versionSpecifier:">= 4.0.0",patch:w};function x(){A.channel.registerMonkeyPatch("console",s.console),K(6206)}a(x,"IC"),s.enable=x}),Ro=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.mongoCore=void 0;var A=he(),f=a(function(x){var g=x.Server.prototype.connect;return x.Server.prototype.connect=function(){var u=g.apply(this,arguments),h=this.s.pool.write;this.s.pool.write=function(){var _=typeof arguments[1]=="function"?1:2;return typeof arguments[_]=="function"&&(arguments[_]=A.channel.bindToContext(arguments[_])),h.apply(this,arguments)};var v=this.s.pool.logout;return this.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=A.channel.bindToContext(arguments[1])),v.apply(this,arguments)},u},x},"CC");s.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:f};function w(){A.channel.registerMonkeyPatch("mongodb-core",s.mongoCore)}a(w,"OC"),s.enable=w}),cs=$(s=>{"use strict";var A=s&&s.__assign||function(){return A=Object.assign||function(v){for(var _,b=1,y=arguments.length;b<y;b++){_=arguments[b];for(var E in _)Object.prototype.hasOwnProperty.call(_,E)&&(v[E]=_[E])}return v},A.apply(this,arguments)};Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.mongo330=s.mongo3=s.mongo2=void 0;var f=he(),w=a(function(v){var _=v.instrument({operationIdGenerator:{next:function(){return f.channel.bindToContext(function(y){return y()})}}}),b={};return _.on("started",function(y){b[y.requestId]||(b[y.requestId]=A(A({},y),{time:new Date}))}),_.on("succeeded",function(y){var E=b[y.requestId];E&&delete b[y.requestId],typeof y.operationId=="function"?y.operationId(function(){return f.channel.publish("mongodb",{startedData:E,event:y,succeeded:!0})}):f.channel.publish("mongodb",{startedData:E,event:y,succeeded:!0})}),_.on("failed",function(y){var E=b[y.requestId];E&&delete b[y.requestId],typeof y.operationId=="function"?y.operationId(function(){return f.channel.publish("mongodb",{startedData:E,event:y,succeeded:!1})}):f.channel.publish("mongodb",{startedData:E,event:y,succeeded:!1})}),v},"PC"),x=a(function(v){var _=v.instrument(),b={},y={};return _.on("started",function(E){b[E.requestId]||(y[E.requestId]=f.channel.bindToContext(function(C){return C()}),b[E.requestId]=A(A({},E),{time:new Date}))}),_.on("succeeded",function(E){var C=b[E.requestId];C&&delete b[E.requestId],typeof E=="object"&&typeof y[E.requestId]=="function"&&(y[E.requestId](function(){return f.channel.publish("mongodb",{startedData:C,event:E,succeeded:!0})}),delete y[E.requestId])}),_.on("failed",function(E){var C=b[E.requestId];C&&delete b[E.requestId],typeof E=="object"&&typeof y[E.requestId]=="function"&&(y[E.requestId](function(){return f.channel.publish("mongodb",{startedData:C,event:E,succeeded:!1})}),delete y[E.requestId])}),v},"RC"),g=a(function(v){var _=v.Server.prototype.connect;return v.Server.prototype.connect=function(){var b=_.apply(this,arguments),y=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var C=typeof arguments[1]=="function"?1:2;return typeof arguments[C]=="function"&&(arguments[C]=f.channel.bindToContext(arguments[C])),y.apply(this,arguments)};var E=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=f.channel.bindToContext(arguments[1])),E.apply(this,arguments)},b},v},"NC"),u=a(function(v){g(v);var _=v.instrument(),b={},y={};return _.on("started",function(E){b[E.requestId]||(y[E.requestId]=f.channel.bindToContext(function(C){return C()}),b[E.requestId]=E)}),_.on("succeeded",function(E){var C=b[E.requestId];C&&delete b[E.requestId],typeof E=="object"&&typeof y[E.requestId]=="function"&&(y[E.requestId](function(){return f.channel.publish("mongodb",{startedData:C,event:E,succeeded:!0})}),delete y[E.requestId])}),_.on("failed",function(E){var C=b[E.requestId];C&&delete b[E.requestId],typeof E=="object"&&typeof y[E.requestId]=="function"&&(y[E.requestId](function(){return f.channel.publish("mongodb",{startedData:C,event:E,succeeded:!1})}),delete y[E.requestId])}),v},"DC");s.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:w},s.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:x},s.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:u};function h(){f.channel.registerMonkeyPatch("mongodb",s.mongo2),f.channel.registerMonkeyPatch("mongodb",s.mongo3),f.channel.registerMonkeyPatch("mongodb",s.mongo330)}a(h,"wC"),s.enable=h}),Io=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.mysql=void 0;var A=he(),f=K(1017),w=a(function(g,u){var h=a(function(C,T){return function(R,D){var k=C[R];k&&(C[R]=function(){for(var G=arguments.length-1,Z=arguments.length-1;Z>=0;--Z)if(typeof arguments[Z]=="function"){G=Z;break}else if(typeof arguments[Z]!="undefined")break;var Q=arguments[G],fe={result:null,startTime:null,startDate:null};typeof Q=="function"&&(D?(fe.startTime=process.hrtime(),fe.startDate=new Date,arguments[G]=A.channel.bindToContext(D(fe,Q))):arguments[G]=A.channel.bindToContext(Q));var Ee=k.apply(this,arguments);return fe.result=Ee,Ee})}},"r"),v=a(function(C,T){return h(C.prototype,T+".prototype")},"n"),_=["connect","changeUser","ping","statistics","end"],b=K(3255)(f.dirname(u)+"/lib/Connection");_.forEach(function(C){return v(b,"Connection")(C)}),h(b,"Connection")("createQuery",function(C,T){return function(R){var D=process.hrtime(C.startTime),k=D[0]*1e3+D[1]/1e6|0;A.channel.publish("mysql",{query:C.result,callbackArgs:arguments,err:R,duration:k,time:C.startDate}),T.apply(this,arguments)}});var y=["_enqueueCallback"],E=K(9118)(f.dirname(u)+"/lib/Pool");return y.forEach(function(C){return v(E,"Pool")(C)}),g},"MC");s.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:w};function x(){A.channel.registerMonkeyPatch("mysql",s.mysql)}a(x,"xC"),s.enable=x}),ha=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.postgresPool1=void 0;var A=he();function f(x){var g=x.prototype.connect;return x.prototype.connect=function(u){return u&&(arguments[0]=A.channel.bindToContext(u)),g.apply(this,arguments)},x}a(f,"LC"),s.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:f};function w(){A.channel.registerMonkeyPatch("pg-pool",s.postgresPool1)}a(w,"qC"),s.enable=w}),cc=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.postgres7=s.postgres6=void 0;var A=he(),f=K(2361);function w(u,h){var v=u.Client.prototype.query,_="__diagnosticOriginalFunc";return u.Client.prototype.query=function(b,y,E){var C={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},T=process.hrtime(),R;function D(k){k&&k[_]&&(k=k[_]);var G=A.channel.bindToContext(function(Z,Q){var fe=process.hrtime(T);if(C.result=Q&&{rowCount:Q.rowCount,command:Q.command},C.error=Z,C.duration=Math.ceil(fe[0]*1e3+fe[1]/1e6),A.channel.publish("postgres",C),Z){if(k)return k.apply(this,arguments);R&&R instanceof f.EventEmitter&&R.emit("error",Z)}else k&&k.apply(this,arguments)});try{return Object.defineProperty(G,_,{value:k}),G}catch(Z){return k}}a(D,"f");try{typeof b=="string"?y instanceof Array?(C.query.preparable={text:b,args:y},E=D(E)):(C.query.text=b,E?E=D(E):y=D(y)):(typeof b.name=="string"?C.query.plan=b.name:b.values instanceof Array?C.query.preparable={text:b.text,args:b.values}:C.query.text=b.text,E?E=D(E):y?y=D(y):b.callback=D(b.callback))}catch(k){return v.apply(this,arguments)}return arguments[0]=b,arguments[1]=y,arguments[2]=E,arguments.length=arguments.length>3?arguments.length:3,R=v.apply(this,arguments),R},u}a(w,"kC");function x(u,h){var v=u.Client.prototype.query,_="__diagnosticOriginalFunc";return u.Client.prototype.query=function(b,y,E){var C=this,T=!!E,R={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},D=process.hrtime(),k;function G(Z){Z&&Z[_]&&(Z=Z[_]);var Q=A.channel.bindToContext(function(fe,Ee){var Pe=process.hrtime(D);if(R.result=Ee&&{rowCount:Ee.rowCount,command:Ee.command},R.error=fe,R.duration=Math.ceil(Pe[0]*1e3+Pe[1]/1e6),A.channel.publish("postgres",R),fe){if(Z)return Z.apply(this,arguments);k&&k instanceof f.EventEmitter&&k.emit("error",fe)}else Z&&Z.apply(this,arguments)});try{return Object.defineProperty(Q,_,{value:Z}),Q}catch(fe){return Z}}a(G,"_");try{typeof b=="string"?y instanceof Array?(R.query.preparable={text:b,args:y},T=typeof E=="function",E=T?G(E):E):(R.query.text=b,E?(T=typeof E=="function",E=T?G(E):E):(T=typeof y=="function",y=T?G(y):y)):(typeof b.name=="string"?R.query.plan=b.name:b.values instanceof Array?R.query.preparable={text:b.text,args:b.values}:R.query.text=b.text,E?(T=typeof E=="function",E=G(E)):y?(T=typeof y=="function",y=T?G(y):y):(T=typeof b.callback=="function",b.callback=T?G(b.callback):b.callback))}catch(Z){return v.apply(this,arguments)}return arguments[0]=b,arguments[1]=y,arguments[2]=E,arguments.length=arguments.length>3?arguments.length:3,k=v.apply(this,arguments),T?k:k.then(function(Z){return G()(void 0,Z),new C._Promise(function(Q,fe){Q(Z)})}).catch(function(Z){return G()(Z,void 0),new C._Promise(function(Q,fe){fe(Z)})})},u}a(x,"jC"),s.postgres6={versionSpecifier:"6.*",patch:w},s.postgres7={versionSpecifier:">=7.* <=8.*",patch:x};function g(){A.channel.registerMonkeyPatch("pg",s.postgres6),A.channel.registerMonkeyPatch("pg",s.postgres7)}a(g,"HC"),s.enable=g}),lc=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.redis=void 0;var A=he(),f=a(function(x){var g=x.RedisClient.prototype.internal_send_command;return x.RedisClient.prototype.internal_send_command=function(u){if(u){var h=u.callback;if(!h||!h.pubsubBound){var v=this.address,_=process.hrtime(),b=new Date;u.callback=A.channel.bindToContext(function(y,E){var C=process.hrtime(_),T=C[0]*1e3+C[1]/1e6|0;A.channel.publish("redis",{duration:T,address:v,commandObj:u,err:y,result:E,time:b}),typeof h=="function"&&h.apply(this,arguments)}),u.callback.pubsubBound=!0}}return g.call(this,u)},x},"UC");s.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:f};function w(){A.channel.registerMonkeyPatch("redis",s.redis)}a(w,"BC"),s.enable=w}),ls=$(s=>{"use strict";var A=s&&s.__assign||function(){return A=Object.assign||function(g){for(var u,h=1,v=arguments.length;h<v;h++){u=arguments[h];for(var _ in u)Object.prototype.hasOwnProperty.call(u,_)&&(g[_]=u[_])}return g},A.apply(this,arguments)};Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.tedious=void 0;var f=he(),w=a(function(g){var u=g.Connection.prototype.makeRequest;return g.Connection.prototype.makeRequest=function(){function h(_){var b=process.hrtime(),y={query:{},database:{host:null,port:null},result:null,error:null,duration:0};return f.channel.bindToContext(function(E,C,T){var R=process.hrtime(b);y=A(A({},y),{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!E&&{rowCount:C,rows:T},query:{text:this.parametersByName.statement.value},error:E,duration:Math.ceil(R[0]*1e3+R[1]/1e6)}),f.channel.publish("tedious",y),_.call(this,E,C,T)})}a(h,"n");var v=arguments[0];arguments[0].callback=h(v.callback),u.apply(this,arguments)},g},"GC");s.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:w};function x(){f.channel.registerMonkeyPatch("tedious",s.tedious)}a(x,"FC"),s.enable=x}),bi=$(s=>{"use strict";var A=s&&s.__extends||function(){var h=a(function(v,_){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,y){b.__proto__=y}||function(b,y){for(var E in y)Object.prototype.hasOwnProperty.call(y,E)&&(b[E]=y[E])},h(v,_)},"e");return function(v,_){h(v,_);function b(){this.constructor=v}a(b,"n"),v.prototype=_===null?Object.create(_):(b.prototype=_.prototype,new b)}}(),f=s&&s.__rest||function(h,v){var _={};for(var b in h)Object.prototype.hasOwnProperty.call(h,b)&&v.indexOf(b)<0&&(_[b]=h[b]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,b=Object.getOwnPropertySymbols(h);y<b.length;y++)v.indexOf(b[y])<0&&Object.prototype.propertyIsEnumerable.call(h,b[y])&&(_[b[y]]=h[b[y]]);return _};Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.winston2=s.winston3=void 0;var w=he(),x=a(function(h){var v=h.Logger.prototype.log,_,b=a(function(y,E,C){var T;return _===h.config.npm.levels?T="npm":_===h.config.syslog.levels?T="syslog":T="unknown",w.channel.publish("winston",{level:y,message:E,meta:C,levelKind:T}),E},"n");return h.Logger.prototype.log=function(){return _=this.levels,!this.filters||this.filters.length===0?this.filters=[b]:this.filters[this.filters.length-1]!==b&&(this.filters=this.filters.filter(function(y){return y!==b}),this.filters.push(b)),v.apply(this,arguments)},h},"zC"),g=a(function(h){var v=a(function(C,T){var R;return C.config.npm.levels[T]!=null?R="npm":C.config.syslog.levels[T]!=null?R="syslog":R="unknown",R},"t"),_=function(C){A(T,C);function T(R,D){var k=C.call(this,D)||this;return k.winston=R,k}return a(T,"o"),T.prototype.log=function(R,D){var k=R.message,G=R.level,Z=R.meta,Q=f(R,["message","level","meta"]);G=typeof Symbol.for=="function"?R[Symbol.for("level")]:G,k=R instanceof Error?R:k;var fe=v(this.winston,G);Z=Z||{};for(var Ee in Q)Q.hasOwnProperty(Ee)&&(Z[Ee]=Q[Ee]);w.channel.publish("winston",{message:k,level:G,levelKind:fe,meta:Z}),D()},T}(h.Transport);function b(){var C=arguments[0].levels||h.config.npm.levels,T;for(var R in C)C.hasOwnProperty(R)&&(T=T===void 0||C[R]>C[T]?R:T);this.add(new _(h,{level:T}))}a(b,"n");var y=h.createLogger;h.createLogger=function(){var C=arguments[0].levels||h.config.npm.levels,T;for(var R in C)C.hasOwnProperty(R)&&(T=T===void 0||C[R]>C[T]?R:T);var D=y.apply(this,arguments);D.add(new _(h,{level:T}));var k=D.configure;return D.configure=function(){k.apply(this,arguments),b.apply(this,arguments)},D};var E=h.configure;return h.configure=function(){E.apply(this,arguments),b.apply(this,arguments)},h.add(new _(h)),h},"KC");s.winston3={versionSpecifier:"3.x",patch:g},s.winston2={versionSpecifier:"2.x",patch:x};function u(){w.channel.registerMonkeyPatch("winston",s.winston2),w.channel.registerMonkeyPatch("winston",s.winston3)}a(u,"XC"),s.enable=u}),us=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.tedious=s.pgPool=s.pg=s.winston=s.redis=s.mysql=s.mongodb=s.mongodbCore=s.console=s.bunyan=s.azuresdk=void 0;var A=ei();s.azuresdk=A;var f=da();s.bunyan=f;var w=wi();s.console=w;var x=Ro();s.mongodbCore=x;var g=cs();s.mongodb=g;var u=Io();s.mysql=u;var h=ha();s.pgPool=h;var v=cc();s.pg=v;var _=lc();s.redis=_;var b=ls();s.tedious=b;var y=bi();s.winston=y;function E(){f.enable(),w.enable(),x.enable(),g.enable(),u.enable(),v.enable(),h.enable(),_.enable(),y.enable(),A.enable(),b.enable()}a(E,"YC"),s.enable=E}),Oo=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.registerContextPreservation=s.IsInitialized=void 0;var A=we(),f=ot();s.IsInitialized=!process.env.APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL;var w="DiagnosticChannel";if(s.IsInitialized){x=us(),g=process.env.APPLICATION_INSIGHTS_NO_PATCH_MODULES||"",u=g.split(","),h={bunyan:x.bunyan,console:x.console,mongodb:x.mongodb,mongodbCore:x.mongodbCore,mysql:x.mysql,redis:x.redis,pg:x.pg,pgPool:x.pgPool,winston:x.winston,azuresdk:x.azuresdk};for(v in h)u.indexOf(v)===-1&&(h[v].enable(),f.info(w,"Subscribed to "+v+" events"));u.length>0&&f.info(w,"Some modules will not be patched",u)}else f.info(w,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");var x,g,u,h,v;function _(b){if(s.IsInitialized){var y=he();y.channel.addContextPreservation(b),y.channel.spanContextPropagator=A.AsyncScopeManager}}a(_,"WC"),s.registerContextPreservation=_}),Po=$((s,A)=>{"use strict";A.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}}),hn=$((s,A)=>{"use strict";var f=s&&s.__assign||function(){return f=Object.assign||function(b){for(var y,E=1,C=arguments.length;E<C;E++){y=arguments[E];for(var T in y)Object.prototype.hasOwnProperty.call(y,T)&&(b[T]=y[T])}return b},f.apply(this,arguments)},w=K(3685),x=K(5687),g=K(7310),u=K(2057),h=ot(),v=Po(),_=function(){function b(){}return a(b,"e"),b.getCookie=function(y,E){var C="";if(y&&y.length&&typeof E=="string")for(var T=y+"=",R=E.split(";"),D=0;D<R.length;D++){var E=R[D];if(E=b.trim(E),E&&E.indexOf(T)===0){C=E.substring(T.length,R[D].length);break}}return C},b.trim=function(y){return typeof y=="string"?y.replace(/^\s+|\s+$/g,""):""},b.int32ArrayToBase64=function(y){var E=a(function(k,G){return String.fromCharCode(k>>G&255)},"r"),C=a(function(k){return E(k,24)+E(k,16)+E(k,8)+E(k,0)},"n"),T=y.map(C).join(""),R=Buffer.from?Buffer.from(T,"binary"):new Buffer(T,"binary"),D=R.toString("base64");return D.substr(0,D.indexOf("="))},b.random32=function(){return 4294967296*Math.random()|0},b.randomu32=function(){return b.random32()+2147483648},b.w3cTraceId=function(){for(var y=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],E="",C,T=0;T<4;T++)C=b.random32(),E+=y[C&15]+y[C>>4&15]+y[C>>8&15]+y[C>>12&15]+y[C>>16&15]+y[C>>20&15]+y[C>>24&15]+y[C>>28&15];var R=y[8+Math.random()*4|0];return E.substr(0,8)+E.substr(9,4)+"4"+E.substr(13,3)+R+E.substr(16,3)+E.substr(19,12)},b.w3cSpanId=function(){return b.w3cTraceId().substring(16)},b.isValidW3CId=function(y){return y.length===32&&y!=="00000000000000000000000000000000"},b.isArray=function(y){return Object.prototype.toString.call(y)==="[object Array]"},b.isError=function(y){return y instanceof Error},b.isPrimitive=function(y){var E=typeof y;return E==="string"||E==="number"||E==="boolean"},b.isDate=function(y){return Object.prototype.toString.call(y)==="[object Date]"},b.msToTimeSpan=function(y){(isNaN(y)||y<0)&&(y=0);var E=(y/1e3%60).toFixed(7).replace(/0{0,4}$/,""),C=""+Math.floor(y/(1e3*60))%60,T=""+Math.floor(y/(1e3*60*60))%24,R=Math.floor(y/(1e3*60*60*24));E=E.indexOf(".")<2?"0"+E:E,C=C.length<2?"0"+C:C,T=T.length<2?"0"+T:T;var D=R>0?R+".":"";return D+T+":"+C+":"+E},b.extractError=function(y){var E=y;return{message:y.message,code:E.code||E.id||""}},b.extractObject=function(y){return y instanceof Error?b.extractError(y):typeof y.toJSON=="function"?y.toJSON():y},b.validateStringMap=function(y){if(typeof y!="object"){h.info("Invalid properties dropped from payload");return}var E={};for(var C in y){var T="",R=y[C],D=typeof R;if(b.isPrimitive(R))T=R.toString();else if(R===null||D==="undefined")T="";else if(D==="function"){h.info("key: "+C+" was function; will not serialize");continue}else{var k=b.isArray(R)?R:b.extractObject(R);try{b.isPrimitive(k)?T=k:T=JSON.stringify(k)}catch(G){T=R.constructor.name.toString()+" (Error: "+G.message+")",h.info("key: "+C+", could not be serialized")}}E[C]=T.substring(0,b.MAX_PROPERTY_LENGTH)}return E},b.canIncludeCorrelationHeader=function(y,E){var C=y&&y.config&&y.config.correlationHeaderExcludedDomains;if(!C||C.length==0||!E)return!0;for(var T=0;T<C.length;T++){var R=new RegExp(C[T].replace(/\./g,".").replace(/\*/g,".*"));if(R.test(g.parse(E).hostname))return!1}return!0},b.getCorrelationContextTarget=function(y,E){var C=y.headers&&y.headers[v.requestContextHeader];if(C)for(var T=C.split(","),R=0;R<T.length;++R){var D=T[R].split("=");if(D.length==2&&D[0]==E)return D[1]}},b.makeRequest=function(y,E,C,T){E&&E.indexOf("//")===0&&(E="https:"+E);var R=g.parse(E),D=f(f({},C),{host:R.hostname,port:R.port,path:R.pathname}),k=void 0;if(R.protocol==="https:"&&(k=y.proxyHttpsUrl||void 0),R.protocol==="http:"&&(k=y.proxyHttpUrl||void 0),k){k.indexOf("//")===0&&(k="http:"+k);var G=g.parse(k);G.protocol==="https:"?(h.info("Proxies that use HTTPS are not supported"),k=void 0):D=f(f({},D),{host:G.hostname,port:G.port||"80",path:E,headers:f(f({},D.headers),{Host:R.hostname})})}var Z=R.protocol==="https:"&&!k;return Z&&y.httpsAgent!==void 0?D.agent=y.httpsAgent:!Z&&y.httpAgent!==void 0?D.agent=y.httpAgent:Z&&(D.agent=b.tlsRestrictedAgent),Z?x.request(D,T):w.request(D,T)},b.safeIncludeCorrelationHeader=function(y,E,C){var T;if(typeof C=="string")T=C;else if(C instanceof Array)T=C.join(",");else if(C&&typeof C.toString=="function")try{T=C.toString()}catch(R){h.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",R,C)}T?b.addCorrelationIdHeaderFromString(y,E,T):E.setHeader(v.requestContextHeader,v.requestContextSourceKey+"="+y.config.correlationId)},b.dumpObj=function(y){var E=Object.prototype.toString.call(y),C="";return E==="[object Error]"?C="{ stack: '"+y.stack+"', message: '"+y.message+"', name: '"+y.name+"'":C=JSON.stringify(y),E+C},b.addCorrelationIdHeaderFromString=function(y,E,C){var T=C.split(","),R=v.requestContextSourceKey+"=",D=T.some(function(k){return k.substring(0,R.length)===R});D||E.setHeader(v.requestContextHeader,C+","+v.requestContextSourceKey+"="+y.config.correlationId)},b.MAX_PROPERTY_LENGTH=8192,b.tlsRestrictedAgent=new x.Agent({keepAlive:!0,maxSockets:25,secureOptions:u.SSL_OP_NO_SSLv2|u.SSL_OP_NO_SSLv3|u.SSL_OP_NO_TLSv1|u.SSL_OP_NO_TLSv1_1}),b}();A.exports=_}),J=$((s,A)=>{"use strict";var f=hn(),w=ot(),x=function(){function g(){}return a(g,"e"),g.queryCorrelationId=function(u,h){var v=u.profileQueryEndpoint+"/api/profiles/"+u.instrumentationKey+"/appId";if(g.completedLookups.hasOwnProperty(v)){h(g.completedLookups[v]);return}else if(g.pendingLookups[v]){g.pendingLookups[v].push(h);return}g.pendingLookups[v]=[h];var _=a(function(){if(g.pendingLookups[v]){var b={method:"GET",disableAppInsightsAutoCollection:!0};w.info(g.TAG,b);var y=f.makeRequest(u,v,b,function(E){if(E.statusCode===200){var C="";E.setEncoding("utf-8"),E.on("data",function(T){C+=T}),E.on("end",function(){w.info(g.TAG,C);var T=g.correlationIdPrefix+C;g.completedLookups[v]=T,g.pendingLookups[v]&&g.pendingLookups[v].forEach(function(R){return R(T)}),delete g.pendingLookups[v]})}else E.statusCode>=400&&E.statusCode<500?(g.completedLookups[v]=void 0,delete g.pendingLookups[v]):setTimeout(_,u.correlationIdRetryIntervalMs)});y&&(y.on("error",function(E){w.warn(g.TAG,E)}),y.end())}},"i");setTimeout(_,0)},g.cancelCorrelationIdQuery=function(u,h){var v=u.profileQueryEndpoint+"/api/profiles/"+u.instrumentationKey+"/appId",_=g.pendingLookups[v];_&&(g.pendingLookups[v]=_.filter(function(b){return b!=h}),g.pendingLookups[v].length==0&&delete g.pendingLookups[v])},g.generateRequestId=function(u){if(u){u=u[0]=="|"?u:"|"+u,u[u.length-1]!=="."&&(u+=".");var h=(g.currentRootId++).toString(16);return g.appendSuffix(u,h,"_")}else return g.generateRootId()},g.getRootId=function(u){var h=u.indexOf(".");h<0&&(h=u.length);var v=u[0]==="|"?1:0;return u.substring(v,h)},g.generateRootId=function(){return"|"+f.w3cTraceId()+"."},g.appendSuffix=function(u,h,v){if(u.length+h.length<g.requestIdMaxLength)return u+h+v;var _=g.requestIdMaxLength-9;if(u.length>_)for(;_>1;--_){var b=u[_-1];if(b==="."||b==="_")break}if(_<=1)return g.generateRootId();for(h=f.randomu32().toString(16);h.length<8;)h="0"+h;return u.substring(0,_)+h+"#"},g.TAG="CorrelationIdManager",g.correlationIdPrefix="cid-v1:",g.w3cEnabled=!0,g.pendingLookups={},g.completedLookups={},g.requestIdMaxLength=1024,g.currentRootId=f.randomu32(),g}();A.exports=x}),_e=$((s,A)=>{"use strict";var f=hn(),w=J(),x=function(){function g(u,h){if(this.traceFlag=g.DEFAULT_TRACE_FLAG,this.version=g.DEFAULT_VERSION,u&&typeof u=="string")if(u.split(",").length>1)this.traceId=f.w3cTraceId(),this.spanId=f.w3cTraceId().substr(0,16);else{var v=u.trim().split("-"),_=v.length;_>=4?(this.version=v[0],this.traceId=v[1],this.spanId=v[2],this.traceFlag=v[3]):(this.traceId=f.w3cTraceId(),this.spanId=f.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=g.DEFAULT_VERSION,this.traceId=f.w3cTraceId()),this.version==="00"&&_!==4&&(this.traceId=f.w3cTraceId(),this.spanId=f.w3cTraceId().substr(0,16)),this.version==="ff"&&(this.version=g.DEFAULT_VERSION,this.traceId=f.w3cTraceId(),this.spanId=f.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=g.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=g.DEFAULT_TRACE_FLAG,this.traceId=f.w3cTraceId()),g.isValidTraceId(this.traceId)||(this.traceId=f.w3cTraceId()),g.isValidSpanId(this.spanId)||(this.spanId=f.w3cTraceId().substr(0,16),this.traceId=f.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(h){this.parentId=h.slice();var b=w.getRootId(h);g.isValidTraceId(b)||(this.legacyRootId=b,b=f.w3cTraceId()),h.indexOf("|")!==-1&&(h=h.substring(1+h.substring(0,h.length-1).lastIndexOf("."),h.length-1)),this.traceId=b,this.spanId=h}else this.traceId=f.w3cTraceId(),this.spanId=f.w3cTraceId().substr(0,16)}return a(g,"e"),g.isValidTraceId=function(u){return u.match(/^[0-9a-f]{32}$/)&&u!=="00000000000000000000000000000000"},g.isValidSpanId=function(u){return u.match(/^[0-9a-f]{16}$/)&&u!=="0000000000000000"},g.formatOpenTelemetryTraceFlags=function(u){var h="0"+u.toString(16);return h.substring(h.length-2)},g.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},g.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},g.prototype.updateSpanId=function(){this.spanId=f.w3cTraceId().substr(0,16)},g.DEFAULT_TRACE_FLAG="01",g.DEFAULT_VERSION="00",g}();A.exports=x}),Ge=$((s,A)=>{"use strict";var f=function(){function w(x){this.fieldmap=[],!!x&&(this.fieldmap=this.parseHeader(x))}return a(w,"e"),w.prototype.toString=function(){var x=this.fieldmap;return!x||x.length==0?null:x.join(", ")},w.validateKeyChars=function(x){var g=x.split("@");if(g.length==2){var u=g[0].trim(),h=g[1].trim(),v=Boolean(u.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/)),_=Boolean(h.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/));return v&&_}else if(g.length==1)return Boolean(x.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/));return!1},w.prototype.parseHeader=function(x){var g=[],u={},h=x.split(",");if(h.length>32)return null;for(var v=0,_=h;v<_.length;v++){var b=_[v],y=b.trim();if(y.length!==0){var E=y.split("=");if(E.length!==2||!w.validateKeyChars(E[0])||u[E[0]])return null;u[E[0]]=!0,g.push(y)}}return g},w.strict=!0,w}();A.exports=f}),gt=$((s,A)=>{"use strict";var f=function(){function w(){}return a(w,"e"),w}();A.exports=f}),hr=$((s,A)=>{"use strict";var f=s&&s.__extends||function(){var g=a(function(u,h){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},g(u,h)},"e");return function(u,h){g(u,h);function v(){this.constructor=u}a(v,"n"),u.prototype=h===null?Object.create(h):(v.prototype=h.prototype,new v)}}(),w=gt(),x=function(g){f(u,g);function u(){var h=g.call(this)||this;return h.ver=2,h.properties={},h.measurements={},h}return a(u,"t"),u}(w);A.exports=x}),$t=$((s,A)=>{"use strict";var f=function(){function w(){}return a(w,"e"),w}();A.exports=f}),br=$((s,A)=>{"use strict";var f=function(){function w(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"}return a(w,"e"),w}();A.exports=f}),Rr=$((s,A)=>{"use strict";var f=s&&s.__extends||function(){var g=a(function(u,h){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},g(u,h)},"e");return function(u,h){g(u,h);function v(){this.constructor=u}a(v,"n"),u.prototype=h===null?Object.create(h):(v.prototype=h.prototype,new v)}}(),w=$t(),x=function(g){f(u,g);function u(){return g.call(this)||this}return a(u,"t"),u}(w);A.exports=x}),Or=$((s,A)=>{"use strict";var f;(function(w){w[w.Measurement=0]="Measurement",w[w.Aggregation=1]="Aggregation"})(f||(f={})),A.exports=f}),fr=$((s,A)=>{"use strict";var f=Or(),w=function(){function x(){this.kind=f.Measurement}return a(x,"e"),x}();A.exports=w}),sn=$((s,A)=>{"use strict";var f=function(){function w(){this.ver=1,this.sampleRate=100,this.tags={}}return a(w,"e"),w}();A.exports=f}),fn=$((s,A)=>{"use strict";var f=s&&s.__extends||function(){var g=a(function(u,h){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},g(u,h)},"e");return function(u,h){g(u,h);function v(){this.constructor=u}a(v,"n"),u.prototype=h===null?Object.create(h):(v.prototype=h.prototype,new v)}}(),w=gt(),x=function(g){f(u,g);function u(){var h=g.call(this)||this;return h.ver=2,h.properties={},h.measurements={},h}return a(u,"t"),u}(w);A.exports=x}),$r=$((s,A)=>{"use strict";var f=s&&s.__extends||function(){var g=a(function(u,h){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},g(u,h)},"e");return function(u,h){g(u,h);function v(){this.constructor=u}a(v,"n"),u.prototype=h===null?Object.create(h):(v.prototype=h.prototype,new v)}}(),w=gt(),x=function(g){f(u,g);function u(){var h=g.call(this)||this;return h.ver=2,h.exceptions=[],h.properties={},h.measurements={},h}return a(u,"t"),u}(w);A.exports=x}),nr=$((s,A)=>{"use strict";var f=function(){function w(){this.hasFullStack=!0,this.parsedStack=[]}return a(w,"e"),w}();A.exports=f}),Xr=$((s,A)=>{"use strict";var f=s&&s.__extends||function(){var g=a(function(u,h){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},g(u,h)},"e");return function(u,h){g(u,h);function v(){this.constructor=u}a(v,"n"),u.prototype=h===null?Object.create(h):(v.prototype=h.prototype,new v)}}(),w=gt(),x=function(g){f(u,g);function u(){var h=g.call(this)||this;return h.ver=2,h.properties={},h}return a(u,"t"),u}(w);A.exports=x}),ti=$((s,A)=>{"use strict";var f=s&&s.__extends||function(){var g=a(function(u,h){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},g(u,h)},"e");return function(u,h){g(u,h);function v(){this.constructor=u}a(v,"n"),u.prototype=h===null?Object.create(h):(v.prototype=h.prototype,new v)}}(),w=gt(),x=function(g){f(u,g);function u(){var h=g.call(this)||this;return h.ver=2,h.metrics=[],h.properties={},h}return a(u,"t"),u}(w);A.exports=x}),On=$((s,A)=>{"use strict";var f=s&&s.__extends||function(){var g=a(function(u,h){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},g(u,h)},"e");return function(u,h){g(u,h);function v(){this.constructor=u}a(v,"n"),u.prototype=h===null?Object.create(h):(v.prototype=h.prototype,new v)}}(),w=fn(),x=function(g){f(u,g);function u(){var h=g.call(this)||this;return h.ver=2,h.properties={},h.measurements={},h}return a(u,"t"),u}(w);A.exports=x}),wn=$((s,A)=>{"use strict";var f=s&&s.__extends||function(){var g=a(function(u,h){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},g(u,h)},"e");return function(u,h){g(u,h);function v(){this.constructor=u}a(v,"n"),u.prototype=h===null?Object.create(h):(v.prototype=h.prototype,new v)}}(),w=gt(),x=function(g){f(u,g);function u(){var h=g.call(this)||this;return h.ver=2,h.success=!0,h.properties={},h.measurements={},h}return a(u,"t"),u}(w);A.exports=x}),fa=$((s,A)=>{"use strict";var f=s&&s.__extends||function(){var g=a(function(u,h){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,_){v.__proto__=_}||function(v,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(v[b]=_[b])},g(u,h)},"e");return function(u,h){g(u,h);function v(){this.constructor=u}a(v,"n"),u.prototype=h===null?Object.create(h):(v.prototype=h.prototype,new v)}}(),w=gt(),x=function(g){f(u,g);function u(){var h=g.call(this)||this;return h.ver=2,h.properties={},h.measurements={},h}return a(u,"t"),u}(w);A.exports=x}),ri=$((s,A)=>{"use strict";var f;(function(w){w[w.Verbose=0]="Verbose",w[w.Information=1]="Information",w[w.Warning=2]="Warning",w[w.Error=3]="Error",w[w.Critical=4]="Critical"})(f||(f={})),A.exports=f}),Do=$((s,A)=>{"use strict";var f=function(){function w(){}return a(w,"e"),w}();A.exports=f}),vl=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.AvailabilityData=hr(),s.Base=$t(),s.ContextTagKeys=br(),s.Data=Rr(),s.DataPoint=fr(),s.DataPointType=Or(),s.Domain=gt(),s.Envelope=sn(),s.EventData=fn(),s.ExceptionData=$r(),s.ExceptionDetails=nr(),s.MessageData=Xr(),s.MetricData=ti(),s.PageViewData=On(),s.RemoteDependencyData=wn(),s.RequestData=fa(),s.SeverityLevel=ri(),s.StackFrame=Do()}),bu=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.domainSupportsProperties=s.RemoteDependencyDataConstants=void 0;var A=vl(),f=function(){function x(){}return a(x,"e"),x.TYPE_HTTP="Http",x.TYPE_AI="Http (tracked component)",x}();s.RemoteDependencyDataConstants=f;function w(x){return"properties"in x||x instanceof A.EventData||x instanceof A.ExceptionData||x instanceof A.MessageData||x instanceof A.MetricData||x instanceof A.PageViewData||x instanceof A.RemoteDependencyData||x instanceof A.RequestData}a(w,"UO"),s.domainSupportsProperties=w}),Pn=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Su=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),yl=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),ni=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Eu=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Dt=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),xu=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),pa=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),ko=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),ga=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),_l=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Cu=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),uc=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.TelemetryType=s.TelemetryTypeString=s.baseTypeToTelemetryType=s.telemetryTypeToBaseType=void 0;function A(x){switch(x){case w.Event:return"EventData";case w.Exception:return"ExceptionData";case w.Trace:return"MessageData";case w.Metric:return"MetricData";case w.Request:return"RequestData";case w.Dependency:return"RemoteDependencyData";case w.Availability:return"AvailabilityData";case w.PageView:return"PageViewData"}}a(A,"BO"),s.telemetryTypeToBaseType=A;function f(x){switch(x){case"EventData":return w.Event;case"ExceptionData":return w.Exception;case"MessageData":return w.Trace;case"MetricData":return w.Metric;case"RequestData":return w.Request;case"RemoteDependencyData":return w.Dependency;case"AvailabilityData":return w.Availability;case"PageViewData":return w.PageView}}a(f,"GO"),s.baseTypeToTelemetryType=f,s.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData",PageView:"PageViewData"};var w;(function(x){x[x.Event=0]="Event",x[x.Exception=1]="Exception",x[x.Trace=2]="Trace",x[x.Metric=3]="Metric",x[x.Request=4]="Request",x[x.Dependency=5]="Dependency",x[x.Availability=6]="Availability",x[x.PageView=7]="PageView"})(w=s.TelemetryType||(s.TelemetryType={}))}),Tu=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(Pn(),s),f(Su(),s),f(yl(),s),f(ni(),s),f(Eu(),s),f(Dt(),s),f(xu(),s),f(pa(),s),f(ko(),s),f(ga(),s),f(_l(),s),f(Cu(),s),f(uc(),s)}),wl=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Au=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Ru=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),jn=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Iu=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Ou=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Pu=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),dc=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),ma=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(wl(),s),f(Au(),s),f(Ru(),s),f(jn(),s),f(Iu(),s),f(Ou(),s),f(Pu(),s),f(dc(),s)}),pn=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(bu(),s),f(vl(),s),f(Tu(),s),f(ma(),s)}),bl=$((s,A)=>{"use strict";var f=function(){function w(){}return a(w,"e"),w.prototype.getUrl=function(){return this.url},w.prototype.RequestParser=function(){this.startTime=+new Date},w.prototype._setStatus=function(x,g){var u=+new Date;this.duration=u-this.startTime,this.statusCode=x;var h=this.properties||{};if(g){if(typeof g=="string")h.error=g;else if(g instanceof Error)h.error=g.message;else if(typeof g=="object")for(var v in g)h[v]=g[v]&&g[v].toString&&g[v].toString()}this.properties=h},w.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},w}();A.exports=f}),va=$((s,A)=>{"use strict";var f=s&&s.__extends||function(){var E=a(function(C,T){return E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,D){R.__proto__=D}||function(R,D){for(var k in D)Object.prototype.hasOwnProperty.call(D,k)&&(R[k]=D[k])},E(C,T)},"e");return function(C,T){E(C,T);function R(){this.constructor=C}a(R,"n"),C.prototype=T===null?Object.create(T):(R.prototype=T.prototype,new R)}}(),w=K(7310),x=pn(),g=hn(),u=Po(),h=bl(),v=J(),_=Ge(),b=_e(),y=function(E){f(C,E);function C(T,R){var D=E.call(this)||this;return T&&(D.method=T.method,D.url=D._getAbsoluteUrl(T),D.startTime=+new Date,D.socketRemoteAddress=T.socket&&T.socket.remoteAddress,D.parseHeaders(T,R),T.connection&&(D.connectionRemoteAddress=T.connection.remoteAddress,D.legacySocketRemoteAddress=T.connection.socket&&T.connection.socket.remoteAddress)),D}return a(C,"t"),C.prototype.onError=function(T,R){this._setStatus(void 0,T),R&&(this.duration=R)},C.prototype.onResponse=function(T,R){this._setStatus(T.statusCode,void 0),R&&(this.duration=R)},C.prototype.getRequestTelemetry=function(T){var R={id:this.requestId,name:this.method+" "+w.parse(this.url).pathname,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(T&&T.time?R.time=T.time:this.startTime&&(R.time=new Date(this.startTime)),T){for(var D in T)R[D]||(R[D]=T[D]);if(T.properties)for(var D in T.properties)R.properties[D]=T.properties[D]}return R},C.prototype.getRequestTags=function(T){var R={};for(var D in T)R[D]=T[D];return R[C.keys.locationIp]=T[C.keys.locationIp]||this._getIp(),R[C.keys.sessionId]=T[C.keys.sessionId]||this._getId("ai_session"),R[C.keys.userId]=T[C.keys.userId]||this._getId("ai_user"),R[C.keys.userAuthUserId]=T[C.keys.userAuthUserId]||this._getId("ai_authUser"),R[C.keys.operationName]=this.getOperationName(T),R[C.keys.operationParentId]=this.getOperationParentId(T),R[C.keys.operationId]=this.getOperationId(T),R},C.prototype.getOperationId=function(T){return T[C.keys.operationId]||this.operationId},C.prototype.getOperationParentId=function(T){return T[C.keys.operationParentId]||this.parentId||this.getOperationId(T)},C.prototype.getOperationName=function(T){return T[C.keys.operationName]||this.method+" "+w.parse(this.url).pathname},C.prototype.getRequestId=function(){return this.requestId},C.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},C.prototype.getTraceparent=function(){return this.traceparent},C.prototype.getTracestate=function(){return this.tracestate},C.prototype.getLegacyRootId=function(){return this.legacyRootId},C.prototype._getAbsoluteUrl=function(T){if(!T.headers)return T.url;var R=T.connection?T.connection.encrypted:null,D=w.parse(T.url),k=D.pathname,G=D.search,Z=R||T.headers["x-forwarded-proto"]=="https"?"https":"http",Q=w.format({protocol:Z,host:T.headers.host,pathname:k,search:G});return Q},C.prototype._getIp=function(){var T=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,R=a(function(k){var G=T.exec(k);if(G)return G[0]},"n"),D=R(this.rawHeaders["x-forwarded-for"])||R(this.rawHeaders["x-client-ip"])||R(this.rawHeaders["x-real-ip"])||R(this.connectionRemoteAddress)||R(this.socketRemoteAddress)||R(this.legacySocketRemoteAddress);return!D&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&this.connectionRemoteAddress.substr(0,2)==="::"&&(D="127.0.0.1"),D},C.prototype._getId=function(T){var R=this.rawHeaders&&this.rawHeaders.cookie&&typeof this.rawHeaders.cookie=="string"&&this.rawHeaders.cookie||"",D=C.parseId(g.getCookie(T,R));return D},C.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},C.prototype.parseHeaders=function(T,R){if(this.rawHeaders=T.headers||T.rawHeaders,this.userAgent=T.headers&&T.headers["user-agent"],this.sourceCorrelationId=g.getCorrelationContextTarget(T,u.requestContextSourceKey),T.headers){var D=T.headers[u.traceStateHeader]?T.headers[u.traceStateHeader].toString():null,k=T.headers[u.traceparentHeader]?T.headers[u.traceparentHeader].toString():null,G=T.headers[u.requestIdHeader]?T.headers[u.requestIdHeader].toString():null,Z=T.headers[u.parentIdHeader]?T.headers[u.parentIdHeader].toString():null,Q=T.headers[u.rootIdHeader]?T.headers[u.rootIdHeader].toString():null;this.correlationContextHeader=T.headers[u.correlationContextHeader]?T.headers[u.correlationContextHeader].toString():null,v.w3cEnabled&&(k||D)?(this.traceparent=new b(k?k.toString():null),this.tracestate=k&&D&&new _(D?D.toString():null),this.setBackCompatFromThisTraceContext()):G?v.w3cEnabled?(this.traceparent=new b(null,G),this.setBackCompatFromThisTraceContext()):(this.parentId=G,this.requestId=v.generateRequestId(this.parentId),this.operationId=v.getRootId(this.requestId)):v.w3cEnabled?(this.traceparent=new b,this.traceparent.parentId=Z,this.traceparent.legacyRootId=Q||Z,this.setBackCompatFromThisTraceContext()):(this.parentId=Z,this.requestId=v.generateRequestId(Q||this.parentId),this.correlationContextHeader=null,this.operationId=v.getRootId(this.requestId)),R&&(this.requestId=R,this.operationId=v.getRootId(this.requestId))}},C.parseId=function(T){var R=T.split("|");return R.length>0?R[0]:""},C.keys=new x.ContextTagKeys,C}(h);A.exports=y}),qn=$((s,A)=>{"use strict";function f(b){return typeof b=="function"}a(f,"pc");var w=console.error.bind(console);function x(b,y,E){var C=!!b[y]&&b.propertyIsEnumerable(y);Object.defineProperty(b,y,{configurable:!0,enumerable:C,writable:!0,value:E})}a(x,"gi");function g(b){b&&b.logger&&(f(b.logger)?w=b.logger:w("new logger isn't a function, not replacing"))}a(g,"vi");function u(b,y,E){if(!b||!b[y]){w("no original function "+y+" to wrap");return}if(!E){w("no wrapper function"),w(new Error().stack);return}if(!f(b[y])||!f(E)){w("original object and wrapper must be functions");return}var C=b[y],T=E(C,y);return x(T,"__original",C),x(T,"__unwrap",function(){b[y]===T&&x(b,y,C)}),x(T,"__wrapped",!0),x(b,y,T),T}a(u,"Rg");function h(b,y,E){if(b)Array.isArray(b)||(b=[b]);else{w("must provide one or more modules to patch"),w(new Error().stack);return}if(!(y&&Array.isArray(y))){w("must provide one or more functions to wrap on modules");return}b.forEach(function(C){y.forEach(function(T){u(C,T,E)})})}a(h,"ZO");function v(b,y){if(!b||!b[y]){w("no function to unwrap."),w(new Error().stack);return}if(!b[y].__unwrap)w("no original to unwrap to -- has "+y+" already been unwrapped?");else return b[y].__unwrap()}a(v,"Ng");function _(b,y){if(b)Array.isArray(b)||(b=[b]);else{w("must provide one or more modules to patch"),w(new Error().stack);return}if(!(y&&Array.isArray(y))){w("must provide one or more functions to unwrap on modules");return}b.forEach(function(E){y.forEach(function(C){v(E,C)})})}a(_,"JO"),g.wrap=u,g.massWrap=h,g.unwrap=v,g.massUnwrap=_,A.exports=g}),ya=$((s,A)=>{"use strict";var f=qn(),w=f.wrap,x=f.unwrap,g="wrap@before";function u(y,E,C){var T=!!y[E]&&y.propertyIsEnumerable(E);Object.defineProperty(y,E,{configurable:!0,enumerable:T,writable:!0,value:C})}a(u,"Rs");function h(y,E){for(var C=E.length,T=0;T<C;T++){var R=E[T],D=y[g];if(typeof D=="function")D(R);else if(Array.isArray(D))for(var k=D.length,G=0;G<k;G++)D[G](R)}}a(h,"eP");function v(y,E){var C;return C=y._events&&y._events[E],Array.isArray(C)||(C?C=[C]:C=[]),C}a(v,"Mg");function _(y,E,C){var T=v(y,E),R=T.filter(function(D){return C.indexOf(D)===-1});R.length>0&&h(y,R)}a(_,"tP");function b(y,E){if(y){var C=y;if(typeof y=="function")C=E(y);else if(Array.isArray(y)){C=[];for(var T=0;T<y.length;T++)C[T]=E(y[T])}return C}}a(b,"xg"),A.exports=function(y,E,C){if(!y||!y.on||!y.addListener||!y.removeListener||!y.emit)throw new Error("can only wrap real EEs");if(!E)throw new Error("must have function to run on listener addition");if(!C)throw new Error("must have function to wrap listeners when emitting");function T(D){return function(k,G){var Z=v(this,k).slice();try{var Q=D.call(this,k,G);return _(this,k,Z),Q}finally{this.on.__wrapped||w(this,"on",T),this.addListener.__wrapped||w(this,"addListener",T)}}}a(T,"i");function R(D){return function(k){if(!this._events||!this._events[k])return D.apply(this,arguments);var G=this._events[k];function Z(Q){return function(){this._events[k]=G;try{return Q.apply(this,arguments)}finally{G=this._events[k],this._events[k]=b(G,C)}}}a(Z,"p"),w(this,"removeListener",Z);try{return this._events[k]=b(G,C),D.apply(this,arguments)}finally{x(this,"removeListener"),this._events[k]=G}}}a(R,"a"),y[g]?typeof y[g]=="function"?u(y,g,[y[g],E]):Array.isArray(y[g])&&y[g].push(E):u(y,g,E),y.__wrapped||(w(y,"addListener",T),w(y,"on",T),w(y,"emit",R),u(y,"__unwrap",function(){x(y,"addListener"),x(y,"on"),x(y,"emit"),delete y[g],delete y.__wrapped}),u(y,"__wrapped",!0))}}),Du=$((s,A)=>{"use strict";var f=K(3837),w=K(9491),x=ya(),g=K(852),u="cls@contexts",h="error@context",v=process.env.DEBUG_CLS_HOOKED,_=-1;A.exports={getNamespace:y,createNamespace:E,destroyNamespace:C,reset:T,ERROR_SYMBOL:h};function b(D){this.name=D,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}a(b,"xe"),b.prototype.set=function(D,k){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");if(this.active[D]=k,v){let G=" ".repeat(this._indent<0?0:this._indent);R(G+"CONTEXT-SET KEY:"+D+"="+k+" in ns:"+this.name+" currentUid:"+_+" active:"+f.inspect(this.active,{showHidden:!0,depth:2,colors:!0}))}return k},b.prototype.get=function(D){if(!this.active){if(v){let k=g.currentId(),G=g.triggerAsyncId(),Z=" ".repeat(this._indent<0?0:this._indent);R(`${Z}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${D}=undefined currentUid:${_} asyncHooksCurrentId:${k} triggerId:${G} len:${this._set.length}`)}return}if(v){let k=g.executionAsyncId(),G=g.triggerAsyncId(),Z=" ".repeat(this._indent<0?0:this._indent);R(Z+"CONTEXT-GETTING KEY:"+D+"="+this.active[D]+" ("+this.name+") currentUid:"+_+" active:"+f.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),R(`${Z}CONTEXT-GETTING KEY: (${this.name}) ${D}=${this.active[D]} currentUid:${_} asyncHooksCurrentId:${k} triggerId:${G} len:${this._set.length} active:${f.inspect(this.active)}`)}return this.active[D]},b.prototype.createContext=function(){let D=Object.create(this.active?this.active:Object.prototype);if(D._ns_name=this.name,D.id=_,v){let k=g.executionAsyncId(),G=g.triggerAsyncId(),Z=" ".repeat(this._indent<0?0:this._indent);R(`${Z}CONTEXT-CREATED Context: (${this.name}) currentUid:${_} asyncHooksCurrentId:${k} triggerId:${G} len:${this._set.length} context:${f.inspect(D,{showHidden:!0,depth:2,colors:!0})}`)}return D},b.prototype.run=function(D){let k=this.createContext();this.enter(k);try{if(v){let G=g.triggerAsyncId(),Z=g.executionAsyncId(),Q=" ".repeat(this._indent<0?0:this._indent);R(`${Q}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${_} triggerId:${G} asyncHooksCurrentId:${Z} len:${this._set.length} context:${f.inspect(k)}`)}return D(k),k}catch(G){throw G&&(G[h]=k),G}finally{if(v){let G=g.triggerAsyncId(),Z=g.executionAsyncId(),Q=" ".repeat(this._indent<0?0:this._indent);R(`${Q}CONTEXT-RUN END: (${this.name}) currentUid:${_} triggerId:${G} asyncHooksCurrentId:${Z} len:${this._set.length} ${f.inspect(k)}`)}this.exit(k)}},b.prototype.runAndReturn=function(D){let k;return this.run(function(G){k=D(G)}),k},b.prototype.runPromise=function(D){let k=this.createContext();this.enter(k);let G=D(k);if(!G||!G.then||!G.catch)throw new Error("fn must return a promise.");return v&&R("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+_+" len:"+this._set.length+" "+f.inspect(k)),G.then(Z=>(v&&R("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+_+" len:"+this._set.length+" "+f.inspect(k)),this.exit(k),Z)).catch(Z=>{throw Z[h]=k,v&&R("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+_+" len:"+this._set.length+" "+f.inspect(k)),this.exit(k),Z})},b.prototype.bind=function(D,k){k||(this.active?k=this.active:k=this.createContext());let G=this;return function(){G.enter(k);try{return D.apply(this,arguments)}catch(Z){throw Z&&(Z[h]=k),Z}finally{G.exit(k)}}},b.prototype.enter=function(D){if(w.ok(D,"context must be provided for entering"),v){let k=g.executionAsyncId(),G=g.triggerAsyncId(),Z=" ".repeat(this._indent<0?0:this._indent);R(`${Z}CONTEXT-ENTER: (${this.name}) currentUid:${_} triggerId:${G} asyncHooksCurrentId:${k} len:${this._set.length} ${f.inspect(D)}`)}this._set.push(this.active),this.active=D},b.prototype.exit=function(D){if(w.ok(D,"context must be provided for exiting"),v){let G=g.executionAsyncId(),Z=g.triggerAsyncId(),Q=" ".repeat(this._indent<0?0:this._indent);R(`${Q}CONTEXT-EXIT: (${this.name}) currentUid:${_} triggerId:${Z} asyncHooksCurrentId:${G} len:${this._set.length} ${f.inspect(D)}`)}if(this.active===D){w.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let k=this._set.lastIndexOf(D);k<0?(v&&R("??ERROR?? context exiting but not entered - ignoring: "+f.inspect(D)),w.ok(k>=0,`context not currently entered; can't exit. 
`+f.inspect(this)+`
`+f.inspect(D))):(w.ok(k,"can't remove top context"),this._set.splice(k,1))},b.prototype.bindEmitter=function(D){w.ok(D.on&&D.addListener&&D.emit,"can only bind real EEs");let k=this,G="context@"+this.name;function Z(fe){!fe||(fe[u]||(fe[u]=Object.create(null)),fe[u][G]={namespace:k,context:k.active})}a(Z,"i");function Q(fe){if(!(fe&&fe[u]))return fe;let Ee=fe,Pe=fe[u];return Object.keys(Pe).forEach(function(He){let Qe=Pe[He];Ee=Qe.namespace.bind(Ee,Qe.context)}),Ee}a(Q,"a"),x(D,Z,Q)},b.prototype.fromException=function(D){return D[h]};function y(D){return process.namespaces[D]}a(y,"qg");function E(D){w.ok(D,"namespace must be given a name."),v&&R(`NS-CREATING NAMESPACE (${D})`);let k=new b(D);return k.id=_,g.createHook({init(G,Z,Q,fe){if(_=g.executionAsyncId(),k.active){if(k._contexts.set(G,k.active),v){let Ee=" ".repeat(k._indent<0?0:k._indent);R(`${Ee}INIT [${Z}] (${D}) asyncId:${G} currentUid:${_} triggerId:${Q} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} resource:${fe}`)}}else if(_===0){let Ee=g.triggerAsyncId(),Pe=k._contexts.get(Ee);if(Pe){if(k._contexts.set(G,Pe),v){let He=" ".repeat(k._indent<0?0:k._indent);R(`${He}INIT USING CONTEXT FROM TRIGGERID [${Z}] (${D}) asyncId:${G} currentUid:${_} triggerId:${Ee} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} resource:${fe}`)}}else if(v){let He=" ".repeat(k._indent<0?0:k._indent);R(`${He}INIT MISSING CONTEXT [${Z}] (${D}) asyncId:${G} currentUid:${_} triggerId:${Ee} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} resource:${fe}`)}}if(v&&Z==="PROMISE"){R(f.inspect(fe,{showHidden:!0}));let Ee=fe.parentId,Pe=" ".repeat(k._indent<0?0:k._indent);R(`${Pe}INIT RESOURCE-PROMISE [${Z}] (${D}) parentId:${Ee} asyncId:${G} currentUid:${_} triggerId:${Q} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} resource:${fe}`)}},before(G){_=g.executionAsyncId();let Z;if(Z=k._contexts.get(G)||k._contexts.get(_),Z){if(v){let Q=g.triggerAsyncId(),fe=" ".repeat(k._indent<0?0:k._indent);R(`${fe}BEFORE (${D}) asyncId:${G} currentUid:${_} triggerId:${Q} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} context:${f.inspect(Z)}`),k._indent+=2}k.enter(Z)}else if(v){let Q=g.triggerAsyncId(),fe=" ".repeat(k._indent<0?0:k._indent);R(`${fe}BEFORE MISSING CONTEXT (${D}) asyncId:${G} currentUid:${_} triggerId:${Q} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} namespace._contexts:${f.inspect(k._contexts,{showHidden:!0,depth:2,colors:!0})}`),k._indent+=2}},after(G){_=g.executionAsyncId();let Z;if(Z=k._contexts.get(G)||k._contexts.get(_),Z){if(v){let Q=g.triggerAsyncId();k._indent-=2;let fe=" ".repeat(k._indent<0?0:k._indent);R(`${fe}AFTER (${D}) asyncId:${G} currentUid:${_} triggerId:${Q} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} context:${f.inspect(Z)}`)}k.exit(Z)}else if(v){let Q=g.triggerAsyncId();k._indent-=2;let fe=" ".repeat(k._indent<0?0:k._indent);R(`${fe}AFTER MISSING CONTEXT (${D}) asyncId:${G} currentUid:${_} triggerId:${Q} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} context:${f.inspect(Z)}`)}},destroy(G){if(_=g.executionAsyncId(),v){let Z=g.triggerAsyncId(),Q=" ".repeat(k._indent<0?0:k._indent);R(`${Q}DESTROY (${D}) currentUid:${_} asyncId:${G} triggerId:${Z} active:${f.inspect(k.active,{showHidden:!0,depth:2,colors:!0})} context:${f.inspect(k._contexts.get(_))}`)}k._contexts.delete(G)}}).enable(),process.namespaces[D]=k,k}a(E,"nP");function C(D){let k=y(D);w.ok(k,`can't delete nonexistent namespace! "`+D+'"'),w.ok(k.id,"don't assign to process.namespaces directly! "+f.inspect(k)),process.namespaces[D]=null}a(C,"kg");function T(){process.namespaces&&Object.keys(process.namespaces).forEach(function(D){C(D)}),process.namespaces=Object.create(null)}a(T,"iP"),process.namespaces={};function R(...D){v&&process._rawDebug(`${f.format(...D)}`)}a(R,"j")}),tr=$((s,A)=>{"use strict";function f(){}a(f,"aP"),A.exports=function(){let w=this._hooks,x=this._state,g=process.nextTick;process.nextTick=function(){if(!x.enabled)return g.apply(process,arguments);let u=new Array(arguments.length);for(let b=0;b<arguments.length;b++)u[b]=arguments[b];let h=u[0];if(typeof h!="function")throw new TypeError("callback is not a function");let v=new f,_=--x.counter;return w.init.call(v,_,0,null,null),u[0]=function(){w.pre.call(v,_);let b=!0;try{h.apply(this,arguments),b=!1}finally{b&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){w.post.call(v,_,!0),w.destroy.call(null,_)})}w.post.call(v,_,!1),w.destroy.call(null,_)},g.apply(process,u)}}}),ku=$((s,A)=>{"use strict";function f(){}a(f,"sP"),A.exports=function(){let w=this._hooks,x=this._state,g=global.Promise,u=g.prototype.then;g.prototype.then=b;function h(y,E,C,T){return typeof y!="function"?T?v(C):_(C):function(){w.pre.call(E,C);try{return y.apply(this,arguments)}finally{w.post.call(E,C,!1),w.destroy.call(null,C)}}}a(h,"a");function v(y){return function(E){return w.destroy.call(null,y),E}}a(v,"s");function _(y){return function(E){throw w.destroy.call(null,y),E}}a(_,"o");function b(y,E){if(!x.enabled)return u.call(this,y,E);let C=new f,T=--x.counter;return w.init.call(C,T,0,null,null),u.call(this,h(y,C,T,!0),h(E,C,T,!1))}a(b,"u")}}),Nu=$((s,A)=>{"use strict";var f=K(9512);function w(){}a(w,"oP");function x(){}a(x,"uP");function g(){}a(g,"cP");var u=new Map,h=new Map,v=new Map,_=null,b=!1;A.exports=function(){y(this._hooks,this._state,"setTimeout","clearTimeout",w,u,!0),y(this._hooks,this._state,"setInterval","clearInterval",x,h,!1),y(this._hooks,this._state,"setImmediate","clearImmediate",g,v,!0),global.setTimeout=f.setTimeout,global.setInterval=f.setInterval,global.setImmediate=f.setImmediate,global.clearTimeout=f.clearTimeout,global.clearInterval=f.clearInterval,global.clearImmediate=f.clearImmediate};function y(E,C,T,R,D,k,G){let Z=f[T],Q=f[R];f[T]=function(){if(!C.enabled)return Z.apply(f,arguments);let fe=new Array(arguments.length);for(let tt=0;tt<arguments.length;tt++)fe[tt]=arguments[tt];let Ee=fe[0];if(typeof Ee!="function")throw new TypeError('"callback" argument must be a function');let Pe=new D,He=--C.counter,Qe;return E.init.call(Pe,He,0,null,null),fe[0]=function(){_=Qe,E.pre.call(Pe,He);let tt=!0;try{Ee.apply(this,arguments),tt=!1}finally{tt&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){E.post.call(Pe,He,!0),k.delete(Qe),E.destroy.call(null,He)})}E.post.call(Pe,He,!1),_=null,(G||b)&&(b=!1,k.delete(Qe),E.destroy.call(null,He))},Qe=Z.apply(f,fe),k.set(Qe,He),Qe},f[R]=function(fe){if(_===fe&&fe!==null)b=!0;else if(k.has(fe)){let Ee=k.get(fe);k.delete(fe),E.destroy.call(null,Ee)}Q.apply(f,arguments)}}a(y,"hc")}),bn=$((s,A)=>{A.exports={name:"async-hook-jl",description:"Inspect the life of handle objects in node",version:"1.7.6",author:"Andreas Madsen <amwebdk@gmail.com>",main:"./index.js",scripts:{test:"node ./test/runner.js && eslint ."},repository:{type:"git",url:"git://github.com/jeff-lewis/async-hook-jl.git"},keywords:["async","async hooks","inspect","async wrap"],license:"MIT",dependencies:{"stack-chain":"^1.3.7"},devDependencies:{async:"1.5.x","cli-color":"1.1.x",eslint:"^3.4.0",endpoint:"0.4.x"},engines:{node:"^4.7 || >=6.9 || >=7.3"}}}),ii=$((s,A)=>{"use strict";var f=process.binding("async_wrap"),w=f.Providers.TIMERWRAP,x={nextTick:tr(),promise:ku(),timers:Nu()},g=new Set;function u(){this.enabled=!1,this.counter=0}a(u,"_P");function h(){let b=this.initFns=[],y=this.preFns=[],E=this.postFns=[],C=this.destroyFns=[];this.init=function(T,R,D,k){if(R===w){g.add(T);return}for(let G of b)G(T,this,R,D,k)},this.pre=function(T){if(!g.has(T))for(let R of y)R(T,this)},this.post=function(T,R){if(!g.has(T))for(let D of E)D(T,this,R)},this.destroy=function(T){if(g.has(T)){g.delete(T);return}for(let R of C)R(T)}}a(h,"gc"),h.prototype.add=function(b){b.init&&this.initFns.push(b.init),b.pre&&this.preFns.push(b.pre),b.post&&this.postFns.push(b.post),b.destroy&&this.destroyFns.push(b.destroy)};function v(b,y){let E=b.indexOf(y);E!==-1&&b.splice(E,1)}a(v,"Ds"),h.prototype.remove=function(b){b.init&&v(this.initFns,b.init),b.pre&&v(this.preFns,b.pre),b.post&&v(this.postFns,b.post),b.destroy&&v(this.destroyFns,b.destroy)};function _(){this._state=new u,this._hooks=new h,this.version=bn().version,this.providers=f.Providers;for(let b of Object.keys(x))x[b].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),f.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}a(_,"Si"),A.exports=_,_.prototype.addHooks=function(b){this._hooks.add(b)},_.prototype.removeHooks=function(b){this._hooks.remove(b)},_.prototype.enable=function(){this._state.enabled=!0,f.enable()},_.prototype.disable=function(){this._state.enabled=!1,f.disable()}}),hc=$((s,A)=>{A.exports={name:"stack-chain",description:"API for combining call site modifiers",version:"1.3.7",author:"Andreas Madsen <amwebdk@gmail.com>",scripts:{test:"tap ./test/simple"},repository:{type:"git",url:"git://github.com/AndreasMadsen/stack-chain.git"},keywords:["stack","chain","trace","call site","concat","format"],devDependencies:{tap:"2.x.x","uglify-js":"2.5.x"},license:"MIT"}}),No=$((s,A)=>{function f(w){try{return Error.prototype.toString.call(w)}catch(x){try{return"<error: "+x+">"}catch(g){return"<error>"}}}a(f,"vP"),A.exports=function(w,x){var g=[];g.push(f(w));for(var u=0;u<x.length;u++){var h=x[u],v;try{v=h.toString()}catch(_){try{v="<error: "+_+">"}catch(b){v="<error>"}}g.push("    at "+v)}return g.join(`
`)}}),Mo=$((s,A)=>{var f=No();function w(){this.extend=new u,this.filter=new u,this.format=new h,this.version=hc().version}a(w,"Wg");var x=!1;w.prototype.callSite=a(function y(E){E||(E={}),x=!0;var C={};Error.captureStackTrace(C,y);var T=C.stack;return x=!1,T=T.slice(E.slice||0),E.extend&&(T=this.extend._modify(C,T)),E.filter&&(T=this.filter._modify(C,T)),T},"e");var g=new w;function u(){this._modifiers=[]}a(u,"Ai"),u.prototype._modify=function(y,E){for(var C=0,T=this._modifiers.length;C<T;C++)E=this._modifiers[C](y,E);return E},u.prototype.attach=function(y){this._modifiers.push(y)},u.prototype.deattach=function(y){var E=this._modifiers.indexOf(y);return E===-1?!1:(this._modifiers.splice(E,1),!0)};function h(){this._formater=f,this._previous=void 0}a(h,"bi"),h.prototype.replace=function(y){y?this._formater=y:this.restore()},h.prototype.restore=function(){this._formater=f,this._previous=void 0},h.prototype._backup=function(){this._previous=this._formater},h.prototype._roolback=function(){this._previous===f?this.replace(void 0):this.replace(this._previous),this._previous=void 0},Error.prepareStackTrace&&g.format.replace(Error.prepareStackTrace);var v=!1;function _(y,E){if(x)return E;if(v)return f(y,E);var C=E.concat();C=g.extend._modify(y,C),C=g.filter._modify(y,C),C=C.slice(0,Error.stackTraceLimit),Object.isExtensible(y)&&Object.getOwnPropertyDescriptor(y,"callSite")===void 0&&(y.callSite={original:E,mutated:C}),v=!0;var T=g.format._formater(y,C);return v=!1,T}a(_,"Zg"),Object.defineProperty(Error,"prepareStackTrace",{get:function(){return _},set:function(y){y===_?g.format._roolback():(g.format._backup(),g.format.replace(y))}});function b(){return this.stack,this.callSite}a(b,"mP"),Object.defineProperty(Error.prototype,"callSite",{get:b,set:function(y){Object.defineProperty(this,"callSite",{value:y,writable:!0,configurable:!0})},configurable:!0}),A.exports=g}),oi=$((s,A)=>{if(global._stackChain)if(global._stackChain.version===hc().version)A.exports=global._stackChain;else throw new Error("Conflicting version of stack-chain found");else A.exports=global._stackChain=Mo()}),Sl=$((s,A)=>{"use strict";var f=ii();if(global._asyncHook)if(global._asyncHook.version===bn().version)A.exports=global._asyncHook;else throw new Error("Conflicting version of async-hook-jl found");else oi().filter.attach(function(w,x){return x.filter(function(g){let u=g.getFileName();return!(u&&u.slice(0,__dirname.length)===__dirname)})}),A.exports=global._asyncHook=new f}),fc=$((s,A)=>{"use strict";var f=K(3837),w=K(9491),x=ya(),g=Sl(),u="cls@contexts",h="error@context",v=[];for(let Q in g.providers)v[g.providers[Q]]=Q;var _=process.env.DEBUG_CLS_HOOKED,b=-1;A.exports={getNamespace:E,createNamespace:C,destroyNamespace:T,reset:R,ERROR_SYMBOL:h};function y(Q){this.name=Q,this.active=null,this._set=[],this.id=null,this._contexts=new Map}a(y,"Le"),y.prototype.set=function(Q,fe){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return _&&D("    SETTING KEY:"+Q+"="+fe+" in ns:"+this.name+" uid:"+b+" active:"+f.inspect(this.active,!0)),this.active[Q]=fe,fe},y.prototype.get=function(Q){if(!this.active){_&&D("    GETTING KEY:"+Q+"=undefined "+this.name+" uid:"+b+" active:"+f.inspect(this.active,!0));return}return _&&D("    GETTING KEY:"+Q+"="+this.active[Q]+" "+this.name+" uid:"+b+" active:"+f.inspect(this.active,!0)),this.active[Q]},y.prototype.createContext=function(){_&&D("   CREATING Context: "+this.name+" uid:"+b+" len:"+this._set.length+"  active:"+f.inspect(this.active,!0,2,!0));let Q=Object.create(this.active?this.active:Object.prototype);return Q._ns_name=this.name,Q.id=b,_&&D("   CREATED Context: "+this.name+" uid:"+b+" len:"+this._set.length+"  context:"+f.inspect(Q,!0,2,!0)),Q},y.prototype.run=function(Q){let fe=this.createContext();this.enter(fe);try{return _&&D(" BEFORE RUN: "+this.name+" uid:"+b+" len:"+this._set.length+" "+f.inspect(fe)),Q(fe),fe}catch(Ee){throw Ee&&(Ee[h]=fe),Ee}finally{_&&D(" AFTER RUN: "+this.name+" uid:"+b+" len:"+this._set.length+" "+f.inspect(fe)),this.exit(fe)}},y.prototype.runAndReturn=function(Q){var fe;return this.run(function(Ee){fe=Q(Ee)}),fe},y.prototype.runPromise=function(Q){let fe=this.createContext();this.enter(fe);let Ee=Q(fe);if(!Ee||!Ee.then||!Ee.catch)throw new Error("fn must return a promise.");return _&&D(" BEFORE runPromise: "+this.name+" uid:"+b+" len:"+this._set.length+" "+f.inspect(fe)),Ee.then(Pe=>(_&&D(" AFTER runPromise: "+this.name+" uid:"+b+" len:"+this._set.length+" "+f.inspect(fe)),this.exit(fe),Pe)).catch(Pe=>{throw Pe[h]=fe,_&&D(" AFTER runPromise: "+this.name+" uid:"+b+" len:"+this._set.length+" "+f.inspect(fe)),this.exit(fe),Pe})},y.prototype.bind=function(Q,fe){fe||(this.active?fe=this.active:fe=this.createContext());let Ee=this;return function(){Ee.enter(fe);try{return Q.apply(this,arguments)}catch(Pe){throw Pe&&(Pe[h]=fe),Pe}finally{Ee.exit(fe)}}},y.prototype.enter=function(Q){w.ok(Q,"context must be provided for entering"),_&&D("  ENTER "+this.name+" uid:"+b+" len:"+this._set.length+" context: "+f.inspect(Q)),this._set.push(this.active),this.active=Q},y.prototype.exit=function(Q){if(w.ok(Q,"context must be provided for exiting"),_&&D("  EXIT "+this.name+" uid:"+b+" len:"+this._set.length+" context: "+f.inspect(Q)),this.active===Q){w.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let fe=this._set.lastIndexOf(Q);fe<0?(_&&D("??ERROR?? context exiting but not entered - ignoring: "+f.inspect(Q)),w.ok(fe>=0,`context not currently entered; can't exit. 
`+f.inspect(this)+`
`+f.inspect(Q))):(w.ok(fe,"can't remove top context"),this._set.splice(fe,1))},y.prototype.bindEmitter=function(Q){w.ok(Q.on&&Q.addListener&&Q.emit,"can only bind real EEs");let fe=this,Ee="context@"+this.name;function Pe(Qe){!Qe||(Qe[u]||(Qe[u]=Object.create(null)),Qe[u][Ee]={namespace:fe,context:fe.active})}a(Pe,"i");function He(Qe){if(!(Qe&&Qe[u]))return Qe;let tt=Qe,mt=Qe[u];return Object.keys(mt).forEach(function(bt){let jt=mt[bt];tt=jt.namespace.bind(tt,jt.context)}),tt}a(He,"a"),x(Q,Pe,He)},y.prototype.fromException=function(Q){return Q[h]};function E(Q){return process.namespaces[Q]}a(E,"nv");function C(Q){w.ok(Q,"namespace must be given a name."),_&&D("CREATING NAMESPACE "+Q);let fe=new y(Q);return fe.id=b,g.addHooks({init(Ee,Pe,He,Qe,tt){b=Ee,Qe?(fe._contexts.set(Ee,fe._contexts.get(Qe)),_&&D("PARENTID: "+Q+" uid:"+Ee+" parent:"+Qe+" provider:"+He)):fe._contexts.set(b,fe.active),_&&D("INIT "+Q+" uid:"+Ee+" parent:"+Qe+" provider:"+v[He]+" active:"+f.inspect(fe.active,!0))},pre(Ee,Pe){b=Ee;let He=fe._contexts.get(Ee);He?(_&&D(" PRE "+Q+" uid:"+Ee+" handle:"+k(Pe)+" context:"+f.inspect(He)),fe.enter(He)):_&&D(" PRE MISSING CONTEXT "+Q+" uid:"+Ee+" handle:"+k(Pe))},post(Ee,Pe){b=Ee;let He=fe._contexts.get(Ee);He?(_&&D(" POST "+Q+" uid:"+Ee+" handle:"+k(Pe)+" context:"+f.inspect(He)),fe.exit(He)):_&&D(" POST MISSING CONTEXT "+Q+" uid:"+Ee+" handle:"+k(Pe))},destroy(Ee){b=Ee,_&&D("DESTROY "+Q+" uid:"+Ee+" context:"+f.inspect(fe._contexts.get(b))+" active:"+f.inspect(fe.active,!0)),fe._contexts.delete(Ee)}}),process.namespaces[Q]=fe,fe}a(C,"TP");function T(Q){let fe=E(Q);w.ok(fe,`can't delete nonexistent namespace! "`+Q+'"'),w.ok(fe.id,"don't assign to process.namespaces directly! "+f.inspect(fe)),process.namespaces[Q]=null}a(T,"iv");function R(){process.namespaces&&Object.keys(process.namespaces).forEach(function(Q){T(Q)}),process.namespaces=Object.create(null)}a(R,"SP"),process.namespaces={},g._state&&!g._state.enabled&&g.enable();function D(Q){process.env.DEBUG&&process._rawDebug(Q)}a(D,"Q");function k(Q){if(!Q)return Q;if(typeof Q=="function")return Q.name?Q.name:(Q.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1];if(Q.constructor&&Q.constructor.name)return Q.constructor.name}if(a(k,"Ms"),_){G=oi();for(Z in G.filter._modifiers)G.filter.deattach(Z)}var G,Z}),Mu=$((s,A)=>{"use strict";var f=Se();process&&f.gte(process.versions.node,"8.0.0")?A.exports=Du():A.exports=fc()}),Lu=$((s,A)=>{var f=qn().wrap,w=1<<0,x=1<<1,g=1<<2,u=1<<3,h=[],v=0,_=!1,b=[],y,E;function C(Pe,He){var Qe=Pe.length,tt=He.length,mt=[];if(Qe===0&&tt===0)return mt;for(var bt=0;bt<Qe;bt++)mt[bt]=Pe[bt];if(tt===0)return mt;for(var jt=0;jt<tt;jt++){var Bt=!0;for(bt=0;bt<Qe;bt++)if(Pe[bt].uid===He[jt].uid){Bt=!1;break}Bt&&mt.push(He[jt])}return mt}a(C,"Rc"),process._fatalException?(T=!1,y=a(function(Pe){var He=h.length;if(T||He===0)return!1;var Qe=!1;T=!0;for(var tt=0;tt<He;++tt){var mt=h[tt];if((mt.flags&u)!=0){var bt=R&&R[mt.uid];Qe=mt.error(bt,Pe)||Qe}}return T=!1,b.length>0&&(h=b.pop()),R=void 0,Qe&&!_},"hn"),E=a(function(Pe,He,Qe){var tt=[];_=!0;for(var mt=0;mt<Qe;++mt){var bt=He[mt];if(tt[bt.uid]=bt.data,(bt.flags&w)!=0){var jt=bt.create(bt.data);jt!==void 0&&(tt[bt.uid]=jt)}}return _=!1,function(){R=tt,b.push(h),h=C(He,h),_=!0;for(var Bt=0;Bt<Qe;++Bt)(He[Bt].flags&x)>0&&He[Bt].before(this,tt[He[Bt].uid]);_=!1;var Tr=Pe.apply(this,arguments);for(_=!0,Bt=0;Bt<Qe;++Bt)(He[Bt].flags&g)>0&&He[Bt].after(this,tt[He[Bt].uid]);return _=!1,h=b.pop(),R=void 0,Tr}},"Pc"),f(process,"_fatalException",function(Pe){return function(He){return y(He)||Pe(He)}})):(D=!1,y=a(function(Pe){if(D)throw Pe;for(var He=!1,Qe=h.length,tt=0;tt<Qe;++tt){var mt=h[tt];(mt.flags&u)!=0&&(He=mt.error(null,Pe)||He)}if(!He&&_)throw Pe},"hn"),E=a(function(Pe,He,Qe){var tt=[];_=!0;for(var mt=0;mt<Qe;++mt){var bt=He[mt];if(tt[bt.uid]=bt.data,(bt.flags&w)!=0){var jt=bt.create(bt.data);jt!==void 0&&(tt[bt.uid]=jt)}}return _=!1,function(){var Bt=!1,Tr=!1;b.push(h),h=C(He,h),_=!0;for(var Mt=0;Mt<Qe;++Mt)(He[Mt].flags&x)>0&&He[Mt].before(this,tt[He[Mt].uid]);_=!1;var Ze;try{Ze=Pe.apply(this,arguments)}catch(ht){Bt=!0;for(var Mt=0;Mt<Qe;++Mt)if((h[Mt].flags&u)!=0)try{Tr=h[Mt].error(tt[He[Mt].uid],ht)||Tr}catch(xt){throw D=!0,xt}if(!Tr)throw process.removeListener("uncaughtException",y),process._originalNextTick(function(){process.addListener("uncaughtException",y)}),ht}finally{if(!Bt||Tr){for(_=!0,Mt=0;Mt<Qe;++Mt)(He[Mt].flags&g)>0&&He[Mt].after(this,tt[He[Mt].uid]);_=!1}h=b.pop()}return Ze}},"Pc"),process.addListener("uncaughtException",y));var T,R,D;function k(Pe,He,Qe){_=!0;for(var tt=0;tt<Qe;++tt){var mt=He[tt];mt.create&&mt.create(mt.data)}return _=!1,function(){b.push(h),h=C(He,h);var bt=Pe.apply(this,arguments);return h=b.pop(),bt}}a(k,"CP");function G(Pe){var He=h.length;if(He===0)return Pe;for(var Qe=h.slice(),tt=0;tt<He;++tt)if(Qe[tt].flags>0)return E(Pe,Qe,He);return k(Pe,Qe,He)}a(G,"OP");function Z(Pe,He){typeof Pe.create=="function"&&(this.create=Pe.create,this.flags|=w),typeof Pe.before=="function"&&(this.before=Pe.before,this.flags|=x),typeof Pe.after=="function"&&(this.after=Pe.after,this.flags|=g),typeof Pe.error=="function"&&(this.error=Pe.error,this.flags|=u),this.uid=++v,this.data=He===void 0?null:He}a(Z,"Ze"),Z.prototype.create=void 0,Z.prototype.before=void 0,Z.prototype.after=void 0,Z.prototype.error=void 0,Z.prototype.data=void 0,Z.prototype.uid=0,Z.prototype.flags=0;function Q(Pe,He){if(typeof Pe!="object"||!Pe)throw new TypeError("callbacks argument must be an object");return Pe instanceof Z?Pe:new Z(Pe,He)}a(Q,"cv");function fe(Pe,He){var Qe;Pe instanceof Z?Qe=Pe:Qe=Q(Pe,He);for(var tt=!1,mt=0;mt<h.length;mt++)if(Qe===h[mt]){tt=!0;break}return tt||h.push(Qe),Qe}a(fe,"PP");function Ee(Pe){for(var He=0;He<h.length;He++)if(Pe===h[He]){h.splice(He,1);break}}a(Ee,"RP"),process.createAsyncListener=Q,process.addAsyncListener=fe,process.removeAsyncListener=Ee,A.exports=G}),ds=$((s,A)=>{"use strict";A.exports=(f,w)=>class extends f{constructor(x){var g,u;super(v);var h=this;try{x.apply(g,u)}catch(_){u[1](_)}return h;function v(_,b){g=this,u=[y,E];function y(C){return w(h,!1),_(C)}a(y,"p");function E(C){return w(h,!1),b(C)}a(E,"f")}}}}),Li=$(()=>{"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var s=qn(),A=Se(),f=s.wrap,w=s.massWrap,x=Lu(),g=K(3837),u=A.gte(process.version,"6.0.0"),h=A.gte(process.version,"7.0.0"),v=A.gte(process.version,"8.0.0"),_=A.gte(process.version,"11.0.0"),b=K(1808);h&&!b._normalizeArgs?b._normalizeArgs=function(Ze){if(Ze.length===0)return[{},null];var ht=Ze[0],dt={};typeof ht=="object"&&ht!==null?dt=ht:Mt(ht)?dt.path=ht:(dt.port=ht,Ze.length>1&&typeof Ze[1]=="string"&&(dt.host=Ze[1]));var xt=Ze[Ze.length-1];return typeof xt!="function"?[dt,null]:[dt,xt]}:!h&&!b._normalizeConnectArgs&&(b._normalizeConnectArgs=function(Ze){var ht={};function dt(Lt){return(Lt=Number(Lt))>=0?Lt:!1}a(dt,"r"),typeof Ze[0]=="object"&&Ze[0]!==null?ht=Ze[0]:typeof Ze[0]=="string"&&dt(Ze[0])===!1?ht.path=Ze[0]:(ht.port=Ze[0],typeof Ze[1]=="string"&&(ht.host=Ze[1]));var xt=Ze[Ze.length-1];return typeof xt=="function"?[ht,xt]:[ht]}),"_setUpListenHandle"in b.Server.prototype?f(b.Server.prototype,"_setUpListenHandle",y):f(b.Server.prototype,"_listen2",y);function y(Ze){return function(){this.on("connection",function(ht){ht._handle&&(ht._handle.onread=x(ht._handle.onread))});try{return Ze.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=x(this._handle.onconnection))}}}a(y,"_v");function E(Ze){if(Ze&&Ze._handle){var ht=Ze._handle;ht._originalOnread||(ht._originalOnread=ht.onread),ht.onread=x(ht._originalOnread)}}a(E,"gv"),f(b.Socket.prototype,"connect",function(Ze){return function(){var ht;v&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?ht=arguments[0]:ht=h?b._normalizeArgs(arguments):b._normalizeConnectArgs(arguments),ht[1]&&(ht[1]=x(ht[1]));var dt=Ze.apply(this,ht);return E(this),dt}});var C=K(3685);f(C.Agent.prototype,"addRequest",function(Ze){return function(ht){var dt=ht.onSocket;return ht.onSocket=x(function(xt){return E(xt),dt.apply(this,arguments)}),Ze.apply(this,arguments)}});var T=K(2081);function R(Ze){Array.isArray(Ze.stdio)&&Ze.stdio.forEach(function(ht){ht&&ht._handle&&(ht._handle.onread=x(ht._handle.onread),f(ht._handle,"close",Bt))}),Ze._handle&&(Ze._handle.onexit=x(Ze._handle.onexit))}a(R,"vv"),T.ChildProcess?f(T.ChildProcess.prototype,"spawn",function(Ze){return function(){var ht=Ze.apply(this,arguments);return R(this),ht}}):w(T,["execFile","fork","spawn"],function(Ze){return function(){var ht=Ze.apply(this,arguments);return R(ht),ht}}),process._fatalException||(process._originalNextTick=process.nextTick);var D=[];process._nextDomainTick&&D.push("_nextDomainTick"),process._tickDomainCallback&&D.push("_tickDomainCallback"),w(process,D,jt),f(process,"nextTick",Bt);var k=["setTimeout","setInterval"];global.setImmediate&&k.push("setImmediate");var G=K(9512),Z=global.setTimeout===G.setTimeout;w(G,k,Bt),Z&&w(global,k,Bt);var Q=K(9523);w(Q,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],jt),Q.resolveNaptr&&f(Q,"resolveNaptr",jt);var fe=K(7147);w(fe,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],jt),fe.lchown&&f(fe,"lchown",jt),fe.lchmod&&f(fe,"lchmod",jt),fe.ftruncate&&f(fe,"ftruncate",jt);var Ee;try{Ee=K(9796)}catch(Ze){}Ee&&Ee.Deflate&&Ee.Deflate.prototype&&(Pe=Object.getPrototypeOf(Ee.Deflate.prototype),Pe._transform?f(Pe,"_transform",jt):Pe.write&&Pe.flush&&Pe.end&&w(Pe,["write","flush","end"],jt));var Pe,He;try{He=K(6113)}catch(Ze){}He&&(Qe=["pbkdf2","randomBytes"],_||Qe.push("pseudoRandomBytes"),w(He,Qe,jt));var Qe,tt=!!global.Promise&&Promise.toString()==="function Promise() { [native code] }"&&Promise.toString.toString()==="function toString() { [native code] }";tt&&(mt=process.addAsyncListener({create:function(){tt=!1}}),global.Promise.resolve(!0).then(function(){tt=!1}),process.removeAsyncListener(mt));var mt;tt&&bt();function bt(){var Ze=global.Promise;function ht(Tt){if(!(this instanceof ht))return Ze(Tt);if(typeof Tt!="function")return new Ze(Tt);var Qt,Dr,vr=new Ze(yr);vr.__proto__=ht.prototype;try{Tt.apply(Qt,Dr)}catch(ir){Dr[1](ir)}return vr;function yr(ir,Fr){Qt=this,Dr=[mn,Ot];function mn(At){return xt(vr,!1),ir(At)}a(mn,"_");function Ot(At){return xt(vr,!1),Fr(At)}a(Ot,"g")}}if(a(ht,"t"),g.inherits(ht,Ze),f(Ze.prototype,"then",qt),Ze.prototype.chain&&f(Ze.prototype,"chain",qt),u)global.Promise=ds()(Ze,xt);else{var dt=["all","race","reject","resolve","accept","defer"];dt.forEach(function(Tt){typeof Ze[Tt]=="function"&&(ht[Tt]=Ze[Tt])}),global.Promise=ht}function xt(Tt,Qt){(!Tt.__asl_wrapper||Qt)&&(Tt.__asl_wrapper=x(Lt))}a(xt,"n");function Lt(Tt,Qt,Dr,vr){var yr;try{return yr=Qt.call(Tt,Dr),{returnVal:yr,error:!1}}catch(ir){return{errorVal:ir,error:!0}}finally{yr instanceof Ze?vr.__asl_wrapper=function(){var ir=yr.__asl_wrapper||Lt;return ir.apply(this,arguments)}:xt(vr,!0)}}a(Lt,"i");function qt(Tt){return function(){var Qt=this,Dr=Tt.apply(Qt,Array.prototype.map.call(arguments,vr));return Dr.__asl_wrapper=function(yr,ir,Fr,mn){return Qt.__asl_wrapper?(Qt.__asl_wrapper(yr,function(){},null,Dr),Dr.__asl_wrapper(yr,ir,Fr,mn)):Lt(yr,ir,Fr,mn)},Dr;function vr(yr){return typeof yr!="function"?yr:x(function(ir){var Fr=(Qt.__asl_wrapper||Lt)(this,yr,ir,Dr);if(Fr.error)throw Fr.errorVal;return Fr.returnVal})}}}a(qt,"a")}a(bt,"qP");function jt(Ze){var ht=a(function(){var dt,xt=arguments.length-1;if(typeof arguments[xt]=="function"){dt=Array(arguments.length);for(var Lt=0;Lt<arguments.length-1;Lt++)dt[Lt]=arguments[Lt];dt[xt]=x(arguments[xt])}return Ze.apply(this,dt||arguments)},"t");switch(Ze.length){case 1:return function(dt){return arguments.length!==1?ht.apply(this,arguments):(typeof dt=="function"&&(dt=x(dt)),Ze.call(this,dt))};case 2:return function(dt,xt){return arguments.length!==2?ht.apply(this,arguments):(typeof xt=="function"&&(xt=x(xt)),Ze.call(this,dt,xt))};case 3:return function(dt,xt,Lt){return arguments.length!==3?ht.apply(this,arguments):(typeof Lt=="function"&&(Lt=x(Lt)),Ze.call(this,dt,xt,Lt))};case 4:return function(dt,xt,Lt,qt){return arguments.length!==4?ht.apply(this,arguments):(typeof qt=="function"&&(qt=x(qt)),Ze.call(this,dt,xt,Lt,qt))};case 5:return function(dt,xt,Lt,qt,Tt){return arguments.length!==5?ht.apply(this,arguments):(typeof Tt=="function"&&(Tt=x(Tt)),Ze.call(this,dt,xt,Lt,qt,Tt))};case 6:return function(dt,xt,Lt,qt,Tt,Qt){return arguments.length!==6?ht.apply(this,arguments):(typeof Qt=="function"&&(Qt=x(Qt)),Ze.call(this,dt,xt,Lt,qt,Tt,Qt))};default:return ht}}a(jt,"et");function Bt(Ze){var ht=a(function(){var dt;if(typeof arguments[0]=="function"){dt=Array(arguments.length),dt[0]=x(arguments[0]);for(var xt=1;xt<arguments.length;xt++)dt[xt]=arguments[xt]}return Ze.apply(this,dt||arguments)},"t");switch(Ze.length){case 1:return function(dt){return arguments.length!==1?ht.apply(this,arguments):(typeof dt=="function"&&(dt=x(dt)),Ze.call(this,dt))};case 2:return function(dt,xt){return arguments.length!==2?ht.apply(this,arguments):(typeof dt=="function"&&(dt=x(dt)),Ze.call(this,dt,xt))};case 3:return function(dt,xt,Lt){return arguments.length!==3?ht.apply(this,arguments):(typeof dt=="function"&&(dt=x(dt)),Ze.call(this,dt,xt,Lt))};case 4:return function(dt,xt,Lt,qt){return arguments.length!==4?ht.apply(this,arguments):(typeof dt=="function"&&(dt=x(dt)),Ze.call(this,dt,xt,Lt,qt))};case 5:return function(dt,xt,Lt,qt,Tt){return arguments.length!==5?ht.apply(this,arguments):(typeof dt=="function"&&(dt=x(dt)),Ze.call(this,dt,xt,Lt,qt,Tt))};case 6:return function(dt,xt,Lt,qt,Tt,Qt){return arguments.length!==6?ht.apply(this,arguments):(typeof dt=="function"&&(dt=x(dt)),Ze.call(this,dt,xt,Lt,qt,Tt,Qt))};default:return ht}}a(Bt,"js");function Tr(Ze){return(Ze=Number(Ze))>=0?Ze:!1}a(Tr,"kP");function Mt(Ze){return typeof Ze=="string"&&Tr(Ze)===!1}a(Mt,"jP")}),pc=$((s,A)=>{"use strict";var f=K(9491),w=ya(),x="cls@contexts",g="error@context";process.addAsyncListener||Li();function u(y){this.name=y,this.active=null,this._set=[],this.id=null}a(u,"Ve"),u.prototype.set=function(y,E){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[y]=E,E},u.prototype.get=function(y){if(this.active)return this.active[y]},u.prototype.createContext=function(){return Object.create(this.active)},u.prototype.run=function(y){var E=this.createContext();this.enter(E);try{return y(E),E}catch(C){throw C&&(C[g]=E),C}finally{this.exit(E)}},u.prototype.runAndReturn=function(y){var E;return this.run(function(C){E=y(C)}),E},u.prototype.bind=function(y,E){E||(this.active?E=this.active:E=this.createContext());var C=this;return function(){C.enter(E);try{return y.apply(this,arguments)}catch(T){throw T&&(T[g]=E),T}finally{C.exit(E)}}},u.prototype.enter=function(y){f.ok(y,"context must be provided for entering"),this._set.push(this.active),this.active=y},u.prototype.exit=function(y){if(f.ok(y,"context must be provided for exiting"),this.active===y){f.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}var E=this._set.lastIndexOf(y);f.ok(E>=0,"context not currently entered; can't exit"),f.ok(E,"can't remove top context"),this._set.splice(E,1)},u.prototype.bindEmitter=function(y){f.ok(y.on&&y.addListener&&y.emit,"can only bind real EEs");var E=this,C="context@"+this.name;function T(D){!D||(D[x]||(D[x]=Object.create(null)),D[x][C]={namespace:E,context:E.active})}a(T,"n");function R(D){if(!(D&&D[x]))return D;var k=D,G=D[x];return Object.keys(G).forEach(function(Z){var Q=G[Z];k=Q.namespace.bind(k,Q.context)}),k}a(R,"i"),w(y,T,R)},u.prototype.fromException=function(y){return y[g]};function h(y){return process.namespaces[y]}a(h,"Tv");function v(y){f.ok(y,"namespace must be given a name!");var E=new u(y);return E.id=process.addAsyncListener({create:function(){return E.active},before:function(C,T){T&&E.enter(T)},after:function(C,T){T&&E.exit(T)},error:function(C){C&&E.exit(C)}}),process.namespaces[y]=E,E}a(v,"UP");function _(y){var E=h(y);f.ok(E,"can't delete nonexistent namespace!"),f.ok(E.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(E.id),process.namespaces[y]=null}a(_,"Sv");function b(){process.namespaces&&Object.keys(process.namespaces).forEach(function(y){_(y)}),process.namespaces=Object.create(null)}a(b,"Av"),process.namespaces||b(),A.exports={getNamespace:h,createNamespace:v,destroyNamespace:_,reset:b}}),$i=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.CorrelationContextManager=void 0;var A=ot(),f=Oo(),w=_e(),x=Ge(),g=va(),u=function(){function v(){}return a(v,"e"),v.getCurrentContext=function(){if(!v.enabled)return null;var _=v.session.get(v.CONTEXT_NAME);return _===void 0?null:_},v.generateContextObject=function(_,b,y,E,C,T){return b=b||_,this.enabled?{operation:{name:y,id:_,parentId:b,traceparent:C,tracestate:T},customProperties:new h(E)}:null},v.spanToContextObject=function(_,b,y){var E=new w;return E.traceId=_.traceId,E.spanId=_.spanId,E.traceFlag=w.formatOpenTelemetryTraceFlags(_.traceFlags)||w.DEFAULT_TRACE_FLAG,E.parentId=b,v.generateContextObject(E.traceId,E.parentId,y,null,E)},v.runWithContext=function(_,b){var y;return v.enabled?v.session.bind(b,(y={},y[v.CONTEXT_NAME]=_,y))():b()},v.wrapEmitter=function(_){v.enabled&&v.session.bindEmitter(_)},v.wrapCallback=function(_,b){var y;return v.enabled?v.session.bind(_,b?(y={},y[v.CONTEXT_NAME]=b,y):void 0):_},v.enable=function(_){if(!this.enabled){if(!this.isNodeVersionCompatible()){this.enabled=!1;return}v.hasEverEnabled||(this.forceClsHooked=_,this.hasEverEnabled=!0,typeof this.cls=="undefined"&&(v.forceClsHooked===!0||v.forceClsHooked===void 0&&v.shouldUseClsHooked()?this.cls=Mu():this.cls=pc()),v.session=this.cls.createNamespace("AI-CLS-Session"),f.registerContextPreservation(function(b){return v.session.bind(b)})),this.enabled=!0}},v.startOperation=function(_,b){var y=_&&_.traceContext||null,E=_&&_.traceId?_:null,C=_&&_.headers;if(E){var T=new w("00-"+E.traceId+"-"+E.spanId+"-01"),R=new x(E.traceState?E.traceState.serialize():null),D=v.generateContextObject(E.traceId,"|"+E.traceId+"."+E.spanId+".",typeof b=="string"?b:"",void 0,T,R);return D}if(y){var T=new w(y.traceparent),R=new x(y.tracestate),k=typeof b=="object"?new g(b):null,D=v.generateContextObject(T.traceId,T.parentId,typeof b=="string"?b:k.getOperationName({}),k&&k.getCorrelationContextHeader()||void 0,T,R);return D}if(C){var T=new w(C.traceparent?C.traceparent.toString():null),R=new x(C.tracestate?C.tracestate.toString():null),k=new g(_),D=v.generateContextObject(T.traceId,T.parentId,k.getOperationName({}),k.getCorrelationContextHeader(),T,R);return D}return A.warn("startOperation was called with invalid arguments",arguments),null},v.disable=function(){this.enabled=!1},v.reset=function(){v.hasEverEnabled&&(v.session=null,v.session=this.cls.createNamespace("AI-CLS-Session"))},v.isNodeVersionCompatible=function(){var _=process.versions.node.split(".");return parseInt(_[0])>3||parseInt(_[0])>2&&parseInt(_[1])>2},v.shouldUseClsHooked=function(){var _=process.versions.node.split(".");return parseInt(_[0])>8||parseInt(_[0])>=8&&parseInt(_[1])>=2},v.canUseClsHooked=function(){var _=process.versions.node.split("."),b=parseInt(_[0])>8||parseInt(_[0])>=8&&parseInt(_[1])>=0,y=parseInt(_[0])<8||parseInt(_[0])<=8&&parseInt(_[1])<2,E=parseInt(_[0])>4||parseInt(_[0])>=4&&parseInt(_[1])>=7;return!(b&&y)&&E},v.enabled=!1,v.hasEverEnabled=!1,v.forceClsHooked=void 0,v.CONTEXT_NAME="ApplicationInsights-Context",v}();s.CorrelationContextManager=u;var h=function(){function v(_){this.props=[],this.addHeaderData(_)}return a(v,"e"),v.prototype.addHeaderData=function(_){var b=_?_.split(", "):[];this.props=b.map(function(y){var E=y.split("=");return{key:E[0],value:E[1]}}).concat(this.props)},v.prototype.serializeToHeader=function(){return this.props.map(function(_){return _.key+"="+_.value}).join(", ")},v.prototype.getProperty=function(_){for(var b=0;b<this.props.length;++b){var y=this.props[b];if(y.key===_)return y.value}},v.prototype.setProperty=function(_,b){if(v.bannedCharacters.test(_)||v.bannedCharacters.test(b)){A.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+_+" and value: "+b);return}for(var y=0;y<this.props.length;++y){var E=this.props[y];if(E.key===_){E.value=b;return}}this.props.push({key:_,value:b})},v.bannedCharacters=/[,=]/,v}()}),gc=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.dispose=s.enable=void 0;var A=pn(),f=he(),w=[],x=a(function(h){var v=h.data.message;w.forEach(function(_){v instanceof Error?_.trackException({exception:v}):(v.lastIndexOf(`
`)==v.length-1&&(v=v.substring(0,v.length-1)),_.trackTrace({message:v,severity:h.data.stderr?A.SeverityLevel.Warning:A.SeverityLevel.Information}))})},"Bc");function g(h,v){h?(w.length===0&&f.channel.subscribe("console",x),w.push(v)):(w=w.filter(function(_){return _!=v}),w.length===0&&f.channel.unsubscribe("console",x))}a(g,"VP"),s.enable=g;function u(){f.channel.unsubscribe("console",x),w=[]}a(u,"$P"),s.dispose=u}),Lo=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.dispose=s.enable=void 0;var A=pn(),f=he(),w=[],x={10:A.SeverityLevel.Verbose,20:A.SeverityLevel.Verbose,30:A.SeverityLevel.Information,40:A.SeverityLevel.Warning,50:A.SeverityLevel.Error,60:A.SeverityLevel.Critical},g=a(function(v){var _=v.data.result;w.forEach(function(b){var y=x[v.data.level];_ instanceof Error?b.trackException({exception:_}):b.trackTrace({message:_,severity:y})})},"Fc");function u(v,_){v?(w.length===0&&f.channel.subscribe("bunyan",g),w.push(_)):(w=w.filter(function(b){return b!=_}),w.length===0&&f.channel.unsubscribe("bunyan",g))}a(u,"KP"),s.enable=u;function h(){f.channel.unsubscribe("bunyan",g),w=[]}a(h,"XP"),s.dispose=h}),zn=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.dispose=s.enable=void 0;var A=pn(),f=he(),w=[],x={syslog:function(v){var _={emerg:A.SeverityLevel.Critical,alert:A.SeverityLevel.Critical,crit:A.SeverityLevel.Critical,error:A.SeverityLevel.Error,warning:A.SeverityLevel.Warning,notice:A.SeverityLevel.Information,info:A.SeverityLevel.Information,debug:A.SeverityLevel.Verbose};return _[v]===void 0?A.SeverityLevel.Information:_[v]},npm:function(v){var _={error:A.SeverityLevel.Error,warn:A.SeverityLevel.Warning,info:A.SeverityLevel.Information,verbose:A.SeverityLevel.Verbose,debug:A.SeverityLevel.Verbose,silly:A.SeverityLevel.Verbose};return _[v]===void 0?A.SeverityLevel.Information:_[v]},unknown:function(v){return A.SeverityLevel.Information}},g=a(function(v){var _=v.data.message;w.forEach(function(b){if(_ instanceof Error)b.trackException({exception:_,properties:v.data.meta});else{var y=x[v.data.levelKind](v.data.level);b.trackTrace({message:_,severity:y,properties:v.data.meta})}})},"$c");function u(v,_){v?(w.length===0&&f.channel.subscribe("winston",g),w.push(_)):(w=w.filter(function(b){return b!=_}),w.length===0&&f.channel.unsubscribe("winston",g))}a(u,"QP"),s.enable=u;function h(){f.channel.unsubscribe("winston",g),w=[]}a(h,"WP"),s.dispose=h}),$u=$((s,A)=>{"use strict";var f=Oo(),w=function(){function x(g){if(x.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=g,x.INSTANCE=this}return a(x,"e"),x.prototype.enable=function(g,u){f.IsInitialized&&(gc().enable(g&&u,this._client),Lo().enable(g,this._client),zn().enable(g,this._client))},x.prototype.isInitialized=function(){return this._isInitialized},x.prototype.dispose=function(){x.INSTANCE=null,this.enable(!1,!1)},x._methodNames=["debug","info","log","warn","error"],x}();A.exports=w}),Fu=$((s,A)=>{"use strict";var f=function(){function w(x){if(w.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");w.INSTANCE=this,this._client=x;var g=process.versions.node.split(".");w._canUseUncaughtExceptionMonitor=parseInt(g[0])>13||parseInt(g[0])===13&&parseInt(g[1])>=7}return a(w,"e"),w.prototype.isInitialized=function(){return this._isInitialized},w.prototype.enable=function(x){var g=this;if(x){this._isInitialized=!0;var u=this;if(!this._exceptionListenerHandle){var h=a(function(v,_,b){b===void 0&&(b=new Error(w._FALLBACK_ERROR_MESSAGE)),g._client.trackException({exception:b}),g._client.flush({isAppCrashing:!0}),v&&_&&process.listeners(_).length===1&&(console.error(b),process.exit(1))},"i");w._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=h.bind(this,!1,void 0),process.on(w.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=h.bind(this,!0,w.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=h.bind(this,!1,void 0),process.on(w.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(w.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(w._canUseUncaughtExceptionMonitor?process.removeListener(w.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(w.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(w.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},w.prototype.dispose=function(){w.INSTANCE=null,this.enable(!1),this._isInitialized=!1},w.INSTANCE=null,w.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",w.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",w.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",w._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",w._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",w._canUseUncaughtExceptionMonitor=!1,w}();A.exports=f}),Qr=$(s=>{"use strict";var A;Object.defineProperty(s,"__esModule",{value:!0}),s.HeartBeatMetricName=s.DependencyTypeName=s.SpanAttribute=s.TelemetryTypeStringToQuickPulseDocumentType=s.TelemetryTypeStringToQuickPulseType=s.QuickPulseType=s.QuickPulseDocumentType=s.PerformanceToQuickPulseCounter=s.MetricId=s.PerformanceCounter=s.QuickPulseCounter=s.DEFAULT_LIVEMETRICS_HOST=s.DEFAULT_LIVEMETRICS_ENDPOINT=s.DEFAULT_BREEZE_ENDPOINT=void 0,s.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com",s.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com",s.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com";var f;(function(g){g.COMMITTED_BYTES="\\Memory\\Committed Bytes",g.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",g.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",g.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",g.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",g.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",g.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",g.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",g.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec"})(f=s.QuickPulseCounter||(s.QuickPulseCounter={}));var w;(function(g){g.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",g.AVAILABLE_BYTES="\\Memory\\Available Bytes",g.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",g.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",g.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",g.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"})(w=s.PerformanceCounter||(s.PerformanceCounter={}));var x;(function(g){g.REQUESTS_DURATION="requests/duration",g.DEPENDENCIES_DURATION="dependencies/duration",g.EXCEPTIONS_COUNT="exceptions/count",g.TRACES_COUNT="traces/count"})(x=s.MetricId||(s.MetricId={})),s.PerformanceToQuickPulseCounter=(A={},A[w.PROCESSOR_TIME]=f.PROCESSOR_TIME,A[w.REQUEST_RATE]=f.REQUEST_RATE,A[w.REQUEST_DURATION]=f.REQUEST_DURATION,A[f.COMMITTED_BYTES]=f.COMMITTED_BYTES,A[f.REQUEST_FAILURE_RATE]=f.REQUEST_FAILURE_RATE,A[f.DEPENDENCY_RATE]=f.DEPENDENCY_RATE,A[f.DEPENDENCY_FAILURE_RATE]=f.DEPENDENCY_FAILURE_RATE,A[f.DEPENDENCY_DURATION]=f.DEPENDENCY_DURATION,A[f.EXCEPTION_RATE]=f.EXCEPTION_RATE,A),s.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability",PageView:"PageView"},s.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument",PageView:"PageViewTelemetryDocument"},s.TelemetryTypeStringToQuickPulseType={EventData:s.QuickPulseType.Event,ExceptionData:s.QuickPulseType.Exception,MessageData:s.QuickPulseType.Trace,MetricData:s.QuickPulseType.Metric,RequestData:s.QuickPulseType.Request,RemoteDependencyData:s.QuickPulseType.Dependency,AvailabilityData:s.QuickPulseType.Availability,PageViewData:s.QuickPulseType.PageView},s.TelemetryTypeStringToQuickPulseDocumentType={EventData:s.QuickPulseDocumentType.Event,ExceptionData:s.QuickPulseDocumentType.Exception,MessageData:s.QuickPulseDocumentType.Trace,MetricData:s.QuickPulseDocumentType.Metric,RequestData:s.QuickPulseDocumentType.Request,RemoteDependencyData:s.QuickPulseDocumentType.Dependency,AvailabilityData:s.QuickPulseDocumentType.Availability,PageViewData:s.QuickPulseDocumentType.PageView},s.SpanAttribute={HttpHost:"http.host",HttpMethod:"http.method",HttpPort:"http.port",HttpStatusCode:"http.status_code",HttpUrl:"http.url",HttpUserAgent:"http.user_agent",GrpcMethod:"grpc.method",GrpcService:"rpc.service"},s.DependencyTypeName={Grpc:"GRPC",Http:"HTTP",InProc:"InProc"},s.HeartBeatMetricName="HeartBeat"}),mr=$((s,A)=>{"use strict";var f=K(2037),w=Qr(),x=function(){function g(u,h,v){h===void 0&&(h=6e4),v===void 0&&(v=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,g.INSTANCE||(g.INSTANCE=this),this._isInitialized=!1,this._client=u,this._collectionInterval=h,this._enableLiveMetricsCounters=v}return a(g,"e"),g.prototype.enable=function(u,h){var v=this;this._isEnabled=u,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),u?this._handle||(this._lastCpus=f.cpus(),this._lastRequests={totalRequestCount:g._totalRequestCount,totalFailedRequestCount:g._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:g._totalDependencyCount,totalFailedDependencyCount:g._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:g._totalExceptionCount,time:+new Date},typeof process.cpuUsage=="function"&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=h||this._collectionInterval,this._handle=setInterval(function(){return v.trackPerformance()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},g.countRequest=function(u,h){var v;if(g.isEnabled()){if(typeof u=="string")v=+new Date("1970-01-01T"+u+"Z");else if(typeof u=="number")v=u;else return;g._intervalRequestExecutionTime+=v,h===!1&&g._totalFailedRequestCount++,g._totalRequestCount++}},g.countException=function(){g._totalExceptionCount++},g.countDependency=function(u,h){var v;if(g.isEnabled()){if(typeof u=="string")v=+new Date("1970-01-01T"+u+"Z");else if(typeof u=="number")v=u;else return;g._intervalDependencyExecutionTime+=v,h===!1&&g._totalFailedDependencyCount++,g._totalDependencyCount++}},g.prototype.isInitialized=function(){return this._isInitialized},g.isEnabled=function(){return g.INSTANCE&&g.INSTANCE._isEnabled},g.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},g.prototype._trackCpu=function(){var u=f.cpus();if(u&&u.length&&this._lastCpus&&u.length===this._lastCpus.length){for(var h=0,v=0,_=0,b=0,y=0,E=0;!!u&&E<u.length;E++){var C=u[E],T=this._lastCpus[E],R="% cpu("+E+") ",D=C.model,k=C.speed,G=C.times,Z=T.times,Q=G.user-Z.user||0;h+=Q;var fe=G.sys-Z.sys||0;v+=fe;var Ee=G.nice-Z.nice||0;_+=Ee;var Pe=G.idle-Z.idle||0;b+=Pe;var He=G.irq-Z.irq||0;y+=He}var Qe=void 0;if(typeof process.cpuUsage=="function"){var tt=process.cpuUsage(),mt=process.hrtime(),bt=tt.user-this._lastAppCpuUsage.user+(tt.system-this._lastAppCpuUsage.system)||0;if(typeof this._lastHrtime!="undefined"&&this._lastHrtime.length===2){var jt=(mt[0]-this._lastHrtime[0])*1e6+(mt[1]-this._lastHrtime[1])/1e3||0;Qe=100*bt/(jt*u.length)}this._lastAppCpuUsage=tt,this._lastHrtime=mt}var Bt=h+v+_+b+y||1;this._client.trackMetric({name:w.PerformanceCounter.PROCESSOR_TIME,value:(Bt-b)/Bt*100}),this._client.trackMetric({name:w.PerformanceCounter.PROCESS_TIME,value:Qe||h/Bt*100})}this._lastCpus=u},g.prototype._trackMemory=function(){var u=f.freemem(),h=process.memoryUsage().rss,v=f.totalmem()-u;this._client.trackMetric({name:w.PerformanceCounter.PRIVATE_BYTES,value:h}),this._client.trackMetric({name:w.PerformanceCounter.AVAILABLE_BYTES,value:u}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:w.QuickPulseCounter.COMMITTED_BYTES,value:v})},g.prototype._trackNetwork=function(){var u=this._lastRequests,h={totalRequestCount:g._totalRequestCount,totalFailedRequestCount:g._totalFailedRequestCount,time:+new Date},v=h.totalRequestCount-u.totalRequestCount||0,_=h.totalFailedRequestCount-u.totalFailedRequestCount||0,b=h.time-u.time,y=b/1e3,E=(g._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/v||0;if(this._lastIntervalRequestExecutionTime=g._intervalRequestExecutionTime,b>0){var C=v/y,T=_/y;this._client.trackMetric({name:w.PerformanceCounter.REQUEST_RATE,value:C}),(!this._enableLiveMetricsCounters||v>0)&&this._client.trackMetric({name:w.PerformanceCounter.REQUEST_DURATION,value:E}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:w.QuickPulseCounter.REQUEST_FAILURE_RATE,value:T})}this._lastRequests=h},g.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var u=this._lastDependencies,h={totalDependencyCount:g._totalDependencyCount,totalFailedDependencyCount:g._totalFailedDependencyCount,time:+new Date},v=h.totalDependencyCount-u.totalDependencyCount||0,_=h.totalFailedDependencyCount-u.totalFailedDependencyCount||0,b=h.time-u.time,y=b/1e3,E=(g._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/v||0;if(this._lastIntervalDependencyExecutionTime=g._intervalDependencyExecutionTime,b>0){var C=v/y,T=_/y;this._client.trackMetric({name:w.QuickPulseCounter.DEPENDENCY_RATE,value:C}),this._client.trackMetric({name:w.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:T}),(!this._enableLiveMetricsCounters||v>0)&&this._client.trackMetric({name:w.QuickPulseCounter.DEPENDENCY_DURATION,value:E})}this._lastDependencies=h}},g.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var u=this._lastExceptions,h={totalExceptionCount:g._totalExceptionCount,time:+new Date},v=h.totalExceptionCount-u.totalExceptionCount||0,_=h.time-u.time,b=_/1e3;if(_>0){var y=v/b;this._client.trackMetric({name:w.QuickPulseCounter.EXCEPTION_RATE,value:y})}this._lastExceptions=h}},g.prototype.dispose=function(){g.INSTANCE=null,this.enable(!1),this._isInitialized=!1},g._totalRequestCount=0,g._totalFailedRequestCount=0,g._totalDependencyCount=0,g._totalFailedDependencyCount=0,g._totalExceptionCount=0,g._intervalDependencyExecutionTime=0,g._intervalRequestExecutionTime=0,g}();A.exports=x}),Wn=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.AggregatedMetricCounter=void 0;var A=function(){function f(w){this.dimensions=w,this.totalCount=0,this.lastTotalCount=0,this.intervalExecutionTime=0,this.lastTime=+new Date,this.lastIntervalExecutionTime=0}return a(f,"e"),f}();s.AggregatedMetricCounter=A}),Yr=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.PreaggregatedMetricPropertyNames=void 0,s.PreaggregatedMetricPropertyNames={cloudRoleInstance:"cloud/roleInstance",cloudRoleName:"cloud/roleName",operationSynthetic:"operation/synthetic",requestSuccess:"Request.Success",requestResultCode:"request/resultCode",dependencyType:"Dependency.Type",dependencyTarget:"dependency/target",dependencySuccess:"Dependency.Success",dependencyResultCode:"dependency/resultCode",traceSeverityLevel:"trace/severityLevel"}}),Pr=$((s,A)=>{"use strict";var f=s&&s.__assign||function(){return f=Object.assign||function(h){for(var v,_=1,b=arguments.length;_<b;_++){v=arguments[_];for(var y in v)Object.prototype.hasOwnProperty.call(v,y)&&(h[y]=v[y])}return h},f.apply(this,arguments)},w=Qr(),x=Wn(),g=Yr(),u=function(){function h(v,_){_===void 0&&(_=6e4),h.INSTANCE||(h.INSTANCE=this),this._isInitialized=!1,h._dependencyCountersCollection=[],h._requestCountersCollection=[],h._exceptionCountersCollection=[],h._traceCountersCollection=[],this._client=v,this._collectionInterval=_}return a(h,"e"),h.prototype.enable=function(v,_){var b=this;this._isEnabled=v,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),v?this._handle||(this._collectionInterval=_||this._collectionInterval,this._handle=setInterval(function(){return b.trackPreAggregatedMetrics()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},h.countException=function(v){if(h.isEnabled()){var _=h._getAggregatedCounter(v,this._exceptionCountersCollection);_.totalCount++}},h.countTrace=function(v){if(h.isEnabled()){var _=h._getAggregatedCounter(v,this._traceCountersCollection);_.totalCount++}},h.countRequest=function(v,_){if(h.isEnabled()){var b,y=h._getAggregatedCounter(_,this._requestCountersCollection);if(typeof v=="string")b=+new Date("1970-01-01T"+v+"Z");else if(typeof v=="number")b=v;else return;y.intervalExecutionTime+=b,y.totalCount++}},h.countDependency=function(v,_){if(h.isEnabled()){var b=h._getAggregatedCounter(_,this._dependencyCountersCollection),y;if(typeof v=="string")y=+new Date("1970-01-01T"+v+"Z");else if(typeof v=="number")y=v;else return;b.intervalExecutionTime+=y,b.totalCount++}},h.prototype.isInitialized=function(){return this._isInitialized},h.isEnabled=function(){return h.INSTANCE&&h.INSTANCE._isEnabled},h.prototype.trackPreAggregatedMetrics=function(){this._trackRequestMetrics(),this._trackDependencyMetrics(),this._trackExceptionMetrics(),this._trackTraceMetrics()},h._getAggregatedCounter=function(v,_){for(var b=!1,y=0;y<_.length;y++){if(v===_[y].dimensions)return _[y];if(Object.keys(v).length===Object.keys(_[y].dimensions).length){for(var E in v)if(v[E]!=_[y].dimensions[E]){b=!0;break}if(!b)return _[y];b=!1}}var C=new x.AggregatedMetricCounter(v);return _.push(C),C},h.prototype._trackRequestMetrics=function(){for(var v=0;v<h._requestCountersCollection.length;v++){var _=h._requestCountersCollection[v];_.time=+new Date;var b=_.totalCount-_.lastTotalCount||0,y=_.time-_.lastTime,E=(_.intervalExecutionTime-_.lastIntervalExecutionTime)/b||0;_.lastIntervalExecutionTime=_.intervalExecutionTime,y>0&&b>0&&this._trackPreAggregatedMetric({name:"Server response time",dimensions:_.dimensions,value:E,count:b,aggregationInterval:y,metricType:w.MetricId.REQUESTS_DURATION}),_.lastTotalCount=_.totalCount,_.lastTime=_.time}},h.prototype._trackDependencyMetrics=function(){for(var v=0;v<h._dependencyCountersCollection.length;v++){var _=h._dependencyCountersCollection[v];_.time=+new Date;var b=_.totalCount-_.lastTotalCount||0,y=_.time-_.lastTime,E=(_.intervalExecutionTime-_.lastIntervalExecutionTime)/b||0;_.lastIntervalExecutionTime=_.intervalExecutionTime,y>0&&b>0&&this._trackPreAggregatedMetric({name:"Dependency duration",dimensions:_.dimensions,value:E,count:b,aggregationInterval:y,metricType:w.MetricId.DEPENDENCIES_DURATION}),_.lastTotalCount=_.totalCount,_.lastTime=_.time}},h.prototype._trackExceptionMetrics=function(){for(var v=0;v<h._exceptionCountersCollection.length;v++){var _=h._exceptionCountersCollection[v],b=_.totalCount-_.lastTotalCount||0,y=_.time-_.lastTime;this._trackPreAggregatedMetric({name:"Exceptions",dimensions:_.dimensions,value:b,count:b,aggregationInterval:y,metricType:w.MetricId.EXCEPTIONS_COUNT}),_.lastTotalCount=_.totalCount,_.lastTime=_.time}},h.prototype._trackTraceMetrics=function(){for(var v=0;v<h._traceCountersCollection.length;v++){var _=h._traceCountersCollection[v],b=_.totalCount-_.lastTotalCount||0,y=_.time-_.lastTime;this._trackPreAggregatedMetric({name:"Traces",dimensions:_.dimensions,value:b,count:b,aggregationInterval:y,metricType:w.MetricId.TRACES_COUNT}),_.lastTotalCount=_.totalCount,_.lastTime=_.time}},h.prototype._trackPreAggregatedMetric=function(v){var _={};for(var b in v.dimensions)_[g.PreaggregatedMetricPropertyNames[b]]=v.dimensions[b];_=f(f({},_),{"_MS.MetricId":v.metricType,"_MS.AggregationIntervalMs":String(v.aggregationInterval),"_MS.IsAutocollected":"True"});var y={name:v.name,value:v.value,count:v.count,properties:_,kind:"Aggregation"};this._client.trackMetric(y)},h.prototype.dispose=function(){h.INSTANCE=null,this.enable(!1),this._isInitialized=!1},h}();A.exports=u}),hs=$((s,A)=>{"use strict";var f=K(2037),w=K(7147),x=K(1017),g=pn(),u=ot(),h=function(){function v(_){this.keys=new g.ContextTagKeys,this.tags={},this._loadApplicationContext(_),this._loadDeviceContext(),this._loadInternalContext()}return a(v,"e"),v.prototype._loadApplicationContext=function(_){if(_=_||x.resolve(__dirname,"../../../../package.json"),!v.appVersion[_]){v.appVersion[_]="unknown";try{var b=JSON.parse(w.readFileSync(_,"utf8"));b&&typeof b.version=="string"&&(v.appVersion[_]=b.version)}catch(y){u.info("unable to read app version: ",y)}}this.tags[this.keys.applicationVersion]=v.appVersion[_]},v.prototype._loadDeviceContext=function(){this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=f&&f.hostname(),this.tags[this.keys.deviceOSVersion]=f&&f.type()+" "+f.release(),this.tags[this.keys.cloudRole]=v.DefaultRoleName,this.tags["ai.device.osArchitecture"]=f&&f.arch(),this.tags["ai.device.osPlatform"]=f&&f.platform()},v.prototype._loadInternalContext=function(){var _=x.resolve(__dirname,"../../package.json");if(!v.sdkVersion){v.sdkVersion="unknown";try{var b=JSON.parse(w.readFileSync(_,"utf8"));b&&typeof b.version=="string"&&(v.sdkVersion=b.version)}catch(y){u.info("unable to read app version: ",y)}}this.tags[this.keys.internalSdkVersion]="node:"+v.sdkVersion},v.DefaultRoleName="Web",v.appVersion={},v.sdkVersion=null,v}();A.exports=h}),Gn=$((s,A)=>{"use strict";var f=s&&s.__extends||function(){var b=a(function(y,E){return b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,T){C.__proto__=T}||function(C,T){for(var R in T)Object.prototype.hasOwnProperty.call(T,R)&&(C[R]=T[R])},b(y,E)},"e");return function(y,E){b(y,E);function C(){this.constructor=y}a(C,"n"),y.prototype=E===null?Object.create(E):(C.prototype=E.prototype,new C)}}(),w=K(7310),x=pn(),g=hn(),u=Po(),h=bl(),v=J(),_=function(b){f(y,b);function y(E,C){var T=b.call(this)||this;return C&&C.method&&E&&(T.method=C.method,T.url=y._getUrlFromRequestOptions(E,C),T.startTime=+new Date),T}return a(y,"t"),y.prototype.onError=function(E){this._setStatus(void 0,E)},y.prototype.onResponse=function(E){this._setStatus(E.statusCode,void 0),this.correlationId=g.getCorrelationContextTarget(E,u.requestContextTargetKey)},y.prototype.getDependencyTelemetry=function(E,C){var T=w.parse(this.url);T.search=void 0,T.hash=void 0;var R=this.method.toUpperCase()+" "+T.pathname,D=x.RemoteDependencyDataConstants.TYPE_HTTP,k=T.hostname;T.port&&(k+=":"+T.port),this.correlationId?(D=x.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==v.correlationIdPrefix&&(k+=" | "+this.correlationId)):D=x.RemoteDependencyDataConstants.TYPE_HTTP;var G={id:C,name:R,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:D,target:k};if(E&&E.time?G.time=E.time:this.startTime&&(G.time=new Date(this.startTime)),E){for(var Z in E)G[Z]||(G[Z]=E[Z]);if(E.properties)for(var Z in E.properties)G.properties[Z]=E.properties[Z]}return G},y._getUrlFromRequestOptions=function(E,C){if(typeof E=="string")if(E.indexOf("http://")===0||E.indexOf("https://")===0)E=w.parse(E);else{var T=w.parse(E);T.host==="443"?E=w.parse("https://"+E):E=w.parse("http://"+E)}else{if(E&&typeof w.URL=="function"&&E instanceof w.URL)return w.format(E);var R=E;E={},R&&Object.keys(R).forEach(function(G){E[G]=R[G]})}if(E.path){var D=w.parse(E.path);E.pathname=D.pathname,E.search=D.search}if(E.host&&E.port){var k=w.parse("http://"+E.host);!k.port&&E.port&&(E.hostname=E.host,delete E.host)}return E.protocol=E.protocol||C.agent&&C.agent.protocol||C.protocol||void 0,E.hostname=E.hostname||"localhost",w.format(E)},y}(h);A.exports=_}),mc=$(s=>{"use strict";var A=s&&s.__assign||function(){return A=Object.assign||function(u){for(var h,v=1,_=arguments.length;v<_;v++){h=arguments[v];for(var b in h)Object.prototype.hasOwnProperty.call(h,b)&&(u[b]=h[b])}return u},A.apply(this,arguments)};Object.defineProperty(s,"__esModule",{value:!0}),s.spanToTelemetryContract=void 0;var f=sr(),w=Qr();function x(u){var h=A({},u);return Object.keys(w.SpanAttribute).forEach(function(v){delete h[v]}),h}a(x,"Qc");function g(u){var h="|"+u.spanContext().traceId+"."+u.spanContext().spanId+".",v=Math.round(u._duration[0]*1e3+u._duration[1]/1e6),_=u.attributes["peer.address"]?u.attributes["peer.address"].toString():"",b=u.attributes.component?u.attributes.component.toString():"",y=b.toUpperCase()===w.DependencyTypeName.Http||!!u.attributes[w.SpanAttribute.HttpUrl],E=b.toLowerCase()===w.DependencyTypeName.Grpc;if(y){var C=u.attributes[w.SpanAttribute.HttpMethod]||"GET",T=new URL(u.attributes[w.SpanAttribute.HttpUrl].toString()),R=u.attributes[w.SpanAttribute.HttpHost]||T.host,D=u.attributes[w.SpanAttribute.HttpPort]||T.port||null,k=T.pathname||"/",G=C+" "+k,Z=w.DependencyTypeName.Http,Q=D?(R+":"+D).toString():R.toString(),fe=T.toString(),Ee=u.attributes[w.SpanAttribute.HttpStatusCode]||u.status.code||0,Pe=Ee<400;return{id:h,name:G,dependencyTypeName:Z,target:Q,data:fe,success:Pe,duration:v,url:fe,resultCode:String(Ee),properties:x(u.attributes)}}else if(E){var C=u.attributes[w.SpanAttribute.GrpcMethod]||"rpc",He=u.attributes[w.SpanAttribute.GrpcService],Qe=He?C+" "+He:u.name;return{id:h,duration:v,name:Qe,target:He.toString(),data:He.toString()||Qe,url:He.toString()||Qe,dependencyTypeName:w.DependencyTypeName.Grpc,resultCode:String(u.status.code||0),success:u.status.code===0,properties:x(u.attributes)}}else{var tt=u.name,mt=u.links&&u.links.map(function(bt){return{operation_Id:bt.context.traceId,id:bt.context.spanId}});return{id:h,duration:v,name:tt,target:_,data:_||tt,url:_||tt,dependencyTypeName:u.kind===f.SpanKind.INTERNAL?w.DependencyTypeName.InProc:b||u.name,resultCode:String(u.status.code||0),success:u.status.code===0,properties:A(A({},x(u.attributes)),{"_MS.links":mt||void 0})}}}a(g,"gR"),s.spanToTelemetryContract=g}),El=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.subscriber=void 0;var A=sr(),f=he(),w=_e(),x=mc(),g=we(),u=[],h=a(function(_){var b=_.data,y=x.spanToTelemetryContract(b),E=b.spanContext(),C=new w;C.traceId=E.traceId,C.spanId=E.spanId,C.traceFlag=w.formatOpenTelemetryTraceFlags(E.traceFlags),C.parentId=b.parentSpanId?"|"+E.traceId+"."+b.parentSpanId+".":null,g.AsyncScopeManager.with(b,function(){u.forEach(function(T){b.kind===A.SpanKind.SERVER?T.trackRequest(y):(b.kind===A.SpanKind.CLIENT||b.kind===A.SpanKind.INTERNAL)&&T.trackDependency(y)})})},"ER");s.subscriber=h;function v(_,b){_?(u.length===0&&f.channel.subscribe("azure-coretracing",s.subscriber),u.push(b)):(u=u.filter(function(y){return y!=b}),u.length===0&&f.channel.unsubscribe("azure-coretracing",s.subscriber))}a(v,"yR"),s.enable=v}),Bu=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.subscriber=void 0;var A=he(),f=[],w=a(function(g){g.data.event.commandName!=="ismaster"&&f.forEach(function(u){var h=g.data.startedData&&g.data.startedData.databaseName||"Unknown database";u.trackDependency({target:h,data:g.data.event.commandName,name:g.data.event.commandName,duration:g.data.event.duration,success:g.data.succeeded,resultCode:g.data.succeeded?"0":"1",time:g.data.startedData.time,dependencyTypeName:"mongodb"})})},"TR");s.subscriber=w;function x(g,u){g?(f.length===0&&A.channel.subscribe("mongodb",s.subscriber),f.push(u)):(f=f.filter(function(h){return h!=u}),f.length===0&&A.channel.unsubscribe("mongodb",s.subscriber))}a(x,"SR"),s.enable=x}),Hu=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.subscriber=void 0;var A=he(),f=[],w=a(function(g){f.forEach(function(u){var h=g.data.query||{},v=h.sql||"Unknown query",_=!g.data.err,b=h._connection||{},y=b.config||{},E=y.socketPath?y.socketPath:(y.host||"localhost")+":"+y.port;u.trackDependency({target:E,data:v,name:v,duration:g.data.duration,success:_,resultCode:_?"0":"1",time:g.data.time,dependencyTypeName:"mysql"})})},"AR");s.subscriber=w;function x(g,u){g?(f.length===0&&A.channel.subscribe("mysql",s.subscriber),f.push(u)):(f=f.filter(function(h){return h!=u}),f.length===0&&A.channel.unsubscribe("mysql",s.subscriber))}a(x,"bR"),s.enable=x}),Uu=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.subscriber=void 0;var A=he(),f=[],w=a(function(g){f.forEach(function(u){g.data.commandObj.command!=="info"&&u.trackDependency({target:g.data.address,name:g.data.commandObj.command,data:g.data.commandObj.command,duration:g.data.duration,success:!g.data.err,resultCode:g.data.err?"1":"0",time:g.data.time,dependencyTypeName:"redis"})})},"IR");s.subscriber=w;function x(g,u){g?(f.length===0&&A.channel.subscribe("redis",s.subscriber),f.push(u)):(f=f.filter(function(h){return h!=u}),f.length===0&&A.channel.unsubscribe("redis",s.subscriber))}a(x,"CR"),s.enable=x}),fs=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.enable=s.subscriber=void 0;var A=he(),f=[],w=a(function(g){f.forEach(function(u){var h=g.data.query,v=h.preparable&&h.preparable.text||h.plan||h.text||"unknown query",_=!g.data.error,b=g.data.database.host+":"+g.data.database.port;u.trackDependency({target:b,data:v,name:v,duration:g.data.duration,success:_,resultCode:_?"0":"1",time:g.data.time,dependencyTypeName:"postgres"})})},"OR");s.subscriber=w;function x(g,u){g?(f.length===0&&A.channel.subscribe("postgres",s.subscriber),f.push(u)):(f=f.filter(function(h){return h!=u}),f.length===0&&A.channel.unsubscribe("postgres",s.subscriber))}a(x,"PR"),s.enable=x}),Fi=$((s,A)=>{"use strict";var f=s&&s.__spreadArrays||function(){for(var T=0,R=0,D=arguments.length;R<D;R++)T+=arguments[R].length;for(var k=Array(T),G=0,R=0;R<D;R++)for(var Z=arguments[R],Q=0,fe=Z.length;Q<fe;Q++,G++)k[G]=Z[Q];return k},w=K(3685),x=K(5687),g=ot(),u=hn(),h=Po(),v=Gn(),_=$i(),b=J(),y=_e(),E=Oo(),C=function(){function T(R){if(T.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");T.INSTANCE=this,this._client=R}return a(T,"e"),T.prototype.enable=function(R){this._isEnabled=R,this._isEnabled&&!this._isInitialized&&this._initialize(),E.IsInitialized&&(El().enable(!0,this._client),Bu().enable(R,this._client),Hu().enable(R,this._client),Uu().enable(R,this._client),fs().enable(R,this._client))},T.prototype.isInitialized=function(){return this._isInitialized},T.prototype._initialize=function(){var R=this;this._isInitialized=!0;var D=w.request,k=x.request,G=a(function(Z,Q){var fe=!Q[T.disableCollectionRequestOption]&&!Z[T.alreadyAutoCollectedFlag];Q.headers&&Q.headers["user-agent"]&&Q.headers["user-agent"].toString().indexOf("azsdk-js")!==-1&&(fe=!1),Z[T.alreadyAutoCollectedFlag]=!0,Z&&Q&&fe&&(_.CorrelationContextManager.wrapEmitter(Z),T.trackRequest(R._client,{options:Q,request:Z}))},"i");w.request=function(Z){for(var Q=[],fe=1;fe<arguments.length;fe++)Q[fe-1]=arguments[fe];var Ee=D.call.apply(D,f([w,Z],Q));return G(Ee,Z),Ee},x.request=function(Z){for(var Q=[],fe=1;fe<arguments.length;fe++)Q[fe-1]=arguments[fe];var Ee=k.call.apply(k,f([x,Z],Q));return G(Ee,Z),Ee},w.get=function(Z){for(var Q,fe=[],Ee=1;Ee<arguments.length;Ee++)fe[Ee-1]=arguments[Ee];var Pe=(Q=w.request).call.apply(Q,f([w,Z],fe));return Pe.end(),Pe},x.get=function(Z){for(var Q,fe=[],Ee=1;Ee<arguments.length;Ee++)fe[Ee-1]=arguments[Ee];var Pe=(Q=x.request).call.apply(Q,f([x,Z],fe));return Pe.end(),Pe}},T.trackRequest=function(R,D){if(!D.options||!D.request||!R){g.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!D.options,!D.request,!R);return}var k=new v(D.options,D.request),G=_.CorrelationContextManager.getCurrentContext(),Z,Q;if(G&&G.operation&&G.operation.traceparent&&y.isValidTraceId(G.operation.traceparent.traceId))G.operation.traceparent.updateSpanId(),Z=G.operation.traceparent.getBackCompatRequestId();else if(b.w3cEnabled){var fe=new y;Q=fe.toString(),Z=fe.getBackCompatRequestId()}else Z=G&&G.operation&&G.operation.parentId+T.requestNumber+++".";if(u.canIncludeCorrelationHeader(R,k.getUrl())&&D.request.getHeader&&D.request.setHeader&&R.config&&R.config.correlationId){var Ee=D.request.getHeader(h.requestContextHeader);try{u.safeIncludeCorrelationHeader(R,D.request,Ee)}catch(Qe){g.warn("Request-Context header could not be set. Correlation of requests may be lost",Qe)}if(G&&G.operation)try{if(D.request.setHeader(h.requestIdHeader,Z),R.config.ignoreLegacyHeaders||(D.request.setHeader(h.parentIdHeader,G.operation.id),D.request.setHeader(h.rootIdHeader,Z)),Q||G.operation.traceparent)D.request.setHeader(h.traceparentHeader,Q||G.operation.traceparent.toString());else if(b.w3cEnabled){var fe=new y().toString();D.request.setHeader(h.traceparentHeader,fe)}if(G.operation.tracestate){var Pe=G.operation.tracestate.toString();Pe&&D.request.setHeader(h.traceStateHeader,Pe)}var He=G.customProperties.serializeToHeader();He&&D.request.setHeader(h.correlationContextHeader,He)}catch(Qe){g.warn("Correlation headers could not be set. Correlation of requests may be lost.",Qe)}}D.request.on&&(D.request.on("response",function(Qe){k.onResponse(Qe);var tt=k.getDependencyTelemetry(D,Z);tt.contextObjects=tt.contextObjects||{},tt.contextObjects["http.RequestOptions"]=D.options,tt.contextObjects["http.ClientRequest"]=D.request,tt.contextObjects["http.ClientResponse"]=Qe,R.trackDependency(tt)}),D.request.on("error",function(Qe){k.onError(Qe);var tt=k.getDependencyTelemetry(D,Z);tt.contextObjects=tt.contextObjects||{},tt.contextObjects["http.RequestOptions"]=D.options,tt.contextObjects["http.ClientRequest"]=D.request,tt.contextObjects.Error=Qe,R.trackDependency(tt)}),D.request.on("abort",function(){k.onError(new Error);var Qe=k.getDependencyTelemetry(D,Z);Qe.contextObjects=Qe.contextObjects||{},Qe.contextObjects["http.RequestOptions"]=D.options,Qe.contextObjects["http.ClientRequest"]=D.request,R.trackDependency(Qe)}))},T.prototype.dispose=function(){T.INSTANCE=null,this.enable(!1),this._isInitialized=!1},T.disableCollectionRequestOption="disableAppInsightsAutoCollection",T.requestNumber=1,T.alreadyAutoCollectedFlag="_appInsightsAutoCollected",T}();A.exports=C}),ju=$((s,A)=>{"use strict";var f=K(2037),w=Qr(),x=hn(),g=hs(),u=Fi(),h="http://169.254.169.254/metadata/instance/compute",v="api-version=2017-12-01",_="format=json",b="ENETUNREACH",y=function(){function E(C){this._collectionInterval=9e5,this._vmData={},this._azInst_vmId="",this._azInst_subscriptionId="",this._azInst_osType="",E.INSTANCE||(E.INSTANCE=this),this._isInitialized=!1,this._client=C}return a(E,"e"),E.prototype.enable=function(C,T){var R=this;this._isEnabled=C,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),C?this._handle||(this._handle=setInterval(function(){return R.trackHeartBeat(T,function(){})},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=null)},E.prototype.isInitialized=function(){return this._isInitialized},E.isEnabled=function(){return E.INSTANCE&&E.INSTANCE._isEnabled},E.prototype.trackHeartBeat=function(C,T){var R=this,D=!1,k={},G=g.sdkVersion;k.sdk=G,k.osType=f.type(),process.env.WEBSITE_SITE_NAME?(k.appSrv_SiteName=process.env.WEBSITE_SITE_NAME||"",k.appSrv_wsStamp=process.env.WEBSITE_HOME_STAMPNAME||"",k.appSrv_wsHost=process.env.WEBSITE_HOSTNAME||""):process.env.FUNCTIONS_WORKER_RUNTIME?k.azfunction_appId=process.env.WEBSITE_HOSTNAME:C&&(this._isVM===void 0?(D=!0,this._getAzureComputeMetadata(C,function(){R._isVM&&Object.keys(R._vmData).length>0&&(k.azInst_vmId=R._vmData.vmId||"",k.azInst_subscriptionId=R._vmData.subscriptionId||"",k.azInst_osType=R._vmData.osType||"",R._azInst_vmId=R._vmData.vmId||"",R._azInst_subscriptionId=R._vmData.subscriptionId||"",R._azInst_osType=R._vmData.osType||""),R._client.trackMetric({name:w.HeartBeatMetricName,value:0,properties:k}),T()})):this._isVM&&(k.azInst_vmId=this._azInst_vmId,k.azInst_subscriptionId=this._azInst_subscriptionId,k.azInst_osType=this._azInst_osType)),D||(this._client.trackMetric({name:w.HeartBeatMetricName,value:0,properties:k}),T())},E.prototype.dispose=function(){E.INSTANCE=null,this.enable(!1),this._isInitialized=!1},E.prototype._getAzureComputeMetadata=function(C,T){var R,D=this,k=h+"?"+v+"&"+_,G=(R={method:"GET"},R[u.disableCollectionRequestOption]=!0,R.headers={Metadata:"True"},R),Z=x.makeRequest(C,k,G,function(Q){if(Q.statusCode===200){D._isVM=!0;var fe="";Q.on("data",function(Ee){fe+=Ee}),Q.on("end",function(){D._vmData=D._isJSON(fe)?JSON.parse(fe):{},T()})}else T()});Z&&(Z.on("error",function(Q){Q&&Q.message&&Q.message.indexOf(b)>-1&&(D._isVM=!1),T()}),Z.end())},E.prototype._isJSON=function(C){try{return JSON.parse(C)&&!!C}catch(T){return!1}},E}();A.exports=y}),xl=$((s,A)=>{"use strict";var f=K(3685),w=K(5687),x=ot(),g=hn(),u=Po(),h=va(),v=$i(),_=mr(),b=function(){function y(E){if(y.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");y.INSTANCE=this,this._client=E}return a(y,"e"),y.prototype.enable=function(E){this._isEnabled=E,(this._isAutoCorrelating||this._isEnabled||_.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},y.prototype.useAutoCorrelation=function(E,C){E&&!this._isAutoCorrelating?v.CorrelationContextManager.enable(C):!E&&this._isAutoCorrelating&&v.CorrelationContextManager.disable(),this._isAutoCorrelating=E},y.prototype.isInitialized=function(){return this._isInitialized},y.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},y.prototype._generateCorrelationContext=function(E){if(this._isAutoCorrelating)return v.CorrelationContextManager.generateContextObject(E.getOperationId(this._client.context.tags),E.getRequestId(),E.getOperationName(this._client.context.tags),E.getCorrelationContextHeader(),E.getTraceparent(),E.getTracestate())},y.prototype._initialize=function(){var E=this;this._isInitialized=!0;var C=a(function(k){if(k){if(typeof k!="function")throw new Error("onRequest handler must be a function");return function(G,Z){v.CorrelationContextManager.wrapEmitter(G),v.CorrelationContextManager.wrapEmitter(Z);var Q=G&&!G[y.alreadyAutoCollectedFlag];if(G&&Q){var fe=new h(G),Ee=E._generateCorrelationContext(fe);v.CorrelationContextManager.runWithContext(Ee,function(){E._isEnabled&&(G[y.alreadyAutoCollectedFlag]=!0,y.trackRequest(E._client,{request:G,response:Z},fe)),typeof k=="function"&&k(G,Z)})}else typeof k=="function"&&k(G,Z)}}},"r"),T=a(function(k){var G=k.addListener.bind(k);k.addListener=function(Z,Q){switch(Z){case"request":case"checkContinue":return G(Z,C(Q));default:return G(Z,Q)}},k.on=k.addListener},"n"),R=f.createServer;f.createServer=function(k,G){if(G&&typeof G=="function"){var Z=R(k,C(G));return T(Z),Z}else{var Z=R(C(k));return T(Z),Z}};var D=w.createServer;w.createServer=function(k,G){var Z=D(k,C(G));return T(Z),Z}},y.trackRequestSync=function(E,C){if(!C.request||!C.response||!E){x.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!C.request,!C.response,!E);return}y.addResponseCorrelationIdHeader(E,C.response);var T=v.CorrelationContextManager.getCurrentContext(),R=new h(C.request,T&&T.operation.parentId);T&&(T.operation.id=R.getOperationId(E.context.tags)||T.operation.id,T.operation.name=R.getOperationName(E.context.tags)||T.operation.name,T.operation.parentId=R.getRequestId()||T.operation.parentId,T.customProperties.addHeaderData(R.getCorrelationContextHeader())),y.endRequest(E,R,C,C.duration,C.error)},y.trackRequest=function(E,C,T){if(!C.request||!C.response||!E){x.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!C.request,!C.response,!E);return}var R=v.CorrelationContextManager.getCurrentContext(),D=T||new h(C.request,R&&R.operation.parentId);g.canIncludeCorrelationHeader(E,D.getUrl())&&y.addResponseCorrelationIdHeader(E,C.response),R&&!T&&(R.operation.id=D.getOperationId(E.context.tags)||R.operation.id,R.operation.name=D.getOperationName(E.context.tags)||R.operation.name,R.operation.parentId=D.getOperationParentId(E.context.tags)||R.operation.parentId,R.customProperties.addHeaderData(D.getCorrelationContextHeader())),C.response.once&&C.response.once("finish",function(){y.endRequest(E,D,C,null,null)}),C.request.on&&C.request.on("error",function(k){y.endRequest(E,D,C,null,k)}),C.request.on&&C.request.on("aborted",function(){var k="The request has been aborted and the network socket has closed.";y.endRequest(E,D,C,null,k)})},y.addResponseCorrelationIdHeader=function(E,C){if(E.config&&E.config.correlationId&&C.getHeader&&C.setHeader&&!C.headersSent){var T=C.getHeader(u.requestContextHeader);g.safeIncludeCorrelationHeader(E,C,T)}},y.endRequest=function(E,C,T,R,D){D?C.onError(D,R):C.onResponse(T.response,R);var k=C.getRequestTelemetry(T);if(k.tagOverrides=C.getRequestTags(E.context.tags),T.tagOverrides)for(var G in T.tagOverrides)k.tagOverrides[G]=T.tagOverrides[G];var Z=C.getLegacyRootId();Z&&(k.properties.ai_legacyRootId=Z),k.contextObjects=k.contextObjects||{},k.contextObjects["http.ServerRequest"]=T.request,k.contextObjects["http.ServerResponse"]=T.response,E.trackRequest(k)},y.prototype.dispose=function(){y.INSTANCE=null,this.enable(!1),this._isInitialized=!1,v.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},y.alreadyAutoCollectedFlag="_appInsightsAutoCollected",y}();A.exports=b}),qu=$((s,A)=>{"use strict";var f=s&&s.__assign||function(){return f=Object.assign||function(b){for(var y,E=1,C=arguments.length;E<C;E++){y=arguments[E];for(var T in y)Object.prototype.hasOwnProperty.call(y,T)&&(b[T]=y[T])}return b},f.apply(this,arguments)},w=K(2037),x=pn(),g=Qr(),u=hn(),h=ot(),v=u.w3cTraceId(),_=function(){function b(){}return a(b,"e"),b.createQuickPulseEnvelope=function(y,E,C,T){var R=w&&typeof w.hostname=="function"&&w.hostname()||"Unknown",D=T.tags&&T.keys&&T.keys.cloudRoleInstance&&T.tags[T.keys.cloudRoleInstance]||R,k=T.tags&&T.keys&&T.keys.cloudRole&&T.tags[T.keys.cloudRole]||null,G={Documents:E.length>0?E:null,InstrumentationKey:C.instrumentationKey||"",Metrics:y.length>0?y:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:T.tags[T.keys.internalSdkVersion],StreamId:v,MachineName:R,Instance:D,RoleName:k};return G},b.createQuickPulseMetric=function(y){var E;return E={Name:y.name,Value:y.value,Weight:y.count||1},E},b.telemetryEnvelopeToQuickPulseDocument=function(y){switch(y.data.baseType){case x.TelemetryTypeString.Event:return b.createQuickPulseEventDocument(y);case x.TelemetryTypeString.Exception:return b.createQuickPulseExceptionDocument(y);case x.TelemetryTypeString.Trace:return b.createQuickPulseTraceDocument(y);case x.TelemetryTypeString.Dependency:return b.createQuickPulseDependencyDocument(y);case x.TelemetryTypeString.Request:return b.createQuickPulseRequestDocument(y)}return null},b.createQuickPulseEventDocument=function(y){var E=b.createQuickPulseDocument(y),C=y.data.baseData.name,T=f(f({},E),{Name:C});return T},b.createQuickPulseTraceDocument=function(y){var E=b.createQuickPulseDocument(y),C=y.data.baseData.severityLevel||0,T=f(f({},E),{Message:y.data.baseData.message,SeverityLevel:x.SeverityLevel[C]});return T},b.createQuickPulseExceptionDocument=function(y){var E=b.createQuickPulseDocument(y),C=y.data.baseData.exceptions,T="",R="",D="";C&&C.length>0&&(C[0].parsedStack&&C[0].parsedStack.length>0?C[0].parsedStack.forEach(function(G){T+=G.assembly+`
`}):C[0].stack&&C[0].stack.length>0&&(T=C[0].stack),R=C[0].message,D=C[0].typeName);var k=f(f({},E),{Exception:T,ExceptionMessage:R,ExceptionType:D});return k},b.createQuickPulseRequestDocument=function(y){var E=b.createQuickPulseDocument(y),C=y.data.baseData,T=f(f({},E),{Name:C.name,Success:C.success,Duration:C.duration,ResponseCode:C.responseCode,OperationName:C.name});return T},b.createQuickPulseDependencyDocument=function(y){var E=b.createQuickPulseDocument(y),C=y.data.baseData,T=f(f({},E),{Name:C.name,Target:C.target,Success:C.success,Duration:C.duration,ResultCode:C.resultCode,CommandName:C.data,OperationName:E.OperationId,DependencyTypeName:C.type});return T},b.createQuickPulseDocument=function(y){var E,C,T,R;y.data.baseType?(C=g.TelemetryTypeStringToQuickPulseType[y.data.baseType],E=g.TelemetryTypeStringToQuickPulseDocumentType[y.data.baseType]):h.warn("Document type invalid; not sending live metric document",y.data.baseType),T=y.tags[b.keys.operationId],R=b.aggregateProperties(y);var D={DocumentType:E,__type:C,OperationId:T,Version:"1.0",Properties:R};return D},b.aggregateProperties=function(y){var E=[],C=y.data.baseData.measurements||{};for(var T in C)if(C.hasOwnProperty(T)){var R=C[T],D={key:T,value:R};E.push(D)}var k=y.data.baseData.properties||{};for(var T in k)if(k.hasOwnProperty(T)){var R=k[T],D={key:T,value:R};E.push(D)}return E},b.keys=new x.ContextTagKeys,b}();A.exports=_}),zu=$((s,A)=>{"use strict";var f=a(function(){return(Date.now()+621355968e5)*1e4},"XR");A.exports={getTransmissionTime:f}}),jr=$((s,A)=>{"use strict";var f=s&&s.__awaiter||function(y,E,C,T){function R(D){return D instanceof C?D:new C(function(k){k(D)})}return a(R,"i"),new(C||(C=Promise))(function(D,k){function G(fe){try{Q(T.next(fe))}catch(Ee){k(Ee)}}a(G,"o");function Z(fe){try{Q(T.throw(fe))}catch(Ee){k(Ee)}}a(Z,"u");function Q(fe){fe.done?D(fe.value):R(fe.value).then(G,Z)}a(Q,"c"),Q((T=T.apply(y,E||[])).next())})},w=s&&s.__generator||function(y,E){var C={label:0,sent:function(){if(D[0]&1)throw D[1];return D[1]},trys:[],ops:[]},T,R,D,k;return k={next:G(0),throw:G(1),return:G(2)},typeof Symbol=="function"&&(k[Symbol.iterator]=function(){return this}),k;function G(Q){return function(fe){return Z([Q,fe])}}function Z(Q){if(T)throw new TypeError("Generator is already executing.");for(;C;)try{if(T=1,R&&(D=Q[0]&2?R.return:Q[0]?R.throw||((D=R.return)&&D.call(R),0):R.next)&&!(D=D.call(R,Q[1])).done)return D;switch(R=0,D&&(Q=[Q[0]&2,D.value]),Q[0]){case 0:case 1:D=Q;break;case 4:return C.label++,{value:Q[1],done:!1};case 5:C.label++,R=Q[1],Q=[0];continue;case 7:Q=C.ops.pop(),C.trys.pop();continue;default:if(D=C.trys,!(D=D.length>0&&D[D.length-1])&&(Q[0]===6||Q[0]===2)){C=0;continue}if(Q[0]===3&&(!D||Q[1]>D[0]&&Q[1]<D[3])){C.label=Q[1];break}if(Q[0]===6&&C.label<D[1]){C.label=D[1],D=Q;break}if(D&&C.label<D[2]){C.label=D[2],C.ops.push(Q);break}D[2]&&C.ops.pop(),C.trys.pop();continue}Q=E.call(y,C)}catch(fe){Q=[6,fe],R=0}finally{T=D=0}if(Q[0]&5)throw Q[1];return{value:Q[0]?Q[1]:void 0,done:!0}}},x=K(5687),g=Fi(),u=ot(),h=zu(),v=hn(),_={method:"POST",time:"x-ms-qps-transmission-time",pollingIntervalHint:"x-ms-qps-service-polling-interval-hint",endpointRedirect:"x-ms-qps-service-endpoint-redirect",instanceName:"x-ms-qps-instance-name",streamId:"x-ms-qps-stream-id",machineName:"x-ms-qps-machine-name",roleName:"x-ms-qps-role-name",streamid:"x-ms-qps-stream-id",invariantVersion:"x-ms-qps-invariant-version",subscribed:"x-ms-qps-subscribed"},b=function(){function y(E){this._config=E,this._consecutiveErrors=0}return a(y,"e"),y.prototype.ping=function(E,C,T){var R=[{name:_.streamId,value:E.StreamId},{name:_.machineName,value:E.MachineName},{name:_.roleName,value:E.RoleName},{name:_.instanceName,value:E.Instance},{name:_.invariantVersion,value:E.InvariantVersion.toString()}];this._submitData(E,C,T,"ping",R)},y.prototype.post=function(E,C,T){return f(this,void 0,void 0,function(){return w(this,function(R){switch(R.label){case 0:return[4,this._submitData([E],C,T,"post")];case 1:return R.sent(),[2]}})})},y.prototype._submitData=function(E,C,T,R,D){return f(this,void 0,void 0,function(){var k,G,Z,Q,fe,Ee=this;return w(this,function(Pe){return k=JSON.stringify(E),G=(Q={},Q[g.disableCollectionRequestOption]=!0,Q.host=C&&C.length>0?C:this._config.quickPulseHost,Q.method=_.method,Q.path="/QuickPulseService.svc/"+R+"?ikey="+this._config.instrumentationKey,Q.headers=(fe={Expect:"100-continue"},fe[_.time]=h.getTransmissionTime(),fe["Content-Type"]="application/json",fe["Content-Length"]=Buffer.byteLength(k),fe),Q),D&&D.length>0&&D.forEach(function(He){return G.headers[He.name]=He.value}),this._config.httpsAgent?G.agent=this._config.httpsAgent:G.agent=v.tlsRestrictedAgent,Z=x.request(G,function(He){if(He.statusCode==200){var Qe=He.headers[_.subscribed]==="true",tt=He.headers[_.endpointRedirect]?He.headers[_.endpointRedirect].toString():null,mt=He.headers[_.pollingIntervalHint]?parseInt(He.headers[_.pollingIntervalHint].toString()):null;Ee._consecutiveErrors=0,T(Qe,He,tt,mt)}else Ee._onError("StatusCode:"+He.statusCode+" StatusMessage:"+He.statusMessage),T()}),Z.on("error",function(He){Ee._onError(He),T()}),Z.write(k),Z.end(),[2]})})},y.prototype._onError=function(E){this._consecutiveErrors++;var C="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";this._consecutiveErrors%y.MAX_QPS_FAILURES_BEFORE_WARN==0?(C="Live Metrics endpoint could not be reached "+this._consecutiveErrors+" consecutive times. Most recent error:",u.warn(y.TAG,C,E)):u.info(y.TAG,C,E)},y.TAG="QuickPulseSender",y.MAX_QPS_FAILURES_BEFORE_WARN=25,y}();A.exports=b}),Wu=$((s,A)=>{"use strict";var f=s&&s.__awaiter||function(b,y,E,C){function T(R){return R instanceof E?R:new E(function(D){D(R)})}return a(T,"i"),new(E||(E=Promise))(function(R,D){function k(Q){try{Z(C.next(Q))}catch(fe){D(fe)}}a(k,"o");function G(Q){try{Z(C.throw(Q))}catch(fe){D(fe)}}a(G,"u");function Z(Q){Q.done?R(Q.value):T(Q.value).then(k,G)}a(Z,"c"),Z((C=C.apply(b,y||[])).next())})},w=s&&s.__generator||function(b,y){var E={label:0,sent:function(){if(R[0]&1)throw R[1];return R[1]},trys:[],ops:[]},C,T,R,D;return D={next:k(0),throw:k(1),return:k(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function k(Z){return function(Q){return G([Z,Q])}}function G(Z){if(C)throw new TypeError("Generator is already executing.");for(;E;)try{if(C=1,T&&(R=Z[0]&2?T.return:Z[0]?T.throw||((R=T.return)&&R.call(T),0):T.next)&&!(R=R.call(T,Z[1])).done)return R;switch(T=0,R&&(Z=[Z[0]&2,R.value]),Z[0]){case 0:case 1:R=Z;break;case 4:return E.label++,{value:Z[1],done:!1};case 5:E.label++,T=Z[1],Z=[0];continue;case 7:Z=E.ops.pop(),E.trys.pop();continue;default:if(R=E.trys,!(R=R.length>0&&R[R.length-1])&&(Z[0]===6||Z[0]===2)){E=0;continue}if(Z[0]===3&&(!R||Z[1]>R[0]&&Z[1]<R[3])){E.label=Z[1];break}if(Z[0]===6&&E.label<R[1]){E.label=R[1],R=Z;break}if(R&&E.label<R[2]){E.label=R[2],E.ops.push(Z);break}R[2]&&E.ops.pop(),E.trys.pop();continue}Z=y.call(b,E)}catch(Q){Z=[6,Q],T=0}finally{C=R=0}if(Z[0]&5)throw Z[1];return{value:Z[0]?Z[1]:void 0,done:!0}}},x=ot(),g=qu(),u=jr(),h=Qr(),v=hs(),_=function(){function b(y,E){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this._redirectedHost=null,this._pollingIntervalHint=-1,this.config=y,this.context=E||new v,this._sender=new u(this.config),this._isEnabled=!1}return a(b,"e"),b.prototype.addCollector=function(y){this._collectors.push(y)},b.prototype.trackMetric=function(y){this._addMetric(y)},b.prototype.addDocument=function(y){var E=g.telemetryEnvelopeToQuickPulseDocument(y);E&&this._documents.push(E)},b.prototype.enable=function(y){y&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!y&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},b.prototype.enableCollectors=function(y){this._collectors.forEach(function(E){E.enable(y)})},b.prototype._addMetric=function(y){var E=y.value,C=y.count||1,T=h.PerformanceToQuickPulseCounter[y.name];T&&(this._metrics[T]?(this._metrics[T].Value=(this._metrics[T].Value*this._metrics[T].Weight+E*C)/(this._metrics[T].Weight+C),this._metrics[T].Weight+=C):(this._metrics[T]=g.createQuickPulseMetric(y),this._metrics[T].Name=T,this._metrics[T].Weight=1))},b.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},b.prototype._goQuickPulse=function(){return f(this,void 0,void 0,function(){var y,E,C,T,R=this;return w(this,function(D){switch(D.label){case 0:return y=Object.keys(this._metrics).map(function(k){return R._metrics[k]}),E=g.createQuickPulseEnvelope(y,this._documents.slice(),this.config,this.context),this._resetQuickPulseBuffer(),this._isCollectingData?[4,this._post(E)]:[3,2];case 1:return D.sent(),[3,3];case 2:this._ping(E),D.label=3;case 3:return C=this._pollingIntervalHint>0?this._pollingIntervalHint:b.PING_INTERVAL,T=this._isCollectingData?b.POST_INTERVAL:C,this._isCollectingData&&Date.now()-this._lastSuccessTime>=b.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,T=b.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=b.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(T=b.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),T),this._handle.unref(),[2]}})})},b.prototype._ping=function(y){this._sender.ping(y,this._redirectedHost,this._quickPulseDone.bind(this))},b.prototype._post=function(y){return f(this,void 0,void 0,function(){return w(this,function(E){switch(E.label){case 0:return[4,this._sender.post(y,this._redirectedHost,this._quickPulseDone.bind(this))];case 1:return E.sent(),[2]}})})},b.prototype._quickPulseDone=function(y,E,C,T){y!=null?(this._isCollectingData!==y&&(x.info("Live Metrics sending data",y),this.enableCollectors(y)),this._isCollectingData=y,C&&C.length>0&&(this._redirectedHost=C,x.info("Redirecting endpoint to: ",C)),T&&T>0&&(this._pollingIntervalHint=T),E&&E.statusCode<300&&E.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},b.MAX_POST_WAIT_TIME=2e4,b.MAX_PING_WAIT_TIME=6e4,b.FALLBACK_INTERVAL=6e4,b.PING_INTERVAL=5e3,b.POST_INTERVAL=1e3,b}();A.exports=_}),Gu=$((s,A)=>{"use strict";var f=Qr(),w=function(){function x(){}return a(x,"e"),x.parse=function(g){if(!g)return{};var u=g.split(x._FIELDS_SEPARATOR),h=u.reduce(function(_,b){var y=b.split(x._FIELD_KEY_VALUE_SEPARATOR);if(y.length===2){var E=y[0].toLowerCase(),C=y[1];_[E]=C}return _},{});if(Object.keys(h).length>0){if(h.endpointsuffix){var v=h.location?h.location+".":"";h.ingestionendpoint=h.ingestionendpoint||"https://"+v+"dc."+h.endpointsuffix,h.liveendpoint=h.liveendpoint||"https://"+v+"live."+h.endpointsuffix}h.ingestionendpoint=h.ingestionendpoint||f.DEFAULT_BREEZE_ENDPOINT,h.liveendpoint=h.liveendpoint||f.DEFAULT_LIVEMETRICS_ENDPOINT}return h},x._FIELDS_SEPARATOR=";",x._FIELD_KEY_VALUE_SEPARATOR="=",x}();A.exports=w}),Cl=$((s,A)=>{"use strict";var f=J(),w=Gu(),x=ot(),g=Qr(),u=K(7310),h=function(){function v(_){var b=this;this.endpointBase=g.DEFAULT_BREEZE_ENDPOINT;var y=process.env[v.ENV_connectionString],E=w.parse(_),C=w.parse(y),T=!E.instrumentationkey&&Object.keys(E).length>0?null:_;this.instrumentationKey=E.instrumentationkey||T||C.instrumentationkey||v._getInstrumentationKey(),v._validateInstrumentationKey(this.instrumentationKey),this.endpointUrl=(E.ingestionendpoint||C.ingestionendpoint||this.endpointBase)+"/v2.1/track",this.maxBatchSize=250,this.maxBatchIntervalMs=15e3,this.disableAppInsights=!1,this.samplingPercentage=100,this.correlationIdRetryIntervalMs=30*1e3,this.correlationHeaderExcludedDomains=["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.setCorrelationId=function(R){return b.correlationId=R},this.proxyHttpUrl=process.env[v.ENV_http_proxy]||void 0,this.proxyHttpsUrl=process.env[v.ENV_https_proxy]||void 0,this.httpAgent=void 0,this.httpsAgent=void 0,this.profileQueryEndpoint=E.ingestionendpoint||C.ingestionendpoint||process.env[v.ENV_profileQueryEndpoint]||this.endpointBase,this._quickPulseHost=E.liveendpoint||C.liveendpoint||process.env[v.ENV_quickPulseHost]||g.DEFAULT_LIVEMETRICS_HOST,this._quickPulseHost.match(/^https?:\/\//)&&(this._quickPulseHost=u.parse(this._quickPulseHost).host)}return a(v,"e"),Object.defineProperty(v.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(_){f.cancelCorrelationIdQuery(this,this.setCorrelationId),this._profileQueryEndpoint=_,this.correlationId=f.correlationIdPrefix,f.queryCorrelationId(this,this.setCorrelationId)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"quickPulseHost",{get:function(){return this._quickPulseHost},set:function(_){this._quickPulseHost=_},enumerable:!1,configurable:!0}),v._getInstrumentationKey=function(){var _=process.env[v.ENV_iKey]||process.env[v.ENV_azurePrefix+v.ENV_iKey]||process.env[v.legacy_ENV_iKey]||process.env[v.ENV_azurePrefix+v.legacy_ENV_iKey];if(!_||_=="")throw new Error("Instrumentation key not found, pass the key in the config to this method or set the key in the environment variable APPINSIGHTS_INSTRUMENTATIONKEY before starting the server");return _},v._validateInstrumentationKey=function(_){var b="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",y=new RegExp(b);return y.test(_)},v.ENV_azurePrefix="APPSETTING_",v.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",v.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",v.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",v.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",v.ENV_connectionString="APPLICATIONINSIGHTS_CONNECTION_STRING",v.ENV_nativeMetricsDisablers="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",v.ENV_nativeMetricsDisableAll="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",v.ENV_http_proxy="http_proxy",v.ENV_https_proxy="https_proxy",v}();A.exports=h}),vc=$(s=>{"use strict";var A=s&&s.__assign||function(){return A=Object.assign||function(u){for(var h,v=1,_=arguments.length;v<_;v++){h=arguments[v];for(var b in h)Object.prototype.hasOwnProperty.call(h,b)&&(u[b]=h[b])}return u},A.apply(this,arguments)};Object.defineProperty(s,"__esModule",{value:!0}),s.AutoCollectNativePerformance=void 0;var f=Cl(),w=hs(),x=ot(),g=function(){function u(h){this._disabledMetrics={},u.INSTANCE&&u.INSTANCE.dispose(),u.INSTANCE=this,this._client=h}return a(u,"e"),u.isNodeVersionCompatible=function(){var h=process.versions.node.split(".");return parseInt(h[0])>=6},u.prototype.enable=function(h,v,_){var b=this;if(v===void 0&&(v={}),_===void 0&&(_=6e4),!!u.isNodeVersionCompatible()){if(u._metricsAvailable==null&&h&&!this._isInitialized)try{var y=K(9166);u._emitter=new y,u._metricsAvailable=!0,x.info("Native metrics module successfully loaded!")}catch(E){u._metricsAvailable=!1;return}this._isEnabled=h,this._disabledMetrics=v,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&u._emitter?(u._emitter.enable(!0,_),this._handle||(this._handle=setInterval(function(){return b._trackNativeMetrics()},_),this._handle.unref())):u._emitter&&(u._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))}},u.prototype.dispose=function(){this.enable(!1)},u.parseEnabled=function(h){var v=process.env[f.ENV_nativeMetricsDisableAll],_=process.env[f.ENV_nativeMetricsDisablers];if(v)return{isEnabled:!1,disabledMetrics:{}};if(_){var b=_.split(","),y={};if(b.length>0)for(var E=0,C=b;E<C.length;E++){var T=C[E];y[T]=!0}return typeof h=="object"?{isEnabled:!0,disabledMetrics:A(A({},h),y)}:{isEnabled:h,disabledMetrics:y}}return typeof h=="boolean"?{isEnabled:h,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:h}},u.prototype._trackNativeMetrics=function(){var h=!0;typeof this._isEnabled!="object"&&(h=this._isEnabled),h&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},u.prototype._trackGarbageCollection=function(){var h;if(!this._disabledMetrics.gc){var v=u._emitter.getGCData();for(var _ in v){var b=v[_].metrics,y=_+" Garbage Collection Duration",E=Math.sqrt(b.sumSquares/b.count-Math.pow(b.total/b.count,2))||0;this._client.trackMetric({name:y,value:b.total,count:b.count,max:b.max,min:b.min,stdDev:E,tagOverrides:(h={},h[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+w.sdkVersion,h)})}}},u.prototype._trackEventLoop=function(){var h;if(!this._disabledMetrics.loop){var v=u._emitter.getLoopData(),_=v.loopUsage;if(_.count!=0){var b="Event Loop CPU Time",y=Math.sqrt(_.sumSquares/_.count-Math.pow(_.total/_.count,2))||0;this._client.trackMetric({name:b,value:_.total,count:_.count,min:_.min,max:_.max,stdDev:y,tagOverrides:(h={},h[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+w.sdkVersion,h)})}}},u.prototype._trackHeapUsage=function(){var h,v,_;if(!this._disabledMetrics.heap){var b=process.memoryUsage(),y=b.heapUsed,E=b.heapTotal,C=b.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:y,count:1,tagOverrides:(h={},h[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+w.sdkVersion,h)}),this._client.trackMetric({name:"Memory Total (Heap)",value:E,count:1,tagOverrides:(v={},v[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+w.sdkVersion,v)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:C-E,count:1,tagOverrides:(_={},_[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+w.sdkVersion,_)})}},u}();s.AutoCollectNativePerformance=g}),Cr=$((s,A)=>{"use strict";var f=ot(),w=function(){function x(g,u,h,v){this._buffer=[],this._lastSend=0,this._isDisabled=g,this._getBatchSize=u,this._getBatchIntervalMs=h,this._sender=v}return a(x,"e"),x.prototype.setUseDiskRetryCaching=function(g,u,h){this._sender.setDiskRetryMode(g,u,h)},x.prototype.send=function(g){var u=this;if(!this._isDisabled()){if(!g){f.warn("Cannot send null/undefined telemetry");return}if(this._buffer.push(g),this._buffer.length>=this._getBatchSize()){this.triggerSend(!1);return}!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout(function(){u._timeoutHandle=null,u.triggerSend(!1)},this._getBatchIntervalMs()))}},x.prototype.triggerSend=function(g,u){var h=this._buffer.length<1;h||(g?(this._sender.saveOnCrash(this._buffer),typeof u=="function"&&u("data saved on crash")):this._sender.send(this._buffer,u)),this._lastSend=+new Date,this._buffer=[],clearTimeout(this._timeoutHandle),this._timeoutHandle=null,h&&typeof u=="function"&&u("no data to send")},x}();A.exports=w}),ps=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.azureRoleEnvironmentTelemetryProcessor=void 0;function A(f,w){process.env.WEBSITE_SITE_NAME&&(f.tags[w.keys.cloudRole]=process.env.WEBSITE_SITE_NAME)}a(A,"pN"),s.azureRoleEnvironmentTelemetryProcessor=A}),$o=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.getSamplingHashCode=s.samplingTelemetryProcessor=void 0;var A=pn();function f(x,g){var u=x.sampleRate,h=!1;return u==null||u>=100||x.data&&A.TelemetryType.Metric===A.baseTypeToTelemetryType(x.data.baseType)?!0:(g.correlationContext&&g.correlationContext.operation?h=w(g.correlationContext.operation.id)<u:h=Math.random()*100<u,h)}a(f,"fN"),s.samplingTelemetryProcessor=f;function w(x){var g=-2147483648,u=2147483647,h=5381;if(!x)return 0;for(;x.length<8;)x=x+x;for(var v=0;v<x.length;v++)h=((h<<5)+h|0)+x.charCodeAt(v)|0;return h=h<=g?u:Math.abs(h),h/u*100}a(w,"Fm"),s.getSamplingHashCode=w}),Tl=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.performanceMetricsTelemetryProcessor=void 0;var A=mr(),f=pn();function w(x,g){switch(g&&g.addDocument(x),x.data.baseType){case f.TelemetryTypeString.Exception:A.countException();break;case f.TelemetryTypeString.Request:var u=x.data.baseData;A.countRequest(u.duration,u.success);break;case f.TelemetryTypeString.Dependency:var h=x.data.baseData;A.countDependency(h.duration,h.success);break}return!0}a(w,"dN"),s.performanceMetricsTelemetryProcessor=w}),gn=$(s=>{"use strict";var A=s&&s.__assign||function(){return A=Object.assign||function(u){for(var h,v=1,_=arguments.length;v<_;v++){h=arguments[v];for(var b in h)Object.prototype.hasOwnProperty.call(h,b)&&(u[b]=h[b])}return u},A.apply(this,arguments)};Object.defineProperty(s,"__esModule",{value:!0}),s.preAggregatedMetricsTelemetryProcessor=void 0;var f=pn(),w=Pr(),x=pn();function g(u,h){if(w.isEnabled())switch(u.data.baseType){case x.TelemetryTypeString.Exception:var v=u.data.baseData;v.properties=A(A({},v.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Exceptions', Ver:'1.1')"});var _={cloudRoleInstance:u.tags[h.keys.cloudRoleInstance],cloudRoleName:u.tags[h.keys.cloudRole]};w.countException(_);break;case x.TelemetryTypeString.Trace:var b=u.data.baseData;b.properties=A(A({},b.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Traces', Ver:'1.1')"});var y={cloudRoleInstance:u.tags[h.keys.cloudRoleInstance],cloudRoleName:u.tags[h.keys.cloudRole],traceSeverityLevel:f.SeverityLevel[b.severity]};w.countTrace(y);break;case x.TelemetryTypeString.Request:var E=u.data.baseData;E.properties=A(A({},E.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Requests', Ver:'1.1')"});var C={cloudRoleInstance:u.tags[h.keys.cloudRoleInstance],cloudRoleName:u.tags[h.keys.cloudRole],operationSynthetic:u.tags[h.keys.operationSyntheticSource],requestSuccess:E.success,requestResultCode:E.responseCode};w.countRequest(E.duration,C);break;case x.TelemetryTypeString.Dependency:var T=u.data.baseData;T.properties=A(A({},T.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Dependencies', Ver:'1.1')"});var R={cloudRoleInstance:u.tags[h.keys.cloudRoleInstance],cloudRoleName:u.tags[h.keys.cloudRole],operationSynthetic:u.tags[h.keys.operationSyntheticSource],dependencySuccess:T.success,dependencyType:T.type,dependencyTarget:T.target,dependencyResultCode:T.resultCode};w.countDependency(T.duration,R);break}return!0}a(g,"_N"),s.preAggregatedMetricsTelemetryProcessor=g}),Vu=$(s=>{"use strict";var A=s&&s.__createBinding||(Object.create?function(w,x,g,u){u===void 0&&(u=g),Object.defineProperty(w,u,{enumerable:!0,get:function(){return x[g]}})}:function(w,x,g,u){u===void 0&&(u=g),w[u]=x[g]}),f=s&&s.__exportStar||function(w,x){for(var g in w)g!=="default"&&!Object.prototype.hasOwnProperty.call(x,g)&&A(x,w,g)};Object.defineProperty(s,"__esModule",{value:!0}),f(ps(),s),f($o(),s),f(Tl(),s),f(gn(),s)}),Si=$((s,A)=>{"use strict";var f=s&&s.__awaiter||function(C,T,R,D){function k(G){return G instanceof R?G:new R(function(Z){Z(G)})}return a(k,"i"),new(R||(R=Promise))(function(G,Z){function Q(Pe){try{Ee(D.next(Pe))}catch(He){Z(He)}}a(Q,"o");function fe(Pe){try{Ee(D.throw(Pe))}catch(He){Z(He)}}a(fe,"u");function Ee(Pe){Pe.done?G(Pe.value):k(Pe.value).then(Q,fe)}a(Ee,"c"),Ee((D=D.apply(C,T||[])).next())})},w=s&&s.__generator||function(C,T){var R={label:0,sent:function(){if(G[0]&1)throw G[1];return G[1]},trys:[],ops:[]},D,k,G,Z;return Z={next:Q(0),throw:Q(1),return:Q(2)},typeof Symbol=="function"&&(Z[Symbol.iterator]=function(){return this}),Z;function Q(Ee){return function(Pe){return fe([Ee,Pe])}}function fe(Ee){if(D)throw new TypeError("Generator is already executing.");for(;R;)try{if(D=1,k&&(G=Ee[0]&2?k.return:Ee[0]?k.throw||((G=k.return)&&G.call(k),0):k.next)&&!(G=G.call(k,Ee[1])).done)return G;switch(k=0,G&&(Ee=[Ee[0]&2,G.value]),Ee[0]){case 0:case 1:G=Ee;break;case 4:return R.label++,{value:Ee[1],done:!1};case 5:R.label++,k=Ee[1],Ee=[0];continue;case 7:Ee=R.ops.pop(),R.trys.pop();continue;default:if(G=R.trys,!(G=G.length>0&&G[G.length-1])&&(Ee[0]===6||Ee[0]===2)){R=0;continue}if(Ee[0]===3&&(!G||Ee[1]>G[0]&&Ee[1]<G[3])){R.label=Ee[1];break}if(Ee[0]===6&&R.label<G[1]){R.label=G[1],G=Ee;break}if(G&&R.label<G[2]){R.label=G[2],R.ops.push(Ee);break}G[2]&&R.ops.pop(),R.trys.pop();continue}Ee=T.call(C,R)}catch(Pe){Ee=[6,Pe],k=0}finally{D=G=0}if(Ee[0]&5)throw Ee[1];return{value:Ee[0]?Ee[1]:void 0,done:!0}}},x=K(7147),g=K(2037),u=K(1017),h=K(9796),v=K(2081),_=ot(),b=Fi(),y=hn(),E=function(){function C(T,R,D){if(this._redirectedHost=null,this._config=T,this._onSuccess=R,this._onError=D,this._enableDiskRetryMode=!1,this._resendInterval=C.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=C.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,this._numConsecutiveRedirects=0,this._resendTimer=null,this._fileCleanupTimer=null,this._tempDir=u.join(g.tmpdir(),C.TEMPDIR_PREFIX+this._config.instrumentationKey),!C.OS_PROVIDES_FILE_PROTECTION)if(C.USE_ICACLS){try{C.OS_PROVIDES_FILE_PROTECTION=x.existsSync(C.ICACLS_PATH)}catch(k){}C.OS_PROVIDES_FILE_PROTECTION||_.warn(C.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else C.OS_PROVIDES_FILE_PROTECTION=!0}return a(C,"e"),C.prototype.setDiskRetryMode=function(T,R,D){var k=this;this._enableDiskRetryMode=C.OS_PROVIDES_FILE_PROTECTION&&T,typeof R=="number"&&R>=0&&(this._resendInterval=Math.floor(R)),typeof D=="number"&&D>=0&&(this._maxBytesOnDisk=Math.floor(D)),T&&!C.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,_.warn(C.TAG,"Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected.")),this._enableDiskRetryMode?this._fileCleanupTimer||(this._fileCleanupTimer=setTimeout(function(){k._fileCleanupTask()},C.CLEANUP_TIMEOUT),this._fileCleanupTimer.unref()):this._fileCleanupTimer&&clearTimeout(this._fileCleanupTimer)},C.prototype.send=function(T,R){return f(this,void 0,void 0,function(){var D,k,G,Z,Q=this;return w(this,function(fe){return T&&(D=this._redirectedHost||this._config.endpointUrl,k={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}},G="",T.forEach(function(Ee){var Pe=Q._stringify(Ee);typeof Pe=="string"&&(G+=Pe+`
`)}),G.length>0&&(G=G.substring(0,G.length-1)),Z=Buffer.from?Buffer.from(G):new Buffer(G),h.gzip(Z,function(Ee,Pe){var He=Pe;Ee?(_.warn(Ee),He=Z,k.headers["Content-Length"]=Z.length.toString()):(k.headers["Content-Encoding"]="gzip",k.headers["Content-Length"]=Pe.length.toString()),_.info(C.TAG,k),k[b.disableCollectionRequestOption]=!0;var Qe=a(function(mt){mt.setEncoding("utf-8");var bt="";mt.on("data",function(jt){bt+=jt}),mt.on("end",function(){if(Q._numConsecutiveFailures=0,Q._enableDiskRetryMode){if(mt.statusCode===200)Q._resendTimer||(Q._resendTimer=setTimeout(function(){Q._resendTimer=null,Q._sendFirstFileOnDisk()},Q._resendInterval),Q._resendTimer.unref());else if(Q._isRetriable(mt.statusCode))try{var jt=JSON.parse(bt),Bt=[];jt.errors.forEach(function(Mt){Q._isRetriable(Mt.statusCode)&&Bt.push(T[Mt.index])}),Bt.length>0&&Q._storeToDisk(Bt)}catch(Mt){Q._storeToDisk(T)}}if(mt.statusCode===307||mt.statusCode===308)if(Q._numConsecutiveRedirects++,Q._numConsecutiveRedirects<10){var Tr=mt.headers.location?mt.headers.location.toString():null;Tr&&(Q._redirectedHost=Tr,Q.send(T,R))}else typeof R=="function"&&R("Error sending telemetry because of circular redirects.");else Q._numConsecutiveRedirects=0,typeof R=="function"&&R(bt),_.info(C.TAG,bt),typeof Q._onSuccess=="function"&&Q._onSuccess(bt)})},"d"),tt=y.makeRequest(Q._config,D,k,Qe);tt.on("error",function(mt){if(Q._numConsecutiveFailures++,!Q._enableDiskRetryMode||Q._numConsecutiveFailures>0&&Q._numConsecutiveFailures%C.MAX_CONNECTION_FAILURES_BEFORE_WARN==0){var bt="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";Q._enableDiskRetryMode&&(bt="Ingestion endpoint could not be reached "+Q._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),_.warn(C.TAG,bt,y.dumpObj(mt))}else{var bt="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:";_.info(C.TAG,bt,y.dumpObj(mt))}Q._onErrorHelper(mt),typeof R=="function"&&(mt&&R(y.dumpObj(mt)),R("Error sending telemetry")),Q._enableDiskRetryMode&&Q._storeToDisk(T)}),tt.write(He),tt.end()})),[2]})})},C.prototype.saveOnCrash=function(T){this._enableDiskRetryMode&&this._storeToDiskSync(this._stringify(T))},C.prototype._isRetriable=function(T){return T===206||T===408||T===429||T===439||T===500||T===503},C.prototype._runICACLS=function(T,R){var D=v.spawn(C.ICACLS_PATH,T,{windowsHide:!0});D.on("error",function(k){return R(k)}),D.on("close",function(k,G){return R(k===0?null:new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+k+")"))})},C.prototype._runICACLSSync=function(T){if(v.spawnSync){var R=v.spawnSync(C.ICACLS_PATH,T,{windowsHide:!0});if(R.error)throw R.error;if(R.status!==0)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+R.status+")")}else throw new Error("Could not synchronously call ICACLS under current version of Node.js")},C.prototype._getACLIdentity=function(T){if(C.ACL_IDENTITY)return T(null,C.ACL_IDENTITY);var R=v.spawn(C.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),D="";R.stdout.on("data",function(k){return D+=k}),R.on("error",function(k){return T(k,null)}),R.on("close",function(k,G){return C.ACL_IDENTITY=D&&D.trim(),T(k===0?null:new Error("Getting ACL identity did not succeed (PS returned code "+k+")"),C.ACL_IDENTITY)})},C.prototype._getACLIdentitySync=function(){if(C.ACL_IDENTITY)return C.ACL_IDENTITY;if(v.spawnSync){var T=v.spawnSync(C.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(T.error)throw T.error;if(T.status!==0)throw new Error("Getting ACL identity did not succeed (PS returned code "+T.status+")");return C.ACL_IDENTITY=T.stdout&&T.stdout.toString().trim(),C.ACL_IDENTITY}else throw new Error("Could not synchronously get ACL identity under current version of Node.js")},C.prototype._getACLArguments=function(T,R){return[T,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",R+":(OI)(CI)F","/inheritance:r"]},C.prototype._applyACLRules=function(T,R){var D=this;if(!C.USE_ICACLS)return R(null);if(C.ACLED_DIRECTORIES[T]===void 0)C.ACLED_DIRECTORIES[T]=!1,this._getACLIdentity(function(k,G){if(k)return C.ACLED_DIRECTORIES[T]=!1,R(k);D._runICACLS(D._getACLArguments(T,G),function(Z){return C.ACLED_DIRECTORIES[T]=!Z,R(Z)})});else return R(C.ACLED_DIRECTORIES[T]?null:new Error("Setting ACL restrictions did not succeed (cached result)"))},C.prototype._applyACLRulesSync=function(T){if(C.USE_ICACLS){if(C.ACLED_DIRECTORIES[T]===void 0){this._runICACLSSync(this._getACLArguments(T,this._getACLIdentitySync())),C.ACLED_DIRECTORIES[T]=!0;return}else if(!C.ACLED_DIRECTORIES[T])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},C.prototype._confirmDirExists=function(T,R){var D=this;x.lstat(T,function(k,G){k&&k.code==="ENOENT"?x.mkdir(T,function(Z){Z&&Z.code!=="EEXIST"?R(Z):D._applyACLRules(T,R)}):!k&&G.isDirectory()?D._applyACLRules(T,R):R(k||new Error("Path existed but was not a directory"))})},C.prototype._getShallowDirectorySize=function(T,R){x.readdir(T,function(D,k){if(D)return R(D,-1);var G=null,Z=0,Q=0;if(k.length===0){R(null,0);return}for(var fe=0;fe<k.length;fe++)x.stat(u.join(T,k[fe]),function(Ee,Pe){Q++,Ee?G=Ee:Pe.isFile()&&(Z+=Pe.size),Q===k.length&&(G?R(G,-1):R(G,Z))})})},C.prototype._getShallowDirectorySizeSync=function(T){for(var R=x.readdirSync(T),D=0,k=0;k<R.length;k++)D+=x.statSync(u.join(T,R[k])).size;return D},C.prototype._storeToDisk=function(T){var R=this;_.info(C.TAG,"Checking existence of data storage directory: "+this._tempDir),this._confirmDirExists(this._tempDir,function(D){if(D){_.warn(C.TAG,"Error while checking/creating directory: "+(D&&D.message)),R._onErrorHelper(D);return}R._getShallowDirectorySize(R._tempDir,function(k,G){if(k||G<0){_.warn(C.TAG,"Error while checking directory size: "+(k&&k.message)),R._onErrorHelper(k);return}else if(G>R._maxBytesOnDisk){_.warn(C.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+G);return}var Z=new Date().getTime()+".ai.json",Q=u.join(R._tempDir,Z);_.info(C.TAG,"saving data to disk at: "+Q),x.writeFile(Q,R._stringify(T),{mode:384},function(fe){return R._onErrorHelper(fe)})})})},C.prototype._storeToDiskSync=function(T){try{_.info(C.TAG,"Checking existence of data storage directory: "+this._tempDir),x.existsSync(this._tempDir)||x.mkdirSync(this._tempDir),this._applyACLRulesSync(this._tempDir);var R=this._getShallowDirectorySizeSync(this._tempDir);if(R>this._maxBytesOnDisk){_.info(C.TAG,"Not saving data due to max size limit being met. Directory size in bytes is: "+R);return}var D=new Date().getTime()+".ai.json",k=u.join(this._tempDir,D);_.info(C.TAG,"saving data before crash to disk at: "+k),x.writeFileSync(k,T,{mode:384})}catch(G){_.warn(C.TAG,"Error while saving data to disk: "+(G&&G.message)),this._onErrorHelper(G)}},C.prototype._sendFirstFileOnDisk=function(){var T=this;x.exists(this._tempDir,function(R){R&&x.readdir(T._tempDir,function(D,k){if(D)T._onErrorHelper(D);else if(k=k.filter(function(Q){return u.basename(Q).indexOf(".ai.json")>-1}),k.length>0){var G=k[0],Z=u.join(T._tempDir,G);x.readFile(Z,function(Q,fe){Q?T._onErrorHelper(Q):x.unlink(Z,function(Ee){if(Ee)T._onErrorHelper(Ee);else try{var Pe=JSON.parse(fe.toString());T.send(Pe)}catch(He){_.warn("Failed to read persisted file",He)}})})}})})},C.prototype._onErrorHelper=function(T){typeof this._onError=="function"&&this._onError(T)},C.prototype._stringify=function(T){try{return JSON.stringify(T)}catch(R){_.warn("Failed to serialize payload",R,T)}},C.prototype._fileCleanupTask=function(){var T=this;x.exists(this._tempDir,function(R){R&&x.readdir(T._tempDir,function(D,k){D?T._onErrorHelper(D):(k=k.filter(function(G){return u.basename(G).indexOf(".ai.json")>-1}),k.length>0&&k.forEach(function(G){var Z=new Date(parseInt(G.split(".ai.json")[0])),Q=new Date(+new Date-C.FILE_RETEMPTION_PERIOD)>Z;if(Q){var fe=u.join(T._tempDir,G);x.unlink(fe,function(Ee){Ee&&T._onErrorHelper(Ee)})}}))})})},C.TAG="Sender",C.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",C.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",C.ACLED_DIRECTORIES={},C.ACL_IDENTITY=null,C.WAIT_BETWEEN_RESEND=60*1e3,C.MAX_BYTES_ON_DISK=50*1024*1024,C.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,C.CLEANUP_TIMEOUT=60*60*1e3,C.FILE_RETEMPTION_PERIOD=7*24*60*60*1e3,C.TEMPDIR_PREFIX="appInsights-node",C.OS_PROVIDES_FILE_PROTECTION=!1,C.USE_ICACLS=g.type()==="Windows_NT",C}();A.exports=E}),yc=$((s,A)=>{"use strict";var f=pn(),w=hn(),x=$i(),g=function(){function h(){}return a(h,"e"),h.createEnvelope=function(v,_,b,y,E){var C=null;switch(_){case f.TelemetryType.Trace:C=h.createTraceData(v);break;case f.TelemetryType.Dependency:C=h.createDependencyData(v);break;case f.TelemetryType.Event:C=h.createEventData(v);break;case f.TelemetryType.Exception:C=h.createExceptionData(v);break;case f.TelemetryType.Request:C=h.createRequestData(v);break;case f.TelemetryType.Metric:C=h.createMetricData(v);break;case f.TelemetryType.Availability:C=h.createAvailabilityData(v);break;case f.TelemetryType.PageView:C=h.createPageViewData(v);break}if(b&&f.domainSupportsProperties(C.baseData)){if(C&&C.baseData)if(!C.baseData.properties)C.baseData.properties=b;else for(var T in b)C.baseData.properties[T]||(C.baseData.properties[T]=b[T]);C.baseData.properties=w.validateStringMap(C.baseData.properties)}var R=E&&E.instrumentationKey||"",D=new f.Envelope;return D.data=C,D.iKey=R,D.name="Microsoft.ApplicationInsights."+R.replace(/-/g,"")+"."+C.baseType.substr(0,C.baseType.length-4),D.tags=this.getTags(y,v.tagOverrides),D.time=new Date().toISOString(),D.ver=1,D.sampleRate=E?E.samplingPercentage:100,_===f.TelemetryType.Metric&&(D.sampleRate=100),D},h.createTraceData=function(v){var _=new f.MessageData;_.message=v.message,_.properties=v.properties,isNaN(v.severity)?_.severityLevel=f.SeverityLevel.Information:_.severityLevel=v.severity;var b=new f.Data;return b.baseType=f.telemetryTypeToBaseType(f.TelemetryType.Trace),b.baseData=_,b},h.createDependencyData=function(v){var _=new f.RemoteDependencyData;typeof v.name=="string"&&(_.name=v.name.length>1024?v.name.slice(0,1021)+"...":v.name),_.data=v.data,_.target=v.target,_.duration=w.msToTimeSpan(v.duration),_.success=v.success,_.type=v.dependencyTypeName,_.properties=v.properties,_.resultCode=v.resultCode?v.resultCode+"":"",v.id?_.id=v.id:_.id=w.w3cTraceId();var b=new f.Data;return b.baseType=f.telemetryTypeToBaseType(f.TelemetryType.Dependency),b.baseData=_,b},h.createEventData=function(v){var _=new f.EventData;_.name=v.name,_.properties=v.properties,_.measurements=v.measurements;var b=new f.Data;return b.baseType=f.telemetryTypeToBaseType(f.TelemetryType.Event),b.baseData=_,b},h.createExceptionData=function(v){var _=new f.ExceptionData;_.properties=v.properties,isNaN(v.severity)?_.severityLevel=f.SeverityLevel.Error:_.severityLevel=v.severity,_.measurements=v.measurements,_.exceptions=[];var b=v.exception.stack,y=new f.ExceptionDetails;y.message=v.exception.message,y.typeName=v.exception.name,y.parsedStack=this.parseStack(b),y.hasFullStack=w.isArray(y.parsedStack)&&y.parsedStack.length>0,_.exceptions.push(y);var E=new f.Data;return E.baseType=f.telemetryTypeToBaseType(f.TelemetryType.Exception),E.baseData=_,E},h.createRequestData=function(v){var _=new f.RequestData;v.id?_.id=v.id:_.id=w.w3cTraceId(),_.name=v.name,_.url=v.url,_.source=v.source,_.duration=w.msToTimeSpan(v.duration),_.responseCode=v.resultCode?v.resultCode+"":"",_.success=v.success,_.properties=v.properties;var b=new f.Data;return b.baseType=f.telemetryTypeToBaseType(f.TelemetryType.Request),b.baseData=_,b},h.createMetricData=function(v){var _=new f.MetricData;_.metrics=[];var b=new f.DataPoint;b.count=isNaN(v.count)?1:v.count,b.kind=f.DataPointType.Aggregation,b.max=isNaN(v.max)?v.value:v.max,b.min=isNaN(v.min)?v.value:v.min,b.name=v.name,b.stdDev=isNaN(v.stdDev)?0:v.stdDev,b.value=v.value,_.metrics.push(b),_.properties=v.properties;var y=new f.Data;return y.baseType=f.telemetryTypeToBaseType(f.TelemetryType.Metric),y.baseData=_,y},h.createAvailabilityData=function(v){var _=new f.AvailabilityData;v.id?_.id=v.id:_.id=w.w3cTraceId(),_.name=v.name,_.duration=w.msToTimeSpan(v.duration),_.success=v.success,_.runLocation=v.runLocation,_.message=v.message,_.measurements=v.measurements,_.properties=v.properties;var b=new f.Data;return b.baseType=f.telemetryTypeToBaseType(f.TelemetryType.Availability),b.baseData=_,b},h.createPageViewData=function(v){var _=new f.PageViewData;_.name=v.name,_.duration=w.msToTimeSpan(v.duration),_.url=v.url,_.measurements=v.measurements,_.properties=v.properties;var b=new f.Data;return b.baseType=f.telemetryTypeToBaseType(f.TelemetryType.PageView),b.baseData=_,b},h.getTags=function(v,_){var b=x.CorrelationContextManager.getCurrentContext(),y={};if(v&&v.tags)for(var E in v.tags)y[E]=v.tags[E];if(_)for(var E in _)y[E]=_[E];return b&&(y[v.keys.operationId]=y[v.keys.operationId]||b.operation.id,y[v.keys.operationName]=y[v.keys.operationName]||b.operation.name,y[v.keys.operationParentId]=y[v.keys.operationParentId]||b.operation.parentId),y},h.parseStack=function(v){var _=void 0;if(typeof v=="string"){var b=v.split(`
`);_=[];for(var y=0,E=0,C=0;C<=b.length;C++){var T=b[C];if(u.regex.test(T)){var R=new u(b[C],y++);E+=R.sizeInBytes,_.push(R)}}var D=32*1024;if(E>D)for(var k=0,G=_.length-1,Z=0,Q=k,fe=G;k<G;){var Ee=_[k].sizeInBytes,Pe=_[G].sizeInBytes;if(Z+=Ee+Pe,Z>D){var He=fe-Q+1;_.splice(Q,He);break}Q=k,fe=G,k++,G--}}return _},h}(),u=function(){function h(v,_){this.sizeInBytes=0,this.level=_,this.method="<no_method>",this.assembly=w.trim(v);var b=v.match(h.regex);b&&b.length>=5&&(this.method=w.trim(b[2])||this.method,this.fileName=w.trim(b[4])||"<no_filename>",this.line=parseInt(b[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=h.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return a(h,"e"),h.regex=/^(\s+at)?(.*?)(\@|\s\(|\s)([^\(\n]+):(\d+):(\d+)(\)?)$/,h.baseSize=58,h}();A.exports=g}),oo=$((s,A)=>{"use strict";var f=K(7310),w=Cl(),x=hs(),g=pn(),u=Cr(),h=Vu(),v=$i(),_=Si(),b=hn(),y=ot(),E=yc(),C=function(){function T(R){this._telemetryProcessors=[],this._enableAzureProperties=!1;var D=new w(R);this.config=D,this.context=new x,this.commonProperties={};var k=new _(this.config);this.channel=new u(function(){return D.disableAppInsights},function(){return D.maxBatchSize},function(){return D.maxBatchIntervalMs},k)}return a(T,"e"),T.prototype.trackAvailability=function(R){this.track(R,g.TelemetryType.Availability)},T.prototype.trackPageView=function(R){this.track(R,g.TelemetryType.PageView)},T.prototype.trackTrace=function(R){this.track(R,g.TelemetryType.Trace)},T.prototype.trackMetric=function(R){this.track(R,g.TelemetryType.Metric)},T.prototype.trackException=function(R){R&&R.exception&&!b.isError(R.exception)&&(R.exception=new Error(R.exception.toString())),this.track(R,g.TelemetryType.Exception)},T.prototype.trackEvent=function(R){this.track(R,g.TelemetryType.Event)},T.prototype.trackRequest=function(R){this.track(R,g.TelemetryType.Request)},T.prototype.trackDependency=function(R){R&&!R.target&&R.data&&(R.target=f.parse(R.data).host),this.track(R,g.TelemetryType.Dependency)},T.prototype.flush=function(R){this.channel.triggerSend(R?!!R.isAppCrashing:!1,R?R.callback:void 0)},T.prototype.track=function(R,D){if(R&&g.telemetryTypeToBaseType(D)){var k=E.createEnvelope(R,D,this.commonProperties,this.context,this.config);R.time&&(k.time=R.time.toISOString()),this._enableAzureProperties&&h.azureRoleEnvironmentTelemetryProcessor(k,this.context);var G=this.runTelemetryProcessors(k,R.contextObjects);G=G&&h.samplingTelemetryProcessor(k,{correlationContext:v.CorrelationContextManager.getCurrentContext()}),h.preAggregatedMetricsTelemetryProcessor(k,this.context),G&&(h.performanceMetricsTelemetryProcessor(k,this.quickPulseClient),this.channel.send(k))}else y.warn("track() requires telemetry object and telemetryType to be specified.")},T.prototype.setAutoPopulateAzureProperties=function(R){this._enableAzureProperties=R},T.prototype.addTelemetryProcessor=function(R){this._telemetryProcessors.push(R)},T.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},T.prototype.runTelemetryProcessors=function(R,D){var k=!0,G=this._telemetryProcessors.length;if(G===0)return k;D=D||{},D.correlationContext=v.CorrelationContextManager.getCurrentContext();for(var Z=0;Z<G;++Z)try{var Q=this._telemetryProcessors[Z];if(Q&&Q.apply(null,[R,D])===!1){k=!1;break}}catch(fe){k=!0,y.warn("One of telemetry processors failed, telemetry item will be sent.",fe,R)}return k&&(R&&R.tags&&(R.tags=b.validateStringMap(R.tags)),R&&R.data&&R.data.baseData&&R.data.baseData.properties&&(R.data.baseData.properties=b.validateStringMap(R.data.baseData.properties))),k},T}();A.exports=C}),cn=$((s,A)=>{"use strict";var f=s&&s.__extends||function(){var v=a(function(_,b){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,E){y.__proto__=E}||function(y,E){for(var C in E)Object.prototype.hasOwnProperty.call(E,C)&&(y[C]=E[C])},v(_,b)},"e");return function(_,b){v(_,b);function y(){this.constructor=_}a(y,"n"),_.prototype=b===null?Object.create(b):(y.prototype=b.prototype,new y)}}(),w=oo(),x=xl(),g=Fi(),u=ot(),h=function(v){f(_,v);function _(){return v!==null&&v.apply(this,arguments)||this}return a(_,"t"),_.prototype.trackNodeHttpRequestSync=function(b){b&&b.request&&b.response&&b.duration?x.trackRequestSync(this,b):u.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},_.prototype.trackNodeHttpRequest=function(b){(b.duration||b.error)&&u.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),b&&b.request&&b.response?x.trackRequest(this,b):u.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},_.prototype.trackNodeHttpDependency=function(b){b&&b.request?g.trackRequest(this,b):u.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},_}(w);A.exports=h}),_c=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0})}),Ei=$(s=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.dispose=s.Configuration=s.wrapWithCorrelationContext=s.startOperation=s.getCorrelationContext=s.start=s.setup=s.liveMetricsClient=s.defaultClient=s.DistributedTracingModes=void 0;var A=$i(),f=$u(),w=Fu(),x=mr(),g=Pr(),u=ju(),h=Fi(),v=xl(),_=J(),b=ot(),y=Wu(),E=vc();s.TelemetryClient=cn(),s.Contracts=pn(),s.azureFunctionsTypes=_c();var C;(function(Ot){Ot[Ot.AI=0]="AI",Ot[Ot.AI_AND_W3C=1]="AI_AND_W3C"})(C=s.DistributedTracingModes||(s.DistributedTracingModes={}));var T=!0,R=!1,D=!0,k=!0,G=!0,Z=!1,Q=!0,fe=!0,Ee=!0,Pe=!0,He,Qe=!1,tt=!0,mt,bt=void 0,jt=void 0,Bt,Tr,Mt,Ze,ht,dt,xt,Lt,qt=!1,Tt;function Qt(Ot){return s.defaultClient?b.info("The default client is already setup"):(s.defaultClient=new s.TelemetryClient(Ot),Bt=new f(s.defaultClient),Tr=new w(s.defaultClient),Mt=new x(s.defaultClient),Ze=new g(s.defaultClient),ht=new u(s.defaultClient),xt=new v(s.defaultClient),Lt=new h(s.defaultClient),dt||(dt=new E.AutoCollectNativePerformance(s.defaultClient))),s.defaultClient&&s.defaultClient.channel&&s.defaultClient.channel.setUseDiskRetryCaching(Ee,bt,jt),Fr}a(Qt,"GN"),s.setup=Qt;function Dr(){return s.defaultClient?(qt=!0,Bt.enable(T,R),Tr.enable(D),Mt.enable(k),Ze.enable(G),ht.enable(Z,s.defaultClient.config),dt.enable(tt,mt),xt.useAutoCorrelation(Pe,He),xt.enable(Q),Lt.enable(fe),s.liveMetricsClient&&Qe&&s.liveMetricsClient.enable(Qe)):b.warn("Start cannot be called before setup"),Fr}a(Dr,"PE"),s.start=Dr;function vr(){return Pe?A.CorrelationContextManager.getCurrentContext():null}a(vr,"FN"),s.getCorrelationContext=vr;function yr(Ot,At){return A.CorrelationContextManager.startOperation(Ot,At)}a(yr,"VN"),s.startOperation=yr;function ir(Ot,At){return A.CorrelationContextManager.wrapCallback(Ot,At)}a(ir,"$N"),s.wrapWithCorrelationContext=ir;var Fr=function(){function Ot(){}return a(Ot,"e"),Ot.setDistributedTracingMode=function(At){return _.w3cEnabled=At===C.AI_AND_W3C,Ot},Ot.setAutoCollectConsole=function(At,ar){return ar===void 0&&(ar=!1),T=At,R=ar,qt&&Bt.enable(At,ar),Ot},Ot.setAutoCollectExceptions=function(At){return D=At,qt&&Tr.enable(At),Ot},Ot.setAutoCollectPerformance=function(At,ar){ar===void 0&&(ar=!0),k=At;var Nr=E.AutoCollectNativePerformance.parseEnabled(ar);return tt=Nr.isEnabled,mt=Nr.disabledMetrics,qt&&(Mt.enable(At),dt.enable(Nr.isEnabled,Nr.disabledMetrics)),Ot},Ot.setAutoCollectPreAggregatedMetrics=function(At){return G=At,qt&&Ze.enable(At),Ot},Ot.setAutoCollectHeartbeat=function(At){return Z=At,qt&&ht.enable(At,s.defaultClient.config),Ot},Ot.setAutoCollectRequests=function(At){return Q=At,qt&&xt.enable(At),Ot},Ot.setAutoCollectDependencies=function(At){return fe=At,qt&&Lt.enable(At),Ot},Ot.setAutoDependencyCorrelation=function(At,ar){return Pe=At,He=ar,qt&&xt.useAutoCorrelation(At,ar),Ot},Ot.setUseDiskRetryCaching=function(At,ar,Nr){return Ee=At,bt=ar,jt=Nr,s.defaultClient&&s.defaultClient.channel&&s.defaultClient.channel.setUseDiskRetryCaching(At,ar,Nr),Ot},Ot.setInternalLogging=function(At,ar){return At===void 0&&(At=!1),ar===void 0&&(ar=!0),b.enableDebug=At,b.disableWarnings=!ar,Ot},Ot.setSendLiveMetrics=function(At){return At===void 0&&(At=!1),s.defaultClient?(!s.liveMetricsClient&&At?(s.liveMetricsClient=new y(s.defaultClient.config,null),Tt=new x(s.liveMetricsClient,1e3,!0),s.liveMetricsClient.addCollector(Tt),s.defaultClient.quickPulseClient=s.liveMetricsClient):s.liveMetricsClient&&s.liveMetricsClient.enable(At),Qe=At,Ot):(b.warn("Live metrics client cannot be setup without the default client"),Ot)},Ot.start=Dr,Ot}();s.Configuration=Fr;function mn(){_.w3cEnabled=!0,s.defaultClient=null,qt=!1,Bt&&Bt.dispose(),Tr&&Tr.dispose(),Mt&&Mt.dispose(),Ze&&Ze.dispose(),ht&&ht.dispose(),dt&&dt.dispose(),xt&&xt.dispose(),Lt&&Lt.dispose(),s.liveMetricsClient&&(s.liveMetricsClient.enable(!1),Qe=!1,s.liveMetricsClient=void 0)}a(mn,"zN"),s.dispose=mn});Y(B,{default:()=>Il});var wc=qe(K(2037)),Sr=qe(K(9496)),cr=qe(K(9496)),bc=qe(K(9496)),Vn;(function(s){s.ON="on",s.ERROR="error",s.OFF="off"})(Vn||(Vn={}));function Fo(){let s="telemetry",A="enableTelemetry";return bc.env.isTelemetryEnabled!==void 0?bc.env.isTelemetryEnabled?Vn.ON:Vn.OFF:bc.workspace.getConfiguration(s).get(A)?Vn.ON:Vn.OFF}a(Fo,"Fi");var Al=a(class{constructor(s,A,f,w,x){this.extensionId=s,this.extensionVersion=A,this.telemetryAppender=f,this.osShim=w,this.firstParty=!1,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this.firstParty=!!x,this.updateUserOptStatus(),cr.env.onDidChangeTelemetryEnabled!==void 0?(this.disposables.push(cr.env.onDidChangeTelemetryEnabled(()=>this.updateUserOptStatus())),this.disposables.push(cr.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus()))):this.disposables.push(cr.workspace.onDidChangeConfiguration(()=>this.updateUserOptStatus()))}updateUserOptStatus(){let s=Fo();this.userOptIn=s===Vn.ON,this.errorOptIn=s===Vn.ERROR||s===Vn.ON,(this.userOptIn||this.errorOptIn)&&this.telemetryAppender.instantiateAppender()}cleanRemoteName(s){if(!s)return"none";let A="other";return["ssh-remote","dev-container","attached-container","wsl"].forEach(f=>{s.indexOf(`${f}+`)===0&&(A=f)}),A}get extension(){return this._extension===void 0&&(this._extension=cr.extensions.getExtension(this.extensionId)),this._extension}cloneAndChange(s,A){if(s===null||typeof s!="object"||typeof A!="function")return s;let f={};for(let w in s)f[w]=A(w,s[w]);return f}shouldSendErrorTelemetry(){return this.errorOptIn===!1?!1:this.firstParty?this.cleanRemoteName(cr.env.remoteName)!=="other"?!0:!(this.extension===void 0||this.extension.extensionKind===cr.ExtensionKind.Workspace||cr.env.uiKind===cr.UIKind.Web):!0}getCommonProperties(){let s=Object.create(null);if(s["common.os"]=this.osShim.platform,s["common.platformversion"]=(this.osShim.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),s["common.extname"]=this.extensionId,s["common.extversion"]=this.extensionVersion,cr&&cr.env){switch(s["common.vscodemachineid"]=cr.env.machineId,s["common.vscodesessionid"]=cr.env.sessionId,s["common.vscodeversion"]=cr.version,s["common.isnewappinstall"]=cr.env.isNewAppInstall?cr.env.isNewAppInstall.toString():"false",s["common.product"]=cr.env.appHost,cr.env.uiKind){case cr.UIKind.Web:s["common.uikind"]="web";break;case cr.UIKind.Desktop:s["common.uikind"]="desktop";break;default:s["common.uikind"]="unknown"}s["common.remotename"]=this.cleanRemoteName(cr.env.remoteName)}return s}anonymizeFilePaths(s,A){let f;if(s==null)return"";let w=[];cr.env.appRoot!==""&&w.push(new RegExp(cr.env.appRoot.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")),this.extension&&w.push(new RegExp(this.extension.extensionPath.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi"));let x=s;if(A){let g=[];for(let _ of w)for(;(f=_.exec(s))&&f;)g.push([f.index,_.lastIndex]);let u=/^[\\/]?(node_modules|node_modules\.asar)[\\/]/,h=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-._]+(\\\\|\\|\/))+[\w-._]*/g,v=0;for(x="";(f=h.exec(s))&&f;)f[0]&&!u.test(f[0])&&g.every(([_,b])=>f.index<_||f.index>=b)&&(x+=s.substring(v,f.index)+"<REDACTED: user-file-path>",v=h.lastIndex);v<s.length&&(x+=s.substr(v))}for(let g of w)x=x.replace(g,"");return x}removePropertiesWithPossibleUserInfo(s){if(typeof s!="object")return;let A=Object.create(null);for(let f of Object.keys(s)){let w=s[f];if(!w)continue;let x=/@[a-zA-Z0-9-.]+/;/\S*(key|token|sig|password|passwd|pwd)[="':\s]+\S*/.test(w.toLowerCase())?A[f]="<REDACTED: secret>":x.test(w)?A[f]="<REDACTED: email>":A[f]=w}return A}sendTelemetryEvent(s,A,f){if(this.userOptIn&&s!==""){A=X(X({},A),this.getCommonProperties());let w=this.cloneAndChange(A,(x,g)=>this.anonymizeFilePaths(g,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${s}`,{properties:this.removePropertiesWithPossibleUserInfo(w),measurements:f})}}sendTelemetryErrorEvent(s,A,f,w){if(this.errorOptIn&&s!==""){A=X(X({},A),this.getCommonProperties());let x=this.cloneAndChange(A,(g,u)=>this.shouldSendErrorTelemetry()?this.anonymizeFilePaths(u,this.firstParty):w===void 0||w.indexOf(g)!==-1?"REDACTED":this.anonymizeFilePaths(u,this.firstParty));this.telemetryAppender.logEvent(`${this.extensionId}/${s}`,{properties:this.removePropertiesWithPossibleUserInfo(x),measurements:f})}}sendTelemetryException(s,A,f){if(this.shouldSendErrorTelemetry()&&this.errorOptIn&&s){A=X(X({},A),this.getCommonProperties());let w=this.cloneAndChange(A,(x,g)=>this.anonymizeFilePaths(g,this.firstParty));s.stack&&(s.stack=this.anonymizeFilePaths(s.stack,this.firstParty)),this.telemetryAppender.logException(s,{properties:this.removePropertiesWithPossibleUserInfo(w),measurements:f})}}dispose(){return this.telemetryAppender.flush(),Promise.all(this.disposables.map(s=>s.dispose()))}},"ao"),Rl=a(class{constructor(s){this._key=s,this._isInstantiated=!1,Fo()!==Vn.OFF&&this.instantiateAppender()}logEvent(s,A){!this._appInsightsClient||this._appInsightsClient.trackEvent({name:s,properties:A==null?void 0:A.properties,measurements:A==null?void 0:A.measurements})}logException(s,A){!this._appInsightsClient||this._appInsightsClient.trackException({exception:s,properties:A==null?void 0:A.properties,measurements:A==null?void 0:A.measurements})}flush(){return this._appInsightsClient&&(this._appInsightsClient.flush(),this._appInsightsClient=void 0),Promise.resolve(void 0)}instantiateAppender(){this._isInstantiated||Promise.resolve().then(()=>qe(Ei())).then(s=>{s.defaultClient?(this._appInsightsClient=new s.TelemetryClient(this._key),this._appInsightsClient.channel.setUseDiskRetryCaching(!0)):(s.setup(this._key).setAutoCollectRequests(!1).setAutoCollectPerformance(!1).setAutoCollectExceptions(!1).setAutoCollectDependencies(!1).setAutoDependencyCorrelation(!1).setAutoCollectConsole(!1).setUseDiskRetryCaching(!0).start(),this._appInsightsClient=s.defaultClient),Sr&&Sr.env&&(this._appInsightsClient.context.tags[this._appInsightsClient.context.keys.userId]=Sr.env.machineId,this._appInsightsClient.context.tags[this._appInsightsClient.context.keys.sessionId]=Sr.env.sessionId,this._appInsightsClient.context.tags[this._appInsightsClient.context.keys.cloudRole]=Sr.env.appName,this._appInsightsClient.context.tags[this._appInsightsClient.context.keys.cloudRoleInstance]=Sr.env.appName),this._key&&this._key.indexOf("AIF-")===0&&(this._appInsightsClient.config.endpointUrl="https://vortex.data.microsoft.com/collect/v1"),this._isInstantiated=!0})}},"NE"),Il=a(class extends Al{constructor(s,A,f,w){let x=new Rl(f);f&&f.indexOf("AIF-")===0&&(w=!0);super(s,A,x,{release:wc.release(),platform:wc.platform()},w)}},"_l")},3255:m=>{function B(K){var q=new Error("Cannot find module '"+K+"'");throw q.code="MODULE_NOT_FOUND",q}a(B,"webpackEmptyContext"),B.keys=()=>[],B.resolve=B,B.id=3255,m.exports=B},9118:m=>{function B(K){var q=new Error("Cannot find module '"+K+"'");throw q.code="MODULE_NOT_FOUND",q}a(B,"webpackEmptyContext"),B.keys=()=>[],B.resolve=B,B.id=9118,m.exports=B},800:(m,B,K)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0}),B.config=B.loadMessageBundle=B.localize=B.format=B.setPseudo=B.isPseudo=B.isDefined=B.BundleFormat=B.MessageFormat=void 0;var q=K(1926),j;(function(pe){pe.file="file",pe.bundle="bundle",pe.both="both"})(j=B.MessageFormat||(B.MessageFormat={}));var se;(function(pe){pe.standalone="standalone",pe.languagePack="languagePack"})(se=B.BundleFormat||(B.BundleFormat={}));var ne;(function(pe){function $(Y){var Ve=Y;return Ve&&ue(Ve.key)&&ue(Ve.comment)}a($,"is"),pe.is=$})(ne||(ne={}));function ue(pe){return typeof pe!="undefined"}a(ue,"isDefined"),B.isDefined=ue,B.isPseudo=!1;function ce(pe){B.isPseudo=pe}a(ce,"setPseudo"),B.setPseudo=ce;function z(pe,$){var Y;return B.isPseudo&&(pe="\uFF3B"+pe.replace(/[aouei]/g,"$&$&")+"\uFF3D"),$.length===0?Y=pe:Y=pe.replace(/\{(\d+)\}/g,function(Ve,qe){var ot=qe[0],we=$[ot],Se=Ve;return typeof we=="string"?Se=we:(typeof we=="number"||typeof we=="boolean"||we===void 0||we===null)&&(Se=String(we)),Se}),Y}a(z,"format"),B.format=z;function H(pe,$){for(var Y=[],Ve=2;Ve<arguments.length;Ve++)Y[Ve-2]=arguments[Ve];return z($,Y)}a(H,"localize"),B.localize=H;function M(pe){return q.default().loadMessageBundle(pe)}a(M,"loadMessageBundle"),B.loadMessageBundle=M;function X(pe){return q.default().config(pe)}a(X,"config"),B.config=X},1926:(m,B)=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});var K;function q(){if(K===void 0)throw new Error("No runtime abstraction layer installed");return K}a(q,"RAL"),function(j){function se(ne){if(ne===void 0)throw new Error("No runtime abstraction layer provided");K=ne}a(se,"install"),j.install=se}(q||(q={})),B.default=q},8472:(m,B,K)=>{"use strict";var q;q={value:!0},q=B.loadMessageBundle=void 0;var j=K(1017),se=K(7147),ne=K(1926),ue=K(800),ce=K(800);q={enumerable:!0,get:function(){return ce.MessageFormat}},q={enumerable:!0,get:function(){return ce.BundleFormat}};var z=Object.prototype.toString;function H(ye){return z.call(ye)==="[object Number]"}a(H,"isNumber");function M(ye){return z.call(ye)==="[object String]"}a(M,"isString");function X(ye){return ye===!0||ye===!1}a(X,"isBoolean");function pe(ye){return JSON.parse(se.readFileSync(ye,"utf8"))}a(pe,"readJsonFileSync");var $,Y;function Ve(){if(Y={locale:void 0,language:void 0,languagePackSupport:!1,cacheLanguageResolution:!0,messageFormat:ue.MessageFormat.bundle},M(process.env.VSCODE_NLS_CONFIG))try{var ye=JSON.parse(process.env.VSCODE_NLS_CONFIG),Ue=void 0;if(ye.availableLanguages){var Xe=ye.availableLanguages["*"];M(Xe)&&(Ue=Xe)}if(M(ye.locale)&&(Y.locale=ye.locale.toLowerCase()),Ue===void 0?Y.language=Y.locale:Ue!=="en"&&(Y.language=Ue),X(ye._languagePackSupport)&&(Y.languagePackSupport=ye._languagePackSupport),M(ye._cacheRoot)&&(Y.cacheRoot=ye._cacheRoot),M(ye._languagePackId)&&(Y.languagePackId=ye._languagePackId),M(ye._translationsConfigFile)){Y.translationsConfigFile=ye._translationsConfigFile;try{Y.translationsConfig=pe(Y.translationsConfigFile)}catch(Ne){if(ye._corruptedFile){var Ke=j.dirname(ye._corruptedFile);se.exists(Ke,function(De){De&&se.writeFile(ye._corruptedFile,"corrupted","utf8",function(pt){console.error(pt)})})}}}}catch(Ne){}ue.setPseudo(Y.locale==="pseudo"),$=Object.create(null)}a(Ve,"initializeSettings"),Ve();function qe(){return Y.languagePackSupport===!0&&Y.cacheRoot!==void 0&&Y.languagePackId!==void 0&&Y.translationsConfigFile!==void 0&&Y.translationsConfig!==void 0}a(qe,"supportsLanguagePack");function ot(ye){return function(Ue,Xe){for(var Ke=[],Ne=2;Ne<arguments.length;Ne++)Ke[Ne-2]=arguments[Ne];if(H(Ue)){if(Ue>=ye.length){console.error(`Broken localize call found. Index out of bounds. Stacktrace is
: `+new Error("").stack);return}return ue.format(ye[Ue],Ke)}else{if(M(Xe))return console.warn("Message "+Xe+" didn't get externalized correctly."),ue.format(Xe,Ke);console.error(`Broken localize call found. Stacktrace is
: `+new Error("").stack)}}}a(ot,"createScopedLocalizeFunction");function we(ye){var Ue;if(Y.cacheLanguageResolution&&Ue)Ue=Ue;else{if(ue.isPseudo||!Y.language)Ue=".nls.json";else for(var Xe=Y.language;Xe;){var Ke=".nls."+Xe+".json";if(se.existsSync(ye+Ke)){Ue=Ke;break}else{var Ne=Xe.lastIndexOf("-");Ne>0?Xe=Xe.substring(0,Ne):(Ue=".nls.json",Xe=null)}}Y.cacheLanguageResolution&&(Ue=Ue)}return ye+Ue}a(we,"resolveLanguage");function Se(ye){for(var Ue=Y.language;Ue;){var Xe=j.join(ye,"nls.bundle."+Ue+".json");if(se.existsSync(Xe))return Xe;var Ke=Ue.lastIndexOf("-");Ke>0?Ue=Ue.substring(0,Ke):Ue=void 0}if(Ue===void 0){var Xe=j.join(ye,"nls.bundle.json");if(se.existsSync(Xe))return Xe}}a(Se,"findInTheBoxBundle");function be(ye){try{se.mkdirSync(ye)}catch(Xe){if(Xe.code==="EEXIST")return;if(Xe.code==="ENOENT"){var Ue=j.dirname(ye);Ue!==ye&&(be(Ue),se.mkdirSync(ye))}else throw Xe}}a(be,"mkdir");function L(ye){var Ue=pe(j.join(ye,"nls.metadata.json")),Xe=Object.create(null);for(var Ke in Ue){var Ne=Ue[Ke];Xe[Ke]=Ne.messages}return Xe}a(L,"createDefaultNlsBundle");function he(ye,Ue){var Xe=Y.translationsConfig[ye.id];if(!!Xe){var Ke=pe(Xe).contents,Ne=pe(j.join(Ue,"nls.metadata.json")),De=Object.create(null);for(var pt in Ne){var Rt=Ne[pt],xe=Ke[ye.outDir+"/"+pt];if(xe){for(var Pt=[],ut=0;ut<Rt.keys.length;ut++){var It=Rt.keys[ut],Be=M(It)?It:It.key,Me=xe[Be];Me===void 0&&(Me=Rt.messages[ut]),Pt.push(Me)}De[pt]=Pt}else De[pt]=Rt.messages}return De}}a(he,"createNLSBundle");function te(ye){var Ue=new Date;se.utimes(ye,Ue,Ue,function(){})}a(te,"touch");function Ae(ye,Ue){return $[ye]=Ue,Ue}a(Ae,"cacheBundle");function le(ye,Ue){var Xe,Ke=j.join(Y.cacheRoot,ye.id+"-"+ye.hash+".json"),Ne=!1,De=!1;try{return Xe=JSON.parse(se.readFileSync(Ke,{encoding:"utf8",flag:"r"})),te(Ke),Xe}catch(pt){if(pt.code==="ENOENT")De=!0;else if(pt instanceof SyntaxError)console.log("Syntax error parsing message bundle: "+pt.message+"."),se.unlink(Ke,function(Rt){Rt&&console.error("Deleting corrupted bundle "+Ke+" failed.")}),Ne=!0;else throw pt}if(Xe=he(ye,Ue),!Xe||Ne)return Xe;if(De)try{se.writeFileSync(Ke,JSON.stringify(Xe),{encoding:"utf8",flag:"wx"})}catch(pt){if(pt.code==="EEXIST")return Xe;throw pt}return Xe}a(le,"loadNlsBundleOrCreateFromI18n");function de(ye){try{return L(ye)}catch(Ue){console.log("Generating default bundle from meta data failed.",Ue);return}}a(de,"loadDefaultNlsBundle");function Ce(ye,Ue){var Xe;if(qe())try{Xe=le(ye,Ue)}catch(Ne){console.log("Load or create bundle failed ",Ne)}if(!Xe){if(Y.languagePackSupport)return de(Ue);var Ke=Se(Ue);if(Ke)try{return pe(Ke)}catch(Ne){console.log("Loading in the box message bundle failed.",Ne)}Xe=de(Ue)}return Xe}a(Ce,"loadNlsBundle");function Fe(ye){for(var Ue,Xe=j.dirname(ye);Ue=j.join(Xe,"nls.metadata.header.json"),!se.existsSync(Ue);){var Ke=j.dirname(Xe);if(Ke===Xe){Ue=void 0;break}else Xe=Ke}return Ue}a(Fe,"tryFindMetaDataHeaderFile");function We(ye){if(!ye)return ue.localize;var Ue=j.extname(ye);if(Ue&&(ye=ye.substr(0,ye.length-Ue.length)),Y.messageFormat===ue.MessageFormat.both||Y.messageFormat===ue.MessageFormat.bundle){var Xe=Fe(ye);if(Xe){var Ke=j.dirname(Xe),Ne=$[Ke];if(Ne===void 0)try{var De=JSON.parse(se.readFileSync(Xe,"utf8"));try{var pt=Ce(De,Ke);Ne=Ae(Ke,pt?{header:De,nlsBundle:pt}:null)}catch(ut){console.error("Failed to load nls bundle",ut),Ne=Ae(Ke,null)}}catch(ut){console.error("Failed to read header file",ut),Ne=Ae(Ke,null)}if(Ne){var Rt=ye.substr(Ke.length+1).replace(/\\/g,"/"),xe=Ne.nlsBundle[Rt];return xe===void 0?(console.error("Messages for file "+ye+" not found. See console for details."),function(){return"Messages not found."}):ot(xe)}}}if(Y.messageFormat===ue.MessageFormat.both||Y.messageFormat===ue.MessageFormat.file)try{var Pt=pe(we(ye));return Array.isArray(Pt)?ot(Pt):ue.isDefined(Pt.messages)&&ue.isDefined(Pt.keys)?ot(Pt.messages):(console.error("String bundle '"+ye+"' uses an unsupported format."),function(){return"File bundle has unsupported format. See console for details"})}catch(ut){ut.code!=="ENOENT"&&console.error("Failed to load single file bundle",ut)}return console.error("Failed to load message bundle for file "+ye),function(){return"Failed to load message bundle. See console for details."}}a(We,"loadMessageBundle"),B.loadMessageBundle=We;function Je(ye){return ye&&(M(ye.locale)&&(Y.locale=ye.locale.toLowerCase(),Y.language=Y.locale,$=Object.create(null)),ye.messageFormat!==void 0&&(Y.messageFormat=ye.messageFormat),ye.bundleFormat===ue.BundleFormat.standalone&&Y.languagePackSupport===!0&&(Y.languagePackSupport=!1)),ue.setPseudo(Y.locale==="pseudo"),We}a(Je,"config"),q=Je,ne.default.install(Object.freeze({loadMessageBundle:We,config:Je}))},6822:(m,B,K)=>{"use strict";m.exports=K(8472)},2479:m=>{m.exports=B;function B(K,q){if(K&&q)return B(K)(q);if(typeof K!="function")throw new TypeError("need wrapper function");return Object.keys(K).forEach(function(se){j[se]=K[se]}),j;function j(){for(var se=new Array(arguments.length),ne=0;ne<se.length;ne++)se[ne]=arguments[ne];var ue=K.apply(this,se),ce=se[se.length-1];return typeof ue=="function"&&ue!==ce&&Object.keys(ce).forEach(function(z){ue[z]=ce[z]}),ue}a(j,"wrapper")}a(B,"wrappy")},9166:m=>{"use strict";m.exports=require("applicationinsights-native-metrics")},9496:m=>{"use strict";m.exports=require("vscode")},9491:m=>{"use strict";m.exports=require("assert")},852:m=>{"use strict";m.exports=require("async_hooks")},2081:m=>{"use strict";m.exports=require("child_process")},6206:m=>{"use strict";m.exports=require("console")},2057:m=>{"use strict";m.exports=require("constants")},6113:m=>{"use strict";m.exports=require("crypto")},9523:m=>{"use strict";m.exports=require("dns")},2361:m=>{"use strict";m.exports=require("events")},7147:m=>{"use strict";m.exports=require("fs")},3685:m=>{"use strict";m.exports=require("http")},5687:m=>{"use strict";m.exports=require("https")},8188:m=>{"use strict";m.exports=require("module")},1808:m=>{"use strict";m.exports=require("net")},2037:m=>{"use strict";m.exports=require("os")},1017:m=>{"use strict";m.exports=require("path")},4074:m=>{"use strict";m.exports=require("perf_hooks")},2781:m=>{"use strict";m.exports=require("stream")},9512:m=>{"use strict";m.exports=require("timers")},7310:m=>{"use strict";m.exports=require("url")},3837:m=>{"use strict";m.exports=require("util")},9796:m=>{"use strict";m.exports=require("zlib")}},__webpack_module_cache__={};function __webpack_require__(m){var B=__webpack_module_cache__[m];if(B!==void 0)return B.exports;var K=__webpack_module_cache__[m]={id:m,loaded:!1,exports:{}};return __webpack_modules__[m].call(K.exports,K,K.exports,__webpack_require__),K.loaded=!0,K.exports}a(__webpack_require__,"__webpack_require__"),(()=>{__webpack_require__.n=m=>{var B=m&&m.__esModule?()=>m.default:()=>m;return __webpack_require__.d(B,{a:B}),B}})(),(()=>{var m=Object.getPrototypeOf?K=>Object.getPrototypeOf(K):K=>K.__proto__,B;__webpack_require__.t=function(K,q){if(q&1&&(K=this(K)),q&8||typeof K=="object"&&K&&(q&4&&K.__esModule||q&16&&typeof K.then=="function"))return K;var j=Object.create(null);__webpack_require__.r(j);var se={};B=B||[null,m({}),m([]),m(m)];for(var ne=q&2&&K;typeof ne=="object"&&!~B.indexOf(ne);ne=m(ne))Object.getOwnPropertyNames(ne).forEach(ue=>se[ue]=()=>K[ue]);return se.default=()=>K,__webpack_require__.d(j,se),j}})(),(()=>{__webpack_require__.d=(m,B)=>{for(var K in B)__webpack_require__.o(B,K)&&!__webpack_require__.o(m,K)&&Object.defineProperty(m,K,{enumerable:!0,get:B[K]})}})(),(()=>{__webpack_require__.o=(m,B)=>Object.prototype.hasOwnProperty.call(m,B)})(),(()=>{__webpack_require__.r=m=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(m,"__esModule",{value:!0})}})(),(()=>{__webpack_require__.nmd=m=>(m.paths=[],m.children||(m.children=[]),m)})();var __webpack_exports__={};(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{StateKeys:()=>qa,activate:()=>fy,getOpenActionsService:()=>_u,getState:()=>Pp,isInsiders:()=>kp,updateState:()=>th});var m=__webpack_require__(9496),B=__webpack_require__(8472),K;(function(t){t.Off="off",t.Auto="auto",t.Always="always"})(K||(K={}));var q;(function(t){t.None="none",t.Latest="latest",t.Match="match",t.TipPlusLatest="tip+latest"})(q||(q={})),function(t){function e(r){return r===t.None||r===t.Latest||r===t.Match||r===t.TipPlusLatest?r:t.None}a(e,"sanitize"),t.sanitize=e}(q||(q={}));var j;(function(t){t.Browse="browse",t.Edit="edit"})(j||(j={})),function(t){function e(n){return n===t.Browse||n===t.Edit?n:t.Edit}a(e,"sanitize"),t.sanitize=e;function r(n){return n===t.Browse?t.Edit:t.Browse}a(r,"toggle"),t.toggle=r}(j||(j={}));var se;(function(t){function e(r,n){return r.display===n.display&&r.index===n.index}a(e,"equals"),t.equals=e})(se||(se={}));var ne;(function(t){t.Branch="branch",t.RemoteBranch="remoteBranch",t.PullRequestBranch="pullRequestBranch",t.PullRequestRemoteBranch="pullRequestRemoteBranch",t.Tag="tag",t.Commit="commit"})(ne||(ne={}));var ue;(function(t){const e=new Map([[ne.Branch,q.None],[ne.RemoteBranch,q.None],[ne.PullRequestBranch,q.Match],[ne.PullRequestRemoteBranch,q.Match],[ne.Commit,q.Match],[ne.Tag,q.Match]]),r=new Map([[ne.Branch,j.Edit],[ne.RemoteBranch,j.Edit],[ne.PullRequestBranch,j.Browse],[ne.PullRequestRemoteBranch,j.Browse],[ne.Commit,j.Browse],[ne.Tag,j.Browse]]);function n(o){var c,l;return{display:(c=r.get(o))!=null?c:j.Edit,index:(l=e.get(o))!=null?l:q.None}}a(n,"getDefault"),t.getDefault=n;function i(o){switch(o){case ne.Branch:case ne.RemoteBranch:return{display:j.Browse,index:q.Latest};case ne.PullRequestBranch:case ne.PullRequestRemoteBranch:return{display:j.Browse,index:q.Match};case ne.Commit:case ne.Tag:return{display:j.Browse,index:q.Match};default:return{display:j.Edit,index:q.None}}}a(i,"getIndexDefault"),t.getIndexDefault=i})(ue||(ue={}));const ce=null;var z=__webpack_require__(2307),H=__webpack_require__.n(z);const M="remoteHub",X="modes",pe="indexMemento";class ${constructor(){this._onDidChange=new m.EventEmitter,this._onDidChangeAny=new m.EventEmitter,this.memoryState=new Map}static configure(e){Y.state=e.workspaceState,e.subscriptions.push(m.workspace.onDidChangeConfiguration(Y.onConfigurationChanged,Y))}get onDidChange(){return this._onDidChange.event}get onDidChangeAny(){return this._onDidChangeAny.event}onConfigurationChanged(e){if(!e.affectsConfiguration(M)){this._onDidChangeAny.fire(e);return}this._onDidChangeAny.fire(e),this._onDidChange.fire(e)}set state(e){if(this._state=e,this.modes=this._state.get(X),this.modes===void 0&&(this.modes=Object.create(null)),this.memoryState.size!==0){for(const r of this.memoryState.entries())this.modes[r[0]]=r[1];this._state.update(X,this.modes).then(()=>{this.memoryState.clear()},void 0)}this.indexMemento=this._state.get(pe),this.indexMemento===void 0&&(this.indexMemento=Object.create(null))}get(e,r,n){return n===void 0?m.workspace.getConfiguration(e===void 0?void 0:M,r).get(e===void 0?M:e):m.workspace.getConfiguration(e===void 0?void 0:M,r).get(e===void 0?M:e,n)}getMode(e,r,n){var i;const o=e.toString();let c=this.modes!==void 0?this.modes[o]:void 0;if(c!==void 0)return{display:j.sanitize(c.display),index:q.sanitize(c.index)};if(c=this.memoryState.get(o),c!==void 0)return c;if(r===ne.Branch||r===ne.RemoteBranch)switch((i=m.workspace.getConfiguration("remoteHub.richNavigation.indexMode",e))==null?void 0:i.get("branch")){case"none":return{display:j.Edit,index:q.None};case"latest":return{display:j.Browse,index:q.Latest};case"tipPlusLatest":return{display:j.Edit,index:q.TipPlusLatest}}if(!n)return ue.getDefault(r)}setMode(e,r){const n=e.toString();return this._state===void 0||this.modes===void 0?(this.memoryState.set(n,r),Promise.resolve()):(this.modes[n]=r,this._state.update(X,this.modes))}getIndexMemento(e){if(this.indexMemento!==void 0)return this.indexMemento[e.toString()]}setIndexMemento(e,r){return this.indexMemento===void 0||this._state===void 0?Promise.resolve():(this.indexMemento[e.toString()]=r,this._state.update(pe,this.indexMemento))}getAny(e,r,n){return n===void 0?m.workspace.getConfiguration(void 0,r).get(e):m.workspace.getConfiguration(void 0,r).get(e,n)}changed(e,r,n){var i;return(i=e==null?void 0:e.affectsConfiguration(`${M}.${r}`,n))!=null?i:!0}inspect(e,r){return m.workspace.getConfiguration(e===void 0?void 0:M,r).inspect(e===void 0?M:e)}inspectAny(e,r){return m.workspace.getConfiguration(void 0,r).inspect(e)}async migrate(e,r,n){const i=Y.inspect(e);if(i===void 0)return!1;let o=!1;return i.globalValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.globalValue):i.globalValue,m.ConfigurationTarget.Global),o=!0),i.workspaceValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceValue):i.workspaceValue,m.ConfigurationTarget.Workspace),o=!0),i.workspaceFolderValue!==void 0&&(await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,m.ConfigurationTarget.WorkspaceFolder),o=!0),!o&&n.fallbackValue!==void 0&&(await this.update(r,n.fallbackValue,m.ConfigurationTarget.Global),o=!0),o}async migrateIfMissing(e,r,n){const i=Y.inspect(e);if(i===void 0)return;const o=Y.inspect(r);i.globalValue!==void 0&&(o===void 0||o.globalValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.globalValue):i.globalValue,m.ConfigurationTarget.Global),i.workspaceValue!==void 0&&(o===void 0||o.workspaceValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceValue):i.workspaceValue,m.ConfigurationTarget.Workspace),i.workspaceFolderValue!==void 0&&(o===void 0||o.workspaceFolderValue===void 0)&&await this.update(r,n.migrationFn!=null?n.migrationFn(i.workspaceFolderValue):i.workspaceFolderValue,m.ConfigurationTarget.WorkspaceFolder)}name(e){return e}update(e,r,n){return m.workspace.getConfiguration(M).update(e,r,n)}updateAny(e,r,n,i){return m.workspace.getConfiguration(void 0,n===m.ConfigurationTarget.Global?void 0:i).update(e,r,n)}updateEffective(e,r){const n=Y.inspect(e);return n.workspaceFolderValue!==void 0?r===n.workspaceFolderValue?Promise.resolve(void 0):Y.update(e,r,m.ConfigurationTarget.WorkspaceFolder):n.workspaceValue!==void 0?r===n.workspaceValue?Promise.resolve(void 0):Y.update(e,r,m.ConfigurationTarget.Workspace):n.globalValue===r||n.globalValue===void 0&&r===n.defaultValue?Promise.resolve(void 0):Y.update(e,H()(r,n.defaultValue)?void 0:r,m.ConfigurationTarget.Global)}getUseNewCommitApi(){let e=this.get("experimental.useNewCommitApi");return e===null&&(e=kp()),e}}a($,"Configuration");const Y=new $,Ve="";var qe;(function(t){t.Off="off",t.Error="error",t.Warn="warn",t.Info="info",t.Debug="debug"})(qe||(qe={}));var ot;(function(t){t[t.Off=0]="Off",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Info=3]="Info",t[t.Debug=4]="Debug"})(ot||(ot={}));const we="GitHub Repositories",Se="[RemoteHub]",be=a(class{static configure(t,e){this._isDebugging=t.extensionMode===m.ExtensionMode.Development,this.logLevel=e}static enabled(t){return this.level>=this.toOrderedLevel(t)}static get logLevel(){return this._logLevel}static set logLevel(t){var e,r;this._logLevel=t,this.level=this.toOrderedLevel(t),t===qe.Off?((e=this.output)==null||e.dispose(),this.output=void 0):this.output=(r=this.output)!=null?r:m.window.createOutputChannel(we)}static toOrderedLevel(t){switch(t){case qe.Off:return 0;case qe.Error:return 1;case qe.Warn:return 2;case qe.Info:return 3;case qe.Debug:return 4}}static get isDebugging(){return this._isDebugging}static debug(t,...e){be.isDebugging&&console.log(this.timestamp,Se,t!=null?t:Ve,...e),!(this.output===void 0||this.level<4)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:Ve}${this.toLoggableParams(!0,e)}`)}static error(t,e,...r){if(!(this.level<1&&!be.isDebugging)){if(e===void 0){const n=t instanceof Error?t.stack:void 0;if(n){const i=/.*\s*?at\s(.+?)\s/.exec(n);i!==null&&(e=i[1])}}be.isDebugging&&console.error(this.timestamp,Se,e!=null?e:Ve,...r,t),!(this.output===void 0||this.level<1)&&this.output.appendLine(`${this.timestamp} ${e!=null?e:Ve}${this.toLoggableParams(!1,r)}
${String(t)}`)}}static log(t,...e){be.isDebugging&&console.log(this.timestamp,Se,t!=null?t:Ve,...e),!(this.output===void 0||this.level<3)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:Ve}${this.toLoggableParams(!1,e)}`)}static warn(t,...e){be.isDebugging&&console.warn(this.timestamp,Se,t!=null?t:Ve,...e),!(this.output===void 0||this.level<2)&&this.output.appendLine(`${this.timestamp} ${t!=null?t:Ve}${this.toLoggableParams(!1,e)}`)}static showOutputChannel(){var t;(t=this.output)==null||t.show()}static toLoggable(t,e){if(typeof t!="object")return String(t);if(t instanceof m.Uri)return`Uri(${t.toString(!0)})`;try{return JSON.stringify(t,e)}catch{return"<error>"}}static toLoggableName(t){var e,r,n;let i;if(typeof t=="function"){if(t.prototype===void 0||t.prototype.constructor===void 0)return t.name;i=(e=t.prototype.constructor.name)!=null?e:Ve}else i=(n=(r=t.constructor)==null?void 0:r.name)!=null?n:Ve;const o=i.indexOf("_");return o===-1?i:i.substr(o+1)}static get timestamp(){const t=new Date;return`[${t.toISOString().replace(/T/," ").replace(/\..+/,Ve)}:${`00${t.getUTCMilliseconds()}`.slice(-3)}]`}static toLoggableParams(t,e){if(e.length===0||t&&this.level<4&&!be.isDebugging)return Ve;const r=e.map(n=>this.toLoggable(n)).join(", ");return r.length!==0?` \u2014 ${r}`:Ve}},"_Logger");let L=be;L.level=0,L._logLevel=qe.Off;const he=47;function te(t){if(t===void 0)return;const e=t.path.endsWith("/");return!e&&!t.fragment?t.toString():t.with({path:e?t.path.slice(0,-1):t.path,fragment:""}).toString()}a(te,"asKey");function Ae(t){if(t===void 0)return;const e=t.path.endsWith("/");return!e&&!t.query&&!t.fragment?t.toString():t.with({path:e?t.path.slice(0,-1):t.path,query:"",fragment:""}).toString()}a(Ae,"asFileKey");function le(t,e){return`${(e==null?void 0:e.excludeScheme)?"":`${t.scheme}-`}${t.authority}${t.path.endsWith("/")?t.path.slice(0,-1):t.path}`}a(le,"asFileStorageKey");function de(t){const e=t.path;let r=0,n=-1,i=!0;for(let o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===he){if(!i){r=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":e.slice(r,n)}a(de,"basename");function Ce(t){const e=t.path;if(e.length===1)return"/";let r,n=-1,i=!0;for(let o=e.length-1;o>=1;--o)if(r=e.charCodeAt(o),r===he){if(!i){n=o;break}}else i=!1;return n===-1?"/":e.slice(0,n)}a(Ce,"dirname");function Fe(t){const e=t.path.lastIndexOf("/");return e===-1?t.with({path:"/"}):t.with({path:t.path.substring(0,e)})}a(Fe,"getParent");function We(t,e){const r=typeof e=="string"?e:e.path;return r.startsWith(t.path)?m.Uri.joinPath(t,r.substr(t.path.length)):m.Uri.joinPath(t,r)}a(We,"joinRelativePath");function Je(t,e){return typeof e=="string"?(e.startsWith("/")||(e=`/${e}`),ye(t,e)&&t.path.substr(e.length+(e.endsWith("/")?0:1)).split("/").length===1):ye(t,e)&&t.path.substr(e.path.length+(e.path.endsWith("/")?0:1)).split("/").length===1}a(Je,"isChild");function ye(t,e){return typeof e=="string"?(e.startsWith("/")||(e=`/${e}`),e.length===1||t.path.startsWith(e.endsWith("/")?e:`${e}/`)):e.scheme===t.scheme&&e.authority===t.authority&&(e.path.length===1||t.path.startsWith(e.path.endsWith("/")?e.path:`${e.path}/`))}a(ye,"isDescendent");function Ue(t){return t&&typeof t=="object"&&"scheme"in t}a(Ue,"isSerializedUri");const Xe=a(class{constructor(t){this.storageService=t,this._onDidChange=new m.EventEmitter,this.cache=new Map}get onDidChange(){return this._onDidChange.event}async delete(t){const e=te(t),r=this.cache.has(e);this.cache.delete(e);try{await this.storageService.delete(this.getStorageKey(e))}catch(n){throw L.error(n,`Failed to delete repository metadata for ${e}`),n}!r||setTimeout(()=>this._onDidChange.fire({uri:t}),0)}async get(t){this.assertMatchingScheme(t);const e=te(t),r=this.cache.get(e);if(r!==void 0)return r;let n;try{n=this.fromStorage(await this.storageService.get(this.getStorageKey(e)))}catch(i){throw L.error(i,`Failed to get repository metadata for ${e}`),i}return n?this.cache.set(e,{revision:n}):this.cache.delete(e),{revision:n}}async set(t,e,r,n){this.assertMatchingScheme(t);const i=(await this.get(t)).revision!==e?"revision":void 0,o=te(t);if(r!==void 0&&!this.validate(r))throw new Error(`Metadata validation failed for ${t.toString()}`);const c={revision:e,cachedMetadata:r};this.cache.set(o,c);try{await this.storageService.store(this.getStorageKey(o),this.toStorage(e))}catch(l){throw this.cache.delete(o),L.error(l,`Failed to save repository metadata for ${o}`),l}(n==null?void 0:n.silent)||setTimeout(()=>this._onDidChange.fire({uri:t,reason:i}),0)}refresh(){this.cache.clear()}validate(t){var e,r,n,i,o,c,l,d;return typeof t.version=="number"&&t.version>=Xe.schemaVersion&&typeof t.timestamp=="number"&&typeof((e=t.provider)==null?void 0:e.id)=="string"&&typeof t.provider.name=="string"&&typeof t.name=="string"&&t.repo&&typeof t.user=="string"&&typeof t.accessLevel=="number"&&typeof((r=t.HEAD)==null?void 0:r.type)=="number"&&typeof((n=t.HEAD)==null?void 0:n.name)=="string"&&typeof((i=t.HEAD)==null?void 0:i.sha)=="string"&&(typeof((o=t.HEAD.detached)==null?void 0:o.name)=="string"&&typeof((c=t.HEAD.detached)==null?void 0:c.type)=="number"||typeof((l=t.HEAD.branch)==null?void 0:l.name)=="string")&&typeof((d=t.defaultBranch)==null?void 0:d.name)=="string"&&typeof t.defaultBranch.sha=="string"}assertMatchingScheme(t){if(t.scheme!==Xt.scheme)throw new Error(`Uri scheme '${t.scheme}' must match configured scheme '${Xt.scheme}'; uri=${t.toString()}`)}getStorageKey(t){return`metadata/${t}`}fromStorage(t){if(!t)return;const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&Ue(n)?m.Uri.from(n):n);return e==null?void 0:e.revision}toStorage(t){const e={schemaVersion:Xe.storageSchemaVersion,revision:t};return JSON.stringify(e)}},"_MetadataStore");let Ke=Xe;Ke.schemaVersion=6,Ke.storageSchemaVersion=1;var Ne;(function(t){t[t.Admin=100]="Admin",t[t.Maintain=40]="Maintain",t[t.WriteToPullRequest=31]="WriteToPullRequest",t[t.Write=30]="Write",t[t.Triage=20]="Triage",t[t.Read=10]="Read",t[t.None=0]="None"})(Ne||(Ne={}));var De;(function(t){t[t.Branch=0]="Branch",t[t.RemoteBranch=1]="RemoteBranch",t[t.Tag=2]="Tag",t[t.Commit=3]="Commit"})(De||(De={}));class pt extends Error{constructor(e,r){super(typeof e=="string"?e:e.message);this.reauthenticate=r;var n;this.original=typeof e!="string"?e:void 0,(n=Error.captureStackTrace)==null||n.call(Error,this,pt)}}a(pt,"InvalidCredentialsError");class Rt extends Error{constructor(e,r,n){super(e.message);this.original=e,this.name=r,this.id=n;var i;(i=Error.captureStackTrace)==null||i.call(Error,this,Rt)}}a(Rt,"PullRequestNotFoundError");class xe extends Error{constructor(e,r){super(e.message);this.original=e,this.name=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,xe)}}a(xe,"RepositoryForbiddenError");class Pt extends Error{constructor(e,r){super(e.message);this.original=e,this.name=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,Pt)}}a(Pt,"RepositoryNotFoundError");class ut extends Error{constructor(e,r){super(e.message);this.original=e,this.name=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,ut)}}a(ut,"RepositoryEmptyError");class It extends Error{constructor(e){super(e);var r;(r=Error.captureStackTrace)==null||r.call(Error,this,It)}}a(It,"DetachedHEADError");class Be extends Error{constructor(e,r){super(e.message);this.original=e,this.duplicate=r;var n;(n=Error.captureStackTrace)==null||n.call(Error,this,Be)}}a(Be,"InvalidBranchNameError");class Me extends Error{constructor(e){super(e.message);this.original=e;var r;(r=Error.captureStackTrace)==null||r.call(Error,this,Me)}}a(Me,"MergeConflictError");class vt extends Error{constructor(e){super(e);var r;(r=Error.captureStackTrace)==null||r.call(Error,this,vt)}}a(vt,"NothingToCommitError");class Ct extends Error{constructor(e=!1){super(e?"Unable to sync the repository":"Unable to fetch the repository");var r;(r=Error.captureStackTrace)==null||r.call(Error,this,Ct)}}a(Ct,"SyncOrFetchError");class Ut extends Error{constructor(){super("Sync operation will result in conflicts");var e;(e=Error.captureStackTrace)==null||e.call(Error,this,Ut)}}a(Ut,"SyncConflictsError");class wr extends Error{constructor(){super("Failed to create and push commit");var e;(e=Error.captureStackTrace)==null||e.call(Error,this,wr)}}a(wr,"CommitFailedError");class Wt extends Error{constructor(e){var r;const n=typeof e=="string"?e:Xt.getProviderId(e);super(`No provider registered with ${n}`);this.id=n,(r=Error.captureStackTrace)==null||r.call(Error,this,Wt)}}a(Wt,"ProviderNotFoundError");const ur=/^[0-9a-f]{40}$/i;function Ur(t){return t!==void 0&&ur.test(t)}a(Ur,"isSha");const nn=/^[^/](?!.*\/\.)(?!.*\.\.)(?!.*\/\/)(?!.*@\{)[^\000-\037\177 ~^:?*[\\]+[^./]$/;function kr(t){return nn.test(t)}a(kr,"isValidBranchName");function yt(t){return t===""||t==="~"||t==="HEAD"?t:t.endsWith("^")?`${t.substr(0,7)}^`:t.substr(0,7)}a(yt,"shortenRef");var et;(function(t){t[t.Branch=0]="Branch",t[t.Tag=1]="Tag",t[t.Commit=2]="Commit",t[t.PullRequest=3]="PullRequest",t[t.Tree=4]="Tree"})(et||(et={}));class Pi{constructor(e,r,n,i,o){this.providerService=e,this.uri=r,this.id=n,this.name=i,this.provider={id:o.id,name:o.name}}get canonicalUri(){return this.providerService.getVirtualCanonicalRootUri(this.uri)}createRelativeUri(e){return this.providerService.createRelativeUri(this.uri,e)}async getMetadata(){const e=await this.providerService.getMetadata(this.uri);if(!e)throw new Error(`Unable to find metadata for ${this.uri.toString()}`);return e}async getIndexMetadata(){return this.providerService.getIndexMetadata(this.uri)}getUriMetadata(){return this.providerService.getVirtualUriMetadata(this.uri)}}a(Pi,"VirtualRepository");var st;(function(t){t[t.Repository=0]="Repository",t[t.PullRequest=1]="PullRequest",t[t.Branch=2]="Branch",t[t.Commit=3]="Commit",t[t.File=4]="File"})(st||(st={}));var Nt;(function(t){t[t.Clone=-1]="Clone",t[t.Repository=0]="Repository",t[t.PullRequest=1]="PullRequest",t[t.Branch=2]="Branch",t[t.Commit=3]="Commit",t[t.Tag=4]="Tag"})(Nt||(Nt={}));var nt;(function(t){t[t.Open=0]="Open",t[t.Closed=1]="Closed",t[t.Merged=2]="Merged"})(nt||(nt={}));var ft;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.Indexed=1]="Indexed",t[t.Match=2]="Match",t[t.Active=3]="Active"})(ft||(ft={})),function(t){function e(r){return r!==void 0&&(r===t.Indexed||r===t.Match||r===t.Active)}a(e,"hasIndex"),t.hasIndex=e}(ft||(ft={}));var Zt;(function(t){function e(r){return r!==void 0&&r.type===3}a(e,"isActive"),t.isActive=e})(Zt||(Zt={}));var er;(function(t){t[t.Latest=1]="Latest",t[t.SHA=2]="SHA"})(er||(er={}));var Jt;(function(t){function e(r){const n=Xt.decodeAuthority(r).metadata;if(!(n===void 0||n.idx===void 0)){if(n.idx==="latest")return{type:1};if(Ur(n.idx))return{type:2,sha:n.idx}}}a(e,"decode"),t.decode=e})(Jt||(Jt={}));function*yn(t,e){for(const r of t)yield*e(r)}a(yn,"flatMap");function*pi(t,e){for(const r of t)e(r)&&(yield r)}a(pi,"filter");function*on(t,e){for(const r of t){const n=e(r);n!=null&&(yield n)}}a(on,"filterMap");function za(t,e){for(const r of t)if(e(r))return r}a(za,"find");function Wa(t,e){let r="";const n=t[Symbol.iterator]();let i=n.next();if(i.done)return r;for(;;){const o=i.value.toString();if(i=n.next(),i.done){r+=o;break}r+=o,r+=e}return r}a(Wa,"join");function*ro(t,e){for(const r of t)yield e(r)}a(ro,"map");function sr(t,e){for(const r of t)if(e(r))return!0;return!1}a(sr,"some");function*Di(...t){for(const e of t)for(const r of e)yield r}a(Di,"union");function*na(t){const e=new Set;for(const r of t)e.has(r)||(e.add(r),yield r)}a(na,"unique");const ia="";function Qs(...t){if(t.length===1){const e=t[0];return e===void 0?ia:typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"||e instanceof Error?String(e):e instanceof m.Uri?e.toString():JSON.stringify(e)}return JSON.stringify(t)}a(Qs,"defaultResolver");function Lr(t){return(e,r,n)=>{let i;if(typeof n.value=="function"?i=n.value:typeof n.get=="function"&&(i=n.get),i===void 0)throw new Error("Not supported");const o=`$serialize$${r}`;n.value=function(...c){const l=c.length===0?o:`${o}$${(t!=null?t:Qs)(...c)}`;Object.prototype.hasOwnProperty.call(this,l)||Object.defineProperty(this,l,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let d=this[l];const p=a(()=>i.apply(this,c),"run");return d===void 0?d=p():d=d.then(p,p),this[l]=d,d}}}a(Lr,"serialize");const gi=require("process");let So=0;function Ga(){return So===Number.MAX_SAFE_INTEGER&&(So=0),++So}a(Ga,"getNextInstanceId");const An=a(class{constructor(t,e,...r){this.context=t,this.instance=`[${Ga().toString().padStart(5)}] `;var n,i,o,c,l,d;let p;if(typeof(e==null?void 0:e.log)=="boolean"?p=e.log?{}:void 0:p=(n=e==null?void 0:e.log)!=null?n:{},this.logLevel=(i=e==null?void 0:e.logLevel)!=null?i:qe.Info,this.time=(0,gi.hrtime)(),p){if(!L.enabled(this.logLevel))return;r.length?ki(this.logLevel,`${this.instance}${(o=p.prefix)!=null?o:""}${t}${(c=p.message)!=null?c:""}`,...r):ki(this.logLevel,`${this.instance}${(l=p.prefix)!=null?l:""}${t}${(d=p.message)!=null?d:""}`)}}log(t){this.logCore(this.context,t,!1)}logStep(t,e){(!t||e)&&this.logCore(this.context,e,!1),this.step=t?{time:(0,gi.hrtime)(),label:t}:void 0}restart(t){this.logCore(this.context,t,!0),this.step=void 0,this.time=(0,gi.hrtime)()}stop(t){this.restart(t)}logCore(t,e,r){var n,i,o,c,l,d,p;if(!L.enabled(this.logLevel))return;let S="";if(this.step){const[F,N]=(0,gi.hrtime)(this.step.time),U=F*1e3+Math.floor(N/1e6);S=`${this.step.label?`${this.step.label} took `:""}${U} ms`}if(!r){ki(this.logLevel,`${this.instance}${(n=e==null?void 0:e.prefix)!=null?n:""}${t}${(i=e==null?void 0:e.message)!=null?i:""}${S?` ${S}`:""}${(o=e==null?void 0:e.suffix)!=null?o:""}`);return}const[P,I]=(0,gi.hrtime)(this.time),O=P*1e3+Math.floor(I/1e6);ki(O>500?qe.Warn:this.logLevel,`${this.instance}${(c=e==null?void 0:e.prefix)!=null?c:""}${t}${(l=e==null?void 0:e.message)!=null?l:""}${(d=e==null?void 0:e.took)!=null?d:" took "}${O} ms${S?` (${S})`:""}${(p=e==null?void 0:e.suffix)!=null?p:""}`)}static start(t,e,...r){var n;(n=An.watches.get(t))==null||n.log(),An.watches.set(t,new An(t,e,...r))}static log(t,e){var r;(r=An.watches.get(t))==null||r.log(e)}static stop(t,e){var r;(r=An.watches.get(t))==null||r.stop(e),An.watches.delete(t)}},"_Stopwatch");let lt=An;lt.watches=new Map;function ki(t,e,...r){switch(t){case qe.Warn:L.warn(e,...r);break;case qe.Info:L.log(e,...r);break;default:L.debug(e,...r);break}}a(ki,"log");function no(t){return Buffer.from(t,"utf8").toString("hex")}a(no,"encodeUtf8Hex");function Eo(t){return Buffer.from(t,"hex").toString("utf8")}a(Eo,"decodeUtf8Hex");var Ni=__webpack_require__(6724),Ys=Object.defineProperty,Zs=Object.getOwnPropertyDescriptor,Js=a((t,e,r,n)=>{for(var i=n>1?void 0:n?Zs(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&Ys(e,r,i),i},"__decorateClass"),an;(function(t){t[t.Abort=0]="Abort",t[t.KeepCurrent=1]="KeepCurrent",t[t.DiscardCurrent=2]="DiscardCurrent",t[t.Merge=3]="Merge"})(an||(an={}));const dr=a(class{constructor(t,e){this.metadataStore=t,this.telemetryService=e,this._providers=new Map,this._onDidChangeProviders=new m.EventEmitter,this._repositories=new Map,this._onDidChangeRepositories=new m.EventEmitter,this._onDidChangeRepository=new m.EventEmitter,this._onDidSyncRepository=new m.EventEmitter,this._onDidRefresh=new m.EventEmitter,this._onWillRefresh=new m.EventEmitter,this.pendingMetadataRequests=new Map,this.disposable=m.Disposable.from(m.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this),t.onDidChange(r=>this.onMetadataChanged(r)))}get onDidChangeProviders(){return this._onDidChangeProviders.event}get onDidChangeRepositories(){return this._onDidChangeRepositories.event}get onDidChangeRepository(){return this._onDidChangeRepository.event}get onDidSyncRepository(){return this._onDidSyncRepository.event}get onDidRefresh(){return this._onDidRefresh.event}get onWillRefresh(){return this._onWillRefresh.event}dispose(){this.disposable.dispose(),this._providers.clear(),this._repositories.clear()}onMetadataChanged(t){const e=this._repositories.get(te(t.uri));!e||(L.log(`VirtualProviderService.onMetadataChanged(${t.uri.toString()}, reason=${t.reason}): Firing onDidChangeRepository...`),this._onDidChangeRepository.fire({repository:e,reason:t.reason==="revision"?"HEAD":void 0}))}onWorkspaceFoldersChanged(t){if(t.added.length)for(const e of t.added){const r=te(e.uri);if(e.uri.scheme!==dr.scheme||this._repositories.has(r))continue;const n=this.getProvider(e.uri);if(!n)continue;this._repositories.set(r,null);const{repo:i,name:o}=this.getVirtualUriMetadata(e.uri),c=new Pi(this,e.uri,i,o,n);this._repositories.set(r,c),this._onDidChangeRepositories.fire({added:[c],removed:[]}),this.telemetryService.sendEvent("repository.opened",{provider:n.id,repositories:this._repositories.size.toString()})}if(t.removed.length)for(const e of t.removed){const r=te(e.uri);if(e.uri.scheme!==dr.scheme||!this._repositories.has(r))continue;const n=this._repositories.get(r);this._repositories.delete(r),n&&(this._onDidChangeRepositories.fire({added:[],removed:[n]}),this.telemetryService.sendEvent("repository.closed",{repositories:this._repositories.size.toString()}))}oi(ii.HasVirtualFolders,this._repositories.size!==0),oi(ii.VirtualFolderProviders,Wa(na(ro(this.getRepositories(),e=>e.provider.id)),","))}get hasProviders(){return this._providers.size!==0}get registeredProviders(){return[...ro(this._providers.values(),t=>({id:t.id,name:t.name}))]}get repositories(){return[...this.getRepositories()]}register(t,e,r,n,i){var o;if(this._providers.has(t))throw new Error(`Provider '${t}' has already been registered`);const c={id:t,name:e,provider:r,fs:n,index:i};return this._providers.set(t,c),this._onDidChangeProviders.fire({added:[c],removed:[]}),this.telemetryService.sendEvent("provider.registered",{provider:t}),this.onWorkspaceFoldersChanged({added:(o=m.workspace.workspaceFolders)!=null?o:[],removed:[]}),{dispose:()=>{this._providers.delete(t);const l=[];for(const[d,p]of[...this._repositories])(p==null?void 0:p.provider.id)===t&&(this._repositories.delete(d),l.push(p));this._onDidChangeRepositories.fire({added:[],removed:l}),this._onDidChangeProviders.fire({added:[],removed:[c]})}}}refresh(){if(this._providers.size===0)return;const t=[],e=[];for(const r of this._providers.values())t.push(...ro(this.getRepositories(r.id),n=>n.uri)),r.index!==void 0&&e.push(r.index);this._onWillRefresh.fire(t),this.metadataStore.refresh(),e.forEach(r=>r.refresh(t)),this._onDidRefresh.fire(t)}getRegisteredProvider(t){const e=this.getProvider(t);return e?{id:e.id,name:e.name}:void 0}getRepository(t,e){const r=m.workspace.getWorkspaceFolder(t);if(!r||r.uri.scheme!==dr.scheme)return;const n=this._repositories.get(te(r.uri));if(!(e!==void 0&&(n==null?void 0:n.provider.id)!==e))return n!=null?n:void 0}getRepositories(t){return pi(this._repositories.values(),e=>e!==null&&(!t||e.provider.id===t))}getOpenUris(t,e){const r=new Map,n=m.workspace.textDocuments;if(n.length===0)return r;for(const i of n)i.uri.scheme===t&&e.some(o=>ye(i.uri,o))&&r.set(te(i.uri),i.uri);return r}hasProvider(t,e){const r=typeof t=="string"?t:dr.getProviderId(t),n=this._providers.get(r);return e!==void 0&&(n==null?void 0:n.id)!==e?!1:n!==void 0}isReadonly(t){var e;return Boolean((e=this.getProvider(t))==null?void 0:e.provider.isReadonly)}getProvider(t){const e=typeof t=="string"?t:dr.getProviderId(t);return this._providers.get(e)}getRepositoryProvider(t){var e;const r=(e=this.getProvider(t))==null?void 0:e.provider;if(r)return r;throw new Wt(t)}getFileSystemProvider(t){var e;const r=(e=this.getProvider(t))==null?void 0:e.fs;if(r)return r;throw new Wt(t)}getRemoteWorkspaceSourceProviders(t){var e,r,n,i;return t?(i=(n=(e=this.getProvider(t))==null?void 0:(r=e.provider).getRemoteWorkspaceSourceProviders)==null?void 0:n.call(r))!=null?i:[]:[...yn(this._providers.values(),o=>{var c,l,d;return(d=(l=(c=o.provider).getRemoteWorkspaceSourceProviders)==null?void 0:l.call(c))!=null?d:[]})]}isInWorkspace(t){return this.getVirtualWorkspaceUri(t)!==void 0}getAuthentication(t){const e=this.getProvider(t);if(!e)throw new Wt(t);return e==null?void 0:e.provider.getAuthentication(t)}canOpenRemoteUrl(t,e){if(e){const r=this.getProvider(e),n=r==null?void 0:r.provider.canOpenRemoteUrl(t);return n!==void 0?{provider:r,urlType:n}:void 0}for(const r of this._providers.values()){const n=r.provider.canOpenRemoteUrl(t);if(n!==void 0)return{provider:r,urlType:n}}}async createWorkspaceForRemoteUrl(t,e,r=tr.CurrentWindow){var n;const i=this.canOpenRemoteUrl(t,e);return(n=i==null?void 0:i.provider)==null?void 0:n.provider.createWorkspaceForRemoteUrl(t,r)}createProviderUri(t,e,r){return this.getProviderUri(this.getRepositoryProvider(t).createVirtualUri(dr.baseVirtualWorkspaceUri,e,r))}createRelativeProviderUri(t,e){return this.getProviderUri(this.createRelativeUri(t,e))}createRelativeUri(t,e){const r=this.getProviderRootUri(t);let n=`${r.path}/`;n.endsWith("/")&&(n=n.slice(0,-1));const i=r.with({path:`${r.path}/${e.startsWith("/")?e.substr(1):e}`});return t.scheme===dr.scheme?this.getVirtualUri(i):i}createRelativeVirtualUri(t,e){return this.getVirtualUri(this.createRelativeUri(t,e))}createVirtualUri(t,e,r){return this.getRepositoryProvider(t).createVirtualUri(dr.baseVirtualWorkspaceUri,e,r)}async getBestRemoteUri(t,e){const{provider:r,repo:n,ref:i}=this.getVirtualUriMetadata(t);if(e===Nt.Repository)return this.getRemoteUri(r.id,{repo:n});if(e===Nt.Clone)return this.getRemoteUri(r.id,{repo:n,clone:!0});if(e===Nt.PullRequest||e===void 0&&(i==null?void 0:i.type)===et.PullRequest){if((i==null?void 0:i.type)===et.PullRequest)return this.getRemoteUri(r.id,{repo:n,pullRequest:{id:i.id}});const{pullRequest:o}=await this.getMetadata(t);if(e===Nt.PullRequest&&o)return this.getRemoteUri(r.id,{repo:n,pullRequest:{id:o.id}})}if(e===Nt.Branch||e===void 0&&(i==null?void 0:i.type)===et.Branch){if((i==null?void 0:i.type)===et.Branch)return this.getRemoteUri(r.id,{repo:n,branch:i.id});const{HEAD:o}=await this.getMetadata(t);if(o.type===De.Branch||o.type===De.RemoteBranch&&e===Nt.Branch)return this.getRemoteUri(r.id,{repo:n,branch:o.branch.name})}if(e===Nt.Tag||e===void 0&&(i==null?void 0:i.type)===et.Tag){if((i==null?void 0:i.type)===et.Tag)return this.getRemoteUri(r.id,{repo:n,tag:i.id});const{HEAD:o}=await this.getMetadata(t);if(o.type===De.Tag)return this.getRemoteUri(r.id,{repo:n,tag:o.detached.name})}if(e===Nt.Commit||e===void 0&&((i==null?void 0:i.type)===et.Commit||(i==null?void 0:i.type)===et.Tree&&Ur(i.id))){if((i==null?void 0:i.type)===et.Commit||(i==null?void 0:i.type)===et.Tree&&Ur(i.id))return this.getRemoteUri(r.id,{repo:n,sha:i.id});const{HEAD:o}=await this.getMetadata(t);if(e===Nt.Commit||o.type===De.Commit)return this.getRemoteUri(r.id,{repo:n,sha:o.sha})}if(e===void 0)return this.getRemoteUri(r.id,{repo:n})}getCanonicalUri(t){let{authority:e}=t;const r=e.indexOf(dr.authoritySeparator);return r!==-1&&(e=e.substr(0,r)),t.with({authority:e})}getRemoteUri(t,e){var r,n;return(n=(r=this.getRepositoryProvider(t)).getRemoteUri)==null?void 0:n.call(r,e)}getProviderUri(t){return t.scheme!==dr.scheme?t:t.with({scheme:dr.getProviderId(t)})}getProviderRootUri(t){return t=this.getProviderUri(t),this.getRepositoryProvider(t).getProviderRootUri(t)}getRelativeFilePath(t,e){return e=this.getProviderUri(e!=null?e:t),this.getRepositoryProvider(e).getRelativeFilePath(t,e)}getVirtualUriMetadata(t){return this.getRepositoryProvider(t).getVirtualUriMetadata(t)}getVirtualUri(t){return t.scheme===dr.scheme?t:t.with({scheme:dr.scheme})}getVirtualCanonicalRootUri(t){const e=this.getVirtualUri(this.getProviderRootUri(t));let{authority:r}=e;const n=r.indexOf(dr.authoritySeparator);return n!==-1&&(r=r.substr(0,n)),e.with({authority:r})}getVirtualRootUri(t){return this.getVirtualUri(this.getProviderRootUri(t))}getVirtualWorkspaceUri(t){var e;return(e=m.workspace.getWorkspaceFolder(this.getVirtualUri(t)))==null?void 0:e.uri}createIGitRepository(t,e,r,n){var i,o;return(o=(i=this.getRepositoryProvider(t)).createIGitRepository)==null?void 0:o.call(i,t,e,r,n)}async getCommitOperations(t,e,r){let n;return(r==null?void 0:r.staged)?(n=await e.getStagedChanges(t),n.length===0&&r.staged==="auto"&&(n=await e.getChanges(t))):n=await e.getChanges(t),n.map(o=>{const c=this.getRelativeFilePath(t,o.uri);switch(o.type){case Dt.Created:return{type:o.type,path:c,fileType:o.fileType,content:e.readFile(o.uri).then(l=>l!=null?l:new Uint8Array)};case Dt.Changed:return{type:o.type,path:c,fileType:o.fileType,content:e.readFile(o.uri).then(l=>l!=null?l:new Uint8Array)};case Dt.Deleted:return{type:o.type,path:c,fileType:o.fileType,content:void 0}}})}async getMetadata(t){return{...await this.getMetadataCore(this.getVirtualRootUri(t)),path:this.getRelativeFilePath(t,t)}}async getIndexMetadata(t){const e=this.getProvider(t);return(e==null?void 0:e.index)?e.index.getIndexMetadata(t):void 0}getModeConfig(t,e,r){return Y.getMode(this.getVirtualRootUri(t),e,Boolean(r))}async getModeRefType(t,e){return t=this.getVirtualRootUri(t),this.getRepositoryProvider(t).getModeRefType(t,e)}getIndexProvider(t){var e;return(e=this.getProvider(t))==null?void 0:e.index}async getMetadataCore(t){const e=te(t);let r=this.pendingMetadataRequests.get(e);if(r)return r;let{revision:n,cachedMetadata:i}=await this.metadataStore.get(t);if(i!==void 0)return i;const o=this.getProvider(t);if(!o)throw new Wt(t);const c=Jt.decode(t);(c==null?void 0:c.type)===er.SHA&&(n=c.sha),r=o.provider.createMetadata(t,n),this.pendingMetadataRequests.set(e,r);try{const l=await r;return await this.updateMetadataCore(t,l,{silent:!0}),l}finally{this.pendingMetadataRequests.delete(e)}}async updateMetadata(t,e){const r=new lt(`VirtualProviderService.updateMetadata(${t.toString()})`,{},e.HEAD.sha);try{await this.metadataStore.set(this.getVirtualUri(t),e.HEAD.sha,e)}finally{r.stop()}}updateMetadataCore(t,e,r){return this.metadataStore.set(this.getVirtualUri(t),e.HEAD.sha,e,r)}async clone(t){const e=await this.getBestRemoteUri(t,Nt.Clone);if(!e)throw new Error("No url found for clone");if(qn)return void m.env.openExternal(m.Uri.parse(`${m.env.uriScheme}://vscode.git/clone?url=${encodeURIComponent(e.toString(!0))}`));try{const r=m.extensions.getExtension("vscode.git");if(r)await(r==null?void 0:r.activate()),await m.commands.executeCommand("git.clone",e.toString(!0));else throw new Error("Git extension not found")}catch(r){L.error(r,"Unable to clone repository")}}createBranch(t,e,r,n){return this.getRepositoryProvider(t).createBranch(t,e,r,n)}createCommit(t,e,r,n){return this.getRepositoryProvider(t).createCommit(t,e,r,n)}createAndPushCommit(t,e,r,n,i){return this.getRepositoryProvider(t).createAndPushCommit(t,e,r,n,i)}createPullRequest(t,e,r,n,i){return this.getRepositoryProvider(t).createPullRequest(t,e,r,n,i)}fetch(t,e){return this.getRepositoryProvider(t).fetch(t,e)}fork(t){return this.getRepositoryProvider(t).fork(t)}getBranches(t,e){return this.getRepositoryProvider(t).getBranches(t,e)}getCommit(t,e){return this.getRepositoryProvider(t).getCommit(t,e)}getCommits(t,e){var r;return(r=this.getRepositoryProvider(t))==null?void 0:r.getCommits(t,e)}compareCommits(t,e){var r;return(r=this.getRepositoryProvider(t))==null?void 0:r.compareCommits(t,e)}getFileContent(t,e,r){return this.getRepositoryProvider(t).getFileContent(t,e,r)}getFork(t){return this.getRepositoryProvider(t).getFork(t)}async getIncomingChanges(t){var e,r,n;return(n=(r=(e=this.getRepositoryProvider(t)).getIncomingChanges)==null?void 0:r.call(e,t))!=null?n:[]}getPullRequest(t,e){return this.getRepositoryProvider(t).getPullRequest(t,e)}getTags(t,e){return this.getRepositoryProvider(t).getTags(t,e)}getSnapshots(t,e){var r,n;return(n=(r=this.getIndexProvider(t))==null?void 0:r.getSnapshots(t,e))!=null?n:Promise.resolve([])}async getTarGz(t){var e,r;return(r=(e=this.getRepositoryProvider(t)).getTarGz)==null?void 0:r.call(e,t)}pushCommit(t,e,r,n){return this.getRepositoryProvider(t).pushCommit(t,e,r,n)}switchTo(t,e,r){return this.getRepositoryProvider(t).switchTo(t,e,r)}async sync(t,e,r){const n=this._repositories.get(te(t));n&&this._onDidSyncRepository.fire({repository:n,syncing:!0});try{const i=this.getProvider(t);if(i===void 0)throw new Wt(t);let{to:o,reason:c,...l}=r!=null?r:{};return o===void 0&&i.index&&(o=await i.index.resolveIndexRef(t,c==="user")),await i.provider.sync(t,e,{conflictResolution:0,...l,to:o})}finally{n&&this._onDidSyncRepository.fire({repository:n,syncing:!1})}}stat(t){return this.getFileSystemProvider(t).stat(t)}readDirectory(t){return this.getFileSystemProvider(t).readDirectory(t)}readFile(t){return this.getFileSystemProvider(t).readFile(t)}watch(t,e){return this.getFileSystemProvider(t).watch(t,e)}provideFileSearchResults(t,e,r){return this.getFileSystemProvider(e.folder).provideFileSearchResults(t,e,r)}provideTextSearchResults(t,e,r,n){return this.getFileSystemProvider(e.folder).provideTextSearchResults(t,e,r,n)}static decodeAuthority(t,e){const[r,n]=t.authority.split(dr.authoritySeparator);let i;if(n)try{const o=JSON.parse(Eo(n));i=e?e(o):o}catch{}return{scheme:r,metadata:i}}static encodeAuthority(t,e){const r=e?`${dr.authoritySeparator}${no(JSON.stringify(e))}`:"";return`${t}${r}`}static getProviderId(t){const{authority:e}=t,r=e.indexOf(dr.authoritySeparator);return r!==-1?e.substr(0,r):e}static isCanonicalUri(t){return t.authority.indexOf(dr.authoritySeparator)===-1}},"_VirtualProviderService");let Xt=dr;Xt.scheme="vscode-vfs",Xt.authoritySeparator="+",Xt.baseVirtualWorkspaceUri=m.Uri.parse(`${dr.scheme}://`),Js([Lr()],Xt.prototype,"getMetadataCore",1);function _n(){}a(_n,"Diff"),_n.prototype={diff:a(function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=n.callback;typeof n=="function"&&(i=n,n={}),this.options=n;var o=this;function c(N){return i?(setTimeout(function(){i(void 0,N)},0),!0):N}a(c,"done"),e=this.castInput(e),r=this.castInput(r),e=this.removeEmpty(this.tokenize(e)),r=this.removeEmpty(this.tokenize(r));var l=r.length,d=e.length,p=1,S=l+d,P=[{newPos:-1,components:[]}],I=this.extractCommon(P[0],r,e,0);if(P[0].newPos+1>=l&&I+1>=d)return c([{value:this.join(r),count:r.length}]);function O(){for(var N=-1*p;N<=p;N+=2){var U=void 0,W=P[N-1],V=P[N+1],ie=(V?V.newPos:0)-N;W&&(P[N-1]=void 0);var oe=W&&W.newPos+1<l,ge=V&&0<=ie&&ie<d;if(!oe&&!ge){P[N]=void 0;continue}if(!oe||ge&&W.newPos<V.newPos?(U=Va(V),o.pushComponent(U.components,void 0,!0)):(U=W,U.newPos++,o.pushComponent(U.components,!0,void 0)),ie=o.extractCommon(U,r,e,N),U.newPos+1>=l&&ie+1>=d)return c(mi(o,U.components,r,e,o.useLongestToken));P[N]=U}p++}if(a(O,"execEditLength"),i)a(function N(){setTimeout(function(){if(p>S)return i();O()||N()},0)},"exec")();else for(;p<=S;){var F=O();if(F)return F}},"diff"),pushComponent:a(function(e,r,n){var i=e[e.length-1];i&&i.added===r&&i.removed===n?e[e.length-1]={count:i.count+1,added:r,removed:n}:e.push({count:1,added:r,removed:n})},"pushComponent"),extractCommon:a(function(e,r,n,i){for(var o=r.length,c=n.length,l=e.newPos,d=l-i,p=0;l+1<o&&d+1<c&&this.equals(r[l+1],n[d+1]);)l++,d++,p++;return p&&e.components.push({count:p}),e.newPos=l,d},"extractCommon"),equals:a(function(e,r){return this.options.comparator?this.options.comparator(e,r):e===r||this.options.ignoreCase&&e.toLowerCase()===r.toLowerCase()},"equals"),removeEmpty:a(function(e){for(var r=[],n=0;n<e.length;n++)e[n]&&r.push(e[n]);return r},"removeEmpty"),castInput:a(function(e){return e},"castInput"),tokenize:a(function(e){return e.split("")},"tokenize"),join:a(function(e){return e.join("")},"join")};function mi(t,e,r,n,i){for(var o=0,c=e.length,l=0,d=0;o<c;o++){var p=e[o];if(p.removed){if(p.value=t.join(n.slice(d,d+p.count)),d+=p.count,o&&e[o-1].added){var P=e[o-1];e[o-1]=e[o],e[o]=P}}else{if(!p.added&&i){var S=r.slice(l,l+p.count);S=S.map(function(O,F){var N=n[d+F];return N.length>O.length?N:O}),p.value=t.join(S)}else p.value=t.join(r.slice(l,l+p.count));l+=p.count,p.added||(d+=p.count)}}var I=e[c-1];return c>1&&typeof I.value=="string"&&(I.added||I.removed)&&t.equals("",I.value)&&(e[c-2].value+=I.value,e.pop()),e}a(mi,"buildValues");function Va(t){return{newPos:t.newPos,components:t.components.slice(0)}}a(Va,"clonePath");var ec=new _n;function dl(t,e,r){return ec.diff(t,e,r)}a(dl,"diffChars");function Ka(t,e){if(typeof t=="function")e.callback=t;else if(t)for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}a(Ka,"generateOptions");var Xa=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,Rn=/\S/,io=new _n;io.equals=function(t,e){return this.options.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t===e||this.options.ignoreWhitespace&&!Rn.test(t)&&!Rn.test(e)},io.tokenize=function(t){for(var e=t.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),r=0;r<e.length-1;r++)!e[r+1]&&e[r+2]&&Xa.test(e[r])&&Xa.test(e[r+2])&&(e[r]+=e[r+2],e.splice(r+1,2),r--);return e};function hl(t,e,r){return r=Ka(r,{ignoreWhitespace:!0}),io.diff(t,e,r)}a(hl,"diffWords");function fl(t,e,r){return io.diff(t,e,r)}a(fl,"diffWordsWithSpace");var xo=new _n;xo.tokenize=function(t){var e=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var n=0;n<r.length;n++){var i=r[n];n%2&&!this.options.newlineIsToken?e[e.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),e.push(i))}return e};function Qa(t,e,r){return xo.diff(t,e,r)}a(Qa,"diffLines");function vi(t,e,r){var n=Ka(r,{ignoreWhitespace:!0});return xo.diff(t,e,n)}a(vi,"diffTrimmedLines");var Ya=new _n;Ya.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};function pl(t,e,r){return Ya.diff(t,e,r)}a(pl,"diffSentences");var Za=new _n;Za.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function gl(t,e,r){return Za.diff(t,e,r)}a(gl,"diffCss");function Kr(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Kr=a(function(e){return typeof e},"_typeof"):Kr=a(function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},"_typeof"),Kr(t)}a(Kr,"_typeof");function dn(t){return Ja(t)||es(t)||Jn(t)||tc()}a(dn,"_toConsumableArray");function Ja(t){if(Array.isArray(t))return oa(t)}a(Ja,"_arrayWithoutHoles");function es(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}a(es,"_iterableToArray");function Jn(t,e){if(!!t){if(typeof t=="string")return oa(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oa(t,e)}}a(Jn,"_unsupportedIterableToArray");function oa(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}a(oa,"_arrayLikeToArray");function tc(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}a(tc,"_nonIterableSpread");var rc=Object.prototype.toString,Mi=new _n;Mi.useLongestToken=!0,Mi.tokenize=xo.tokenize,Mi.castInput=function(t){var e=this.options,r=e.undefinedReplacement,n=e.stringifyReplacer,i=n===void 0?function(o,c){return typeof c=="undefined"?r:c}:n;return typeof t=="string"?t:JSON.stringify(aa(t,null,null,i),i,"  ")},Mi.equals=function(t,e){return _n.prototype.equals.call(Mi,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function ml(t,e,r){return Mi.diff(t,e,r)}a(ml,"diffJson");function aa(t,e,r,n,i){e=e||[],r=r||[],n&&(t=n(i,t));var o;for(o=0;o<e.length;o+=1)if(e[o]===t)return r[o];var c;if(rc.call(t)==="[object Array]"){for(e.push(t),c=new Array(t.length),r.push(c),o=0;o<t.length;o+=1)c[o]=aa(t[o],e,r,n,i);return e.pop(),r.pop(),c}if(t&&t.toJSON&&(t=t.toJSON()),Kr(t)==="object"&&t!==null){e.push(t),c={},r.push(c);var l=[],d;for(d in t)t.hasOwnProperty(d)&&l.push(d);for(l.sort(),o=0;o<l.length;o+=1)d=l[o],c[d]=aa(t[d],e,r,n,d);e.pop(),r.pop()}else c=t;return c}a(aa,"canonicalize");var yi=new _n;yi.tokenize=function(t){return t.slice()},yi.join=yi.removeEmpty=function(t){return t};function nc(t,e,r){return yi.diff(t,e,r)}a(nc,"diffArrays");function In(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.split(/\r\n|[\n\v\f\r\x85]/),n=t.match(/\r\n|[\n\v\f\r\x85]/g)||[],i=[],o=0;function c(){var p={};for(i.push(p);o<r.length;){var S=r[o];if(/^(\-\-\-|\+\+\+|@@)\s/.test(S))break;var P=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(S);P&&(p.index=P[1]),o++}for(l(p),l(p),p.hunks=[];o<r.length;){var I=r[o];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(I))break;if(/^@@/.test(I))p.hunks.push(d());else{if(I&&e.strict)throw new Error("Unknown line "+(o+1)+" "+JSON.stringify(I));o++}}}a(c,"parseIndex");function l(p){var S=/^(---|\+\+\+)\s+(.*)$/.exec(r[o]);if(S){var P=S[1]==="---"?"old":"new",I=S[2].split("	",2),O=I[0].replace(/\\\\/g,"\\");/^".*"$/.test(O)&&(O=O.substr(1,O.length-2)),p[P+"FileName"]=O,p[P+"Header"]=(I[1]||"").trim(),o++}}a(l,"parseFileHeader");function d(){var p=o,S=r[o++],P=S.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),I={oldStart:+P[1],oldLines:typeof P[2]=="undefined"?1:+P[2],newStart:+P[3],newLines:typeof P[4]=="undefined"?1:+P[4],lines:[],linedelimiters:[]};I.oldLines===0&&(I.oldStart+=1),I.newLines===0&&(I.newStart+=1);for(var O=0,F=0;o<r.length&&!(r[o].indexOf("--- ")===0&&o+2<r.length&&r[o+1].indexOf("+++ ")===0&&r[o+2].indexOf("@@")===0);o++){var N=r[o].length==0&&o!=r.length-1?" ":r[o][0];if(N==="+"||N==="-"||N===" "||N==="\\")I.lines.push(r[o]),I.linedelimiters.push(n[o]||`
`),N==="+"?O++:N==="-"?F++:N===" "&&(O++,F++);else break}if(!O&&I.newLines===1&&(I.newLines=0),!F&&I.oldLines===1&&(I.oldLines=0),e.strict){if(O!==I.newLines)throw new Error("Added line count did not match for hunk at line "+(p+1));if(F!==I.oldLines)throw new Error("Removed line count did not match for hunk at line "+(p+1))}return I}for(a(d,"parseHunk");o<r.length;)c();return i}a(In,"parsePatch");function ts(t,e,r){var n=!0,i=!1,o=!1,c=1;return a(function l(){if(n&&!o){if(i?c++:n=!1,t+c<=r)return c;o=!0}if(!i)return o||(n=!0),e<=t-c?-c++:(i=!0,l())},"iterator")}a(ts,"distanceIterator");function sa(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string"&&(e=In(e)),Array.isArray(e)){if(e.length>1)throw new Error("applyPatch only works with a single input.");e=e[0]}var n=t.split(/\r\n|[\n\v\f\r\x85]/),i=t.match(/\r\n|[\n\v\f\r\x85]/g)||[],o=e.hunks,c=r.compareLine||function(Hn,Zn,Ii,Oi){return Zn===Oi},l=0,d=r.fuzzFactor||0,p=0,S=0,P,I;function O(Hn,Zn){for(var Ii=0;Ii<Hn.lines.length;Ii++){var Oi=Hn.lines[Ii],Xs=Oi.length>0?Oi[0]:" ",wu=Oi.length>0?Oi.substr(1):Oi;if(Xs===" "||Xs==="-"){if(!c(Zn+1,n[Zn],Xs,wu)&&(l++,l>d))return!1;Zn++}}return!0}a(O,"hunkFits");for(var F=0;F<o.length;F++){for(var N=o[F],U=n.length-N.oldLines,W=0,V=S+N.oldStart-1,ie=ts(V,p,U);W!==void 0;W=ie())if(O(N,V+W)){N.offset=S+=W;break}if(W===void 0)return!1;p=N.offset+N.oldStart+N.oldLines}for(var oe=0,ge=0;ge<o.length;ge++){var ke=o[ge],Re=ke.oldStart+ke.offset+oe-1;oe+=ke.newLines-ke.oldLines;for(var Ie=0;Ie<ke.lines.length;Ie++){var Ye=ke.lines[Ie],$e=Ye.length>0?Ye[0]:" ",ze=Ye.length>0?Ye.substr(1):Ye,at=ke.linedelimiters[Ie];if($e===" ")Re++;else if($e==="-")n.splice(Re,1),i.splice(Re,1);else if($e==="+")n.splice(Re,0,ze),i.splice(Re,0,at),Re++;else if($e==="\\"){var kt=ke.lines[Ie-1]?ke.lines[Ie-1][0]:null;kt==="+"?P=!0:kt==="-"&&(I=!0)}}}if(P)for(;!n[n.length-1];)n.pop(),i.pop();else I&&(n.push(""),i.push(`
`));for(var rn=0;rn<n.length-1;rn++)n[rn]=n[rn]+i[rn];return n.join("")}a(sa,"applyPatch");function rs(t,e){typeof t=="string"&&(t=In(t));var r=0;function n(){var i=t[r++];if(!i)return e.complete();e.loadFile(i,function(o,c){if(o)return e.complete(o);var l=sa(c,i,e);e.patched(i,l,function(d){if(d)return e.complete(d);n()})})}a(n,"processIndex"),n()}a(rs,"applyPatches");function ns(t,e,r,n,i,o,c){c||(c={}),typeof c.context=="undefined"&&(c.context=4);var l=Qa(r,n,c);l.push({value:"",lines:[]});function d(W){return W.map(function(V){return" "+V})}a(d,"contextLines");for(var p=[],S=0,P=0,I=[],O=1,F=1,N=a(function(V){var ie=l[V],oe=ie.lines||ie.value.replace(/\n$/,"").split(`
`);if(ie.lines=oe,ie.added||ie.removed){var ge;if(!S){var ke=l[V-1];S=O,P=F,ke&&(I=c.context>0?d(ke.lines.slice(-c.context)):[],S-=I.length,P-=I.length)}(ge=I).push.apply(ge,dn(oe.map(function(rn){return(ie.added?"+":"-")+rn}))),ie.added?F+=oe.length:O+=oe.length}else{if(S)if(oe.length<=c.context*2&&V<l.length-2){var Re;(Re=I).push.apply(Re,dn(d(oe)))}else{var Ie,Ye=Math.min(oe.length,c.context);(Ie=I).push.apply(Ie,dn(d(oe.slice(0,Ye))));var $e={oldStart:S,oldLines:O-S+Ye,newStart:P,newLines:F-P+Ye,lines:I};if(V>=l.length-2&&oe.length<=c.context){var ze=/\n$/.test(r),at=/\n$/.test(n),kt=oe.length==0&&I.length>$e.oldLines;!ze&&kt&&r.length>0&&I.splice($e.oldLines,0,"\\ No newline at end of file"),(!ze&&!kt||!at)&&I.push("\\ No newline at end of file")}p.push($e),S=0,P=0,I=[]}O+=oe.length,F+=oe.length}},"_loop"),U=0;U<l.length;U++)N(U);return{oldFileName:t,newFileName:e,oldHeader:i,newHeader:o,hunks:p}}a(ns,"structuredPatch");function is(t){var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader=="undefined"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader=="undefined"?"":"	"+t.newHeader));for(var r=0;r<t.hunks.length;r++){var n=t.hunks[r];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),e.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@"),e.push.apply(e,n.lines)}return e.join(`
`)+`
`}a(is,"formatPatch");function ic(t,e,r,n,i,o,c){return is(ns(t,e,r,n,i,o,c))}a(ic,"createTwoFilesPatch");function Co(t,e,r,n,i,o){return ic(t,t,e,r,n,i,o)}a(Co,"createPatch");function oc(t,e){return t.length!==e.length?!1:ca(t,e)}a(oc,"arrayEqual");function ca(t,e){if(e.length>t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}a(ca,"arrayStartsWith");function la(t){var e=ha(t.lines),r=e.oldLines,n=e.newLines;r!==void 0?t.oldLines=r:delete t.oldLines,n!==void 0?t.newLines=n:delete t.newLines}a(la,"calcLineCount");function ua(t,e,r){t=_i(t,r),e=_i(e,r);var n={};(t.index||e.index)&&(n.index=t.index||e.index),(t.newFileName||e.newFileName)&&(os(t)?os(e)?(n.oldFileName=To(n,t.oldFileName,e.oldFileName),n.newFileName=To(n,t.newFileName,e.newFileName),n.oldHeader=To(n,t.oldHeader,e.oldHeader),n.newHeader=To(n,t.newHeader,e.newHeader)):(n.oldFileName=t.oldFileName,n.newFileName=t.newFileName,n.oldHeader=t.oldHeader,n.newHeader=t.newHeader):(n.oldFileName=e.oldFileName||t.oldFileName,n.newFileName=e.newFileName||t.newFileName,n.oldHeader=e.oldHeader||t.oldHeader,n.newHeader=e.newHeader||t.newHeader)),n.hunks=[];for(var i=0,o=0,c=0,l=0;i<t.hunks.length||o<e.hunks.length;){var d=t.hunks[i]||{oldStart:1/0},p=e.hunks[o]||{oldStart:1/0};if(Un(d,p))n.hunks.push(as(d,c)),i++,l+=d.newLines-d.oldLines;else if(Un(p,d))n.hunks.push(as(p,l)),o++,c+=p.newLines-p.oldLines;else{var S={oldStart:Math.min(d.oldStart,p.oldStart),oldLines:0,newStart:Math.min(d.newStart+c,p.oldStart+l),newLines:0,lines:[]};ac(S,d.oldStart,d.lines,p.oldStart,p.lines),o++,i++,n.hunks.push(S)}}return n}a(ua,"merge");function _i(t,e){if(typeof t=="string"){if(/^@@/m.test(t)||/^Index:/m.test(t))return In(t)[0];if(!e)throw new Error("Must provide a base reference or pass in a patch");return ns(void 0,void 0,e,t)}return t}a(_i,"loadPatch");function os(t){return t.newFileName&&t.newFileName!==t.oldFileName}a(os,"fileNameChanged");function To(t,e,r){return e===r?e:(t.conflict=!0,{mine:e,theirs:r})}a(To,"selectField");function Un(t,e){return t.oldStart<e.oldStart&&t.oldStart+t.oldLines<e.oldStart}a(Un,"hunkBefore");function as(t,e){return{oldStart:t.oldStart,oldLines:t.oldLines,newStart:t.newStart+e,newLines:t.newLines,lines:t.lines}}a(as,"cloneHunk");function ac(t,e,r,n,i){var o={offset:e,lines:r,index:0},c={offset:n,lines:i,index:0};for(ei(t,o,c),ei(t,c,o);o.index<o.lines.length&&c.index<c.lines.length;){var l=o.lines[o.index],d=c.lines[c.index];if((l[0]==="-"||l[0]==="+")&&(d[0]==="-"||d[0]==="+"))sc(t,o,c);else if(l[0]==="+"&&d[0]===" "){var p;(p=t.lines).push.apply(p,dn(wi(o)))}else if(d[0]==="+"&&l[0]===" "){var S;(S=t.lines).push.apply(S,dn(wi(c)))}else l[0]==="-"&&d[0]===" "?ss(t,o,c):d[0]==="-"&&l[0]===" "?ss(t,c,o,!0):l===d?(t.lines.push(l),o.index++,c.index++):Ao(t,wi(o),wi(c))}da(t,o),da(t,c),la(t)}a(ac,"mergeLines");function sc(t,e,r){var n=wi(e),i=wi(r);if(cs(n)&&cs(i)){if(ca(n,i)&&Io(r,n,n.length-i.length)){var o;(o=t.lines).push.apply(o,dn(n));return}else if(ca(i,n)&&Io(e,i,i.length-n.length)){var c;(c=t.lines).push.apply(c,dn(i));return}}else if(oc(n,i)){var l;(l=t.lines).push.apply(l,dn(n));return}Ao(t,n,i)}a(sc,"mutualChange");function ss(t,e,r,n){var i=wi(e),o=Ro(r,i);if(o.merged){var c;(c=t.lines).push.apply(c,dn(o.merged))}else Ao(t,n?o:i,n?i:o)}a(ss,"removal");function Ao(t,e,r){t.conflict=!0,t.lines.push({conflict:!0,mine:e,theirs:r})}a(Ao,"conflict");function ei(t,e,r){for(;e.offset<r.offset&&e.index<e.lines.length;){var n=e.lines[e.index++];t.lines.push(n),e.offset++}}a(ei,"insertLeading");function da(t,e){for(;e.index<e.lines.length;){var r=e.lines[e.index++];t.lines.push(r)}}a(da,"insertTrailing");function wi(t){for(var e=[],r=t.lines[t.index][0];t.index<t.lines.length;){var n=t.lines[t.index];if(r==="-"&&n[0]==="+"&&(r="+"),r===n[0])e.push(n),t.index++;else break}return e}a(wi,"collectChange");function Ro(t,e){for(var r=[],n=[],i=0,o=!1,c=!1;i<e.length&&t.index<t.lines.length;){var l=t.lines[t.index],d=e[i];if(d[0]==="+")break;if(o=o||l[0]!==" ",n.push(d),i++,l[0]==="+")for(c=!0;l[0]==="+";)r.push(l),l=t.lines[++t.index];d.substr(1)===l.substr(1)?(r.push(l),t.index++):c=!0}if((e[i]||"")[0]==="+"&&o&&(c=!0),c)return r;for(;i<e.length;)n.push(e[i++]);return{merged:n,changes:r}}a(Ro,"collectContext");function cs(t){return t.reduce(function(e,r){return e&&r[0]==="-"},!0)}a(cs,"allRemoves");function Io(t,e,r){for(var n=0;n<r;n++){var i=e[e.length-r+n].substr(1);if(t.lines[t.index+n]!==" "+i)return!1}return t.index+=r,!0}a(Io,"skipRemoveSuperset");function ha(t){var e=0,r=0;return t.forEach(function(n){if(typeof n!="string"){var i=ha(n.mine),o=ha(n.theirs);e!==void 0&&(i.oldLines===o.oldLines?e+=i.oldLines:e=void 0),r!==void 0&&(i.newLines===o.newLines?r+=i.newLines:r=void 0)}else r!==void 0&&(n[0]==="+"||n[0]===" ")&&r++,e!==void 0&&(n[0]==="-"||n[0]===" ")&&e++}),{oldLines:e,newLines:r}}a(ha,"calcOldNewLineCount");function cc(t){for(var e=[],r,n,i=0;i<t.length;i++)r=t[i],r.added?n=1:r.removed?n=-1:n=0,e.push([n,r.value]);return e}a(cc,"convertChangesToDMP");function lc(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];n.added?e.push("<ins>"):n.removed&&e.push("<del>"),e.push(ls(n.value)),n.added?e.push("</ins>"):n.removed&&e.push("</del>")}return e.join("")}a(lc,"convertChangesToXML");function ls(t){var e=t;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}a(ls,"escapeHTML");function bi(t,e){let r={};for(let o=0;o<e.length;o++){const c=e[o];r[c]?r[c].push(o):r[c]=[o]}let i=[{buffer1index:-1,buffer2index:-1,chain:null}];for(let o=0;o<t.length;o++){const c=t[o],l=r[c]||[];let d=0,p=i[0];for(let S=0;S<l.length;S++){const P=l[S];let I;for(I=d;I<i.length&&!(i[I].buffer2index<P&&(I===i.length-1||i[I+1].buffer2index>P));I++);if(I<i.length){const O={buffer1index:o,buffer2index:P,chain:i[I]};if(d===i.length?i.push(p):i[d]=p,d=I+1,p=O,d===i.length)break}}i[d]=p}return i[i.length-1]}a(bi,"LCS");function us(t,e){const r=bi(t,e);let n=[],i=t.length,o=e.length,c={common:[]};function l(){c.common.length&&(c.common.reverse(),n.push(c),c={common:[]})}a(l,"processCommon");for(let d=r;d!==null;d=d.chain){let p={buffer1:[],buffer2:[]};for(;--i>d.buffer1index;)p.buffer1.push(t[i]);for(;--o>d.buffer2index;)p.buffer2.push(e[o]);(p.buffer1.length||p.buffer2.length)&&(l(),p.buffer1.reverse(),p.buffer2.reverse(),n.push(p)),i>=0&&c.common.push(t[i])}return l(),n.reverse(),n}a(us,"diffComm");function Oo(t,e){const r=bi(t,e);let n=[],i=t.length,o=e.length;for(let c=r;c!==null;c=c.chain){const l=i-c.buffer1index-1,d=o-c.buffer2index-1;i=c.buffer1index,o=c.buffer2index,(l||d)&&n.push({buffer1:[i+1,l],buffer1Content:t.slice(i+1,i+1+l),buffer2:[o+1,d],buffer2Content:e.slice(o+1,o+1+d)})}return n.reverse(),n}a(Oo,"diffIndices");function Po(t,e){const r=bi(t,e);let n=[],i=t.length,o=e.length;function c(l,d,p){let S=[];for(let P=0;P<p;P++)S.push(l[d+P]);return{offset:d,length:p,chunk:S}}a(c,"chunkDescription");for(let l=r;l!==null;l=l.chain){const d=i-l.buffer1index-1,p=o-l.buffer2index-1;i=l.buffer1index,o=l.buffer2index,(d||p)&&n.push({buffer1:c(t,l.buffer1index+1,d),buffer2:c(e,l.buffer2index+1,p)})}return n.reverse(),n}a(Po,"diffPatch");function hn(t,e,r){let n=[];function i(d,p){n.push({ab:p,oStart:d.buffer1[0],oLength:d.buffer1[1],abStart:d.buffer2[0],abLength:d.buffer2[1]})}a(i,"addHunk"),Oo(e,t).forEach(d=>i(d,"a")),Oo(e,r).forEach(d=>i(d,"b")),n.sort((d,p)=>d.oStart-p.oStart);let o=[],c=0;function l(d){d>c&&(o.push({stable:!0,buffer:"o",bufferStart:c,bufferLength:d-c,bufferContent:e.slice(c,d)}),c=d)}for(a(l,"advanceTo");n.length;){let d=n.shift(),p=d.oStart,S=d.oStart+d.oLength,P=[d];for(l(p);n.length;){const I=n[0],O=I.oStart;if(O>S)break;S=Math.max(S,O+I.oLength),P.push(n.shift())}if(P.length===1){if(d.abLength>0){const I=d.ab==="a"?t:r;o.push({stable:!0,buffer:d.ab,bufferStart:d.abStart,bufferLength:d.abLength,bufferContent:I.slice(d.abStart,d.abStart+d.abLength)})}}else{let I={a:[t.length,-1,e.length,-1],b:[r.length,-1,e.length,-1]};for(;P.length;){d=P.shift();const V=d.oStart,ie=V+d.oLength,oe=d.abStart,ge=oe+d.abLength;let ke=I[d.ab];ke[0]=Math.min(oe,ke[0]),ke[1]=Math.max(ge,ke[1]),ke[2]=Math.min(V,ke[2]),ke[3]=Math.max(ie,ke[3])}const O=I.a[0]+(p-I.a[2]),F=I.a[1]+(S-I.a[3]),N=I.b[0]+(p-I.b[2]),U=I.b[1]+(S-I.b[3]);let W={stable:!1,aStart:O,aLength:F-O,aContent:t.slice(O,F),oStart:p,oLength:S-p,oContent:e.slice(p,S),bStart:N,bLength:U-N,bContent:r.slice(N,U)};o.push(W)}c=S}return l(e.length),o}a(hn,"diff3MergeRegions");function J(t,e,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},n);const o=typeof t=="string",c=typeof e=="string",l=typeof r=="string";o&&(t=t.split(n.stringSeparator)),c&&(e=e.split(n.stringSeparator)),l&&(r=r.split(n.stringSeparator));let d=[];const p=hn(t,e,r);let S=[];function P(){S.length&&d.push({ok:S}),S=[]}a(P,"flushOk");function I(O,F){if(O.length!==F.length)return!1;for(let N=0;N<O.length;N++)if(O[N]!==F[N])return!1;return!0}return a(I,"isFalseConflict"),p.forEach(O=>{O.stable?S.push(...O.bufferContent):n.excludeFalseConflicts&&I(O.aContent,O.bContent)?S.push(...O.aContent):(P(),d.push({conflict:{a:O.aContent,aIndex:O.aStart,o:O.oContent,oIndex:O.oStart,b:O.bContent,bIndex:O.bStart}}))}),P(),d}a(J,"diff3Merge");function _e(t,e,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/,label:{}},n);const o=J(t,e,r,n);let c=!1,l=[];return o.forEach(d=>{d.ok?l=l.concat(d.ok):d.conflict&&(c=!0,l.push(`<<<<<<<${n.label.a?` ${n.label.a}`:""}`),l=l.concat(d.conflict.a),l.push(`|||||||${n.label.o?` ${n.label.o}`:""}`),l=l.concat(d.conflict.o),l.push("======="),l=l.concat(d.conflict.b),l.push(`>>>>>>>${n.label.b?` ${n.label.b}`:""}`))}),{conflict:c,result:l}}a(_e,"mergeDiff3");function Ge(t,e,r,n){n=Object.assign({excludeFalseConflicts:!0,stringSeparator:/\s+/},n);const o=J(t,e,r,n);let c=!1,l=[];for(let d=0;d<o.length;d++){const p=o[d];p.ok?l=l.concat(p.ok):(c=!0,l=l.concat([`
<<<<<<<<<
`],p.conflict.a,[`
=========
`],p.conflict.b,[`
>>>>>>>>>
`]))}return{conflict:c,result:l}}a(Ge,"node_diff3_merge");function gt(t,e,r,n){n=Object.assign({excludeFalseConflicts:!1,stringSeparator:/\s+/},n);const o=J(t,e,r,n);let c=!1,l=[];for(let d=0;d<o.length;d++){const p=o[d];if(p.ok)l=l.concat(p.ok);else{const S=us(p.conflict.a,p.conflict.b);for(let P=0;P<S.length;P++){let I=S[P];I.common?l=l.concat(I.common):(c=!0,l=l.concat([`
<<<<<<<<<
`],I.buffer1,[`
=========
`],I.buffer2,[`
>>>>>>>>>
`]))}}}return{conflict:c,result:l}}a(gt,"mergeDigIn");function hr(t,e){let r=[],n=0;function i(o){for(;n<o;)r.push(t[n]),n++}a(i,"advanceTo");for(let o=0;o<e.length;o++){let c=e[o];i(c.buffer1.offset);for(let l=0;l<c.buffer2.chunk.length;l++)r.push(c.buffer2.chunk[l]);n+=c.buffer1.length}return i(t.length),r}a(hr,"patch");function $t(t){return t.map(e=>({buffer1:{offset:e.buffer1.offset,length:e.buffer1.length},buffer2:{chunk:e.buffer2.chunk}}))}a($t,"stripPatch");function br(t){return t.map(e=>({buffer1:e.buffer2,buffer2:e.buffer1}))}a(br,"invertPatch");function Rr(t,e,r){return sa(t,e,r)}a(Rr,"diffs_applyPatch");function Or(t,e){const r=[];for(const n of In(t,e))r.push({...n,oldFileName:n.newFileName,oldHeader:n.newHeader,newFileName:n.oldFileName,newHeader:n.oldHeader,hunks:n.hunks.map(i=>({...i,oldLines:i.newLines,oldStart:i.newStart,newLines:i.oldLines,newStart:i.oldStart,lines:i.lines.map(o=>o[0]==="-"?`+${o.slice(1)}`:o[0]==="+"?`-${o.slice(1)}`:o)}))}),r.push(n);return r}a(Or,"reversePatch");function fr(t,e,r){let n=`
`;const i=t.match(/(?:\r?\n)/g);if(i!==null&&i.length!==0){const d=i.filter(p=>p===`\r
`).length;n=d>i.length-d?`\r
`:`
`}const o=Ge(t,e,r,{excludeFalseConflicts:!0,stringSeparator:/\r?\n/}),c=o.result;let l=!1;if(o.conflict){let d;const p=[];let S=0;for(const O of c)O===`
<<<<<<<<<
`?d={start:S,separator:S,end:S}:O===`
=========
`?d.separator=S:O===`
>>>>>>>>>
`&&(d.end=S,p.push(d)),S++;let P=0,I=0;for(const O of p)c.splice(O.start-P,1),P++,I=O.end-O.separator+1,c.splice(O.separator-P,I),P+=I;p.length&&(l=!0)}return{conflicts:l,mergedContent:c.join(n)}}a(fr,"diffs_merge");function sn(t){return t!==void 0&&typeof t.then=="function"}a(sn,"isPromise");const fn="";function $r(...t){if(t.length===1){const e=t[0];return e===void 0?fn:typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"||e instanceof Error?String(e):e instanceof m.Uri?e.toString():JSON.stringify(e)}return JSON.stringify(t)}a($r,"gate_defaultResolver");function nr(t){return(e,r,n)=>{let i;if(typeof n.value=="function"?i=n.value:typeof n.get=="function"&&(i=n.get),i===void 0)throw new Error("Not supported");const o=`$gate$${r}`;n.value=function(...c){const l=c.length===0?o:`${o}$${(t!=null?t:$r)(...c)}`;Object.prototype.hasOwnProperty.call(this,l)||Object.defineProperty(this,l,{configurable:!1,enumerable:!1,writable:!0,value:void 0});let d=this[l];if(d===void 0){let p;try{if(p=i.apply(this,c),p==null||!sn(p))return p;this[l]=d=p.then(S=>(this[l]=void 0,S)).catch(S=>{throw this[l]=void 0,S})}catch(S){throw this[l]=void 0,S}}return d}}}a(nr,"gate");let Xr=0;function ti(){return Xr===Number.MAX_SAFE_INTEGER&&(Xr=0),String(++Xr)}a(ti,"getNextLockId");class On{constructor(){this.id=ti()}async synchronize(e){let r;const n=this.promise;this.promise=new Promise(i=>r=i),await n;try{return await e()}finally{r()}}}a(On,"Lock");class wn{constructor(e){this.lock=new On,this.readers=new Set,this.counter=0,this._id=e!=null?e:this.lock.id}get id(){return this._id}getNextCounter(){return this.counter===Number.MAX_SAFE_INTEGER&&(this.counter=0),++this.counter}async synchronizeRead(e,r){let n;const i=new lt(`Reader(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:r?` \u2022 ${r}`:""},logLevel:qe.Debug});let o;await this.lock.synchronize(async()=>{this.writer&&await this.writer,o=new Promise(c=>n=c),this.readers.add(o)}),i.restart({prefix:"(L) ",suffix:r?` \u2022 ${r}`:"",took:" waited for "});try{return await e()}finally{i.stop({prefix:"(U) ",suffix:r?` \u2022 ${r}`:"",took:" locked for "}),o!==void 0&&this.readers.delete(o),n()}}async synchronizeWrite(e,r){let n;const i=new lt(`Writer(${this.getNextCounter()}|${this.id})`,{log:{prefix:"(A) ",message:r?` \u2022 ${r}`:""},logLevel:qe.Debug});await this.lock.synchronize(async()=>{if(this.writer&&await this.writer,this.readers.size){const o=[...this.readers];this.readers.clear(),await Promise.all(o)}this.writer=new Promise(o=>n=o)}),i.restart({prefix:"(L) ",suffix:r?` \u2022 ${r}`:"",took:" waited for "});try{return await e()}finally{i.stop({prefix:"(U) ",suffix:r?` \u2022 ${r}`:"",took:" locked for "}),n(),this.writer=void 0}}}a(wn,"ReaderWriterLock");class fa{constructor(){this.locks=new Map}async synchronizeRead(e,r,n){let i=this.locks.get(e);return i===void 0&&(i=new wn(String(e)),this.locks.set(e,i)),i.synchronizeRead(r,n)}async synchronizeWrite(e,r,n){let i=this.locks.get(e);return i===void 0&&(i=new wn(String(e)),this.locks.set(e,i)),i.synchronizeWrite(r,n)}}a(fa,"KeyedReaderWriterLock");async function ri(t){return(await Promise.resolve().then(__webpack_require__.t.bind(__webpack_require__,6113,23))).createHash("sha1").update(t).digest("base64")}a(ri,"sha1");var Do=Object.defineProperty,vl=Object.getOwnPropertyDescriptor,bu=a((t,e,r,n)=>{for(var i=n>1?void 0:n?vl(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&Do(e,r,i),i},"changeStore_decorateClass");const Pn=(0,B.loadMessageBundle)(),Su=m.FileSystemError.FileNotFound().code,yl=`===================================================================
`,ni=new TextDecoder,Eu=new TextEncoder;var Dt;(function(t){t[t.Changed=1]="Changed",t[t.Created=2]="Created",t[t.Deleted=3]="Deleted"})(Dt||(Dt={}));function xu(t){return t&&"type"in t&&"uri"in t&&"uri"in t&&"fileType"in t&&"revision"in t&&"timestamp"in t}a(xu,"isOperation");function pa(t,e,r){return{type:t.type,rootUri:e,uri:r!=null?r:t.uri}}a(pa,"toEvent");const ko=a(class{constructor(t,e,r,n,i,o){this.providerService=t,this.storageService=e,this.fileStorageService=r,this.telemetryService=n,this.workspaceId=i,this._onDidChange=new m.EventEmitter,this.cache=new Map,this.lock=new fa,this.scopedStores=new Map,o===void 0&&(ko._instance=this,this.disposable=m.Disposable.from(this.providerService.onDidRefresh(()=>this.cache.clear())))}static get instance(){return this._instance}get onDidChange(){return this._onDidChange.event}dispose(){var t;(t=this.disposable)==null||t.dispose()}async exportDebugInfo(t){var e;async function r(n){const i=await m.workspace.openTextDocument({language:"json",content:`ChangeStore Operations for ${n.toString(!0)}

${this.toStorage(await this.getWorkingOperations(n))}`});return void m.window.showTextDocument(i)}if(a(r,"exportCore"),t===void 0)for(const n of(e=m.workspace.workspaceFolders)!=null?e:[])await r.call(this,n.uri);else return r.call(this,t)}async getWorkspaceProvidersWithChanges(){var t,e;const r=new Map;for(const n of(t=m.workspace.workspaceFolders)!=null?t:[])if(n.uri.scheme===Xt.scheme&&await this.hasChanges(n.uri)){const i=(e=this.providerService.getRepository(n.uri))==null?void 0:e.provider;if(!i)continue;r.set(i.id,i)}return[...r.values()]}async getWorkspacesWithChanges(){var t;const e=new lt("ChangeStore.getWorkspacesWithChanges()");try{const r=[];for(const n of(t=m.workspace.workspaceFolders)!=null?t:[])n.uri.scheme===Xt.scheme&&await this.hasChanges(n.uri)&&r.push(n.uri);return r.length>0?r:void 0}finally{e.stop()}}async acceptAll(t,e){const r=`ChangeStore.acceptAll(${t.toString()}, ${e==null?void 0:e.staged})`;L.log(r);const n=[];await this.lock.synchronizeWrite(te(t),async()=>{const i=await this.getWorkingOperations(t),o=[];let c=[];const l=(e==null?void 0:e.staged)&&!(e.staged==="auto"&&!i.some(d=>d.staged));for(const d of i){if(l&&!d.staged){c.push(d);continue}d.fileType===m.FileType.File&&await this.discardWorkingContent(t,d.uri);let p;if(d.type===2&&d.fileType===m.FileType.Directory&&(i.some(S=>Je(S.uri,d.uri))||(p={type:3,rootUri:t,uri:d.uri})),n.push(p!=null?p:pa(d,t)),d.type===2){let S=d.uri;for(;;){const{parent:P}=this.findParent(S,i,I=>I.type===2);if(P){o.push(P),S=P.uri;continue}break}}}c.length>0&&o.length>0&&(c=c.filter(d=>o.includes(d)?(n.push(pa(d,t)),!1):!0)),await this.saveWorkingOperations(t,c)},r),n.length!==0&&this._onDidChange.fire(n)}async discard(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=`ChangeStore.discard(${t.toString()})`;L.log(r);const n=[];await this.lock.synchronizeWrite(te(e),async()=>this.discardCore(e,t,n),r),n.length!==0&&this._onDidChange.fire(n)}async discardCore(t,e,r){L.debug(`ChangeStore.discardCore(${e.toString()})`);const n=await this.getWorkingOperations(t);if(n.length===0)return;const i=Ae(e),o=n.findIndex(d=>Ae(d.uri)===i);if(o===-1)return;const[c]=n.splice(o,1);let l;switch(c.type){case 2:l=3;break;case 3:l=2;break;default:l=c.type;break}if(r.push({type:l,rootUri:t,uri:e}),c.type===2){let d=c.uri;for(;;){const{parent:p,parentIndex:S}=this.findNewParentWithOnlyChild(d,n);if(p){n.splice(S,1),r.push({type:3,rootUri:t,uri:p.uri}),d=p.uri;continue}break}}await this.saveWorkingOperations(t,n),c.fileType===m.FileType.File&&await this.discardWorkingContent(t,e)}async discardAll(t,e){const r=this.getUriScope(t);if(r)return this.getScopedChangeStore(r).discardAll(t,e);const n=`ChangeStore.discardAll(${t.toString()}, ${e==null?void 0:e.staged})`;L.log(n);const i=[];await this.lock.synchronizeWrite(te(t),async()=>{const o=await this.getWorkingOperations(t),c=[];let l=[];const d=(e==null?void 0:e.staged)&&!(e.staged==="auto"&&!o.some(p=>p.staged));for(const p of o){if(d&&!p.staged){l.push(p);continue}p.fileType===m.FileType.File&&await this.discardWorkingContent(t,p.uri);let S;switch(p.type){case 2:S=3;break;case 3:S=2;break;default:S=p.type;break}if(i.push({type:S,rootUri:t,uri:p.uri}),p.type===2){let P=p.uri;for(;;){const{parent:I}=this.findNewParentWithOnlyChild(P,o);if(I){c.push(I),P=I.uri;continue}break}}}l.length>0&&c.length>0&&(l=l.filter(p=>c.includes(p)?(i.push({type:3,rootUri:t,uri:p.uri}),!1):!0)),await this.saveWorkingOperations(t,l)},n),i.length!==0&&this._onDidChange.fire(i)}async stage(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=`ChangeStore.stage(${t.toString()})`;L.log(r);const n=[];await this.lock.synchronizeWrite(te(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);i!==void 0&&await this.spliceOperation(t,o,{...i,staged:!0,timestamp:Date.now()},n)},r),n.length!==0&&this._onDidChange.fire(n)}async stageAll(t){const e=`ChangeStore.stageAll(${t.toString()})`;L.log(e);const r=[];await this.lock.synchronizeWrite(te(t),async()=>{const n=(await this.getWorkingOperations(t)).map(i=>({...i,staged:!0,timestamp:Date.now()}));n.length!==0&&(await this.saveWorkingOperations(t,n),r.push(...n.map(i=>pa(i,t))))},e),r.length!==0&&this._onDidChange.fire(r)}async unstage(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=`ChangeStore.unstage(${t.toString()})`;L.log(r);const n=[];await this.lock.synchronizeWrite(te(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);i!==void 0&&await this.spliceOperation(t,o,{...i,staged:!1,timestamp:Date.now()},n)},r),n.length!==0&&this._onDidChange.fire(n)}async unstageAll(t){const e=`ChangeStore.unstageAll(${t.toString()})`;L.log(e);const r=[];await this.lock.synchronizeWrite(te(t),async()=>{const n=(await this.getWorkingOperations(t)).map(i=>({...i,staged:!1,timestamp:Date.now()}));n.length!==0&&(await this.saveWorkingOperations(t,n),r.push(...n.map(i=>pa(i,t))))},e),r.length!==0&&this._onDidChange.fire(r)}async hasChanges(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).hasChanges(t);const r=te(t),n=this.cache.get(r);return n!==void 0?n.length!==0:this.lock.synchronizeRead(r,async()=>(await this.getWorkingOperations(t)).length!==0,`ChangeStore.hasChanges(${t.toString()})`)}maybeHasChanges(t,e){const r=this.getUriScope(t);if(r)return this.getScopedChangeStore(r).maybeHasChanges(t,e);const n=te(t),i=this.cache.get(n);if(i===void 0)return;if(i.length===0)return!1;if(e===void 0)return!0;const o=Ae(e);return i.some(c=>Ae(c.uri)===o)}async hasMergeConflicts(t){return this.lock.synchronizeRead(te(t),async()=>(await this.getWorkingOperations(t)).some(e=>e.conflicts!==void 0),`ChangeStore.hasMergeConflicts(${t.toString()})`)}async hasStagedChanges(t){return this.lock.synchronizeRead(te(t),async()=>(await this.getWorkingOperations(t)).some(e=>e.staged&&e.conflicts===void 0),`ChangeStore.hasStagedChanges(${t.toString()})`)}async hasWorkingChanges(t){return this.lock.synchronizeRead(te(t),async()=>(await this.getWorkingOperations(t)).some(e=>!e.staged&&e.conflicts===void 0),`ChangeStore.hasWorkingChanges(${t.toString()})`)}async getChange(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).getChange(t);const r=this.providerService.getVirtualRootUri(t);if(r!==void 0)return this.lock.synchronizeRead(te(r),async()=>{const{operation:n}=await this.getWorkingOperation(t,r);return n},`ChangeStore.getChange(${t.toString()})`)}async getChanges(t,e){const r=this.getUriScope(t);return r?this.getScopedChangeStore(r).getChanges(t,e):this.lock.synchronizeRead(te(t),async()=>{let n=await this.getWorkingOperations(t);if((e==null?void 0:e.excludeConflicts)||(e==null?void 0:e.predicate)){const{excludeConflicts:i,predicate:o}=e;n=n.filter(c=>{var l;return(!i||c.conflicts===void 0)&&((l=o==null?void 0:o(c))!=null?l:!0)})}return n},`ChangeStore.getChanges(${t.toString()})`)}async getGroupedChanges(t,e){const r=this.getUriScope(t);return r?this.getScopedChangeStore(r).getGroupedChanges(t,e):this.lock.synchronizeRead(te(t),async()=>{var n,i;const o=await this.getWorkingOperations(t),c={conflicts:[],staged:[],working:[]};for(const l of o)!((i=(n=e==null?void 0:e.predicate)==null?void 0:n.call(e,l))!=null?i:!0)||(l.conflicts?c.conflicts.push(l):l.staged?c.staged.push(l):c.working.push(l));return c},`ChangeStore.getChangesByType(${t.toString()})`)}async getContent(t){const e=this.providerService.getVirtualRootUri(t);if(e===void 0)throw new Error(`Unable to find content for ${t.toString()}; Repository not found`);const r=te(e),n=this.cache.get(r);if((n==null?void 0:n.length)===0)throw new Error(`Unable to find content for ${t.toString()}`);return this.lock.synchronizeRead(r,async()=>{const i=ni.decode(await this.getWorkingContent(e,t));if(i!==void 0)return i;throw new Error(`Unable to find content for ${t.toString()}`)},`ChangeStore.getContent(${t.toString()}}`)}async getMergeConflicts(t,e){return this.lock.synchronizeRead(te(t),async()=>(await this.getWorkingOperations(t)).filter(n=>{var i,o;return n.conflicts!==void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getMergeConflicts(${t.toString()})`)}async getStagedChanges(t,e){return this.lock.synchronizeRead(te(t),async()=>(await this.getWorkingOperations(t)).filter(n=>{var i,o;return n.staged&&n.conflicts===void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getStagedChanges(${t.toString()})`)}async getWorkingChanges(t,e){return this.lock.synchronizeRead(te(t),async()=>(await this.getWorkingOperations(t)).filter(n=>{var i,o;return!n.staged&&n.conflicts===void 0&&((o=(i=e==null?void 0:e.predicate)==null?void 0:i.call(e,n))!=null?o:!0)}),`ChangeStore.getWorkingChanges(${t.toString()})`)}async applyChangeset(t,e,r,n){var i;let o;xu(r)?o=r:n=n!=null?n:r,L.log(`ChangeStore.applyChangeset${t.toString()}`,e.workspaceId,e.uri,o==null?void 0:o.uri,n==null?void 0:n.save);const c=this.getScopedChangeStore(e.workspaceId),l=(i=e.patch)!=null?i:await c.createPatch(e.uri,o==null?void 0:o.uri);await this.applyPatchCore(t,l,{...n,getIncomingContent:async d=>{const p=this.getScopedUri(this.providerService.createRelativeVirtualUri(e.uri,d),e.workspaceId);return ni.decode(await m.workspace.fs.readFile(p))},merge:async(d,p,S)=>{try{const P=this.providerService.getProviderUri(d),I=ni.decode(await m.workspace.fs.readFile(P)),O=this.getScopedUri(this.providerService.createRelativeVirtualUri(e.uri,p),e.workspaceId),F=ni.decode(await m.workspace.fs.readFile(O));return{...fr(S,I,F),baseUri:P,incomingUri:O}}catch(P){throw new Error(`Unable to apply patch to ${p}: ${String(P)}`)}}})}async applyPatch(t,e,r){if(L.log(`ChangeStore.applyPatch(${t.toString()})`,r==null?void 0:r.save),!e.startsWith("diff --"))throw new Error("Invalid patch");return this.applyPatchCore(t,e,r)}async applyPatchCore(t,e,r={}){const n=`ChangeStore.applyPatchCore(${t.toString()})`;L.debug(n,r==null?void 0:r.save);const i=new m.WorkspaceEdit,o=[],c=new Map;async function l(I){var O;const F=te(I),N=m.workspace.textDocuments.find(U=>te(U.uri)===F);return(O=N==null?void 0:N.getText())!=null?O:ni.decode(await m.workspace.fs.readFile(I))}a(l,"getContent");async function d(I){try{const O=await m.workspace.fs.stat(I);return Boolean(O)}catch{return!1}}a(d,"exists");async function p(I,O,F){let N=Rr("",F,{fuzzFactor:0});if(N===!1){if(!r.getIncomingContent)throw new Error(`Unable to apply patch to ${O}`);N=await r.getIncomingContent(O)}i.createFile(I,{overwrite:!0}),i.replace(I,new m.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),N)}a(p,"applyCreate");async function S(I,O,F,N){const U=await l(I);let W=Rr(U,F,{fuzzFactor:1});if(W===!1){if(r.merge===void 0)throw new Error(`Unable to apply patch to ${O}; Resulted in conflicts`);const V={title:Pn("apply patch failed prompt confirm","Merge")},ie={title:Pn("apply patch failed prompt cancel","Skip File"),isCloseAffordance:!0};if(await m.window.showWarningMessage(Pn("apply patch failed prompt",`Unable to apply changes to '{0}'.

Do you want to retry by merging the files?`,O),{modal:!0,useCustom:!0},V,ie)!==V)return;const ge=await r.merge(I,O,U);W=ge.mergedContent,ge.conflicts&&c.set(te(I),{type:N,baseUri:ge.baseUri,incomingUri:ge.incomingUri})}i.replace(I,new m.Range(0,0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),W)}a(S,"applyModification");const P=(r==null?void 0:r.reverse)?Or(e,{}):In(e,{});for(const I of P)if(I.oldFileName==="/dev/null"){if(!I.newFileName)continue;const O=I.newFileName.startsWith("b/")?I.newFileName.substr(2):I.newFileName,F=this.providerService.createRelativeVirtualUri(t,O);o.push(te(F)),!await d(F)?await p(F,O,I):await S(F,O,I,2)}else if(I.newFileName==="/dev/null"){if(!I.oldFileName)continue;const O=I.oldFileName.startsWith("a/")?I.oldFileName.substr(2):I.oldFileName,F=this.providerService.createRelativeVirtualUri(t,O);await d(F)&&i.deleteFile(F)}else if(I.oldFileName===I.newFileName){if(!I.newFileName)continue;const O=this.providerService.createRelativeVirtualUri(t,I.newFileName);o.push(te(O)),!await d(O)?await p(O,I.newFileName,I):await S(O,I.newFileName,I,1)}else throw new Error(`Unable to apply patch to ${I.oldFileName}; Renames aren't currently supported`);if(await m.workspace.applyEdit(i),r.save&&o.length)for(const I of o){const O=m.workspace.textDocuments.find(F=>te(F.uri)===I);await(O==null?void 0:O.save())}c.size&&setTimeout(async()=>{const I=[];await this.lock.synchronizeWrite(te(t),async()=>{const O=await this.getWorkingOperations(t);if(O.length===0)return;let F=-1;for(const N of O){F++;const U=c.get(te(N.uri));U!==void 0&&await this.spliceOperation(N.uri,F,{...N,conflicts:{baseUri:U.baseUri,incomingUri:U.incomingUri,status:[N.type,U.type]},timestamp:Date.now()},I)}},n),I.length!==0&&this._onDidChange.fire(I)},0)}async createChangeset(t){L.log(`ChangeStore.createChangeset${t.toString()})`);const e=await this.createPatch(t);return e?{workspaceId:this.workspaceId,uri:t,patch:e}:void 0}async createPatch(t,e,r){if(L.log(`ChangeStore.createPatch${t.toString()})`,e),e===void 0){let o=await this.getWorkingOperations(t);if((r==null?void 0:r.staged)&&(o=o.filter(l=>l.staged)),o.length===0)return"";const c=[];for(const l of o){const d=await this.createPatchCore(t,l);c.push(d)}return c.join("")}const{operation:n}=await this.getWorkingOperation(e,t);if(n===void 0)throw new Error(`Unable to create patch for ${e.toString()}`);return(r==null?void 0:r.staged)&&n.staged?"":await this.createPatchCore(t,n)}async createPatchCore(t,e){const r=this.providerService.getRelativeFilePath(t,e.uri),n=`diff --git a/${r} b/${r}`;if(e.type===2){let d=await this.getContent(e.uri),p;!d.endsWith(`
`)&&!d.endsWith(`\r
`)?p=`
\\ No newline at end of file`:p="";let S=0;return d=d.replace(/\r?\n/g,P=>(S++,`${P}+`)),`${n}
new file mode 100644
--- /dev/null
+++ b/${r}
@@ -0,0 +1,${S} @@
+${d}${p}`}if(e.type===3){let d=ni.decode(await m.workspace.fs.readFile(this.providerService.getProviderUri(e.uri))),p=0;return d=d.replace(/\r?\n/g,S=>(p++,`${S}-`)),`${n}
deleted file mode 100644
--- a/${r}
+++ /dev/null
@@ -1,${p} +0,0 @@
-${d}`}const i=await this.getContent(e.uri),o=ni.decode(await m.workspace.fs.readFile(this.providerService.getProviderUri(e.uri))),c=Co(r,o,i),l=c.indexOf(yl);return`${n}
${c.substr(l+yl.length)}`}async keep(t,e){const r=this.providerService.getVirtualWorkspaceUri(t);if(r===void 0)return;const n=`ChangeStore.keep(${t.toString()})`;L.log(n,e);const i=[];await this.lock.synchronizeWrite(te(r),async()=>{const{operation:o,index:c}=await this.getWorkingOperation(t,r);if(o===void 0)return;if(e===void 0&&o.conflicts){const[,d]=o.conflicts.status;switch(d){case 1:switch(o.type){case 1:case 2:case 3:await this.spliceOperation(t,c,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break;case 2:switch(o.type){case 1:case 3:await this.spliceOperation(t,c,{...o,conflicts:void 0,timestamp:Date.now()},i);break;case 2:await this.spliceOperation(t,c,{...o,type:1,size:o.size,hash:o.hash,originalHash:o.originalHash,conflicts:void 0,timestamp:Date.now()},i);break}break;case 3:switch(o.type){case 3:await this.discardCore(r,t,i);break;case 1:await this.spliceOperation(t,c,{...o,type:2,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);break;case 2:await this.spliceOperation(t,c,{...o,conflicts:void 0,timestamp:Date.now()},i);break}break}return}if(e===void 0)return;switch(e.type){case 1:switch(o.type){case 3:await this.spliceOperation(t,c,{...o,type:3,size:void 0,hash:void 0,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case 2:break;case 1:break}break;case 2:switch(o.type){case 1:case 3:return;case 2:break}break;case 3:switch(o.type){case 3:return this.discardCore(r,t,i);case 1:await this.spliceOperation(t,c,{...o,type:2,originalHash:void 0,conflicts:void 0,timestamp:Date.now()},i);return;case 2:return}}const l=e!==void 0?await m.workspace.fs.readFile(e.providerUri):void 0;await this.spliceOperation(t,c,{...o,type:1,originalHash:l!==void 0?await ri(l):o.originalHash,conflicts:void 0,timestamp:Date.now()},i)},n),i.length!==0&&this._onDidChange.fire(i)}async merge(t,e,r){const n=this.providerService.getVirtualWorkspaceUri(t);if(n===void 0)return;const i=`ChangeStore.merge(${t.toString()})`;L.log(i,e,r);const o=[];await this.lock.synchronizeWrite(te(n),async()=>{const{operation:c,index:l}=await this.getWorkingOperation(t,n);if(c===void 0)return;switch(e.type){case 1:switch(c.type){case 3:return void this.spliceOperation(t,l,{...c,type:3,size:void 0,hash:void 0,originalHash:void 0,conflicts:{baseUri:r.providerUri,incomingUri:e.providerUri,status:[c.type,e.type]},timestamp:Date.now()},o);case 2:break;case 1:break}break;case 2:switch(c.type){case 3:case 1:return;case 2:break}break;case 3:switch(c.type){case 3:return this.discardCore(n,t,o);case 1:return void this.spliceOperation(t,l,{...c,type:2,originalHash:void 0,conflicts:{baseUri:void 0,incomingUri:e.providerUri,status:[c.type,e.type]},timestamp:Date.now()},o);case 2:return}}const d=await this.getWorkingContent(n,t),p=await m.workspace.fs.readFile(r.providerUri),S=await m.workspace.fs.readFile(e.providerUri),P=fr(ni.decode(d),ni.decode(p),ni.decode(S));await this.writeFileCore(n,t,o,Eu.encode(P.mergedContent),S!=null?S:new Uint8Array(0),P.conflicts?{baseUri:r.providerUri,incomingUri:e.providerUri,status:[c.type,e.type]}:void 0)},i),o.length!==0&&this._onDidChange.fire(o)}async resolveDiffCommand(t,e,r,n){let i;const o=this.providerService.getVirtualRootUri(t);return o!==void 0&&({operation:i}=await this.getWorkingOperation(t,o)),(i==null?void 0:i.type)===3?this.resolveOpenCommand(e):((i==null?void 0:i.type)===2&&(e=e.with({query:"~"})),{command:"vscode.diff",title:"Open Changes",arguments:[e,t,r,n]})}resolveOpenCommand(t,e){return{command:"vscode.open",title:"Open File",arguments:[t,e]}}getScopedUri(t,e){const r=typeof e=="string"?e:e.workspaceId;return r===this.workspaceId?t:t.with({fragment:r})}getUriScope(t){return t.fragment||void 0}getScopedChangeStore(t){const e=typeof t=="string"?t:t.workspaceId;L.log(`ChangeStore.getScopedChangeStore(${e})`);let r=this.scopedStores.get(e);return r===void 0&&(r=e===this.workspaceId?new ko.ScopedChangeStore(this,e,this.workspaceId):new ko.ScopedChangeStore(new ko(this.providerService,this.storageService.with(e),this.fileStorageService.with(e),this.telemetryService,this.workspaceId,e),e,this.workspaceId),this.scopedStores.set(e,r)),r}async stat(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).stat(t);const r=this.providerService.getVirtualRootUri(t);if(r===void 0)return;const n=te(r),i=this.cache.get(n);if((i==null?void 0:i.length)!==0)return this.lock.synchronizeRead(n,async()=>{var o;const{operation:c}=await this.getWorkingOperation(t,r);if(c!==void 0){if(c.type===3)throw m.FileSystemError.FileNotFound(`The ${c.fileType===m.FileType.Directory?"folder":"file"} has been deleted.`);return{type:c.fileType,size:(o=c.size)!=null?o:0,ctime:0,mtime:c.timestamp}}},`ChangeStore.stat(${t.toString()}`)}async readFile(t){const e=this.getUriScope(t);if(e)return this.getScopedChangeStore(e).readFile(t);const r=new lt(`ChangeStore.readFile(${t.toString()})`);try{const n=this.providerService.getVirtualRootUri(t);if(n===void 0)return;const i=te(n),o=this.cache.get(i);return(o==null?void 0:o.length)===0?void 0:await this.lock.synchronizeRead(i,()=>{const c=this.cache.get(i);if((c==null?void 0:c.length)===0){r.log({message:": Not found; no operations"});return}return this.getWorkingContent(n,t)},r.context)}finally{r.stop()}}async createDirectory(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=new lt(`ChangeStore.createDirectory(${t.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(te(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e),c=await this.providerService.getMetadata(t);await this.spliceOperation(t,o,i===void 0?{type:2,uri:t,fileType:m.FileType.Directory,revision:c.HEAD.sha,timestamp:Date.now(),size:0,hash:"",originalHash:void 0}:{...i,timestamp:Date.now()},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}async deleteDirectory(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=new lt(`ChangeStore.deleteDirectory(${t.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(te(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if((i==null?void 0:i.type)===2)return this.discardCore(e,t,n);const c=await this.providerService.getMetadata(t);await this.spliceOperation(t,o,{type:3,uri:t,fileType:m.FileType.Directory,revision:c.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}async updateDirectoryEntries(t,e){const r=this.providerService.getVirtualWorkspaceUri(t);if(r===void 0)return e;const n=new lt(`ChangeStore.updateDirectoryEntries(${t.toString()})`,{},e.length);try{const i=te(r),o=this.cache.get(i);return(o==null?void 0:o.length)===0?e:await this.lock.synchronizeRead(i,async()=>{const{path:c}=We(r,t),l=await this.getWorkingOperations(r);for(const d of l)switch(d.type){case 1:break;case 2:{if(Je(d.uri,c)){const p=this.providerService.getRelativeFilePath(t,d.uri);e.push([p,d.fileType])}break}case 3:{if(Je(d.uri,c)){const p=this.providerService.getRelativeFilePath(t,d.uri),S=e.findIndex(([P])=>P===p);S!==-1&&e.splice(S,1)}break}}return e},n.context)}finally{n.stop()}}async writeFile(t,e,r,n){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=new lt(`ChangeStore.writeFile(${t.toString()})`,{},e.length,n);try{const c=[];if(await this.lock.synchronizeWrite(te(i),async()=>this.writeFileCore(i,t,c,e,r,n),o.context),c.length===0)return;this._onDidChange.fire(c)}finally{o.stop()}}async writeFileCore(t,e,r,n,i,o){const c=new lt(`ChangeStore.writeFileCore(${e.toString()})`,{},n.length,o);try{const[{operation:l,index:d},p,S]=await Promise.all([this.getWorkingOperation(e,t),ri(n),ri(i)]);if(p===S&&(l==null?void 0:l.type)===1)return this.discardCore(t,e,r);if(p===(l==null?void 0:l.hash)&&S===(l==null?void 0:l.originalHash))return;const[{HEAD:P}]=await Promise.all([this.providerService.getMetadata(e),this.saveWorkingContent(t,e,n)]);await this.spliceOperation(e,d,l===void 0?{type:1,uri:e,fileType:m.FileType.File,revision:P.sha,timestamp:Date.now(),size:n.byteLength,hash:p,originalHash:S,conflicts:o,staged:!1}:{...l,revision:P.sha,timestamp:Date.now(),size:n.byteLength,hash:p,originalHash:S,conflicts:o,staged:!1},r)}finally{c.stop()}}async createFile(t,e){const r=this.providerService.getVirtualWorkspaceUri(t);if(r===void 0)return;const n=new lt(`ChangeStore.createFile(${t.toString()})`,{},e.length);try{const i=[];if(await this.lock.synchronizeWrite(te(r),async()=>{const[{operation:o,index:c},l,d]=await Promise.all([this.getWorkingOperation(t,r),ri(e),this.providerService.getMetadata(t),this.saveWorkingContent(r,t,e)]);await this.spliceOperation(t,c,o===void 0?{type:2,uri:t,fileType:m.FileType.File,revision:d.HEAD.sha,timestamp:Date.now(),size:e.byteLength,hash:l,originalHash:l}:{...o,type:2,revision:d.HEAD.sha,timestamp:Date.now(),size:e.byteLength,hash:l},i)},n.context),i.length===0)return;this._onDidChange.fire(i)}finally{n.stop()}}async deleteFile(t){const e=this.providerService.getVirtualWorkspaceUri(t);if(e===void 0)return;const r=new lt(`ChangeStore.deleteFile(${t.toString()})`);try{const n=[];if(await this.lock.synchronizeWrite(te(e),async()=>{const{operation:i,index:o}=await this.getWorkingOperation(t,e);if((i==null?void 0:i.type)===2)return this.discardCore(e,t,n);const[c]=await Promise.all([this.providerService.getMetadata(t),this.discardWorkingContent(e,t)]);await this.spliceOperation(t,o,{type:3,uri:t,fileType:m.FileType.File,revision:c.HEAD.sha,timestamp:Date.now(),size:void 0,hash:void 0,originalHash:void 0},n)},r.context),n.length===0)return;this._onDidChange.fire(n)}finally{r.stop()}}findParent(t,e,r){const n=Fe(t),{operation:i,index:o}=this.findWorkingOperation(n,e);return i!==void 0&&r(i,e)?{parent:i,parentIndex:o}:{parent:void 0,parentIndex:-1}}findNewParentWithOnlyChild(t,e){const r=Ae(t);return this.findParent(t,e,(n,i)=>n.type===2&&!i.some(o=>Je(o.uri,n.uri)&&Ae(o.uri)!==r))}async getWorkingOperation(t,e){return this.findWorkingOperation(t,await this.getWorkingOperations(e))}findWorkingOperation(t,e){if(e.length===0)return{operation:void 0,index:-1};const r=Ae(t);let n=-1;const i=e.find((o,c)=>Ae(o.uri)!==r?!1:(n=c,!0));return i===void 0?{operation:void 0,index:-1}:{operation:i,index:n}}async getWorkingOperations(t){const e=te(t);let r=this.cache.get(e);return r===void 0&&(r=this.fromStorage(await this.storageService.get(this.getOperationsStorageKey(e))),this.cache.set(e,r)),r}async saveWorkingOperations(t,e){L.debug(`ChangeStore.saveWorkingOperations(${t.toString()})`,e.length);const r=te(t);this.cache.set(r,e);try{await this.storageService.store(this.getOperationsStorageKey(r),this.toStorage(e))}catch(n){throw this.cache.delete(r),L.error(n,`Failed to save repository changes for ${r}`),n}}getOperationsStorageKey(t){return`operations/${t}`}async getWorkingContent(t,e){try{return await this.fileStorageService.get(this.getFileStorageKey(t,e))}catch(r){throw L.error(r),this.telemetryService.sendException(r),r}}async discardWorkingContent(t,e){L.debug(`ChangeStore.discardWorkingContent(${e.toString()})`);try{return await this.fileStorageService.delete(this.getFileStorageKey(t,e))}catch(r){if(r instanceof m.FileSystemError&&r.code===Su)return;throw L.error(r),this.telemetryService.sendException(r),r}}async saveWorkingContent(t,e,r){L.debug(`ChangeStore.saveWorkingContent(${e.toString()})`,r.length);try{return await this.fileStorageService.store(this.getFileStorageKey(t,e),r)}catch(n){throw L.error(n),this.telemetryService.sendException(n),n}}getFileStorageKey(t,e){return`changestore/${le(e)}`}async spliceOperation(t,e,r,n){const i=this.providerService.getVirtualWorkspaceUri(t);if(i===void 0)return;const o=await this.getWorkingOperations(i);e!==-1?o.splice(e,1,r):o.push(r),await this.saveWorkingOperations(i,o),n.push(pa(r,i,t))}fromStorage(t){if(!t)return[];try{const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&Ue(n)?typeof n=="string"?m.Uri.parse(n):m.Uri.from(n):n);return Array.isArray(e)?e:e.operations}catch(e){throw L.error(e,"Failed to deserialize ChangeStore operations"),e}}toStorage(t){const e={schemaVersion:ko.operationsStorageSchemaVersion,operations:t};return JSON.stringify(e)}},"_ChangeStore");let ga=ko;ga.operationsStorageSchemaVersion=1,ga.ScopedChangeStore=class{constructor(t,e,r){this.changeStore=t,this.scope=e,this.workspaceId=r}createPatch(t,e,r){return this.changeStore.createPatch(this.stripUriScope(t),this.stripUriScope(e),r)}discardAll(t,e){return this.changeStore.discardAll(this.stripUriScope(t),e)}getChange(t){return this.changeStore.getChange(this.stripUriScope(t))}getChanges(t,e){return this.changeStore.getChanges(this.stripUriScope(t),e)}async getGroupedChanges(t,e){return this.changeStore.getGroupedChanges(this.stripUriScope(t),e)}hasChanges(t){return this.changeStore.hasChanges(this.stripUriScope(t))}maybeHasChanges(t,e){return this.changeStore.maybeHasChanges(this.stripUriScope(t),this.stripUriScope(e))}async stat(t){const r=this.changeStore.getUriScope(t)!==this.workspaceId,n=await this.changeStore.stat(this.stripUriScope(t));return n!==void 0&&r&&(n.permissions=m.FilePermission.Readonly),n}readFile(t){return this.changeStore.readFile(this.stripUriScope(t))}resolveDiffCommand(t,e,r,n){return this.changeStore.resolveDiffCommand(this.changeStore.getScopedUri(t,this.scope),this.changeStore.getScopedUri(e,this.scope),r,n)}stripUriScope(t){return t===void 0||!t.fragment?t:t.with({fragment:""})}},bu([nr()],ga.prototype,"getWorkingOperations",1);function _l(t){switch(t){case 1:return Pn("change type changed","Modified");case 2:return Pn("change type created","Added");case 3:return Pn("change type deleted","Deleted")}}a(_l,"getStatusText");function Cu(t){const[e,r]=t;switch(e){case 1:switch(r){case 1:case 2:return Pn("conflict status changed both","Modified by Both");case 3:return Pn("conflict status deleted them","Deleted by Incoming")}break;case 2:switch(r){case 1:case 2:return Pn("conflict status created both","Added by Both");case 3:return Pn("conflict status deleted them","Deleted by Incoming")}break;case 3:switch(r){case 1:case 2:return Pn("conflict status deleted us","Deleted by Current");case 3:return Pn("conflict status deleted both","Deleted by Both")}break}}a(Cu,"getConflictStatusText");class uc extends Error{constructor(e){super(e);Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="Deprecation"}}a(uc,"Deprecation");var Tu=__webpack_require__(778),wl=__webpack_require__.n(Tu);const Au=wl()(t=>console.warn(t)),Ru=wl()(t=>console.warn(t));class jn extends Error{constructor(e,r,n){super(e);Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name="HttpError",this.status=r;let i;"headers"in n&&typeof n.headers!="undefined"&&(i=n.headers),"response"in n&&(this.response=n.response,i=n.response.headers);const o=Object.assign({},n.request);n.request.headers.authorization&&(o.headers=Object.assign({},n.request.headers,{authorization:n.request.headers.authorization.replace(/ .*$/," [REDACTED]")})),o.url=o.url.replace(/\bclient_secret=\w+/g,"client_secret=[REDACTED]").replace(/\baccess_token=\w+/g,"access_token=[REDACTED]"),this.request=o,Object.defineProperty(this,"code",{get(){return Au(new uc("[@octokit/request-error] `error.code` is deprecated, use `error.status`.")),r}}),Object.defineProperty(this,"headers",{get(){return Ru(new uc("[@octokit/request-error] `error.headers` is deprecated, use `error.response.headers`.")),i||{}}})}}a(jn,"RequestError");var Iu=__webpack_require__(8361),Ou=__webpack_require__.n(Iu);const Pu="Type of classified event does not match event properties",dc=a(class{constructor(t){this.sharedProperties={},dc._instance=this,this.reporter=new(Ou())(t.extension.id,t.extension.packageJSON.version,dc.aiKey,!0)}static get instance(){return this._instance}dispose(){this.reporter.dispose()}publicLog2(t,e){e!==Pu&&this.reporter.sendTelemetryEvent(t,{...this.sharedProperties,...e})}sendEvent(t,e,r){this.reporter.sendTelemetryEvent(t,{...this.sharedProperties,...e},r)}sendErrorEvent(t,e,r){this.reporter.sendTelemetryErrorEvent(t,{...this.sharedProperties,...e},r)}sendException(t,e,r){this.reporter.sendTelemetryException(t,{...this.sharedProperties,...e},r)}setSharedProperty(t,e){this.sharedProperties[t]=e}},"_TelemetryService");let ma=dc;ma.aiKey="AIF-d9b70cd4-b9f9-4d70-929b-a071c400b217";function pn(t,e){m.env.appHost==="github.dev"&&(L.debug(`Executing ${t}`),e={...e,errorDetail:e.errorDetail instanceof jn?e.errorDetail.status:void 0},m.commands.executeCommand(t,e).then(r=>{},r=>{L.debug(`Failed to execute ${t}`,r)}))}a(pn,"reportWorkbenchLoadResult");function bl(t,e){if(t===e)return-1;let r=0;for(;t[r]===e[r];)r++;return r}a(bl,"indexOfDifference");const va=(0,B.loadMessageBundle)();let qn;var ya;(function(t){function e(r){const n=Nu(r);return qn=m.env.uiKind===m.UIKind.Web,L.warn(`Running on the ${qn?"web":"desktop"}${r.extensionRuntime!==m.ExtensionRuntime.Node?" in a webworker":""}; workspaceId=${n}; storageUri=${r.globalStorageUri.toString(!0)}`),n}a(e,"configure"),t.configure=e})(ya||(ya={}));function Du(){var t,e;return(e=(t=m.workspace.workspaceFolders)==null?void 0:t.every(r=>r.uri.scheme===Xt.scheme))!=null?e:!1}a(Du,"isVirtualWorkspace");var tr;(function(t){t.CurrentWindow="currentWindow",t.NewWindow="newWindow",t.AddToWorkspace="addToWorkspace"})(tr||(tr={}));const ku=/\/workspaceStorage\/(?<id>[^/]+)/i;function Nu(t){var e;if(t.storageUri===void 0)return"";const r=ku.exec(t.storageUri.path);let n;if((e=r==null?void 0:r.groups)==null?void 0:e.id)n=r.groups.id;else{n=t.storageUri.path;const i=bl(t.globalStorageUri.path,n),o=`/${t.extension.id}`;n.endsWith(o)?n=n.slice(i,-o.length):n=n.substr(i)}return/-[0-9]$/.test(n)?n.slice(0,-2):n}a(Nu,"getWorkspaceId");async function bn(t,e){var r,n,i,o,c;if(ma.instance.sendEvent("openWorkspace",{location:t.location}),t.location===tr.AddToWorkspace){const d=(n=(r=m.workspace.workspaceFolders)==null?void 0:r.length)!=null?n:0;return void m.workspace.updateWorkspaceFolders(d,0,{uri:t.uri,name:t.name})}if(t.location===tr.CurrentWindow&&!(e==null?void 0:e.skipChangesPrompt)){const d=await ga.instance.getWorkspaceProvidersWithChanges();if(d.length){const p={title:va("continue","Continue")},S={title:va("cancel","Cancel"),isCloseAffordance:!0};if(await m.window.showWarningMessage(qn?va("open folder uncommitted changes web",`You have uncommitted changes.

If you want to see your changes on {0} or from other browsers or machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,d.map(I=>I.name).join(", ")):va("open folder uncommitted changes",`You have uncommitted changes.

If you want to see your changes on {0} or from other machines, commit them before leaving this workspace. Otherwise, you can re-open this workspace anytime and pick up right where you left off.

Do you want to continue opening a new workspace?`,d.map(I=>I.name).join(", ")),{modal:!0,useCustom:!0},p,S)!==p){ma.instance.sendEvent("openWorkspace.abort",{reason:"abandoned uncommitted changes prompt"});return}}}const l=m.env.remoteName?!0:void 0;return t.filesToOpen&&(t.location===tr.CurrentWindow&&l===void 0&&((i=m.workspace.workspaceFolders)==null?void 0:i.length)===1&&m.workspace.workspaceFolders[0].uri.toString()===t.uri.toString()?await((o=_u())==null?void 0:o.openPendingFiles(t.uri,t.filesToOpen)):await((c=_u())==null?void 0:c.setPendingFilesToOpen(t.uri,t.filesToOpen))),ma.instance.sendEvent("openWorkspace.success",{location:t.location,forceLocalWindow:String(l)}),void m.commands.executeCommand("vscode.openFolder",t.uri,{forceNewWindow:t.location===tr.NewWindow,forceLocalWindow:l})}a(bn,"openWorkspace");var ii;(function(t){t.HasVirtualFolders="remoteHub:hasVirtualFolders",t.HasSearchIndexes="remoteHub:hasSearchIndexes",t.EnabledSomeSearchIndexes="remoteHub:enabledSomeSearchIndexes",t.EnabledAllSearchIndexes="remoteHub:enabledAllSearchIndexes",t.VirtualFolderProviders="remoteHub:virtualFolderProviders",t.HasPullRequestExtension="remoteHub:hasPullRequestExtension",t.HasWriteableScmProvider="remoteHub:hasWriteableScmProvider",t.HasRecentRepositories="remoteHub:hasRecentRepositories"})(ii||(ii={}));const hc=new Map;function No(t){return t==="isWeb"?qn:t==="remoteName"?m.env.remoteName:t==="virtualWorkspace"?Du():t.startsWith("config.")?Y.getAny(t.substr(7)):hc.get(t)}a(No,"getContext");function Mo(t){return t==="isWeb"||t==="remoteName"||t==="virtualWorkspace"||t.startsWith("config.")||t.startsWith("remoteHub:")||t.startsWith("continueOn:")}a(Mo,"isSupportedContextKey");async function oi(t,e){hc.set(t,e),!t.startsWith("continueOn:")&&await m.commands.executeCommand("setContext",t,e)}a(oi,"setContext");class Sl{constructor(e){this.menuItem=e}get label(){return`${this.menuItem.icon?`${this.menuItem.icon} `:""}${this.menuItem.title}`}get description(){return this.menuItem.extension.builtin?"Built-in":this.menuItem.extension.name||this.menuItem.extension.id}async execute(e){return void await m.commands.executeCommand(this.menuItem.command,e)}}a(Sl,"ContinueOnCommandQuickPickItem");var fc;(function(t){async function e(r,n,i){const o=Mu(r).map(d=>new Sl(d)),c=m.window.createQuickPick(),l=[];try{return await new Promise(p=>{l.push(c.onDidHide(()=>p(void 0)),c.onDidAccept(()=>{if(c.activeItems.length!==0){const[S]=c.activeItems;p(S)}})),c.title=i,c.placeholder=n,c.items=o,c.show()})}finally{c.dispose(),l.forEach(d=>void d.dispose())}}a(e,"show"),t.show=e})(fc||(fc={}));function Mu(t){var e,r,n,i,o;const c=new Map,[,l]=t.split(".");for(const p of m.extensions.all){const{name:S,displayName:P,contributes:I}=p.packageJSON;if(!I)continue;const O=(r=(e=I.virtualWorkspaces)==null?void 0:e.menus)==null?void 0:r.continueOn;if(O==null?void 0:O.length){const F=new Map(((n=I.commands)!=null?n:[]).map(N=>[N.command,N]));for(const N of O){if(!N.command)continue;if(c.has(N.command)){L.warn(`Duplicate 'continueOn' menu command: ${N.command}`);continue}const U=F.get(N.command);if(!U){L.warn(`Unable to find 'continueOn' menu command: ${N.command}`);continue}if(!Lu(N.when))continue;const W=(o=(i=N.group)==null?void 0:i.lastIndexOf("@"))!=null?o:-1;c.set(N.command,{extension:{id:S,name:P,builtin:S===l},command:U.command,title:U.title,icon:typeof U.icon=="string"?U.icon:void 0,group:W>0?N.group.substr(0,W):N.group,order:W>0?Number(N.group.substr(W+1)):0,category:U.category})}}}function d(p,S){const P=p.group,I=S.group;if(P!==I){if(!P)return 1;if(!I||P==="navigation")return-1;if(I==="navigation")return 1;const O=P.localeCompare(I);if(O!==0)return O}return p.order<S.order?-1:p.order>S.order?1:p.title.localeCompare(S.title)}return a(d,"compareMenuItems"),[...c.values()].sort(d)}a(Mu,"getContinueOnContributions");function Lu(t){return t?t.split("&&").every(e=>{const r=/^(?:(!)?(\S+)|(\S+)\s?(==|!=|=~)\s?(\S+))$/.exec(e.trim());if(!r)return!0;const[,n,i,o,c,l]=r;if(i){if(i==="false")return!1;if(!Mo(i))return!0;const d=No(i);return n?!d:d}if(o&&c&&l)switch(c){case"==":return!Mo(o)||!Mo(l)||No(o)==No(l);case"!=":return!Mo(o)||!Mo(l)||No(o)!=No(l);case"=~":{if(!Mo(o))return!0;const d=No(o);try{return new RegExp(l.slice(1,-1)).test(String(d!=null?d:""))}catch{return!1}}}return!0}):!0}a(Lu,"evaluateWhenClause");class ds{constructor(e){this.defaultDelay=e}dispose(){this.cancelTimeout()}debounce(e,r=this.defaultDelay){return this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((n,i)=>{this.resolver=n,this.rejecter=i}).then(()=>{if(this.completionPromise=void 0,this.resolver=void 0,this.task){const n=this.task;return this.task=void 0,n()}})),this.timeout=setTimeout(()=>{var n;this.timeout=void 0,(n=this.resolver)==null||n.call(this,void 0)},r),this.completionPromise}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.rejecter)==null||e.call(this,new Error("Canceled")),this.completionPromise=void 0)}cancelTimeout(){this.timeout!==void 0&&(clearTimeout(this.timeout),this.timeout=void 0)}}a(ds,"TaskDebouncer");const Li=(0,B.loadMessageBundle)(),pc=Symbol("QuickPickGoBack");var $i;(function(t){async function e(r,n,i,o,c,l){const d=r.getRemoteWorkspaceSourceProviders();let p=[];d.length===0?p=[]:p=d.map(F=>new gc(F));const S=await n.getRemoteWorkspaceSourceProvider();if(S){const F=await S.provideSources();F&&p.push(...F.filter(N=>Y.get("azureRepos.enabled")?!0:N.providerId==="github").map(N=>({label:`${N.icon?`${N.icon} `:""}${N.name}`,description:N.description,detail:N.detail,url:N.url,workspace:N.url?void 0:N.workspace,buttons:[zn.OpenInNewWindow]})))}const P=m.window.createQuickPick();P.ignoreFocusOut=!0;const I=[];let O=i;try{for(;;){const F=await new Promise(N=>{I.push(P.onDidHide(()=>N(void 0)),P.onDidChangeValue(U=>{U=U.trim(),U.length===0?P.items=p:P.activeItems.length===0||P.activeItems[0]instanceof Lo?P.items=[new Lo(r,U),...p]:P.items=p}),P.onDidAccept(()=>{if(P.activeItems.length!==0){const[U]=P.activeItems;(!(U instanceof Lo)||U.validate())&&N(U)}}),P.onDidChangeActive(()=>{if(O!==void 0||!(l==null?void 0:l.allowAddToWorkspace))return;const[U]=P.activeItems;let W=!0;if(U===void 0?W=Boolean(P.value):W=U instanceof Lo,W){if(P.buttons.length===1)return;P.buttons=[zn.AddToWorkspace]}else{if(P.buttons.length===0)return;P.buttons=[]}}),P.onDidTriggerButton(U=>{if(U===zn.AddToWorkspace){const[W]=P.activeItems;if(!(W instanceof Lo))return;W.validate()&&(O=tr.AddToWorkspace,N(W))}}),P.onDidTriggerItemButton(U=>{switch(U.button){case zn.OpenInNewWindow:O=tr.NewWindow,N(U.item);break;default:break}})),P.title=c,P.placeholder=o,P.matchOnDescription=!0,P.items=p,P.sortByLabel=!1,P.show()});if(F instanceof gc){const N=await F.show(O,F.placeholder,c,l);if(N===pc)continue;return N}return[F,O]}}finally{P.dispose(),I.forEach(F=>void F.dispose())}}a(e,"show"),t.show=e})($i||($i={}));class gc{constructor(e){this.provider=e}get label(){return`${this.provider.icon?`${this.provider.icon} `:""}${this.provider.label}`}get placeholder(){return this.provider.placeholder}async show(e,r,n,i){const o=m.window.createQuickPick(),c=new ds(500),l=[c];async function d(U,W,V,ie,oe){const ge=await U.provideSources(W,V,ie,oe);return ge==null?void 0:ge.map(ke=>({label:`${ke.icon?`${ke.icon} `:""}${ke.name}`,description:ke.description,detail:ke.detail,url:ke.url,workspace:ke.workspace,buttons:[zn.OpenInNewWindow]}))}a(d,"getItems");async function p(U){var W;O=void 0;const V=o.activeItems;o.items=(W=U!=null?U:await N)!=null?W:[],I&&V.length!==0&&(o.activeItems=o.items.filter(ie=>V.some(oe=>oe.url===ie.url))),o.busy=!1}a(p,"setItems");let S,P;if(this.provider.provideOrganization&&this.provider.provideProject){if(S=await this.provider.provideOrganization(),!S)return[void 0,void 0];if(P=await this.provider.provideProject(S),!P)return[void 0,void 0]}let I=!1,O,F=e;const N=d(this.provider,S,P,void 0,{sort:"updated"});try{const U=await new Promise(W=>{l.push(o.onDidHide(()=>W(void 0)),o.onDidChangeValue(V=>{I=!1,V=V.trim(),o.busy=!0;const ie=c.debounce(V?()=>d(this.provider,S,P,V,{sort:"stars"}):()=>N);O===void 0&&(O=ie.then(oe=>p(oe)))}),o.onDidAccept(()=>{if(o.activeItems.length!==0){const[V]=o.activeItems;W(V)}}),o.onDidChangeActive(()=>{if(I=o.activeItems.length!==0,F!==void 0||!(i==null?void 0:i.allowAddToWorkspace))return;const[V]=o.activeItems;if(V===void 0){if(o.buttons.length===1)return;o.buttons=[m.QuickInputButtons.Back]}else{if(o.buttons.length===2)return;o.buttons=[m.QuickInputButtons.Back,zn.AddToWorkspace]}}),o.onDidTriggerButton(V=>{if(V===m.QuickInputButtons.Back){W(pc);return}if(V===zn.AddToWorkspace){const[ie]=o.activeItems;if(ie===void 0)return;F=tr.AddToWorkspace,W(ie)}}),o.onDidTriggerItemButton(V=>{switch(V.button){case zn.OpenInNewWindow:F=tr.NewWindow,W(V.item);break;default:break}})),o.title=n,o.placeholder=r,o.matchOnDetail=!0,o.ignoreFocusOut=!0,o.sortByLabel=!1,o.buttons=[m.QuickInputButtons.Back],o.busy=!0,o.show(),O=c.debounce(()=>N,0).then(V=>p(V))});return U===pc?U:[U,F]}finally{o.dispose(),l.forEach(U=>void U.dispose())}}}a(gc,"RemoteSourceProviderPickerItem");class Lo{constructor(e,r){this.url=r,this.alwaysShow=!0,this.canOpenResult=e.canOpenRemoteUrl(r)}get buttons(){return[zn.OpenInNewWindow]}get label(){if(this.canOpenResult){const{provider:e,urlType:r}=this.canOpenResult;switch(r){case st.Branch:return Li("remote url picker open branch","Open Branch from {0} Repository",e.name);case st.Commit:return Li("remote url picker open commit","Open Commit from {0} Repository",e.name);case st.File:return Li("remote url picker open file","Open File from {0} Repository",e.name);case st.PullRequest:return Li("remote url picker open pull request","Open Pull Request from {0} Repository",e.name);default:return Li("remote url picker open repository","Open {0} Repository",e.name)}}return Li("remote url picker open unknown","Enter a Remote Url")}get description(){return this.url}validate(){return this.canOpenResult!==void 0}}a(Lo,"RemoteUrlQuickPickItem");var zn;(function(t){t.AddToWorkspace={iconPath:new m.ThemeIcon("plus"),tooltip:Li("remote url picker button add to workspace","Add to Workspace")},t.OpenInNewWindow={iconPath:new m.ThemeIcon("empty-window"),tooltip:Li("remote picker open in new window","Open in New Window")}})(zn||(zn={}));var $u=Object.defineProperty,Fu=Object.getOwnPropertyDescriptor,Qr=a((t,e,r,n)=>{for(var i=n>1?void 0:n?Fu(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&$u(e,r,i),i},"messages_decorateClass");const mr=(0,B.loadMessageBundle)();class Wn{showGitHubStatus500Message(){return m.window.showErrorMessage(mr("github 500 error notification","GitHub failed to respond and might be experiencing issues. Visit the [GitHub status page](https://githubstatus.com) for more information."),mr("ok","OK")),Promise.resolve()}async showStatus401Message(e){if(!e)return void m.window.showErrorMessage(mr("401 error notification","The provided credentials are either invalid or expired."),mr("ok","OK"));const r=mr("401 error notification confirm","Reauthenticate");await m.window.showErrorMessage(mr("401 error notification with reauth","The provided credentials are either invalid or expired. Would you like to reauthenticate?"),r)===r&&e()}async showStatus403Message(e){if(!e)return void m.window.showErrorMessage(mr("403 error notification","The provided credentials do not have the required access."),mr("ok","OK"));const r=mr("403 error notification confirm","Reauthenticate");await m.window.showErrorMessage(mr("403 error notification with reauth","The provided credentials do not have the required access. Would you like to reauthenticate to grant additional access?"),r)===r&&e()}async showRepositoryEmptyMessage(e){const r=mr("repository empty open","Open Repository");await m.window.showErrorMessage(mr("repository empty","Repository '{0}' is empty and cannot be opened. Would you like to open another repository?",e),r)===r&&m.commands.executeCommand("remoteHub.openRepository")}async showPullRequestNotFoundMessage(e,r){const n=mr("pull request not found open","Open Pull Request");await m.window.showErrorMessage(mr("pull request not found","Unable to find pull request {1} on repository '{0}'. Would you like to open another pull request?",e,r),n)===n&&m.commands.executeCommand("remoteHub.openRepository")}async showPullRequestHeadNotFoundMessage(e,r){const n=mr("pull request head not found ok","OK");await m.window.showWarningMessage(mr("pull request head not found","Unable to find the source branch for pull request {1} on repository '{0}'.",e,r),n)}async showRepositoryForbiddenMessage(e){const r=mr("repository forbidden open","Open Repository");await m.window.showErrorMessage(mr("repository forbidden","You don't have access to repository '{0}'. Would you like to open another repository?",e),r)===r&&m.commands.executeCommand("remoteHub.openRepository")}async showRepositoryNotFoundMessage(e){const r=mr("repository not found confirm","Open Repository");await m.window.showErrorMessage(mr("repository not found","Unable to find repository '{0}'. Would you like to open another repository?",e),r)===r&&m.commands.executeCommand("remoteHub.openRepository")}async showUnableToOpenRepositoryMessage(e){const r=mr("unable to open repo confirm","Open Repository");await m.window.showErrorMessage(mr("unable to open repo","Unable to open repository. {0}. Would you like to open another repository?",String(e)),r)===r&&m.commands.executeCommand("remoteHub.openRepository")}}a(Wn,"Messages"),Qr([nr(()=>"")],Wn.prototype,"showGitHubStatus500Message",1),Qr([nr(()=>"")],Wn.prototype,"showStatus401Message",1),Qr([nr(()=>"")],Wn.prototype,"showStatus403Message",1),Qr([nr()],Wn.prototype,"showRepositoryEmptyMessage",1),Qr([nr()],Wn.prototype,"showPullRequestNotFoundMessage",1),Qr([nr()],Wn.prototype,"showPullRequestHeadNotFoundMessage",1),Qr([nr()],Wn.prototype,"showRepositoryForbiddenMessage",1),Qr([nr()],Wn.prototype,"showRepositoryNotFoundMessage",1),Qr([nr()],Wn.prototype,"showUnableToOpenRepositoryMessage",1);const Yr=new Wn,Pr=(0,B.loadMessageBundle)();function hs(t,e,r,n,i){async function o(l){const[d,p]=await $i.show(t,r,l,Pr("open repo placeholder","Enter a remote url, or select a remote provider"),l===tr.AddToWorkspace?Pr("open repo title add to workspace","Add Remote Repository to Workspace"):Pr("open repo title current window","Open Remote Repository"),{allowAddToWorkspace:!1});if(!d){i.sendEvent("openRepository.abort",{reason:"abandoned"});return}try{let S;if(d.workspace)S=d.workspace,S.location=p!=null?p:S.location;else if(S=await t.createWorkspaceForRemoteUrl(d.url,void 0,p!=null?p:l),!S){i.sendEvent("openRepository.abort",{reason:"aborted invalid url"});return}await bn(S)}catch(S){if(i.sendException(S),S instanceof pt){const{reauthenticate:P}=S;Yr.showStatus401Message(()=>P());return}if(S instanceof Pt){Yr.showRepositoryNotFoundMessage(S.name);return}if(S instanceof xe){Yr.showRepositoryForbiddenMessage(S.name);return}if(S instanceof ut){Yr.showRepositoryEmptyMessage(S.name);return}if(S instanceof Rt){Yr.showPullRequestNotFoundMessage(S.name,S.id);return}L.error(S)}}a(o,"openRepository");async function c(l,d,p){if(p==null?void 0:p.workspaceFolder){const P=t.getRepository(p.workspaceFolder,d);if(P!==void 0)return P}const S=d?t.repositories.filter(P=>P.provider.id===d):t.repositories;if(S.length!==0){if(S.length>1){const P=await m.window.showQuickPick(S.map(I=>({label:I.name,description:I.provider.name,repository:I})),{placeHolder:l});return P?P.repository:void 0}return S[0]}}return a(c,"getRepository"),[m.commands.registerCommand("remoteHub.openRepository",()=>(i.sendEvent("command.openRepository"),o())),m.commands.registerCommand("remoteHub.continueOn.openRepository",()=>(i.sendEvent("command.continueOn.openRepository"),o())),m.commands.registerCommand("remoteHub.addRepositoryToWorkspace",()=>{i.sendEvent("command.continueOn.openRepository")}),m.commands.registerCommand("remoteHub.continueOn.addRepositoryToWorkspace",()=>{i.sendEvent("command.continueOn.openRepository")}),m.commands.registerCommand("remoteHub.continueOn",async()=>{const l=await c(Pr("continue on choose repository placeholder","Choose which repository to continue working on elsewhere"));if(l===void 0)return;i.sendEvent("command.continueOn");const d=await fc.show(n,Pr("continue on placeholder","Choose how you would like to continue working"),Pr("continue on title","Continue '{0}' on",l.name));if(!d){i.sendEvent("command.continueOn.abort",{reason:"abandoned"});return}if(await e.hasChanges(l.uri)){const P={title:Pr("continue","Continue")},I={title:Pr("cancel","Cancel"),isCloseAffordance:!0};if(await m.window.showWarningMessage(Pr("continue on uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them from elsewhere.`),{modal:!0,useCustom:!0},P,I)!==P){i.sendEvent("command.continueOn.abort",{reason:"abandoned uncommitted changes prompt"});return}}const p=t.getRemoteUri(l.provider.id,{repo:l.id}),{HEAD:S}=await l.getMetadata();await d.execute({provider:l.provider,workspaceFolder:l.uri,name:l.name,url:p==null?void 0:p.toString(!0),ref:S.name})}),m.commands.registerCommand("remoteHub.openOnDesktop",async l=>{if(!qn)return;const d=await c(Pr("continue on desktop choose repository placeholder","Choose which repository to open on the desktop"),void 0,l);if(d===void 0)return;const p=await t.getBestRemoteUri(d.uri);p!==void 0&&(i.sendEvent("command.openOnDesktop"),m.env.openExternal(m.Uri.parse(`${m.env.uriScheme}://${n}/open?url=${encodeURIComponent(p.toString(!0))}`)))}),m.commands.registerCommand("remoteHub.openOnWeb",async l=>{if(qn)return;const d=await c(Pr("continue on web choose repository placeholder","Choose which repository to open on the web"),void 0,l);if(d===void 0)return;const p=await t.getBestRemoteUri(d.uri);p!==void 0&&(i.sendEvent("command.openOnWeb"),m.env.openExternal(p))}),m.commands.registerCommand("remoteHub.goToRepository",async()=>{i.sendEvent("command.goToRepository");const l=await c(Pr("open on remote choose repository placeholder","Choose which repository to open on the remote"));if(!l)return;const d={provider:l.provider,repo:l.id};return m.commands.executeCommand("remoteHub.openOnRemote",d)}),m.commands.registerCommand("remoteHub.openOnRemote",async l=>{i.sendEvent("command.openOnRemote");const{provider:d,...p}=l,S=t.getRemoteUri(d.id,p);if(S){await m.env.openExternal(S);return}m.window.showErrorMessage(Pr("open on remote command provider not supported","Unable to open the resource on {0}",l.provider.name))}),m.commands.registerCommand("remoteHub.clone",async l=>{const d=await c(Pr("clone placeholder","Choose which repository to clone"),void 0,l);if(d!==void 0){if(i.sendEvent("command.clone"),l===void 0&&await e.hasChanges(d.uri)){const p={title:Pr("continue","Continue")},S={title:Pr("cancel","Cancel"),isCloseAffordance:!0};if(await m.window.showWarningMessage(Pr("clone uncommitted changes",`You have uncommitted changes.

Unless you commit those changes, you won't be able see them in your local clone.`),{modal:!0,useCustom:!0},p,S)!==p){i.sendEvent("command.clone.abort",{reason:"abandoned uncommitted changes prompt"});return}}await t.clone(d.uri)}}),m.commands.registerCommand("remoteHub.refresh",()=>void t.refresh()),m.commands.registerCommand("remoteHub.enableDebugLogging",()=>Y.updateEffective("logLevel",qe.Debug)),m.commands.registerCommand("remoteHub.disableDebugLogging",()=>Y.updateEffective("logLevel",qe.Warn)),m.commands.registerCommand("remoteHub.exportDebugInfo",async()=>{await r.exportDebugInfo(),await e.exportDebugInfo()}),m.commands.registerCommand("remoteHub.setContext",async(l,d)=>{if(!l.startsWith("continueOn:"))throw new Error("Key must start with 'continueOn:'");await oi(l,d)}),m.commands.registerCommand("remoteHub.notebook.continueOn",async()=>{const l={title:Pr("continue on","Continue Working On...")};await m.window.showInformationMessage(Pr("notebook continue on","Running notebook cells is not available in the web editor. To run this cell, you will need to continue in an environment that can run code, like a codespace or local VS Code."),{modal:!0},l)===l&&await m.commands.executeCommand("remoteHub.continueOn")})]}a(hs,"registerCommands");function Gn(t){return t}a(Gn,"command");async function mc(t,e){return m.commands.executeCommand(t,e)}a(mc,"executeCommand");class El{constructor(){this._timeout=0,this._disposable=Y.onDidChange(this.onConfigurationChanged,this),this.maybeQueueFetch()}dispose(){this._disposable.dispose(),this._timeout&&clearTimeout(this._timeout)}get config(){var e;if(this._config===void 0){const r=Y.get("autoFetch");this._config={enabled:(e=r.enabled)!=null?e:!0,interval:r.interval*1e3}}return this._config}onConfigurationChanged(e){!Y.changed(e,"autoFetch")||(this._config=void 0,this.maybeQueueFetch())}async fetchAll(){try{await mc("remoteHub.fetchAll",{automated:!0})}catch(e){L.error(e,"Autofetch failed")}this.maybeQueueFetch()}maybeQueueFetch(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),!!this.config.enabled&&(this._timeout=setTimeout(()=>this.fetchAll(),this.config.interval))}}a(El,"AutoFetchService");const Bu=require("buffer");var Hu=__webpack_require__(6113),Uu=__webpack_require__.n(Hu);const fs=new Uint8Array(256);let Fi=fs.length;function ju(){return Fi>fs.length-16&&(Uu().randomFillSync(fs),Fi=0),fs.slice(Fi,Fi+=16)}a(ju,"rng");const xl=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function qu(t){return typeof t=="string"&&xl.test(t)}a(qu,"validate");const zu=qu,jr=[];for(let t=0;t<256;++t)jr.push((t+256).toString(16).substr(1));function Wu(t,e=0){const r=(jr[t[e+0]]+jr[t[e+1]]+jr[t[e+2]]+jr[t[e+3]]+"-"+jr[t[e+4]]+jr[t[e+5]]+"-"+jr[t[e+6]]+jr[t[e+7]]+"-"+jr[t[e+8]]+jr[t[e+9]]+"-"+jr[t[e+10]]+jr[t[e+11]]+jr[t[e+12]]+jr[t[e+13]]+jr[t[e+14]]+jr[t[e+15]]).toLowerCase();if(!zu(r))throw TypeError("Stringified UUID is invalid");return r}a(Wu,"stringify");const Gu=Wu;function Cl(t,e,r){t=t||{};const n=t.random||(t.rng||ju)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let i=0;i<16;++i)e[r+i]=n[i];return e}return Gu(n)}a(Cl,"v4");const vc=Cl;var Cr=__webpack_require__(2781),ps=__webpack_require__(3685),$o=__webpack_require__(7310),Tl=__webpack_require__(5687),gn=__webpack_require__(9796);const Vu=Cr.Readable,Si=Symbol("buffer"),yc=Symbol("type");class oo{constructor(){this[yc]="";const e=arguments[0],r=arguments[1],n=[];let i=0;if(e){const c=e,l=Number(c.length);for(let d=0;d<l;d++){const p=c[d];let S;p instanceof Buffer?S=p:ArrayBuffer.isView(p)?S=Buffer.from(p.buffer,p.byteOffset,p.byteLength):p instanceof ArrayBuffer?S=Buffer.from(p):p instanceof oo?S=p[Si]:S=Buffer.from(typeof p=="string"?p:String(p)),i+=S.length,n.push(S)}}this[Si]=Buffer.concat(n);let o=r&&r.type!==void 0&&String(r.type).toLowerCase();o&&!/[^\u0020-\u007E]/.test(o)&&(this[yc]=o)}get size(){return this[Si].length}get type(){return this[yc]}text(){return Promise.resolve(this[Si].toString())}arrayBuffer(){const e=this[Si],r=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return Promise.resolve(r)}stream(){const e=new Vu;return e._read=function(){},e.push(this[Si]),e.push(null),e}toString(){return"[object Blob]"}slice(){const e=this.size,r=arguments[0],n=arguments[1];let i,o;r===void 0?i=0:r<0?i=Math.max(e+r,0):i=Math.min(r,e),n===void 0?o=e:n<0?o=Math.max(e+n,0):o=Math.min(n,e);const c=Math.max(o-i,0),d=this[Si].slice(i,i+c),p=new oo([],{type:arguments[2]});return p[Si]=d,p}}a(oo,"Blob"),Object.defineProperties(oo.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(oo.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0});function cn(t,e,r){Error.call(this,t),this.message=t,this.type=e,r&&(this.code=this.errno=r.code),Error.captureStackTrace(this,this.constructor)}a(cn,"FetchError"),cn.prototype=Object.create(Error.prototype),cn.prototype.constructor=cn,cn.prototype.name="FetchError";let _c;try{_c=require("encoding").convert}catch(t){}const Ei=Symbol("Body internals"),wc=Cr.PassThrough;function Sr(t){var e=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.size;let i=n===void 0?0:n;var o=r.timeout;let c=o===void 0?0:o;t==null?t=null:Vn(t)?t=Buffer.from(t.toString()):Fo(t)||Buffer.isBuffer(t)||(Object.prototype.toString.call(t)==="[object ArrayBuffer]"?t=Buffer.from(t):ArrayBuffer.isView(t)?t=Buffer.from(t.buffer,t.byteOffset,t.byteLength):t instanceof Cr||(t=Buffer.from(String(t)))),this[Ei]={body:t,disturbed:!1,error:null},this.size=i,this.timeout=c,t instanceof Cr&&t.on("error",function(l){const d=l.name==="AbortError"?l:new cn(`Invalid response body while trying to fetch ${e.url}: ${l.message}`,"system",l);e[Ei].error=d})}a(Sr,"Body"),Sr.prototype={get body(){return this[Ei].body},get bodyUsed(){return this[Ei].disturbed},arrayBuffer(){return cr.call(this).then(function(t){return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)})},blob(){let t=this.headers&&this.headers.get("content-type")||"";return cr.call(this).then(function(e){return Object.assign(new oo([],{type:t.toLowerCase()}),{[Si]:e})})},json(){var t=this;return cr.call(this).then(function(e){try{return JSON.parse(e.toString())}catch(r){return Sr.Promise.reject(new cn(`invalid json response body at ${t.url} reason: ${r.message}`,"invalid-json"))}})},text(){return cr.call(this).then(function(t){return t.toString()})},buffer(){return cr.call(this)},textConverted(){var t=this;return cr.call(this).then(function(e){return bc(e,t.headers)})}},Object.defineProperties(Sr.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),Sr.mixIn=function(t){for(const e of Object.getOwnPropertyNames(Sr.prototype))if(!(e in t)){const r=Object.getOwnPropertyDescriptor(Sr.prototype,e);Object.defineProperty(t,e,r)}};function cr(){var t=this;if(this[Ei].disturbed)return Sr.Promise.reject(new TypeError(`body used already for: ${this.url}`));if(this[Ei].disturbed=!0,this[Ei].error)return Sr.Promise.reject(this[Ei].error);let e=this.body;if(e===null)return Sr.Promise.resolve(Buffer.alloc(0));if(Fo(e)&&(e=e.stream()),Buffer.isBuffer(e))return Sr.Promise.resolve(e);if(!(e instanceof Cr))return Sr.Promise.resolve(Buffer.alloc(0));let r=[],n=0,i=!1;return new Sr.Promise(function(o,c){let l;t.timeout&&(l=setTimeout(function(){i=!0,c(new cn(`Response timeout while trying to fetch ${t.url} (over ${t.timeout}ms)`,"body-timeout"))},t.timeout)),e.on("error",function(d){d.name==="AbortError"?(i=!0,c(d)):c(new cn(`Invalid response body while trying to fetch ${t.url}: ${d.message}`,"system",d))}),e.on("data",function(d){if(!(i||d===null)){if(t.size&&n+d.length>t.size){i=!0,c(new cn(`content size at ${t.url} over limit: ${t.size}`,"max-size"));return}n+=d.length,r.push(d)}}),e.on("end",function(){if(!i){clearTimeout(l);try{o(Buffer.concat(r,n))}catch(d){c(new cn(`Could not create Buffer from response body for ${t.url}: ${d.message}`,"system",d))}}})})}a(cr,"consumeBody");function bc(t,e){if(typeof _c!="function")throw new Error("The package `encoding` must be installed to use the textConverted() function");const r=e.get("content-type");let n="utf-8",i,o;return r&&(i=/charset=([^;]*)/i.exec(r)),o=t.slice(0,1024).toString(),!i&&o&&(i=/<meta.+?charset=(['"])(.+?)\1/i.exec(o)),!i&&o&&(i=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(o),i||(i=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(o),i&&i.pop()),i&&(i=/charset=(.*)/i.exec(i.pop()))),!i&&o&&(i=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(o)),i&&(n=i.pop(),(n==="gb2312"||n==="gbk")&&(n="gb18030")),_c(t,"UTF-8",n).toString()}a(bc,"convertBody");function Vn(t){return typeof t!="object"||typeof t.append!="function"||typeof t.delete!="function"||typeof t.get!="function"||typeof t.getAll!="function"||typeof t.has!="function"||typeof t.set!="function"?!1:t.constructor.name==="URLSearchParams"||Object.prototype.toString.call(t)==="[object URLSearchParams]"||typeof t.sort=="function"}a(Vn,"isURLSearchParams");function Fo(t){return typeof t=="object"&&typeof t.arrayBuffer=="function"&&typeof t.type=="string"&&typeof t.stream=="function"&&typeof t.constructor=="function"&&typeof t.constructor.name=="string"&&/^(Blob|File)$/.test(t.constructor.name)&&/^(Blob|File)$/.test(t[Symbol.toStringTag])}a(Fo,"isBlob");function Al(t){let e,r,n=t.body;if(t.bodyUsed)throw new Error("cannot clone body after it is used");return n instanceof Cr&&typeof n.getBoundary!="function"&&(e=new wc,r=new wc,n.pipe(e),n.pipe(r),t[Ei].body=e,n=r),n}a(Al,"clone");function Rl(t){return t===null?null:typeof t=="string"?"text/plain;charset=UTF-8":Vn(t)?"application/x-www-form-urlencoded;charset=UTF-8":Fo(t)?t.type||null:Buffer.isBuffer(t)||Object.prototype.toString.call(t)==="[object ArrayBuffer]"||ArrayBuffer.isView(t)?null:typeof t.getBoundary=="function"?`multipart/form-data;boundary=${t.getBoundary()}`:t instanceof Cr?null:"text/plain;charset=UTF-8"}a(Rl,"extractContentType");function Il(t){const e=t.body;return e===null?0:Fo(e)?e.size:Buffer.isBuffer(e)?e.length:e&&typeof e.getLengthSync=="function"&&(e._lengthRetrievers&&e._lengthRetrievers.length==0||e.hasKnownLength&&e.hasKnownLength())?e.getLengthSync():null}a(Il,"getTotalBytes");function s(t,e){const r=e.body;r===null?t.end():Fo(r)?r.stream().pipe(t):Buffer.isBuffer(r)?(t.write(r),t.end()):r.pipe(t)}a(s,"writeToStream"),Sr.Promise=global.Promise;const A=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,f=/[^\t\x20-\x7e\x80-\xff]/;function w(t){if(t=`${t}`,A.test(t)||t==="")throw new TypeError(`${t} is not a legal HTTP header name`)}a(w,"validateName");function x(t){if(t=`${t}`,f.test(t))throw new TypeError(`${t} is not a legal HTTP header value`)}a(x,"validateValue");function g(t,e){e=e.toLowerCase();for(const r in t)if(r.toLowerCase()===e)return r}a(g,"lib_find");const u=Symbol("map");class h{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;if(this[u]=Object.create(null),e instanceof h){const r=e.raw(),n=Object.keys(r);for(const i of n)for(const o of r[i])this.append(i,o);return}if(e!=null)if(typeof e=="object"){const r=e[Symbol.iterator];if(r!=null){if(typeof r!="function")throw new TypeError("Header pairs must be iterable");const n=[];for(const i of e){if(typeof i!="object"||typeof i[Symbol.iterator]!="function")throw new TypeError("Each header pair must be iterable");n.push(Array.from(i))}for(const i of n){if(i.length!==2)throw new TypeError("Each header pair must be a name/value tuple");this.append(i[0],i[1])}}else for(const n of Object.keys(e)){const i=e[n];this.append(n,i)}}else throw new TypeError("Provided initializer must be an object")}get(e){e=`${e}`,w(e);const r=g(this[u],e);return r===void 0?null:this[u][r].join(", ")}forEach(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,n=v(this),i=0;for(;i<n.length;){var o=n[i];const c=o[0],l=o[1];e.call(r,l,c,this),n=v(this),i++}}set(e,r){e=`${e}`,r=`${r}`,w(e),x(r);const n=g(this[u],e);this[u][n!==void 0?n:e]=[r]}append(e,r){e=`${e}`,r=`${r}`,w(e),x(r);const n=g(this[u],e);n!==void 0?this[u][n].push(r):this[u][e]=[r]}has(e){return e=`${e}`,w(e),g(this[u],e)!==void 0}delete(e){e=`${e}`,w(e);const r=g(this[u],e);r!==void 0&&delete this[u][r]}raw(){return this[u]}keys(){return b(this,"key")}values(){return b(this,"value")}[Symbol.iterator](){return b(this,"key+value")}}a(h,"Headers"),h.prototype.entries=h.prototype[Symbol.iterator],Object.defineProperty(h.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(h.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});function v(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"key+value";return Object.keys(t[u]).sort().map(e==="key"?function(n){return n.toLowerCase()}:e==="value"?function(n){return t[u][n].join(", ")}:function(n){return[n.toLowerCase(),t[u][n].join(", ")]})}a(v,"getHeaders");const _=Symbol("internal");function b(t,e){const r=Object.create(y);return r[_]={target:t,kind:e,index:0},r}a(b,"createHeadersIterator");const y=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==y)throw new TypeError("Value of `this` is not a HeadersIterator");var t=this[_];const e=t.target,r=t.kind,n=t.index,i=v(e,r),o=i.length;return n>=o?{value:void 0,done:!0}:(this[_].index=n+1,{value:i[n],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));Object.defineProperty(y,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});function E(t){const e=Object.assign({__proto__:null},t[u]),r=g(t[u],"Host");return r!==void 0&&(e[r]=e[r][0]),e}a(E,"exportNodeCompatibleHeaders");function C(t){const e=new h;for(const r of Object.keys(t))if(!A.test(r))if(Array.isArray(t[r]))for(const n of t[r])f.test(n)||(e[u][r]===void 0?e[u][r]=[n]:e[u][r].push(n));else f.test(t[r])||(e[u][r]=[t[r]]);return e}a(C,"createHeadersLenient");const T=Symbol("Response internals"),R=ps.STATUS_CODES;class D{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Sr.call(this,e,r);const n=r.status||200,i=new h(r.headers);if(e!=null&&!i.has("Content-Type")){const o=Rl(e);o&&i.append("Content-Type",o)}this[T]={url:r.url,status:n,statusText:r.statusText||R[n],headers:i,counter:r.counter}}get url(){return this[T].url||""}get status(){return this[T].status}get ok(){return this[T].status>=200&&this[T].status<300}get redirected(){return this[T].counter>0}get statusText(){return this[T].statusText}get headers(){return this[T].headers}clone(){return new D(Al(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}a(D,"Response"),Sr.mixIn(D.prototype),Object.defineProperties(D.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(D.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});const k=Symbol("Request internals"),G=$o.parse,Z=$o.format,Q="destroy"in Cr.Readable.prototype;function fe(t){return typeof t=="object"&&typeof t[k]=="object"}a(fe,"isRequest");function Ee(t){const e=t&&typeof t=="object"&&Object.getPrototypeOf(t);return!!(e&&e.constructor.name==="AbortSignal")}a(Ee,"isAbortSignal");class Pe{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;fe(e)?n=G(e.url):(e&&e.href?n=G(e.href):n=G(`${e}`),e={});let i=r.method||e.method||"GET";if(i=i.toUpperCase(),(r.body!=null||fe(e)&&e.body!==null)&&(i==="GET"||i==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let o=r.body!=null?r.body:fe(e)&&e.body!==null?Al(e):null;Sr.call(this,o,{timeout:r.timeout||e.timeout||0,size:r.size||e.size||0});const c=new h(r.headers||e.headers||{});if(o!=null&&!c.has("Content-Type")){const d=Rl(o);d&&c.append("Content-Type",d)}let l=fe(e)?e.signal:null;if("signal"in r&&(l=r.signal),l!=null&&!Ee(l))throw new TypeError("Expected signal to be an instanceof AbortSignal");this[k]={method:i,redirect:r.redirect||e.redirect||"follow",headers:c,parsedURL:n,signal:l},this.follow=r.follow!==void 0?r.follow:e.follow!==void 0?e.follow:20,this.compress=r.compress!==void 0?r.compress:e.compress!==void 0?e.compress:!0,this.counter=r.counter||e.counter||0,this.agent=r.agent||e.agent}get method(){return this[k].method}get url(){return Z(this[k].parsedURL)}get headers(){return this[k].headers}get redirect(){return this[k].redirect}get signal(){return this[k].signal}clone(){return new Pe(this)}}a(Pe,"Request"),Sr.mixIn(Pe.prototype),Object.defineProperty(Pe.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(Pe.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});function He(t){const e=t[k].parsedURL,r=new h(t[k].headers);if(r.has("Accept")||r.set("Accept","*/*"),!e.protocol||!e.hostname)throw new TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(e.protocol))throw new TypeError("Only HTTP(S) protocols are supported");if(t.signal&&t.body instanceof Cr.Readable&&!Q)throw new Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let n=null;if(t.body==null&&/^(POST|PUT)$/i.test(t.method)&&(n="0"),t.body!=null){const o=Il(t);typeof o=="number"&&(n=String(o))}n&&r.set("Content-Length",n),r.has("User-Agent")||r.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),t.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip,deflate");let i=t.agent;return typeof i=="function"&&(i=i(e)),!r.has("Connection")&&!i&&r.set("Connection","close"),Object.assign({},e,{method:t.method,headers:E(r),agent:i})}a(He,"getNodeRequestOptions");function Qe(t){Error.call(this,t),this.type="aborted",this.message=t,Error.captureStackTrace(this,this.constructor)}a(Qe,"AbortError"),Qe.prototype=Object.create(Error.prototype),Qe.prototype.constructor=Qe,Qe.prototype.name="AbortError";const tt=Cr.PassThrough,mt=$o.resolve;function bt(t,e){if(!bt.Promise)throw new Error("native promise missing, set fetch.Promise to your favorite alternative");return Sr.Promise=bt.Promise,new bt.Promise(function(r,n){const i=new Pe(t,e),o=He(i),c=(o.protocol==="https:"?Tl:ps).request,l=i.signal;let d=null;const p=a(function(){let N=new Qe("The user aborted a request.");n(N),i.body&&i.body instanceof Cr.Readable&&i.body.destroy(N),!(!d||!d.body)&&d.body.emit("error",N)},"abort");if(l&&l.aborted){p();return}const S=a(function(){p(),O()},"abortAndFinalize"),P=c(o);let I;l&&l.addEventListener("abort",S);function O(){P.abort(),l&&l.removeEventListener("abort",S),clearTimeout(I)}a(O,"finalize"),i.timeout&&P.once("socket",function(F){I=setTimeout(function(){n(new cn(`network timeout at: ${i.url}`,"request-timeout")),O()},i.timeout)}),P.on("error",function(F){n(new cn(`request to ${i.url} failed, reason: ${F.message}`,"system",F)),O()}),P.on("response",function(F){clearTimeout(I);const N=C(F.headers);if(bt.isRedirect(F.statusCode)){const oe=N.get("Location"),ge=oe===null?null:mt(i.url,oe);switch(i.redirect){case"error":n(new cn(`uri requested responds with a redirect, redirect mode is set to error: ${i.url}`,"no-redirect")),O();return;case"manual":if(ge!==null)try{N.set("Location",ge)}catch(Re){n(Re)}break;case"follow":if(ge===null)break;if(i.counter>=i.follow){n(new cn(`maximum redirect reached at: ${i.url}`,"max-redirect")),O();return}const ke={headers:new h(i.headers),follow:i.follow,counter:i.counter+1,agent:i.agent,compress:i.compress,method:i.method,body:i.body,signal:i.signal,timeout:i.timeout,size:i.size};if(F.statusCode!==303&&i.body&&Il(i)===null){n(new cn("Cannot follow redirect with body being a readable stream","unsupported-redirect")),O();return}(F.statusCode===303||(F.statusCode===301||F.statusCode===302)&&i.method==="POST")&&(ke.method="GET",ke.body=void 0,ke.headers.delete("content-length")),r(bt(new Pe(ge,ke))),O();return}}F.once("end",function(){l&&l.removeEventListener("abort",S)});let U=F.pipe(new tt);const W={url:i.url,status:F.statusCode,statusText:F.statusMessage,headers:N,size:i.size,timeout:i.timeout,counter:i.counter},V=N.get("Content-Encoding");if(!i.compress||i.method==="HEAD"||V===null||F.statusCode===204||F.statusCode===304){d=new D(U,W),r(d);return}const ie={flush:gn.Z_SYNC_FLUSH,finishFlush:gn.Z_SYNC_FLUSH};if(V=="gzip"||V=="x-gzip"){U=U.pipe(gn.createGunzip(ie)),d=new D(U,W),r(d);return}if(V=="deflate"||V=="x-deflate"){F.pipe(new tt).once("data",function(ge){(ge[0]&15)==8?U=U.pipe(gn.createInflate()):U=U.pipe(gn.createInflateRaw()),d=new D(U,W),r(d)});return}if(V=="br"&&typeof gn.createBrotliDecompress=="function"){U=U.pipe(gn.createBrotliDecompress()),d=new D(U,W),r(d);return}d=new D(U,W),r(d)}),s(P,i)})}a(bt,"fetch"),bt.isRedirect=function(t){return t===301||t===302||t===303||t===307||t===308},bt.Promise=global.Promise;const jt=bt;var Bt=__webpack_require__(271),Tr=__webpack_require__.n(Bt);const Mt=jt;async function Ze(t,e,r){const n=new(Tr());r.onCancellationRequested(()=>{n.abort()});try{return await jt(t,{...e,signal:n.signal})}catch(i){throw r.isCancellationRequested?new m.CancellationError:i}}a(Ze,"fetchWithCancellation");const ht=B.loadMessageBundle(),dt="https://app.vssps.visualstudio.com/oauth2",xt="https://vscode.dev/codeExchangeProxyEndpoints/azuredevops",Lt="B6B1E9E6-B408-45D9-A6EA-AF1FFBAB6A0F",qt=["vso.code"];function Tt(t){return(t.query.includes("&")?t.query:decodeURIComponent(t.query)).split("&").reduce((r,n)=>{const i=n.split("=");return r[i[0]]=i[1],r},{})}a(Tt,"parseQuery");const Qt=new m.EventEmitter,Dr=new m.EventEmitter,vr="Network failure",yr="AzDO",ir="azuredevops";class Fr{constructor(e){this._tokens=[],this._refreshTimeouts=new Map,this._disposables=[],this._pendingStates=new Map,this._codeExchangePromises=new Map,this.secretStorage=e.secrets,this.extensionId=e.extension.id}async initialize(){await this.secretStorage.get(yr)&&(L.debug("Detected outdated auth session format. Removing and will ask for new auth session... "),await this.secretStorage.delete(yr));const r=await this.secretStorage.get(ir);if(r)try{const i=this.parseStoredData(r).map(async o=>{var c;if(!o.refreshToken)return Promise.resolve();try{await this.refreshToken(o.refreshToken,o.scope,o.id)}catch(l){l.message===vr?await this.handleRefreshNetworkError(o.id,o.refreshToken,o.scope)||(this._tokens.push({accessToken:void 0,refreshToken:o.refreshToken,account:{label:(c=o.account.label)!=null?c:o.account.displayName,id:o.account.id},scope:o.scope,sessionId:o.id}),this.pollForReconnect(o.id,o.refreshToken,o.scope)):await this.removeSession(o.id)}});await Promise.all(i)}catch(n){L.log("Failed to initialize stored data"),await this.clearSessions()}this._disposables.push(this.secretStorage.onDidChange(()=>this.checkForUpdates))}parseStoredData(e){return JSON.parse(e)}async storeTokenData(){const e=this._tokens.map(r=>({id:r.sessionId,refreshToken:r.refreshToken,scope:r.scope,account:r.account}));await this.secretStorage.store(ir,JSON.stringify(e))}async checkForUpdates(){const e=[];let r=[];const n=await this.secretStorage.get(ir);if(n)try{const i=this.parseStoredData(n);let o=i.map(async c=>{if(!this._tokens.some(d=>d.scope===c.scope&&d.sessionId===c.id)&&c.refreshToken)try{const d=await this.refreshToken(c.refreshToken,c.scope,c.id);e.push(this.convertToSessionSync(d))}catch(d){d.message===vr||await this.removeSession(c.id)}});o=o.concat(this._tokens.map(async c=>{i.some(d=>c.scope===d.scope&&c.sessionId===d.id)||(await this.removeSession(c.sessionId),r.push(this.convertToSessionSync(c)))})),await Promise.all(o)}catch(i){L.error(i),r=this._tokens.map(this.convertToSessionSync),this.clearSessions()}else this._tokens.length&&(r=this._tokens.map(this.convertToSessionSync),L.log("No stored keychain data, clearing local data"),this._tokens=[],this._refreshTimeouts.forEach(i=>{clearTimeout(i)}),this._refreshTimeouts.clear());(e.length||r.length)&&Qt.fire({added:e,removed:r,changed:[]})}convertToSessionSync(e){return{id:e.sessionId,accessToken:e.accessToken,account:e.account,scopes:e.scope.split(" ")}}async convertToSession(e){const r=await this.resolveAccessToken(e);return{id:e.sessionId,accessToken:r,account:e.account,scopes:e.scope.split(" ")}}async resolveAccessToken(e){if(e.accessToken&&(!e.expiresAt||e.expiresAt>Date.now()))return e.expiresAt?L.log(`Token available from cache, expires in ${e.expiresAt-Date.now()} milliseconds`):L.log("Token available from cache"),Promise.resolve(e.accessToken);try{L.log("Token expired or unavailable, trying refresh");const r=await this.refreshToken(e.refreshToken,e.scope,e.sessionId);if(r.accessToken)return r.accessToken;throw new Error("No access token returned.")}catch(r){throw new Error("Unavailable due to network problems")}}getTokenClaims(e){try{return JSON.parse(Bu.Buffer.from(e.split(".")[1],"base64").toString())}catch(r){throw L.error(r),new Error("Unable to read token claims")}}get sessions(){return Promise.all(this._tokens.map(e=>this.convertToSession(e)))}async getSessions(e){if(!e)return this.sessions;const r=e.sort().join(" "),n=this._tokens.filter(i=>i.scope===r);return Promise.all(n.map(i=>this.convertToSession(i)))}createSession(e){return L.log("Logging in..."),this.loginWithoutLocalServer(e)}dispose(){this._disposables.forEach(e=>e.dispose()),this._disposables=[]}isTestEnvironment(e){return/\.azurewebsites\.net$/.test(e.authority)||e.authority.startsWith("localhost:")}async loginWithoutLocalServer(e){var r;const n=await m.env.asExternalUri(m.Uri.parse(`${m.env.uriScheme}://${this.extensionId}/login`));if(this.isTestEnvironment(n)){const p=await m.window.showInputBox({prompt:'Azure Repos Personal Access Token (you must have "vso.code" in your scopes)',ignoreFocusOut:!0});if(!p)throw new Error("Sign in failed: No token provided");return{id:"test",accessToken:p,scopes:qt,account:{id:"test",label:"Test Account"}}}const i=n.toString(),o=m.Uri.parse(`${dt}/authorize?client_id=${Lt}&response_type=Assertion&state=${encodeURIComponent(i)}&scope=${encodeURIComponent(qt.join(" "))}&redirect_uri=${encodeURIComponent(xt)}`),c=new Promise((p,S)=>{const P=setTimeout(()=>{clearTimeout(P),S("Login timed out.")},1e3*60*5)}),l=(r=this._pendingStates.get(e))!=null?r:[];this._pendingStates.set(e,[...l,i]);let d=this._codeExchangePromises.get(e);return d||(d=this.handleCodeResponse(e),this._codeExchangePromises.set(e,d)),m.env.openExternal(o),Promise.race([d,c]).finally(()=>{this._pendingStates.delete(e),this._codeExchangePromises.delete(e)})}async handleCodeResponse(e){let r;return new Promise((n,i)=>{r=Dr.event(async o=>{try{L.log(`Received Uri: ${o.toString()}`);const c=Tt(o);if(!c)throw new Error(`No access info found in query: ${JSON.stringify(c)}`);const l=c,d=await this.getTokenFromResponse(l,e);this.setToken(d,e);const p=await this.convertToSession(d);n(p)}catch(c){L.error(c),i(c)}})}).then(n=>(r.dispose(),n)).catch(n=>{throw r.dispose(),n})}setToken(e,r){const n=this._tokens.findIndex(i=>i.sessionId===e.sessionId);return n>-1?this._tokens.splice(n,1,e):this._tokens.push(e),this.clearSessionTimeout(e.sessionId),e.expiresIn&&this._refreshTimeouts.set(e.sessionId,setTimeout(async()=>{try{const i=await this.refreshToken(e.refreshToken,r,e.sessionId);Qt.fire({added:[],removed:[],changed:[this.convertToSessionSync(i)]})}catch(i){i.message===vr?await this.handleRefreshNetworkError(e.sessionId,e.refreshToken,r)||this.pollForReconnect(e.sessionId,e.refreshToken,e.scope):(await this.removeSession(e.sessionId),Qt.fire({added:[],removed:[this.convertToSessionSync(e)],changed:[]}))}},1e3*(e.expiresIn*2/3))),this.storeTokenData()}async getTokenFromResponse(e,r,n){var i;const o=this.getTokenClaims(e.access_token),c=await Mt("https://app.vssps.visualstudio.com/_apis/profile/profiles/me?api-version=6.0",{headers:{Authorization:`Bearer ${e.access_token}`,"Content-Type":"application/json"}});let l;if(c.ok)l=(await c.json()).displayName;else{const d=await c.text();L.error(d),l="User"}return{expiresIn:e.expires_in,expiresAt:e.expires_in?Date.now()+e.expires_in*1e3:void 0,accessToken:e.access_token,refreshToken:e.refresh_token,scope:r,sessionId:n!=null?n:`${o.nameid}/${vc()}`,account:{label:l,id:`${o.nameid}/${(i=o.aui)!=null?i:""}`}}}async refreshToken(e,r,n){L.log("Refreshing token...");const i=`refresh_token=${encodeURIComponent(e)}`;let o;try{o=await Mt(xt,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":i.length.toString()},body:i})}catch(c){throw L.error("Refreshing token failed"),new Error(vr)}try{if(o.ok){const c=await o.json(),l=await this.getTokenFromResponse({access_token:c.access_token,expires_in:c.expires_in,refresh_token:c.refresh_token},r,n);return this.setToken(l,r),L.log("Token refresh success"),l}throw new Error("Bad request.")}catch(c){throw await m.window.showErrorMessage(ht("signOut","You have been signed out because reading stored authentication information failed.")),L.error(`Refreshing token failed: ${o.statusText}`),new Error("Refreshing token failed")}}clearSessionTimeout(e){const r=this._refreshTimeouts.get(e);r&&(clearTimeout(r),this._refreshTimeouts.delete(e))}removeInMemorySessionData(e){const r=this._tokens.findIndex(i=>i.sessionId===e);let n;return r>-1&&(n=this._tokens[r],this._tokens.splice(r,1)),this.clearSessionTimeout(e),n}pollForReconnect(e,r,n){this.clearSessionTimeout(e),this._refreshTimeouts.set(e,setTimeout(async()=>{try{const i=await this.refreshToken(r,n,e);Qt.fire({added:[],removed:[],changed:[this.convertToSessionSync(i)]})}catch(i){this.pollForReconnect(e,r,n)}},1e3*60*30))}handleRefreshNetworkError(e,r,n,i=1){return new Promise((o,c)=>{if(i===3)return L.error("Token refresh failed after 3 attempts"),o(!1);const l=5*i*i;this.clearSessionTimeout(e),this._refreshTimeouts.set(e,setTimeout(async()=>{try{const d=await this.refreshToken(r,n,e);return Qt.fire({added:[],removed:[],changed:[this.convertToSessionSync(d)]}),o(!0)}catch(d){return o(await this.handleRefreshNetworkError(e,r,n,i+1))}},1e3*l))})}async removeSession(e){L.log(`Logging out of session '${e}'`);const r=this.removeInMemorySessionData(e);let n;return r&&(n=this.convertToSessionSync(r)),this._tokens.length===0?await this.secretStorage.delete(ir):this.storeTokenData(),n}async clearSessions(){L.log("Logging out of all sessions"),this._tokens=[],await this.secretStorage.delete(ir),this._refreshTimeouts.forEach(e=>{clearTimeout(e)}),this._refreshTimeouts.clear()}}a(Fr,"AzureDevOpsAuthService");const mn=a(class{constructor(t){this.onDidChangeSessions=Qt.event,this.loginService=new Fr(t),this.initializePromise=this.loginService.initialize(),this.disposable=m.authentication.registerAuthenticationProvider(mn.id,"Azure Repos",this)}dispose(){this.disposable.dispose()}async getSessions(t){return await this.initializePromise,this.loginService.getSessions(t)}async createSession(t){await this.initializePromise;const e=await this.loginService.createSession(t.sort().join(" "));return Qt.fire({added:[e],removed:[],changed:[]}),e}async removeSession(t){await this.initializePromise;const e=await this.loginService.removeSession(t);e&&Qt.fire({added:[],removed:[e],changed:[]})}},"_AzDOAuthenticationProvider");let Ot=mn;Ot.id="azurerepos";var At=__webpack_require__(7360),ar=__webpack_require__(850),Nr=__webpack_require__.n(ar);function _a(t,e,r){if(!(e==null?void 0:e.length)&&!(r==null?void 0:r.length))return new Set(t);let n;if(e==null?void 0:e.length){const i=new Set([...e,...e.map(c=>`${c}/**`)]),o=Nr()(t,[...i],{dot:!0,nocase:!0});n=new Set(o)}if(r==null?void 0:r.length){const i=new Set([...r,...r.map(o=>`${o}/**`)]);if(n===void 0){const o=Nr().not(t,[...i],{dot:!0,nocase:!0});n=new Set(o)}else Nr()(t,[...i],{dot:!0,nocase:!0}).forEach(n.delete,n)}return n}a(_a,"globFilter");var Sc=Object.defineProperty,Gt=Object.getOwnPropertyDescriptor,wa=a((t,e,r,n)=>{for(var i=n>1?void 0:n?Gt(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&Sc(e,r,i),i},"fs_decorateClass");const Ec=(0,B.loadMessageBundle)(),ao=m.FileSystemError.FileNotFound().code,ai=/(\/|\\)/g;class si{constructor(e,r,n){this.providerService=e,this.azdo=r,this.changeStore=n,this._onDidChangeFile=new m.EventEmitter,this.contentCache=new Map,this.fileSearchCache=new Map,this.pendingUriRequests=new Map,this.pendingUriRequestsEventDelay=10,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.pathTypeMap={},this.disposable=m.Disposable.from(m.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0,isReadonly:!0}),m.workspace.registerFileSearchProvider(this.scheme,this),m.workspace.registerTextSearchProvider(this.scheme,this),m.workspace.onDidCloseTextDocument(i=>this.onTextDocumentClosed(i.uri)),e.onDidChangeRepository(i=>{i.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([i.repository.uri])}),e.onDidRefresh(i=>this.onRefreshOrRepositoryChanged(i)))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return this.azdo.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){if(e=e.filter(r=>Xt.getProviderId(r)===this.scheme).map(r=>this.providerService.getProviderUri(r)),e.length!==0){L.log(`AzDOFS.onRefreshOrRepositoryChanged(${e.map(r=>r.toString()).join(", ")})`),this.fileSearchCache.clear();for(const[r,n]of[...this.pendingUriRequests])e.some(i=>ye(n.uri,i))&&(this.pendingUriRequests.delete(r),n.outdated=!0);for(const[r,{uri:n}]of[...this.contentCache])e.some(i=>ye(n,i))&&this.contentCache.delete(r);this.updateOpenOrWatchedUris(e)}}onTextDocumentClosed(e){e.scheme===this.scheme&&this.contentCache.delete(te(e))}updateOpenOrWatchedUris(e){const r=this.providerService.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(c=>ye(o,c))&&(this.implicitlyWatchedUris.delete(i),r.set(i,o));L.debug(`AzDOFS.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${r.size}`);for(const i of e)r.set(te(i),i);const n=[...r.values()].map(i=>({type:m.FileChangeType.Changed,uri:i}));setTimeout(()=>{L.debug(`AzDOFS.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,r){const n=te(e);return this.watchedUris.set(n,e),{dispose:()=>{this.watchedUris.delete(n)}}}async stat(e){const r=te(e);this.implicitlyWatchedUris.set(r,e);const n={uri:e,outdated:!1};try{this.pendingUriRequests.set(`stat:${r}`,n);const i=await this.providerService.getMetadata(e),o=m.FilePermission.Readonly;if(!i.path)return{type:m.FileType.Directory,mtime:0,ctime:0,size:0,permissions:o};if(i.path in this.pathTypeMap||await this.updateWorkspaceItemMap(i,e.path,!0),i.path in this.pathTypeMap)return this.pathTypeMap[i.path]===m.FileType.Directory?{type:m.FileType.Directory,mtime:0,ctime:0,size:0,permissions:o}:{type:m.FileType.File,mtime:0,ctime:0,size:0,permissions:o};if(this.implicitlyWatchedUris.delete(r),e.query!=="~")throw m.FileSystemError.FileNotFound(e);return{type:m.FileType.File,size:0,ctime:0,mtime:Date.now(),permissions:m.FilePermission.Readonly}}finally{this.pendingUriRequests.delete(`stat:${r}`),(n==null?void 0:n.outdated)&&setTimeout(()=>{L.log(`AzDOFS.stat(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:m.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}async updateWorkspaceItemMap(e,r,n){const i=new Array,o=await this.azdo.getRepoItems(e,r,{recursionLevel:"OneLevel"});for(const c of o){const l=c.path.substring(1);if(l!==e.path||n){const d=c.isFolder===!0?m.FileType.Directory:m.FileType.File;this.pathTypeMap[l]=d,i.push([l,d])}}return i}async readDirectory(e){this.implicitlyWatchedUris.set(te(e),e);const r=this.providerService.getVirtualRootUri(e),n=await this.providerService.getMetadata(e);return(await this.updateWorkspaceItemMap(n,e.path,!1)).map(o=>[this.providerService.getRelativeFilePath(e,We(r,o[0])),o[1]])}createDirectory(e){throw m.FileSystemError.NoPermissions()}async readFile(e){var r;const n=te(e);this.implicitlyWatchedUris.set(n,e);let i=this.contentCache.get(n);if(i!==void 0)return i.content;const o={uri:e,outdated:!1};try{return this.pendingUriRequests.set(n,o),i={content:this.azdo.getFileContent(e),uri:e},this.contentCache.set(n,i),await i.content}catch(c){if(this.implicitlyWatchedUris.delete(n),i!==void 0&&i.content===((r=this.contentCache.get(n))==null?void 0:r.content)&&this.contentCache.delete(n),e.query==="~"&&c instanceof m.FileSystemError&&c.code===ao)return new Uint8Array(0);throw c}finally{this.pendingUriRequests.delete(n),(o==null?void 0:o.outdated)&&setTimeout(()=>{L.log(`AzDOFS.readFile(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:m.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}writeFile(e,r,n){throw m.FileSystemError.NoPermissions()}delete(e,r){throw m.FileSystemError.NoPermissions()}rename(e,r,n){throw m.FileSystemError.NoPermissions()}copy(e,r,n){throw m.FileSystemError.NoPermissions()}async provideFileSearchResults(e,{folder:r,maxResults:n,includes:i,excludes:o},c){const l=`${te(r)}|${JSON.stringify({includes:i,excludes:o})}`;let d=this.fileSearchCache.get(l);if(d===void 0){const S=await this.providerService.getMetadata(r),P=await this.azdo.getRepoItems(S,"",{recursionLevel:"Full"});let I=[];for(const O of P)O.isFolder||I.push(O.path);if(I.length===0||c.isCancellationRequested)return[];((i==null?void 0:i.length)||(o==null?void 0:o.length))&&(I=[..._a(I,i,o)]),d=I.map(O=>At.prepareSlow(O)),this.fileSearchCache.set(l,d)}let p;return e.pattern===""?p=d.map(S=>m.Uri.joinPath(r,S.target)):(p=At.go(e.pattern.replace(ai,"/"),d,{allowTypo:!0,limit:n}).map(S=>m.Uri.joinPath(r,S.target)),At.cleanup()),n!==void 0&&n!==0&&n<p.length&&(p=p.slice(0,n)),p}async provideTextSearchResults(e,r,n,i){const o=[];(e.isCaseSensitive||e.isRegExp||e.isWordMatch)&&o.push({text:Ec("azdo flags not supported","Search flags are not supported."),type:m.TextSearchCompleteMessageType.Warning});const c=await this.azdo.searchCodeQuery(e.pattern,r.folder,{maxResults:r.maxResults,context:{before:r.beforeContext,after:r.afterContext}});if(c.warnings&&c.warnings.forEach(d=>{o.push({text:d,type:m.TextSearchCompleteMessageType.Warning})}),c===void 0)return{limitHit:!0,message:o};let l;for(const d of c.matches)l=m.Uri.joinPath(r.folder,d.path),n.report({uri:l,ranges:d.ranges,preview:{text:d.preview,matches:d.matches}});return{limitHit:!1,message:o}}}a(si,"AzDOFS"),wa([Lr()],si.prototype,"stat",1),wa([Lr()],si.prototype,"readDirectory",1),wa([Lr()],si.prototype,"readFile",1);var Dn;(function(t){t[t.Force=0]="Force",t[t.ForceWithLease=1]="ForceWithLease"})(Dn||(Dn={}));var Sn;(function(t){t[t.Head=0]="Head",t[t.RemoteHead=1]="RemoteHead",t[t.Tag=2]="Tag"})(Sn||(Sn={}));var Bi;(function(t){t[t.INDEX_MODIFIED=0]="INDEX_MODIFIED",t[t.INDEX_ADDED=1]="INDEX_ADDED",t[t.INDEX_DELETED=2]="INDEX_DELETED",t[t.INDEX_RENAMED=3]="INDEX_RENAMED",t[t.INDEX_COPIED=4]="INDEX_COPIED",t[t.MODIFIED=5]="MODIFIED",t[t.DELETED=6]="DELETED",t[t.UNTRACKED=7]="UNTRACKED",t[t.IGNORED=8]="IGNORED",t[t.INTENT_TO_ADD=9]="INTENT_TO_ADD",t[t.ADDED_BY_US=10]="ADDED_BY_US",t[t.ADDED_BY_THEM=11]="ADDED_BY_THEM",t[t.DELETED_BY_US=12]="DELETED_BY_US",t[t.DELETED_BY_THEM=13]="DELETED_BY_THEM",t[t.BOTH_ADDED=14]="BOTH_ADDED",t[t.BOTH_DELETED=15]="BOTH_DELETED",t[t.BOTH_MODIFIED=16]="BOTH_MODIFIED"})(Bi||(Bi={}));var kn;(function(t){t.BadConfigFile="BadConfigFile",t.AuthenticationFailed="AuthenticationFailed",t.NoUserNameConfigured="NoUserNameConfigured",t.NoUserEmailConfigured="NoUserEmailConfigured",t.NoRemoteRepositorySpecified="NoRemoteRepositorySpecified",t.NotAGitRepository="NotAGitRepository",t.NotAtRepositoryRoot="NotAtRepositoryRoot",t.Conflict="Conflict",t.StashConflict="StashConflict",t.UnmergedChanges="UnmergedChanges",t.PushRejected="PushRejected",t.RemoteConnectionError="RemoteConnectionError",t.DirtyWorkTree="DirtyWorkTree",t.CantOpenResource="CantOpenResource",t.GitNotFound="GitNotFound",t.CantCreatePipe="CantCreatePipe",t.PermissionDenied="PermissionDenied",t.CantAccessRemote="CantAccessRemote",t.RepositoryNotFound="RepositoryNotFound",t.RepositoryIsLocked="RepositoryIsLocked",t.BranchNotFullyMerged="BranchNotFullyMerged",t.NoRemoteReference="NoRemoteReference",t.InvalidBranchName="InvalidBranchName",t.BranchAlreadyExists="BranchAlreadyExists",t.NoLocalChanges="NoLocalChanges",t.NoStashFound="NoStashFound",t.LocalChangesOverwritten="LocalChangesOverwritten",t.NoUpstreamBranch="NoUpstreamBranch",t.IsInSubmodule="IsInSubmodule",t.WrongCase="WrongCase",t.CantLockRef="CantLockRef",t.CantRebaseMultipleBranches="CantRebaseMultipleBranches",t.PatchDoesNotApply="PatchDoesNotApply",t.NoPathFound="NoPathFound",t.UnknownPath="UnknownPath"})(kn||(kn={}));function xc(t){return Buffer.from(t,"base64")}a(xc,"fromBase64");function xi(t){return Buffer.from(t).toString("base64")}a(xi,"toBase64");var gs=Object.defineProperty,ms=Object.getOwnPropertyDescriptor,Hi=a((t,e,r,n)=>{for(var i=n>1?void 0:n?ms(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&gs(e,r,i),i},"provider_decorateClass");const Ui=/^https?:\/\/dev\.azure\.com(?:\/defaultcollection)?\/(?<organization>[^/]+)(?:\/(?<project>[^_/][^/]*))?(?:\/_git)?\/(?<repo>[^/?#]+)(?:\/commit\/(?<commit>[0-9a-f]{40})|\/pullrequest\/(?<pull>\d+))?/i,so=(0,B.loadMessageBundle)(),ba=1,Bo=Object.freeze({id:"azurerepos",name:"Azure Repos"});function qr(t){const{scheme:e,metadata:r}=Xt.decodeAuthority(t),[,n,i,o,...c]=t.path.split("/");return{scheme:e,provider:Bo,name:`${n}/${i}/${o}`,repo:{organization:n,project:i,name:o},path:c.join("/")||"",ref:r==null?void 0:r.ref,idx:r==null?void 0:r.idx}}a(qr,"getAzDOMetadata");function Ci(t,e){const{repo:r}=e!=null?e:qr(t);return t.with({path:`/${r.organization}/${r.project}/${r.name}`,query:"",fragment:""})}a(Ci,"getAzDORootUri");function Zr(t,e,r){const{repo:{organization:n,name:i}}=t instanceof m.Uri?qr(t):t;return m.Uri.parse(`azurerepos://${Xt.encodeAuthority("azurerepos",{v:ba,ref:{type:et.Commit,id:e}})}/${n}/${i}/${r}`)}a(Zr,"getAzDORevisionUri");class ci{constructor(e){this.providerService=e}get isReadonly(){return!0}get scheme(){return"azurerepos"}dispose(){}async ensureAuthenticated(e=!1){const r=new lt("AzDO.ensureAuthenticated");try{if(this._session===void 0){async function n(){try{return await m.authentication.getSession(Ot.id,qt,{createIfNone:!0,forceNewSession:e})}catch{try{const o=await m.authentication.getSession(Ot.id,qt,{createIfNone:!1});if(o!==void 0)return o}catch{}return new Promise(o=>{async function c(){const d=await m.authentication.getSession(Ot.id,qt,{createIfNone:!0});d!==void 0&&o(d)}a(c,"getSession");const l=m.authentication.onDidChangeSessions(async d=>{d.provider.id===Ot.id&&(l.dispose(),await c())})})}}a(n,"waitUntilAuthenticated"),this._session=await n();const i=m.authentication.onDidChangeSessions(o=>{if(this._session===void 0){i.dispose();return}o.provider.id===Ot.id&&(this.clearAuthenticationSession(),i.dispose())})}return this._session}finally{r.stop()}}async getAuthentication(e){const r=await this.ensureAuthenticated();return{provider:Bo,session:r,getRichNavigationHeaders:()=>({"X-Git-AzureDevOps":`Basic ${this.getBase64AuthenticationSessionToken(r)}`})}}getBase64AuthenticationSessionToken(e){if(this._sessionTokenBase64===void 0){if(e===void 0)return this.ensureAuthenticated().then(r=>(this._sessionTokenBase64=xi(`PAT:${r.accessToken}`),this._sessionTokenBase64));this._sessionTokenBase64=xi(`PAT:${e.accessToken}`)}return this._sessionTokenBase64}clearAuthenticationSession(){this._session=void 0,this._sessionTokenBase64=void 0}async reauthenticate(){this.clearAuthenticationSession(),await this.ensureAuthenticated(!0)}async sendGetRequest(e,r,n,i){const c=`${n?`https://dev.azure.com/${e}/${n}/_apis/`:`https://dev.azure.com/${e}/_apis/`}${r}${i?`?${i}&`:"?"}api-version=5.1`;try{const l=await this.getBase64AuthenticationSessionToken();if(!l)throw new pt("Unauthenticated",()=>this.reauthenticate());const d=await Mt(c,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${l}`}});if(d.status===401)throw new pt("Unauthenticated",()=>this.reauthenticate());if(d.status===404)return;const p=await d.json();return p!=null?p:void 0}catch(l){throw L.error(l),l instanceof pt&&Yr.showStatus401Message(l.reauthenticate),l}}async sendPostRequest(e,r){try{const n=await this.getBase64AuthenticationSessionToken();if(!n)throw new pt("Unauthenticated",()=>this.reauthenticate());const i=await Mt(e,{method:"POST",body:r,headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${n}`}});if(i.status===401)throw new pt("Unauthenticated",()=>this.reauthenticate());const o=await i.json();return o!=null?o:void 0}catch(n){throw L.error(n),n instanceof pt&&Yr.showStatus401Message(n.reauthenticate),n}}canOpenRemoteUrl(e){const r=Ui.exec(e);if((r==null?void 0:r.groups)===void 0)return;const{commit:n}=r.groups;return n?st.Commit:st.Repository}async createWorkspaceForRemoteUrl(e,r=tr.CurrentWindow){const n=Ui.exec(e);if((n==null?void 0:n.groups)===void 0)return;const{organization:i,project:o,repo:c,commit:l}=n.groups;let d;l&&(d={type:et.Commit,id:l});const p=this.providerService.createVirtualUri("azurerepos",{repo:{organization:i,project:o!=null?o:c,name:c},ref:d});return{name:(await this.providerService.getMetadata(p)).name,uri:p,location:r}}createVirtualUri(e,{repo:r,ref:n,idx:i},o){if((n==null?void 0:n.type)===et.Tree)throw new Error(`Invalid ref type '${n.type}'`);const c=n!==void 0||i!==void 0?{v:ba}:void 0;return c&&(n&&(c.ref={type:n.type,id:n.id}),i&&(c.idx=i)),e.with({authority:Xt.encodeAuthority("azurerepos",c),path:`/${r.organization}/${r.project}/${r.name}${(o==null?void 0:o.startsWith("/"))?o:`/${o!=null?o:""}`}`})}getRemoteUri(e){const r=`https://dev.azure.com/${e.repo.organization}/${e.repo.project}/_git/${e.repo.name}`;return e.pullRequest?m.Uri.parse(r):e.branch?m.Uri.parse(`${r}?version=GB${e.branch}`):e.tag?m.Uri.parse(`${r}?version=GT${e.tag}`):e.sha?m.Uri.parse(`${r}/commit/${e.sha}`):m.Uri.parse(r)}getProviderRootUri(e){return Ci(e)}getRelativeFilePath(e,r){const{path:n}=qr(e),{path:i}=qr(We(e,r));return n.length!==0&&i!==n&&i.startsWith(n)?i.slice(n.length+1):i}getVirtualUriMetadata(e){const{provider:r,name:n,repo:i,ref:o}=qr(e);return{provider:r,name:n,repo:i,ref:o}}async validateBranchOrTagCasing(e,r,n,i){const o=`git/repositories/${n}/refs`,c="includeLinks=true",l=await this.sendGetRequest(e,o,r,c);if((l==null?void 0:l.value)===void 0){L.warn("Could not get branches, might be incorrect auth token");return}const d=l.value;if(d.length===0)return i?{type:et.Branch,id:i}:void 0;const p=`refs/heads/${i.toLowerCase()}`,S=`refs/tags/${i.toLowerCase()}`;for(const P of d){const I=P.name;if(I.toLowerCase()==p)return{type:et.Branch,id:I.substr(11)};if(I.toLowerCase()==S)return{type:et.Tag,id:I.substr(10)}}}async getModeRefType(e,r){const{HEAD:n,pullRequest:i}=await(r!=null?r:this.getMetadata(e));switch(n.type){case De.Branch:return i!==void 0?ne.PullRequestBranch:ne.Branch;case De.RemoteBranch:return i!==void 0?ne.PullRequestRemoteBranch:ne.RemoteBranch;case De.Tag:return ne.Tag;case De.Commit:return ne.Commit}}async createMetadata(e,r){var n,i,o,c;const l=new lt(`AzDO.createMetadata(${e.toString()}, ${r})`);let d;try{let{provider:p,name:S,repo:{organization:P,project:I,name:O},ref:F}=qr(e);if(!F||F.type===et.Commit&&/HEAD/i.test(F.id))F={type:et.Commit,id:"HEAD"};else if((F.type===et.Branch||F.type===et.Tag)&&(F=await this.validateBranchOrTagCasing(P,I,O,F.id),F===void 0))throw new Error(`Cannot get metadata for Uri(${e.toString(!0)}); Unable to find the specified branch or tag`);const N=await this.getRepositoryInfo(P,I,O,F);if(N===void 0)throw d=" \u2022 Aborted; Unable to get repository info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository info`);let U;if(r)U=r;else if(F.type===et.Commit)U=F.id;else if(U=(i=(n=N.ref)==null?void 0:n.sha)!=null?i:N.defaultBranch.sha,U===void 0)throw d=" \u2022 Aborted; Unable to get repository revision",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository info`);let W;((o=N.ref)==null?void 0:o.prefix)==="refs/heads/"?W={type:De.Branch,name:N.ref.name,sha:U,branch:{name:N.ref.name,sha:N.ref.sha}}:((c=N.ref)==null?void 0:c.prefix)==="refs/tags/"?W={type:De.Tag,name:N.ref.name,sha:U,detached:{type:De.Tag,name:N.ref.name}}:W={type:De.Commit,name:yt(U),sha:U,detached:{type:De.Commit,name:yt(U)}};const V={version:Ke.schemaVersion,timestamp:Date.now(),provider:p,name:S,repo:N.repo,user:N.user,accessLevel:N.accessLevel,HEAD:W,defaultBranch:N.defaultBranch,pullRequest:N.pullRequest};return d=` \u2022 HEAD=${W.sha}`,V}finally{l.stop(d?{suffix:d}:void 0)}}getMetadata(e){return this.providerService.getMetadata(e)}getRemoteWorkspaceSourceProviders(){return[{name:"Azure Repos",icon:"$(azure-devops)",label:so("open repo from","Open Repository from {0}","Azure Repos"),placeholder:so("pick repo","Choose a repository"),provideOrganization:async()=>{var e;return(e=await this.getOrganization())==null?void 0:e.label},provideProject:async e=>{var r;return(r=await this.getTeamProject(e))==null?void 0:r.label},provideSources:async(e,r,n,i)=>{if(n)return;const o=await this.searchRepositoriesQuery(e,r);return o==null?void 0:o.map(c=>({providerId:"azurerepos",name:c.name,icon:"$(repo)",description:`${c.fork?`$(repo-forked) ${c.fork}`:""}${c.stars>0?`${c.fork?" \u2022 ":""}$(star-full) ${c.stars}`:""}`,detail:c.description,url:c.url}))}}]}async createBranch(e,r,n,i){throw new Error("Branch creation is currently not supported")}async createCommit(e,r,n,i){throw new Error("Commit creation is currently not supported")}async createAndPushCommit(e,r,n,i,o){throw new Error("Commit creation is currently not supported")}async createPullRequest(e,r,n,i,o){throw new Error("PR creation is currently not supported")}async fetch(e,r){const{fetched:n,metadata:i}=await this.fetchCore(e,!1,r);n&&await this.providerService.updateMetadata(e,i)}async fetchCore(e,r,n){var i,o,c,l;const{force:d,to:p}={...n,force:r||(n==null?void 0:n.force)},S=new lt(`AzDO.fetch(${e.toString()}, force=${d}, to=${p})`);let P;try{const I=await this.getMetadata(e);if(I.HEAD.detached)return P=" \u2022 Skipped; detached HEAD",{fetched:!1,metadata:I};if(I.HEAD.type===De.RemoteBranch)return P=" \u2022 Skipped; remote branch",{fetched:!1,metadata:I};const O=await this.getBranchTips(e);if(!O)throw P=" \u2022 Unable to fetch branch tips",new Ct(r);if(!d&&!p&&((i=O.defaultBranch)==null?void 0:i.sha)!==void 0&&O.defaultBranch.sha===I.defaultBranch.sha&&((o=O.branch)==null?void 0:o.sha)!==void 0&&O.branch.sha===I.HEAD.branch.sha)return P=" \u2022 No changes detected",{fetched:!1,metadata:I};let F;if(((c=O.defaultBranch)==null?void 0:c.sha)!==void 0&&O.defaultBranch.sha!==I.defaultBranch.sha&&(F={defaultBranch:{...I.defaultBranch,sha:O.defaultBranch.sha}}),((l=O.branch)==null?void 0:l.sha)===void 0){if(P=" \u2022 Unable to find branch tip",d)throw new Ct(r);return F!==void 0?{fetched:!0,metadata:{...I,...F}}:{fetched:!1,metadata:I}}return O.branch.sha!==I.HEAD.branch.sha&&(F={...F,HEAD:{...I.HEAD,branch:{...I.HEAD.branch,sha:O.branch.sha},detached:void 0}}),O.branch.sha===I.HEAD.sha?(P=" \u2022 Up to date",I.state!==void 0||F!==void 0?{fetched:!0,metadata:{...I,...F,state:void 0}}:{fetched:!1,metadata:I}):F!==void 0?{fetched:!0,metadata:{...I,...F}}:{fetched:!1,metadata:I}}finally{S.stop(P?{suffix:P}:void 0)}}async fork(e){throw new Error("Forks are currently not supported")}async getBranches(e,r){try{const n=await this.getRefs(e,{...r,filter:"heads",filterContains:r==null?void 0:r.query});if(n.length===0)return{branches:[]};const i=[];for(const o of n)!o.name.startsWith("refs/heads/")||i.push({type:Sn.Head,name:o.name.substr(11),commit:o.objectId,commitUrl:o.url});return{branches:i}}catch(n){return{branches:[]}}}async getCommit(e,r){try{const{repo:{organization:n,project:i,name:o}}=await this.getMetadata(e),c=`git/repositories/${o}/commits/${r}`,l=await this.sendGetRequest(n,c,i);return l===void 0?void 0:{hash:l.commitId,message:l.comment,parents:l.parents,authorDate:new Date(l.author.date),authorEmail:l.author.email,authorName:l.author.name,commitDate:new Date(l.committer.date)}}catch(n){return}}async getCommits(e,r){var n,i;try{const{repo:{organization:o,project:c,name:l}}=await this.getMetadata(e),d=`git/repositories/${l}/commits`;let p=`searchCriteria.itemVersion.version=${(n=r==null?void 0:r.cursor)!=null?n:r==null?void 0:r.ref}&searchCriteria.itemVersion.versionType=commit`;(r==null?void 0:r.path)&&(p+=`&searchCriteria.itemPath=${r.path}`);const S=(i=r==null?void 0:r.limit)!=null?i:100;p+=`&searchCriteria.$top=${S+1}`;const P=await this.sendGetRequest(o,d,c,p);if((P==null?void 0:P.value)===void 0)return;const I=P.value.map((F,N)=>({hash:F.commitId,message:F.comment,parents:P.value[N+1]?[P.value[N+1].commitId]:[],authorDate:new Date(F.author.date),authorEmail:F.author.email,authorName:F.author.name,commitDate:new Date(F.committer.date)}));let O;return I.length>S&&(I.splice(I.length-1,1),O={cursor:I[I.length-1].hash,more:!0}),{commits:I,paging:O}}catch(o){return}}async getFileContent(e,r,n){var i,o;try{const{HEAD:c,repo:{organization:l,project:d,id:p},path:S}=await this.providerService.getMetadata(e);n=n!=null?n:S;const P=`git/repositories/${p}/items`;let I="";n&&(I+=`path=${n}&includeContent=true`),r||Ur((i=c.branch)==null?void 0:i.name)?I+=`&versionDescriptor.version=${r!=null?r:(o=c.branch)==null?void 0:o.name}&versionDescriptor.versionType=commit`:c.type===De.Branch?I+=`&versionDescriptor.version=${c.branch.name}&versionDescriptor.versionType=branch`:c.type===De.Tag&&(I+=`&versionDescriptor.version=${c.name}&versionDescriptor.versionType=tag`);const O=await this.sendGetRequest(l,P,d,I);if(O)return new TextEncoder().encode(O.content);throw m.FileSystemError.FileNotFound(e)}catch(c){throw L.logLevel===qe.Debug&&L.error(c),c}}async getFork(e){throw new Error("Forks are currently not supported")}async getIncomingChanges(e){var r,n;return(n=(r=(await this.getMetadata(e)).state)==null?void 0:r.incomingChanges)!=null?n:[]}async compareCommits(e,r){throw new Error("Comparing commits is currently not supported")}async getObjectDetails(e,r,n){throw new Error("Not able to get object detail")}async getPullRequest(e,r){throw new Error("PRs are currently not supported")}async getRepoItems(e,r,n){const i=`git/repositories/${e.repo.name}/items`,[,,,,...o]=r.split("/");let c=`scopePath=${o.join("/")}&recursionLevel=${n.recursionLevel}&includeContentMetadata=true`;e.HEAD.type===De.Commit?c+=`&versionDescriptor.version=${e.HEAD.sha}&versionDescriptor.versionType=commit`:e.HEAD.type===De.Branch?c+=`&versionDescriptor.version=${e.HEAD.branch.name}&versionDescriptor.versionType=branch`:e.HEAD.type===De.Tag&&(c+=`&versionDescriptor.version=${e.HEAD.name}&versionDescriptor.versionType=tag`);const l=await this.sendGetRequest(e.repo.organization,i,e.repo.project,c);return l&&Array.isArray(l==null?void 0:l.value)?l==null?void 0:l.value:(L.debug(`AzDOProvider.getRepoItems returned ${l===void 0?"empty":"invalid"} result ${l==null?void 0:l.value} for path ${r}`),[])}async getTags(e,r){try{const n=await this.getRefs(e,{...r,filter:"tags",filterContains:r==null?void 0:r.query});if(n.length===0)return{tags:[]};const i=[];for(const o of n)!o.name.startsWith("refs/tags/")||i.push({type:Sn.Tag,name:o.name.substr(10),commit:o.objectId,commitUrl:o.url});return{tags:i}}catch(n){return{tags:[]}}}async getTarGz(e,r){throw new Error("Getting zip is currently not supported")}async pushCommit(e,r,n,i){throw new Error("Commit pushing is not currently supported")}async getRefs(e,r){var n;const{repo:{organization:i,project:o,name:c}}=qr(e),l=`git/repositories/${c}/refs`;let d="includeLinks=true";(r==null?void 0:r.filter)&&(d+=`&filter=${r.filter}`),(r==null?void 0:r.filterContains)&&(d+=`&filterContains=${r.filterContains}`),(r==null?void 0:r.limit)&&(d+=`&$top=${r.limit}`);const p=await this.sendGetRequest(i,l,o,d);return(n=p==null?void 0:p.value)!=null?n:[]}async getOrganization(){const e=a(async()=>{const r=await this.getAccounts();return r?r.sort((n,i)=>n.accountName.localeCompare(i.accountName)).map(n=>({label:n.accountName})):[]},"getQuickPickItems");return m.window.showQuickPick(e(),{placeHolder:"Choose an Azure DevOps Organization",title:"Choose an Azure DevOps Organization",ignoreFocusOut:!0})}async getTeamProject(e){const r=a(async()=>{const n=await this.sendGetRequest(e,"projects");return(n==null?void 0:n.value)?n.value.sort((i,o)=>i.name.localeCompare(o.name)).map(i=>({label:i.name,description:i.description})):[]},"getQuickPickItems");return m.window.showQuickPick(r(),{placeholder:"Choose an Azure DevOps project",title:"Choose an Azure DevOps project",ignoreFocusOut:!0})}async searchRepositoriesQuery(e,r){try{const n=await this.sendGetRequest(e,"git/repositories",r);return n?n.value.filter(i=>i.defaultBranch&&!i.isDisabled).sort((i,o)=>i.name.localeCompare(o.name)).map(i=>({name:i.name,description:void 0,url:i.webUrl,fork:void 0,stars:0})):void 0}catch(n){throw L.error(n),n}}async getAccounts(){var e;try{const r=await this.getBase64AuthenticationSessionToken();if(!r)throw new pt("Unauthenticated",()=>this.reauthenticate());const i=`https://app.vssps.visualstudio.com/_apis/accounts?memberId=${(e=this._session)==null?void 0:e.account.id.split("/")[0]}&api-version=6.0`,o=await Mt(i,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${r}`}});if(o.status===401)throw new pt("Unauthenticated",()=>this.reauthenticate());return(await o.json()).value}catch(r){L.error(r);return}}async searchCodeQuery(e,r,n){var i;const{repo:{organization:o,project:c,name:l},HEAD:d,defaultBranch:p}=await this.getMetadata(r),S=`https://almsearch.dev.azure.com/${o}/${c}/_apis/search/codesearchresults?api-version=6.1-preview.1`,P=d.branch?d.branch.name:p.name,I={searchText:e,$skip:0,$top:1e3,filters:{Project:[c],Repository:[l],Path:["/"],Branch:[P]},$orderBy:[{field:"filename",sortOrder:"ASC"}],includeSnippet:!0},O=await this.sendPostRequest(S,JSON.stringify(I)),F=new m.Range(0,0,0,0),N=[];let U;for(const W of(i=O==null?void 0:O.results)!=null?i:[])for(const V of W.matches.content){U={path:W.path,ranges:[],preview:"",matches:[]};const ie=Math.max(0,V.line-1),oe=V.charOffset,ge=oe+V.length;U.preview=V.codeSnippet?V.codeSnippet:`CharOffset: ${V.charOffset}, Type: ${V.type}`,U.ranges.push(new m.Range(ie,oe,ie,ge)),U.matches.push(F),N.push(U)}return{matches:N,limitHit:!1}}async switchTo(e,r,n){const{name:i,repo:o,HEAD:{branch:c}}=await this.getMetadata(e);let l;if(!(r!==void 0&&(typeof r=="string"?r.startsWith("refs/heads/")?l={type:et.Branch,id:r.substr(11)}:r.startsWith("refs/tags/")?l={type:et.Tag,id:r.substr(10)}:l={type:et.Branch,id:r}:l={...r,type:r.type===et.Tree?et.Branch:r.type},(c==null?void 0:c.name)===l.id)))return{name:i,uri:this.providerService.createVirtualUri(e,{repo:o,ref:l}),location:(n==null?void 0:n.openInNewWindow)?tr.NewWindow:tr.CurrentWindow}}async sync(e,r,n){var i,o,c,l,d,p;const S=new lt(`AzDO.sync(${e.toString()}, resolution=${n.conflictResolution}, to=${n.to})`);let P;try{const{metadata:I}=await this.fetchCore(e,!0,{to:n.to});if(I.HEAD.detached){P=" \u2022 Skipped; detached HEAD";return}if(((o=(i=I==null?void 0:I.state)==null?void 0:i.behind)!=null?o:0)>0&&await r.hasChanges(e)){S.logStep("Fetching upstream changes");const O=[],F=(l=(c=I.state)==null?void 0:c.incomingChanges)!=null?l:[];if(F.length>0){const N=await r.getChanges(e);for(const U of N){const W=this.providerService.getRelativeFilePath(e,U.uri),V=F.find(ie=>ie.uri.path===U.uri.path);if(V!==void 0){O.push({path:W,current:U,incomingType:V.type});break}}}if(O.length>0)switch(n.conflictResolution){case an.KeepCurrent:S.logStep("Syncing (keep) upstream changes",{message:`: ${O.length} conflicts; \u2022`,suffix:" \u2022 Syncing (keep) upstream changes..."});for(const N of O)await r.keep(N.current.uri,{type:N.incomingType,providerUri:Zr(I,I.HEAD.branch.sha,N.path)});break;case an.DiscardCurrent:S.logStep("Syncing (discard) upstream changes",{message:`: ${O.length} conflicts; \u2022`,suffix:" \u2022 Syncing (discard) upstream changes..."});for(const N of O)await r.discard(N.current.uri);break;case an.Merge:S.logStep("Syncing (merge) upstream changes",{message:`: ${O.length} conflicts; \u2022`,suffix:" \u2022 Syncing (merge) upstream changes..."});for(const N of O)await r.merge(N.current.uri,{type:N.incomingType,providerUri:Zr(I,I.HEAD.branch.sha,N.path)},{providerUri:Zr(I,I.HEAD.sha,N.path)});break;case an.Abort:default:throw S.logStep("Syncing (abort) upstream changes",{message:`: ${O.length} conflicts; \u2022`,suffix:" \u2022 Syncing (abort) upstream changes..."}),await this.providerService.updateMetadata(e,I),new Ut}}P=` \u2022 to=${(d=n.to)!=null?d:I.HEAD.branch.sha}`,await this.fastForwardTo(e,(p=n.to)!=null?p:I.HEAD.branch.sha,I)}finally{S.stop(P?{suffix:P}:void 0)}}async fastForwardTo(e,r,n){if(n.HEAD.detached)throw new It("Unable to fast-forward; no current branch");n.HEAD.sha===r&&n.state===void 0||(L.log(`Fast forward to ${r}; rootUri=${e.toString()}`),await this.providerService.updateMetadata(e,{...n,HEAD:{...n.HEAD,detached:void 0,sha:r},state:void 0,timestamp:Date.now()}),r!==n.HEAD.branch.sha&&await this.fetchCore(e,!1,{to:r}))}async getBranchTips(e,r){try{const{repo:{organization:n,project:i,name:o},HEAD:{branch:c}}=await this.getMetadata(e);r===void 0?r=c?`heads/${c.name}`:"":r.startsWith("refs/")&&(r=r.slice(5));const l=`git/repositories/${o}/refs`,d=`includeLinks=true&filter=${r}`,p=await this.sendGetRequest(n,l,i,d),S=p==null?void 0:p.value;if(S===[])return;const P={target:{oid:S[0].objectId}},I=`git/repositories/${o}`,O=await this.sendGetRequest(n,I,i);let F=O==null?void 0:O.defaultBranch;F.startsWith("refs/")&&(F=F.slice(5));const N=`git/repositories/${o}/refs`,U=`includeLinks=true&filter=${F}`,W=await this.sendGetRequest(n,N,i,U),V=W==null?void 0:W.value;if(V===[])return;const ie={target:{oid:V[0].objectId}};if(!ie&&!P)return;const oe=ie?{sha:ie.target.oid}:void 0,ge=P?{sha:P.target.oid}:void 0;return{defaultBranch:oe,branch:ge}}catch(n){return}}async getRepositoryId(e,r,n){const i=`git/repositories/${n}`,o=await this.sendGetRequest(e,i,r);if(o){if(o.id)return o.id;throw new Error("Sign in page was returned for repoId. Check the token sent")}throw new Error("Can't get Repo Id")}async getRepositoryInfo(e,r,n,i){const o=await this.getRepositoryId(e,r,n),c=`git/repositories/${o}`,l=await this.sendGetRequest(e,c,r);if(!l)return;l.defaultBranch.startsWith("refs/heads/")&&(l.defaultBranch=l.defaultBranch.substr(11));const d=`git/repositories/${n}/stats/branches`,p=`name=${l.defaultBranch}`,S=await this.sendGetRequest(e,d,r,p);if(!S)return;let P=null;Ur(i.id)&&(P=i.id);const I={user:"jepetty",repo:{organization:e,project:r,name:n,id:o},accessLevel:Ne.Read,defaultBranch:{name:S.name,sha:P||S.commit.commitId}};if(i.type===et.Branch){const O=`git/repositories/${n}/stats/branches`,F=`name=${i.id}`,N=await this.sendGetRequest(e,O,r,F);if(N)return{...I,ref:{name:N.name,sha:N.commit.commitId,prefix:"refs/heads/"}}}else if(i.type===et.Tag){const O=`git/repositories/${o}/items`,F=`versionDescriptor.version=${i.id}&versionDescriptor.versionType=tag`,N=await this.sendGetRequest(e,O,r,F);if(N&&N.value.length===1)return{...I,ref:{name:i.id,sha:N.value[0].commitId,prefix:"refs/tags/"}}}else{if(i.type===et.Commit)return i.id==="HEAD"&&(i.id=l.defaultBranch),{...I,ref:{name:i.id,sha:S.commit.commitId,prefix:"refs/heads/"}};throw new Error("Not supported yet :(")}}}a(ci,"AzDORepositoryProvider"),Hi([nr()],ci.prototype,"ensureAuthenticated",1);class pr{constructor(e,r){this.providerService=e,this.changeStore=r,this.providers=[],this.handledRepositories=new Set,this.services=new Map,this.disposable=m.Disposable.from(e.onDidChangeRepositories(n=>{for(const i of n.added)this.repositoryOpened(i);for(const i of n.removed)this.repositoryClosed(i)}));for(const n of this.providerService.repositories)this.repositoryOpened(n)}dispose(){this.disposable.dispose()}register(e){const r=this.providers.length;return this.providers.push(e),{dispose:()=>this.providers.splice(r,1)}}async repositoryOpened(e){const r=te(e.uri);if(!this.handledRepositories.has(r)){this.handledRepositories.add(r);for(const n of this.providers){const i=await n.createNavigationService(this.providerService,e,this.changeStore);if(i!==void 0){const o=i();this.services.set(r,{service:o});break}}}}repositoryClosed(e){const r=te(e.uri);this.handledRepositories.delete(r);const n=this.services.get(r);n!==void 0&&(n.service.dispose(),this.services.delete(te(e.uri)))}}a(pr,"CodeNavigationServices");/*! (c) Andrea Giammarchi - ISC */var co={};try{(function(t,e){if(new t("q=%2B").get("q")!==e||new t({q:e}).get("q")!==e||new t([["q",e]]).get("q")!==e||new t(`q=
`).toString()!=="q=%0A"||new t({q:" &"}).toString()!=="q=+%26"||new t({q:"%zx"}).toString()!=="q=%25zx")throw t;co.URLSearchParams=t})(URLSearchParams,"+")}catch(t){(function(e,r,n){"use strict";var i=e.create,o=e.defineProperty,c=/[!'\(\)~]|%20|%00/g,l=/%(?![0-9a-fA-F]{2})/g,d=/\+/g,p={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"},S={append:function(V,ie){F(this._ungap,V,ie)},delete:function(V){delete this._ungap[V]},get:function(V){return this.has(V)?this._ungap[V][0]:null},getAll:function(V){return this.has(V)?this._ungap[V].slice(0):[]},has:function(V){return V in this._ungap},set:function(V,ie){this._ungap[V]=[r(ie)]},forEach:function(V,ie){var oe=this;for(var ge in oe._ungap)oe._ungap[ge].forEach(ke,ge);function ke(Re){V.call(ie,Re,r(ge),oe)}a(ke,"invoke")},toJSON:function(){return{}},toString:function(){var V=[];for(var ie in this._ungap)for(var oe=U(ie),ge=0,ke=this._ungap[ie];ge<ke.length;ge++)V.push(oe+"="+U(ke[ge]));return V.join("&")}};for(var P in S)o(I.prototype,P,{configurable:!0,writable:!0,value:S[P]});co.URLSearchParams=I;function I(V){var ie=i(null);switch(o(this,"_ungap",{value:ie}),!0){case!V:break;case typeof V=="string":V.charAt(0)==="?"&&(V=V.slice(1));for(var oe=V.split("&"),ge=0,ke=oe.length;ge<ke;ge++){var Re=oe[ge],Ie=Re.indexOf("=");-1<Ie?F(ie,N(Re.slice(0,Ie)),N(Re.slice(Ie+1))):Re.length&&F(ie,N(Re),"")}break;case n(V):for(var ge=0,ke=V.length;ge<ke;ge++){var Re=V[ge];F(ie,Re[0],Re[1])}break;case"forEach"in V:V.forEach(O,ie);break;default:for(var Ye in V)F(ie,Ye,V[Ye])}}a(I,"URLSearchParams");function O(V,ie){F(this,ie,V)}a(O,"addEach");function F(V,ie,oe){var ge=n(oe)?oe.join(","):oe;ie in V?V[ie].push(ge):V[ie]=[ge]}a(F,"appendTo");function N(V){return decodeURIComponent(V.replace(l,"%25").replace(d," "))}a(N,"decode");function U(V){return encodeURIComponent(V).replace(c,W)}a(U,"encode");function W(V){return p[V]}a(W,"replacer")})(Object,String,Array.isArray)}(function(t){var e=!1;try{e=!!Symbol.iterator}catch(n){}"forEach"in t||(t.forEach=a(function(i,o){var c=this,l=Object.create(null);this.toString().replace(/=[\s\S]*?(?:&|$)/g,"=").split("=").forEach(function(d){!d.length||d in l||(l[d]=c.getAll(d)).forEach(function(p){i.call(o,p,d,c)})})},"forEach")),"keys"in t||(t.keys=a(function(){return r(this,function(i,o){this.push(o)})},"keys")),"values"in t||(t.values=a(function(){return r(this,function(i,o){this.push(i)})},"values")),"entries"in t||(t.entries=a(function(){return r(this,function(i,o){this.push([o,i])})},"entries")),e&&!(Symbol.iterator in t)&&(t[Symbol.iterator]=t.entries),"sort"in t||(t.sort=a(function(){for(var i=this.entries(),o=i.next(),c=o.done,l=[],d=Object.create(null),p,S,P;!c;)P=o.value,S=P[0],l.push(S),S in d||(d[S]=[]),d[S].push(P[1]),o=i.next(),c=o.done;for(l.sort(),p=0;p<l.length;p++)this.delete(l[p]);for(p=0;p<l.length;p++)S=l[p],this.append(S,d[S].shift())},"sort"));function r(n,i){var o=[];return n.forEach(i,o),e?o[Symbol.iterator]():{next:function(){var c=o.shift();return{done:c===void 0,value:c}}}}a(r,"iterator"),function(n){var i=n.defineProperty,o=n.getOwnPropertyDescriptor,c=a(function(P){function I(N,U){t.append.call(this,N,U),N=this.toString(),P.set.call(this._usp,N?"?"+N:"")}a(I,"append");function O(N){t.delete.call(this,N),N=this.toString(),P.set.call(this._usp,N?"?"+N:"")}a(O,"del");function F(N,U){t.set.call(this,N,U),N=this.toString(),P.set.call(this._usp,N?"?"+N:"")}return a(F,"set"),function(N,U){return N.append=I,N.delete=O,N.set=F,i(N,"_usp",{configurable:!0,writable:!0,value:U})}},"createSearchParamsPollute"),l=a(function(P){return function(I,O){return i(I,"_searchParams",{configurable:!0,writable:!0,value:P(O,I)}),O}},"createSearchParamsCreate"),d=a(function(P){var I=P.append;P.append=t.append,URLSearchParams.call(P,P._usp.search.slice(1)),P.append=I},"updateSearchParams"),p=a(function(P,I){if(!(P instanceof I))throw new TypeError("'searchParams' accessed on an object that does not implement interface "+I.name)},"verifySearchParams"),S=a(function(P){var I=P.prototype,O=o(I,"searchParams"),F=o(I,"href"),N=o(I,"search"),U;!O&&N&&N.set&&(U=l(c(N)),n.defineProperties(I,{href:{get:function(){return F.get.call(this)},set:function(W){var V=this._searchParams;F.set.call(this,W),V&&d(V)}},search:{get:function(){return N.get.call(this)},set:function(W){var V=this._searchParams;N.set.call(this,W),V&&d(V)}},searchParams:{get:function(){return p(this,P),this._searchParams||U(this,new URLSearchParams(this.search.slice(1)))},set:function(W){p(this,P),U(this,W)}}}))},"upgradeClass");try{S(HTMLAnchorElement),/^function|object$/.test(typeof URL)&&URL.prototype&&S(URL)}catch(P){}}(Object)})(co.URLSearchParams.prototype,Object);const ji=co.URLSearchParams;var zr=__webpack_require__(6822);const St=(0,B.loadMessageBundle)(),Sa=60,Ea=Sa*60,lo=Ea*24,vs=lo*7,ys=lo*30,Nn=lo*365;function uo(t,e){typeof t!="number"&&(t=t.getTime());const r=Math.round((new Date().getTime()-t)/1e3);if(r<-30)return St("date.fromNow.in","in {0}",uo(new Date().getTime()+r*1e3,{ago:!1,short:e==null?void 0:e.short}));if(r<30)return(e==null?void 0:e.ago)?(e==null?void 0:e.short)?St("date.fromNow.seconds.short.ago","secs ago"):St("date.fromNow.seconds.ago","A few seconds ago"):(e==null?void 0:e.short)?St("date.fromNow.now.short","now"):St("date.fromNow.now","Just now");let n;return r<Sa?(n=r,(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?St("date.fromNow.seconds.singular.short.ago","{0} sec ago",n):St("date.fromNow.seconds.singular.ago","{0} second ago",n):(e==null?void 0:e.short)?St("date.fromNow.seconds.plural.short.ago","{0} secs ago",n):St("date.fromNow.seconds.plural.ago","{0} seconds ago",n):n===1?(e==null?void 0:e.short)?St("date.fromNow.seconds.singular.short","{0} sec",n):St("date.fromNow.seconds.singular","{0} second",n):(e==null?void 0:e.short)?St("date.fromNow.seconds.plural.short","{0} secs",n):St("date.fromNow.seconds.plural","{0} seconds",n)):r<Ea?(n=Math.floor(r/Sa),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?St("date.fromNow.minutes.singular.short.ago","{0} min ago",n):St("date.fromNow.minutes.singular.ago","{0} minute ago",n):(e==null?void 0:e.short)?St("date.fromNow.minutes.plural.short.ago","{0} mins ago",n):St("date.fromNow.minutes.plural.ago","{0} minutes ago",n):n===1?(e==null?void 0:e.short)?St("date.fromNow.minutes.singular.short","{0} min",n):St("date.fromNow.minutes.singular","{0} minute",n):(e==null?void 0:e.short)?St("date.fromNow.minutes.plural.short","{0} mins",n):St("date.fromNow.minutes.plural","{0} minutes",n)):r<lo?(n=Math.floor(r/Ea),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?St("date.fromNow.hours.singular.short.ago","{0} hr ago",n):St("date.fromNow.hours.singular.ago","{0} hour ago",n):(e==null?void 0:e.short)?St("date.fromNow.hours.plural.short.ago","{0} hrs ago",n):St("date.fromNow.hours.plural.ago","{0} hours ago",n):n===1?(e==null?void 0:e.short)?St("date.fromNow.hours.singular.short","{0} hr",n):St("date.fromNow.hours.singular","{0} hour",n):(e==null?void 0:e.short)?St("date.fromNow.hours.plural.short","{0} hrs",n):St("date.fromNow.hours.plural","{0} hours",n)):r<vs?(n=Math.floor(r/lo),(e==null?void 0:e.ago)?n===1?St("date.fromNow.days.singular.ago","{0} day ago",n):St("date.fromNow.days.plural.ago","{0} days ago",n):n===1?St("date.fromNow.days.singular","{0} day",n):St("date.fromNow.days.plural","{0} days",n)):r<ys?(n=Math.floor(r/vs),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?St("date.fromNow.weeks.singular.short.ago","{0} wk ago",n):St("date.fromNow.weeks.singular.ago","{0} week ago",n):(e==null?void 0:e.short)?St("date.fromNow.weeks.plural.short.ago","{0} wks ago",n):St("date.fromNow.weeks.plural.ago","{0} weeks ago",n):n===1?(e==null?void 0:e.short)?St("date.fromNow.weeks.singular.short","{0} wk",n):St("date.fromNow.weeks.singular","{0} week",n):(e==null?void 0:e.short)?St("date.fromNow.weeks.plural.short","{0} wks",n):St("date.fromNow.weeks.plural","{0} weeks",n)):r<Nn?(n=Math.floor(r/ys),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?St("date.fromNow.months.singular.short.ago","{0} mo ago",n):St("date.fromNow.months.singular.ago","{0} month ago",n):(e==null?void 0:e.short)?St("date.fromNow.months.plural.short.ago","{0} mos ago",n):St("date.fromNow.months.plural.ago","{0} months ago",n):n===1?(e==null?void 0:e.short)?St("date.fromNow.months.singular.short","{0} mo",n):St("date.fromNow.months.singular","{0} month",n):(e==null?void 0:e.short)?St("date.fromNow.months.plural.short","{0} mos",n):St("date.fromNow.months.plural","{0} months",n)):(n=Math.floor(r/Nn),(e==null?void 0:e.ago)?n===1?(e==null?void 0:e.short)?St("date.fromNow.years.singular.short.ago","{0} yr ago",n):St("date.fromNow.years.singular.ago","{0} year ago",n):(e==null?void 0:e.short)?St("date.fromNow.years.plural.short.ago","{0} yrs ago",n):St("date.fromNow.years.plural.ago","{0} years ago",n):n===1?(e==null?void 0:e.short)?St("date.fromNow.years.singular.short","{0} yr",n):St("date.fromNow.years.singular","{0} year",n):(e==null?void 0:e.short)?St("date.fromNow.years.plural.short","{0} yrs",n):St("date.fromNow.years.plural","{0} years",n))}a(uo,"fromNow");var _s,Ir;(function(t){t.None=0,t.First=1,t.AsOld=t.First,t.Last=2,t.AsNew=t.Last})(Ir||(Ir={}));class ws{constructor(){this[_s]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,r=Ir.None){const n=this._map.get(e);if(!!n)return r!==Ir.None&&this.touch(n,r),n.value}set(e,r,n=Ir.None){let i=this._map.get(e);if(i)i.value=r,n!==Ir.None&&this.touch(i,n);else{switch(i={key:e,value:r,next:void 0,previous:void 0},n){case Ir.None:this.addItemLast(i);break;case Ir.First:this.addItemFirst(i);break;case Ir.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return Boolean(this.remove(e))}remove(e){const r=this._map.get(e);if(!!r)return this._map.delete(e),this.removeItem(r),this._size--,r.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,r){const n=this._state;let i=this._head;for(;i;){if(r?e.bind(r)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){const e=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:r.key,done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}values(){const e=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:r.value,done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}entries(){const e=this._state;let r=this._head;const n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(r){const i={value:[r.key,r.value],done:!1};return r=r.next,i}return{value:void 0,done:!0}}};return n}[(_s=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let r=this._head,n=this.size;for(;r&&n>e;)this._map.delete(r.key),r=r.next,n--;this._head=r,this._size=n,r&&(r.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const r=e.next,n=e.previous;if(!r||!n)throw new Error("Invalid list");r.previous=n,n.next=r}e.next=void 0,e.previous=void 0,this._state++}touch(e,r){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(r!==Ir.First&&r!==Ir.Last)){if(r===Ir.First){if(e===this._head)return;const n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(r===Ir.Last){if(e===this._tail)return;const n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((r,n)=>{e.push([n,r])}),e}fromJSON(e){this.clear();for(const[r,n]of e)this.set(r,n)}}a(ws,"LinkedMap");class Kn extends ws{constructor(e,r=1){super();this._limit=e,this._ratio=Math.min(Math.max(0,r),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,r=Ir.AsNew){return super.get(e,r)}peek(e){return super.get(e,Ir.None)}set(e,r){return super.set(e,r,Ir.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}a(Kn,"LRUCache");function qi(t,e,r){return new Te(new Ca(t),new Ca(e)).ComputeDiff(r).changes}a(qi,"stringDiff");class Xn{constructor(e,r,n,i){this.originalStart=e,this.originalLength=r,this.modifiedStart=n,this.modifiedLength=i}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}a(Xn,"DiffChange");var bs;(function(t){t[t.MAX_SAFE_SMALL_INTEGER=1073741824]="MAX_SAFE_SMALL_INTEGER",t[t.MIN_SAFE_SMALL_INTEGER=-1073741824]="MIN_SAFE_SMALL_INTEGER",t[t.MAX_UINT_8=255]="MAX_UINT_8",t[t.MAX_UINT_16=65535]="MAX_UINT_16",t[t.MAX_UINT_32=4294967295]="MAX_UINT_32",t[t.UNICODE_SUPPLEMENTARY_PLANE_BEGIN=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"})(bs||(bs={}));function Ss(t,e){return(e<<5)-e+t|0}a(Ss,"numberHash");function xa(t,e){e=Ss(149417,e);for(let r=0,n=t.length;r<n;r++)e=Ss(t.charCodeAt(r),e);return e}a(xa,"stringHash");class Ca{constructor(e){this.source=e}getElements(){const e=this.source,r=new Int32Array(e.length);for(let n=0,i=e.length;n<i;n++)r[n]=e.charCodeAt(n);return r}}a(Ca,"StringDiffSequence");class vn{static Assert(e,r){if(!e)throw new Error(r)}}a(vn,"Debug");class Ti{static Copy(e,r,n,i,o){for(let c=0;c<o;c++)n[i+c]=e[r+c]}static Copy2(e,r,n,i,o){for(let c=0;c<o;c++)n[i+c]=e[r+c]}}a(Ti,"MyArray");var ee;(function(t){t[t.MaxDifferencesHistory=1447]="MaxDifferencesHistory"})(ee||(ee={}));class me{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new Xn(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_originalCount++}AddModifiedElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}a(me,"DiffChangeHelper");class Te{constructor(e,r,n=null){this.ContinueProcessingPredicate=n,this._originalSequence=e,this._modifiedSequence=r;const[i,o,c]=Te._getElements(e),[l,d,p]=Te._getElements(r);this._hasStrings=c&&p,this._originalStringElements=i,this._originalElementsOrHash=o,this._modifiedStringElements=l,this._modifiedElementsOrHash=d,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const r=e.getElements();if(Te._isStringArray(r)){const n=new Int32Array(r.length);for(let i=0,o=r.length;i<o;i++)n[i]=xa(r[i],0);return[r,n,!0]}return r instanceof Int32Array?[[],r,!1]:[[],new Int32Array(r),!1]}ElementsAreEqual(e,r){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[r]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[r]:!0}ElementsAreStrictEqual(e,r){if(!this.ElementsAreEqual(e,r))return!1;const n=Te._getStrictElement(this._originalSequence,e),i=Te._getStrictElement(this._modifiedSequence,r);return n===i}static _getStrictElement(e,r){return typeof e.getStrictElement=="function"?e.getStrictElement(r):null}OriginalElementsAreEqual(e,r){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[r]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[r]:!0}ModifiedElementsAreEqual(e,r){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[r]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[r]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,r,n,i,o){const c=[!1];let l=this.ComputeDiffRecursive(e,r,n,i,c);return o&&(l=this.PrettifyChanges(l)),{quitEarly:c[0],changes:l}}ComputeDiffRecursive(e,r,n,i,o){for(o[0]=!1;e<=r&&n<=i&&this.ElementsAreEqual(e,n);)e++,n++;for(;r>=e&&i>=n&&this.ElementsAreEqual(r,i);)r--,i--;if(e>r||n>i){let P;return n<=i?(vn.Assert(e===r+1,"originalStart should only be one more than originalEnd"),P=[new Xn(e,0,n,i-n+1)]):e<=r?(vn.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),P=[new Xn(e,r-e+1,n,0)]):(vn.Assert(e===r+1,"originalStart should only be one more than originalEnd"),vn.Assert(n===i+1,"modifiedStart should only be one more than modifiedEnd"),P=[]),P}const c=[0],l=[0],d=this.ComputeRecursionPoint(e,r,n,i,c,l,o),p=c[0],S=l[0];if(d!==null)return d;if(!o[0]){const P=this.ComputeDiffRecursive(e,p,n,S,o);let I=[];return o[0]?I=[new Xn(p+1,r-(p+1)+1,S+1,i-(S+1)+1)]:I=this.ComputeDiffRecursive(p+1,r,S+1,i,o),this.ConcatenateChanges(P,I)}return[new Xn(e,r-e+1,n,i-n+1)]}WALKTRACE(e,r,n,i,o,c,l,d,p,S,P,I,O,F,N,U,W,V){let ie=null,oe=null,ge=new me,ke=r,Re=n,Ie=O[0]-U[0]-i,Ye=-1073741824,$e=this.m_forwardHistory.length-1;do{const ze=Ie+e;ze===ke||ze<Re&&p[ze-1]<p[ze+1]?(P=p[ze+1],F=P-Ie-i,P<Ye&&ge.MarkNextChange(),Ye=P,ge.AddModifiedElement(P+1,F),Ie=ze+1-e):(P=p[ze-1]+1,F=P-Ie-i,P<Ye&&ge.MarkNextChange(),Ye=P-1,ge.AddOriginalElement(P,F+1),Ie=ze-1-e),$e>=0&&(p=this.m_forwardHistory[$e],e=p[0],ke=1,Re=p.length-1)}while(--$e>=-1);if(ie=ge.getReverseChanges(),V[0]){let ze=O[0]+1,at=U[0]+1;if(ie!==null&&ie.length>0){const kt=ie[ie.length-1];ze=Math.max(ze,kt.getOriginalEnd()),at=Math.max(at,kt.getModifiedEnd())}oe=[new Xn(ze,I-ze+1,at,N-at+1)]}else{ge=new me,ke=c,Re=l,Ie=O[0]-U[0]-d,Ye=1073741824,$e=W?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const ze=Ie+o;ze===ke||ze<Re&&S[ze-1]>=S[ze+1]?(P=S[ze+1]-1,F=P-Ie-d,P>Ye&&ge.MarkNextChange(),Ye=P+1,ge.AddOriginalElement(P+1,F+1),Ie=ze+1-o):(P=S[ze-1],F=P-Ie-d,P>Ye&&ge.MarkNextChange(),Ye=P,ge.AddModifiedElement(P+1,F+1),Ie=ze-1-o),$e>=0&&(S=this.m_reverseHistory[$e],o=S[0],ke=1,Re=S.length-1)}while(--$e>=-1);oe=ge.getChanges()}return this.ConcatenateChanges(ie,oe)}ComputeRecursionPoint(e,r,n,i,o,c,l){let d=0,p=0,S=0,P=0,I=0,O=0;e--,n--,o[0]=0,c[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const F=r-e+(i-n),N=F+1,U=new Int32Array(N),W=new Int32Array(N),V=i-n,ie=r-e,oe=e-n,ge=r-i,Re=(ie-V)%2==0;U[V]=e,W[ie]=r,l[0]=!1;for(let Ie=1;Ie<=F/2+1;Ie++){let Ye=0,$e=0;S=this.ClipDiagonalBound(V-Ie,Ie,V,N),P=this.ClipDiagonalBound(V+Ie,Ie,V,N);for(let at=S;at<=P;at+=2){at===S||at<P&&U[at-1]<U[at+1]?d=U[at+1]:d=U[at-1]+1,p=d-(at-V)-oe;const kt=d;for(;d<r&&p<i&&this.ElementsAreEqual(d+1,p+1);)d++,p++;if(U[at]=d,d+p>Ye+$e&&(Ye=d,$e=p),!Re&&Math.abs(at-ie)<=Ie-1&&d>=W[at])return o[0]=d,c[0]=p,kt<=W[at]&&1447>0&&Ie<=1447+1?this.WALKTRACE(V,S,P,oe,ie,I,O,ge,U,W,d,r,o,p,i,c,Re,l):null}const ze=(Ye-e+($e-n)-Ie)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(Ye,ze))return l[0]=!0,o[0]=Ye,c[0]=$e,ze>0&&1447>0&&Ie<=1447+1?this.WALKTRACE(V,S,P,oe,ie,I,O,ge,U,W,d,r,o,p,i,c,Re,l):(e++,n++,[new Xn(e,r-e+1,n,i-n+1)]);I=this.ClipDiagonalBound(ie-Ie,Ie,ie,N),O=this.ClipDiagonalBound(ie+Ie,Ie,ie,N);for(let at=I;at<=O;at+=2){at===I||at<O&&W[at-1]>=W[at+1]?d=W[at+1]-1:d=W[at-1],p=d-(at-ie)-ge;const kt=d;for(;d>e&&p>n&&this.ElementsAreEqual(d,p);)d--,p--;if(W[at]=d,Re&&Math.abs(at-V)<=Ie&&d<=U[at])return o[0]=d,c[0]=p,kt>=U[at]&&1447>0&&Ie<=1447+1?this.WALKTRACE(V,S,P,oe,ie,I,O,ge,U,W,d,r,o,p,i,c,Re,l):null}if(Ie<=1447){let at=new Int32Array(P-S+2);at[0]=V-S+1,Ti.Copy2(U,S,at,1,P-S+1),this.m_forwardHistory.push(at),at=new Int32Array(O-I+2),at[0]=ie-I+1,Ti.Copy2(W,I,at,1,O-I+1),this.m_reverseHistory.push(at)}}return this.WALKTRACE(V,S,P,oe,ie,I,O,ge,U,W,d,r,o,p,i,c,Re,l)}PrettifyChanges(e){for(let r=0;r<e.length;r++){const n=e[r],i=r<e.length-1?e[r+1].originalStart:this._originalElementsOrHash.length,o=r<e.length-1?e[r+1].modifiedStart:this._modifiedElementsOrHash.length,c=n.originalLength>0,l=n.modifiedLength>0;for(;n.originalStart+n.originalLength<i&&n.modifiedStart+n.modifiedLength<o&&(!c||this.OriginalElementsAreEqual(n.originalStart,n.originalStart+n.originalLength))&&(!l||this.ModifiedElementsAreEqual(n.modifiedStart,n.modifiedStart+n.modifiedLength));){const p=this.ElementsAreStrictEqual(n.originalStart,n.modifiedStart);if(this.ElementsAreStrictEqual(n.originalStart+n.originalLength,n.modifiedStart+n.modifiedLength)&&!p)break;n.originalStart++,n.modifiedStart++}let d=[null];if(r<e.length-1&&this.ChangesOverlap(e[r],e[r+1],d)){e[r]=d[0],e.splice(r+1,1),r--;continue}}for(let r=e.length-1;r>=0;r--){const n=e[r];let i=0,o=0;if(r>0){const P=e[r-1];i=P.originalStart+P.originalLength,o=P.modifiedStart+P.modifiedLength}const c=n.originalLength>0,l=n.modifiedLength>0;let d=0,p=this._boundaryScore(n.originalStart,n.originalLength,n.modifiedStart,n.modifiedLength);for(let P=1;;P++){const I=n.originalStart-P,O=n.modifiedStart-P;if(I<i||O<o||c&&!this.OriginalElementsAreEqual(I,I+n.originalLength)||l&&!this.ModifiedElementsAreEqual(O,O+n.modifiedLength))break;const N=(I===i&&O===o?5:0)+this._boundaryScore(I,n.originalLength,O,n.modifiedLength);N>p&&(p=N,d=P)}n.originalStart-=d,n.modifiedStart-=d;const S=[null];if(r>0&&this.ChangesOverlap(e[r-1],e[r],S)){e[r-1]=S[0],e.splice(r,1),r++;continue}}if(this._hasStrings)for(let r=1,n=e.length;r<n;r++){const i=e[r-1],o=e[r],c=o.originalStart-i.originalStart-i.originalLength,l=i.originalStart,d=o.originalStart+o.originalLength,p=d-l,S=i.modifiedStart,P=o.modifiedStart+o.modifiedLength,I=P-S;if(c<5&&p<20&&I<20){const O=this._findBetterContiguousSequence(l,p,S,I,c);if(O){const[F,N]=O;(F!==i.originalStart+i.originalLength||N!==i.modifiedStart+i.modifiedLength)&&(i.originalLength=F-i.originalStart,i.modifiedLength=N-i.modifiedStart,o.originalStart=F+c,o.modifiedStart=N+c,o.originalLength=d-o.originalStart,o.modifiedLength=P-o.modifiedStart)}}}return e}_findBetterContiguousSequence(e,r,n,i,o){if(r<o||i<o)return null;const c=e+r-o+1,l=n+i-o+1;let d=0,p=0,S=0;for(let P=e;P<c;P++)for(let I=n;I<l;I++){const O=this._contiguousSequenceScore(P,I,o);O>0&&O>d&&(d=O,p=P,S=I)}return d>0?[p,S]:null}_contiguousSequenceScore(e,r,n){let i=0;for(let o=0;o<n;o++){if(!this.ElementsAreEqual(e+o,r+o))return 0;i+=this._originalStringElements[e+o].length}return i}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,r){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(r>0){const n=e+r;if(this._OriginalIsBoundary(n-1)||this._OriginalIsBoundary(n))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,r){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(r>0){const n=e+r;if(this._ModifiedIsBoundary(n-1)||this._ModifiedIsBoundary(n))return!0}return!1}_boundaryScore(e,r,n,i){const o=this._OriginalRegionIsBoundary(e,r)?1:0,c=this._ModifiedRegionIsBoundary(n,i)?1:0;return o+c}ConcatenateChanges(e,r){let n=[];if(e.length===0||r.length===0)return r.length>0?r:e;if(this.ChangesOverlap(e[e.length-1],r[0],n)){const i=new Array(e.length+r.length-1);return Ti.Copy(e,0,i,0,e.length-1),i[e.length-1]=n[0],Ti.Copy(r,1,i,e.length,r.length-1),i}else{const i=new Array(e.length+r.length);return Ti.Copy(e,0,i,0,e.length),Ti.Copy(r,0,i,e.length,r.length),i}}ChangesOverlap(e,r,n){if(vn.Assert(e.originalStart<=r.originalStart,"Left change is not less than or equal to right change"),vn.Assert(e.modifiedStart<=r.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=r.originalStart||e.modifiedStart+e.modifiedLength>=r.modifiedStart){const i=e.originalStart;let o=e.originalLength;const c=e.modifiedStart;let l=e.modifiedLength;return e.originalStart+e.originalLength>=r.originalStart&&(o=r.originalStart+r.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=r.modifiedStart&&(l=r.modifiedStart+r.modifiedLength-e.modifiedStart),n[0]=new Xn(i,o,c,l),!0}else return n[0]=null,!1}ClipDiagonalBound(e,r,n,i){if(e>=0&&e<i)return e;const o=n,c=i-n-1,l=r%2==0;if(e<0){const d=o%2==0;return l===d?0:1}else{const d=c%2==0;return l===d?i-1:i-2}}}a(Te,"LcsDiff");var rt;(function(t){function e(n,i){return n instanceof Ft?i:new m.Position(i.line,i.character)}a(e,"makePosition"),t.makePosition=e;function r(n,i){return n instanceof Ft?i:new m.Range(i.start.line,i.start.character,i.end.line,i.end.character)}a(r,"makeRange"),t.makeRange=r})(rt||(rt={}));var ct;(function(t){t[t.index2code=1]="index2code",t[t.code2Index=2]="code2Index"})(ct||(ct={}));const _t=a(class{constructor(t,e,r,n){this.diffCache=new Kn(32),this.indexDocumentCache=new Kn(32),this.codeDocumentCache=new Kn(32),this.providerService=t,this.rootUri=e,this.index=r,this.code=n,this.changes=this.computeChanges()}async computeChanges(){if(this.index===this.code)return new Map;const t=await this.providerService.compareCommits(this.rootUri,{base:this.index,compare:this.code});return t===void 0?new Map:new Map(t.map(e=>[e.uri.toString(),e.type]))}async needsMapping(t){const e=t.uri;if(!e.toString().startsWith(this.rootUri.toString()))return!1;if((await this.changes).get(e.toString())!==void 0)return!0;const i=await this.getIndexDocument(e);return i===void 0?!0:this.getDiff(1,i,t).length!==0}async mapPositionFromCodeToIndex(t,e){const r=t.uri;if(!r.toString().startsWith(this.rootUri.toString()))return;const i=(await this.changes).get(r.toString());if(i===Dt.Created||i===Dt.Deleted)return;const o=await this.getIndexDocument(r);if(o===void 0)return;const c=this.getDiff(2,o,t);if(c.length===0)return e;const l=t.offsetAt(new m.Position(e.line,e.character));let d=l;for(const I of c){if(I.modifiedStart<=l&&l<I.modifiedStart+I.modifiedLength)return;if(d<I.modifiedStart)break;d=d-(I.modifiedLength-I.originalLength)}const p=o.positionAt(d),S=this.getWordAtOffset(o.lineAt(p.line).text,p.character),P=this.getWordAtOffset(t.lineAt(e.line).text,e.character);if(!(S===void 0||P===void 0||S!==P))return new m.Position(p.line,p.character)}async mapRangeFromIndexToCode(t,e){const r=t instanceof m.Uri?t:t.uri;if(!r.toString().startsWith(this.rootUri.toString()))return;const i=(await this.changes).get(r.toString());if(i===Dt.Created||i===Dt.Deleted)return;const[o,c]=await Promise.all([this.getIndexDocument(r),this.getCodeDocument(t)]);if(o===void 0||c===void 0)return;const l=this.getDiff(1,o,c);if(l.length===0)return e;const d=o.offsetAt(e.start);let p=d;const S=o.offsetAt(e.end);let P=S;for(const U of l){if(P<U.originalStart)break;const W=U.modifiedLength-U.originalLength;if(U.originalStart<=d){if(d<U.originalStart+U.originalLength)return;p+=W}else if(S<U.originalStart+U.originalLength)return;if(U.originalStart<=S){if(S<U.originalStart+U.originalLength)return;P+=W}}const I=c.positionAt(p),O=c.positionAt(P),F=o.getText(e),N=c.getText(rt.makeRange(c,{start:I,end:O}));if(F===N)return new m.Range(I.line,I.character,O.line,O.character)}async getIndexDocument(t){return this.getDocument(this.indexDocumentCache,t,this.index)}async getCodeDocument(t){return t instanceof m.Uri?this.getDocument(this.codeDocumentCache,t,this.code):t}async getDocument(t,e,r){let n=t.get(e.toString());if(n!==null)return n!==void 0||(n=this._getDocument(e,r),t.set(e.toString(),n),n.then(i=>{i===void 0&&t.set(e.toString(),null)},void 0)),n}async _getDocument(t,e){const r=t.toString().substr(this.rootUri.toString().length);return this.providerService.getFileContent(this.rootUri,e,r).then(n=>new Ft(t,Number.MAX_VALUE,_t.textDecoder.decode(n)),()=>{})}getDiff(t,e,r){if(e.uri.toString()!==r.uri.toString())throw new Error(`Original (${e.uri.toString()}) and modified (${r.uri.toString()}) are pointing to a different document`);const n=`${t}${e.uri.toString()}`;let i=this.diffCache.get(n);return i!==void 0&&i.original===e.version&&i.modified===r.version||(i={original:e.version,modified:r.version,changes:qi(e.getText(),r.getText(),!0)},this.diffCache.set(n,i)),i.changes}getWordAtOffset(t,e){let r="findStart",n=0,i=t.length,o=0;for(;o<t.length&&r!=="endFound";){switch(o===e&&(r="findEnd"),t[o]){case" ":case"	":case"(":case")":case"[":case"]":case"{":case"}":case"'":case'"':case"`":switch(r){case"findStart":n=o+1;break;case"findEnd":i=o,r="endFound";break}break}o++}return r==="endFound"?t.substring(n,i):void 0}},"_DiffMapper");let Et=_t;Et.textDecoder=new TextDecoder("utf8");var zt;(function(t){t[t.LineFeed=10]="LineFeed",t[t.CarriageReturn=13]="CarriageReturn"})(zt||(zt={}));class Ft{static computeLineOffsets(e,r,n=0){const i=r?[n]:[];for(let o=0;o<e.length;o++){const c=e.charCodeAt(o);(c===13||c===10)&&(c===13&&o+1<e.length&&e.charCodeAt(o+1)===10&&o++,i.push(n+o+1))}return i}constructor(e,r,n){this._content=n,this.uri=e,this.version=r,this._lineOffsets=void 0}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=Ft.computeLineOffsets(this._content,!0)),this._lineOffsets}getText(e){if(e){const r=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(r,n)}return this._content}lineAt(e){const r=this.getLineOffsets();if(e>=r.length)return{lineNumber:e,text:""};const n=r[e],i=r[e+1];if(i===void 0)return{lineNumber:e,text:this._content.substring(n)};const o=this._content.substring(n,i);let c=o.length-1;for(;c>=0&&(o[c]===`
`||o[c]==="\r");)c--;return{lineNumber:e,text:o.substr(0,c+1)}}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);const r=this.getLineOffsets();let n=0,i=r.length;if(i===0)return{line:0,character:e};for(;n<i;){const c=Math.floor((n+i)/2);r[c]>e?i=c:n=c+1}const o=n-1;return{line:o,character:e-r[o]}}offsetAt(e){const r=this.getLineOffsets();if(e.line>=r.length)return this._content.length;if(e.line<0)return 0;const n=r[e.line],i=e.line+1<r.length?r[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)}get lineCount(){return this.getLineOffsets().length}}a(Ft,"TextDocument");var En;(function(t){t.MIN_VALUE=-2147483648,t.MAX_VALUE=2147483647})(En||(En={}));var Br;(function(t){t.MIN_VALUE=0,t.MAX_VALUE=2147483647})(Br||(Br={}));var _r;(function(t){function e(n,i){return n===Number.MAX_VALUE&&(n=Br.MAX_VALUE),i===Number.MAX_VALUE&&(i=Br.MAX_VALUE),{line:n,character:i}}a(e,"create"),t.create=e;function r(n){var i=n;return Le.objectLiteral(i)&&Le.uinteger(i.line)&&Le.uinteger(i.character)}a(r,"is"),t.is=r})(_r||(_r={}));var rr;(function(t){function e(n,i,o,c){if(Le.uinteger(n)&&Le.uinteger(i)&&Le.uinteger(o)&&Le.uinteger(c))return{start:_r.create(n,i),end:_r.create(o,c)};if(_r.is(n)&&_r.is(i))return{start:n,end:i};throw new Error("Range#create called with invalid arguments["+n+", "+i+", "+o+", "+c+"]")}a(e,"create"),t.create=e;function r(n){var i=n;return Le.objectLiteral(i)&&_r.is(i.start)&&_r.is(i.end)}a(r,"is"),t.is=r})(rr||(rr={}));var Mn;(function(t){function e(n,i){return{uri:n,range:i}}a(e,"create"),t.create=e;function r(n){var i=n;return Le.defined(i)&&rr.is(i.range)&&(Le.string(i.uri)||Le.undefined(i.uri))}a(r,"is"),t.is=r})(Mn||(Mn={}));var Es;(function(t){function e(n,i,o,c){return{targetUri:n,targetRange:i,targetSelectionRange:o,originSelectionRange:c}}a(e,"create"),t.create=e;function r(n){var i=n;return Le.defined(i)&&rr.is(i.targetRange)&&Le.string(i.targetUri)&&(rr.is(i.targetSelectionRange)||Le.undefined(i.targetSelectionRange))&&(rr.is(i.originSelectionRange)||Le.undefined(i.originSelectionRange))}a(r,"is"),t.is=r})(Es||(Es={}));var xs;(function(t){function e(n,i,o,c){return{red:n,green:i,blue:o,alpha:c}}a(e,"create"),t.create=e;function r(n){var i=n;return Le.numberRange(i.red,0,1)&&Le.numberRange(i.green,0,1)&&Le.numberRange(i.blue,0,1)&&Le.numberRange(i.alpha,0,1)}a(r,"is"),t.is=r})(xs||(xs={}));var Ol;(function(t){function e(n,i){return{range:n,color:i}}a(e,"create"),t.create=e;function r(n){var i=n;return rr.is(i.range)&&xs.is(i.color)}a(r,"is"),t.is=r})(Ol||(Ol={}));var Pl;(function(t){function e(n,i,o){return{label:n,textEdit:i,additionalTextEdits:o}}a(e,"create"),t.create=e;function r(n){var i=n;return Le.string(i.label)&&(Le.undefined(i.textEdit)||Qn.is(i))&&(Le.undefined(i.additionalTextEdits)||Le.typedArray(i.additionalTextEdits,Qn.is))}a(r,"is"),t.is=r})(Pl||(Pl={}));var Ta;(function(t){t.Comment="comment",t.Imports="imports",t.Region="region"})(Ta||(Ta={}));var Dl;(function(t){function e(n,i,o,c,l){var d={startLine:n,endLine:i};return Le.defined(o)&&(d.startCharacter=o),Le.defined(c)&&(d.endCharacter=c),Le.defined(l)&&(d.kind=l),d}a(e,"create"),t.create=e;function r(n){var i=n;return Le.uinteger(i.startLine)&&Le.uinteger(i.startLine)&&(Le.undefined(i.startCharacter)||Le.uinteger(i.startCharacter))&&(Le.undefined(i.endCharacter)||Le.uinteger(i.endCharacter))&&(Le.undefined(i.kind)||Le.string(i.kind))}a(r,"is"),t.is=r})(Dl||(Dl={}));var Cc;(function(t){function e(n,i){return{location:n,message:i}}a(e,"create"),t.create=e;function r(n){var i=n;return Le.defined(i)&&Mn.is(i.location)&&Le.string(i.message)}a(r,"is"),t.is=r})(Cc||(Cc={}));var Ho;(function(t){t.Error=1,t.Warning=2,t.Information=3,t.Hint=4})(Ho||(Ho={}));var Cs;(function(t){t.Unnecessary=1,t.Deprecated=2})(Cs||(Cs={}));var Tc;(function(t){function e(r){var n=r;return n!=null&&Le.string(n.href)}a(e,"is"),t.is=e})(Tc||(Tc={}));var Ts;(function(t){function e(n,i,o,c,l,d){var p={range:n,message:i};return Le.defined(o)&&(p.severity=o),Le.defined(c)&&(p.code=c),Le.defined(l)&&(p.source=l),Le.defined(d)&&(p.relatedInformation=d),p}a(e,"create"),t.create=e;function r(n){var i,o=n;return Le.defined(o)&&rr.is(o.range)&&Le.string(o.message)&&(Le.number(o.severity)||Le.undefined(o.severity))&&(Le.integer(o.code)||Le.string(o.code)||Le.undefined(o.code))&&(Le.undefined(o.codeDescription)||Le.string((i=o.codeDescription)===null||i===void 0?void 0:i.href))&&(Le.string(o.source)||Le.undefined(o.source))&&(Le.undefined(o.relatedInformation)||Le.typedArray(o.relatedInformation,Cc.is))}a(r,"is"),t.is=r})(Ts||(Ts={}));var Aa;(function(t){function e(n,i){for(var o=[],c=2;c<arguments.length;c++)o[c-2]=arguments[c];var l={title:n,command:i};return Le.defined(o)&&o.length>0&&(l.arguments=o),l}a(e,"create"),t.create=e;function r(n){var i=n;return Le.defined(i)&&Le.string(i.title)&&Le.string(i.command)}a(r,"is"),t.is=r})(Aa||(Aa={}));var Qn;(function(t){function e(o,c){return{range:o,newText:c}}a(e,"replace"),t.replace=e;function r(o,c){return{range:{start:o,end:o},newText:c}}a(r,"insert"),t.insert=r;function n(o){return{range:o,newText:""}}a(n,"del"),t.del=n;function i(o){var c=o;return Le.objectLiteral(c)&&Le.string(c.newText)&&rr.is(c.range)}a(i,"is"),t.is=i})(Qn||(Qn={}));var zi;(function(t){function e(n,i,o){var c={label:n};return i!==void 0&&(c.needsConfirmation=i),o!==void 0&&(c.description=o),c}a(e,"create"),t.create=e;function r(n){var i=n;return i!==void 0&&Le.objectLiteral(i)&&Le.string(i.label)&&(Le.boolean(i.needsConfirmation)||i.needsConfirmation===void 0)&&(Le.string(i.description)||i.description===void 0)}a(r,"is"),t.is=r})(zi||(zi={}));var Jr;(function(t){function e(r){var n=r;return typeof n=="string"}a(e,"is"),t.is=e})(Jr||(Jr={}));var Wi;(function(t){function e(o,c,l){return{range:o,newText:c,annotationId:l}}a(e,"replace"),t.replace=e;function r(o,c,l){return{range:{start:o,end:o},newText:c,annotationId:l}}a(r,"insert"),t.insert=r;function n(o,c){return{range:o,newText:"",annotationId:c}}a(n,"del"),t.del=n;function i(o){var c=o;return Qn.is(c)&&(zi.is(c.annotationId)||Jr.is(c.annotationId))}a(i,"is"),t.is=i})(Wi||(Wi={}));var Uo;(function(t){function e(n,i){return{textDocument:n,edits:i}}a(e,"create"),t.create=e;function r(n){var i=n;return Le.defined(i)&&Os.is(i.textDocument)&&Array.isArray(i.edits)}a(r,"is"),t.is=r})(Uo||(Uo={}));var jo;(function(t){function e(n,i,o){var c={kind:"create",uri:n};return i!==void 0&&(i.overwrite!==void 0||i.ignoreIfExists!==void 0)&&(c.options=i),o!==void 0&&(c.annotationId=o),c}a(e,"create"),t.create=e;function r(n){var i=n;return i&&i.kind==="create"&&Le.string(i.uri)&&(i.options===void 0||(i.options.overwrite===void 0||Le.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||Le.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Jr.is(i.annotationId))}a(r,"is"),t.is=r})(jo||(jo={}));var qo;(function(t){function e(n,i,o,c){var l={kind:"rename",oldUri:n,newUri:i};return o!==void 0&&(o.overwrite!==void 0||o.ignoreIfExists!==void 0)&&(l.options=o),c!==void 0&&(l.annotationId=c),l}a(e,"create"),t.create=e;function r(n){var i=n;return i&&i.kind==="rename"&&Le.string(i.oldUri)&&Le.string(i.newUri)&&(i.options===void 0||(i.options.overwrite===void 0||Le.boolean(i.options.overwrite))&&(i.options.ignoreIfExists===void 0||Le.boolean(i.options.ignoreIfExists)))&&(i.annotationId===void 0||Jr.is(i.annotationId))}a(r,"is"),t.is=r})(qo||(qo={}));var zo;(function(t){function e(n,i,o){var c={kind:"delete",uri:n};return i!==void 0&&(i.recursive!==void 0||i.ignoreIfNotExists!==void 0)&&(c.options=i),o!==void 0&&(c.annotationId=o),c}a(e,"create"),t.create=e;function r(n){var i=n;return i&&i.kind==="delete"&&Le.string(i.uri)&&(i.options===void 0||(i.options.recursive===void 0||Le.boolean(i.options.recursive))&&(i.options.ignoreIfNotExists===void 0||Le.boolean(i.options.ignoreIfNotExists)))&&(i.annotationId===void 0||Jr.is(i.annotationId))}a(r,"is"),t.is=r})(zo||(zo={}));var As;(function(t){function e(r){var n=r;return n&&(n.changes!==void 0||n.documentChanges!==void 0)&&(n.documentChanges===void 0||n.documentChanges.every(function(i){return Le.string(i.kind)?jo.is(i)||qo.is(i)||zo.is(i):Uo.is(i)}))}a(e,"is"),t.is=e})(As||(As={}));var Rs=function(){function t(e,r){this.edits=e,this.changeAnnotations=r}return a(t,"TextEditChangeImpl"),t.prototype.insert=function(e,r,n){var i,o;if(n===void 0?i=Qn.insert(e,r):Jr.is(n)?(o=n,i=Wi.insert(e,r,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=Wi.insert(e,r,o)),this.edits.push(i),o!==void 0)return o},t.prototype.replace=function(e,r,n){var i,o;if(n===void 0?i=Qn.replace(e,r):Jr.is(n)?(o=n,i=Wi.replace(e,r,n)):(this.assertChangeAnnotations(this.changeAnnotations),o=this.changeAnnotations.manage(n),i=Wi.replace(e,r,o)),this.edits.push(i),o!==void 0)return o},t.prototype.delete=function(e,r){var n,i;if(r===void 0?n=Qn.del(e):Jr.is(r)?(i=r,n=Wi.del(e,r)):(this.assertChangeAnnotations(this.changeAnnotations),i=this.changeAnnotations.manage(r),n=Wi.del(e,i)),this.edits.push(n),i!==void 0)return i},t.prototype.add=function(e){this.edits.push(e)},t.prototype.all=function(){return this.edits},t.prototype.clear=function(){this.edits.splice(0,this.edits.length)},t.prototype.assertChangeAnnotations=function(e){if(e===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},t}(),kl=function(){function t(e){this._annotations=e===void 0?Object.create(null):e,this._counter=0,this._size=0}return a(t,"ChangeAnnotations"),t.prototype.all=function(){return this._annotations},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),t.prototype.manage=function(e,r){var n;if(Jr.is(e)?n=e:(n=this.nextId(),r=e),this._annotations[n]!==void 0)throw new Error("Id "+n+" is already in use.");if(r===void 0)throw new Error("No annotation provided for id "+n);return this._annotations[n]=r,this._size++,n},t.prototype.nextId=function(){return this._counter++,this._counter.toString()},t}(),ah=function(){function t(e){var r=this;this._textEditChanges=Object.create(null),e!==void 0?(this._workspaceEdit=e,e.documentChanges?(this._changeAnnotations=new kl(e.changeAnnotations),e.changeAnnotations=this._changeAnnotations.all(),e.documentChanges.forEach(function(n){if(Uo.is(n)){var i=new Rs(n.edits,r._changeAnnotations);r._textEditChanges[n.textDocument.uri]=i}})):e.changes&&Object.keys(e.changes).forEach(function(n){var i=new Rs(e.changes[n]);r._textEditChanges[n]=i})):this._workspaceEdit={}}return a(t,"WorkspaceChange"),Object.defineProperty(t.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),t.prototype.getTextEditChange=function(e){if(Os.is(e)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var r={uri:e.uri,version:e.version},n=this._textEditChanges[r.uri];if(!n){var i=[],o={textDocument:r,edits:i};this._workspaceEdit.documentChanges.push(o),n=new Rs(i,this._changeAnnotations),this._textEditChanges[r.uri]=n}return n}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var n=this._textEditChanges[e];if(!n){var i=[];this._workspaceEdit.changes[e]=i,n=new Rs(i),this._textEditChanges[e]=n}return n}},t.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new kl,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},t.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},t.prototype.createFile=function(e,r,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;zi.is(r)||Jr.is(r)?i=r:n=r;var o,c;if(i===void 0?o=jo.create(e,n):(c=Jr.is(i)?i:this._changeAnnotations.manage(i),o=jo.create(e,n,c)),this._workspaceEdit.documentChanges.push(o),c!==void 0)return c},t.prototype.renameFile=function(e,r,n,i){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var o;zi.is(n)||Jr.is(n)?o=n:i=n;var c,l;if(o===void 0?c=qo.create(e,r,i):(l=Jr.is(o)?o:this._changeAnnotations.manage(o),c=qo.create(e,r,i,l)),this._workspaceEdit.documentChanges.push(c),l!==void 0)return l},t.prototype.deleteFile=function(e,r,n){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var i;zi.is(r)||Jr.is(r)?i=r:n=r;var o,c;if(i===void 0?o=zo.create(e,n):(c=Jr.is(i)?i:this._changeAnnotations.manage(i),o=zo.create(e,n,c)),this._workspaceEdit.documentChanges.push(o),c!==void 0)return c},t}(),Is;(function(t){function e(n){return{uri:n}}a(e,"create"),t.create=e;function r(n){var i=n;return Le.defined(i)&&Le.string(i.uri)}a(r,"is"),t.is=r})(Is||(Is={}));var Nl;(function(t){function e(n,i){return{uri:n,version:i}}a(e,"create"),t.create=e;function r(n){var i=n;return Le.defined(i)&&Le.string(i.uri)&&Le.integer(i.version)}a(r,"is"),t.is=r})(Nl||(Nl={}));var Os;(function(t){function e(n,i){return{uri:n,version:i}}a(e,"create"),t.create=e;function r(n){var i=n;return Le.defined(i)&&Le.string(i.uri)&&(i.version===null||Le.integer(i.version))}a(r,"is"),t.is=r})(Os||(Os={}));var Ml;(function(t){function e(n,i,o,c){return{uri:n,languageId:i,version:o,text:c}}a(e,"create"),t.create=e;function r(n){var i=n;return Le.defined(i)&&Le.string(i.uri)&&Le.string(i.languageId)&&Le.integer(i.version)&&Le.string(i.text)}a(r,"is"),t.is=r})(Ml||(Ml={}));var Ln;(function(t){t.PlainText="plaintext",t.Markdown="markdown"})(Ln||(Ln={})),function(t){function e(r){var n=r;return n===t.PlainText||n===t.Markdown}a(e,"is"),t.is=e}(Ln||(Ln={}));var Ra;(function(t){function e(r){var n=r;return Le.objectLiteral(r)&&Ln.is(n.kind)&&Le.string(n.value)}a(e,"is"),t.is=e})(Ra||(Ra={}));var Ps;(function(t){t.Text=1,t.Method=2,t.Function=3,t.Constructor=4,t.Field=5,t.Variable=6,t.Class=7,t.Interface=8,t.Module=9,t.Property=10,t.Unit=11,t.Value=12,t.Enum=13,t.Keyword=14,t.Snippet=15,t.Color=16,t.File=17,t.Reference=18,t.Folder=19,t.EnumMember=20,t.Constant=21,t.Struct=22,t.Event=23,t.Operator=24,t.TypeParameter=25})(Ps||(Ps={}));var Ds;(function(t){t.PlainText=1,t.Snippet=2})(Ds||(Ds={}));var Ll;(function(t){t.Deprecated=1})(Ll||(Ll={}));var Ac;(function(t){function e(n,i,o){return{newText:n,insert:i,replace:o}}a(e,"create"),t.create=e;function r(n){var i=n;return i&&Le.string(i.newText)&&rr.is(i.insert)&&rr.is(i.replace)}a(r,"is"),t.is=r})(Ac||(Ac={}));var ks;(function(t){t.asIs=1,t.adjustIndentation=2})(ks||(ks={}));var Rc;(function(t){function e(r){return{label:r}}a(e,"create"),t.create=e})(Rc||(Rc={}));var Gi;(function(t){function e(r,n){return{items:r||[],isIncomplete:!!n}}a(e,"create"),t.create=e})(Gi||(Gi={}));var Vi;(function(t){function e(n){return n.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}a(e,"fromPlainText"),t.fromPlainText=e;function r(n){var i=n;return Le.string(i)||Le.objectLiteral(i)&&Le.string(i.language)&&Le.string(i.value)}a(r,"is"),t.is=r})(Vi||(Vi={}));var $l;(function(t){function e(r){var n=r;return!!n&&Le.objectLiteral(n)&&(Ra.is(n.contents)||Vi.is(n.contents)||Le.typedArray(n.contents,Vi.is))&&(r.range===void 0||rr.is(r.range))}a(e,"is"),t.is=e})($l||($l={}));var Ic;(function(t){function e(r,n){return n?{label:r,documentation:n}:{label:r}}a(e,"create"),t.create=e})(Ic||(Ic={}));var Fl;(function(t){function e(r,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var c={label:r};return Le.defined(n)&&(c.documentation=n),Le.defined(i)?c.parameters=i:c.parameters=[],c}a(e,"create"),t.create=e})(Fl||(Fl={}));var Wo;(function(t){t.Text=1,t.Read=2,t.Write=3})(Wo||(Wo={}));var Bl;(function(t){function e(r,n){var i={range:r};return Le.number(n)&&(i.kind=n),i}a(e,"create"),t.create=e})(Bl||(Bl={}));var Oc;(function(t){t.File=1,t.Module=2,t.Namespace=3,t.Package=4,t.Class=5,t.Method=6,t.Property=7,t.Field=8,t.Constructor=9,t.Enum=10,t.Interface=11,t.Function=12,t.Variable=13,t.Constant=14,t.String=15,t.Number=16,t.Boolean=17,t.Array=18,t.Object=19,t.Key=20,t.Null=21,t.EnumMember=22,t.Struct=23,t.Event=24,t.Operator=25,t.TypeParameter=26})(Oc||(Oc={}));var Ns;(function(t){t.Deprecated=1})(Ns||(Ns={}));var Hl;(function(t){function e(r,n,i,o,c){var l={name:r,kind:n,location:{uri:o,range:i}};return c&&(l.containerName=c),l}a(e,"create"),t.create=e})(Hl||(Hl={}));var re;(function(t){function e(n,i,o,c,l,d){var p={name:n,detail:i,kind:o,range:c,selectionRange:l};return d!==void 0&&(p.children=d),p}a(e,"create"),t.create=e;function r(n){var i=n;return i&&Le.string(i.name)&&Le.number(i.kind)&&rr.is(i.range)&&rr.is(i.selectionRange)&&(i.detail===void 0||Le.string(i.detail))&&(i.deprecated===void 0||Le.boolean(i.deprecated))&&(i.children===void 0||Array.isArray(i.children))&&(i.tags===void 0||Array.isArray(i.tags))}a(r,"is"),t.is=r})(re||(re={}));var ve;(function(t){t.Empty="",t.QuickFix="quickfix",t.Refactor="refactor",t.RefactorExtract="refactor.extract",t.RefactorInline="refactor.inline",t.RefactorRewrite="refactor.rewrite",t.Source="source",t.SourceOrganizeImports="source.organizeImports",t.SourceFixAll="source.fixAll"})(ve||(ve={}));var Oe;(function(t){function e(n,i){var o={diagnostics:n};return i!=null&&(o.only=i),o}a(e,"create"),t.create=e;function r(n){var i=n;return Le.defined(i)&&Le.typedArray(i.diagnostics,Ts.is)&&(i.only===void 0||Le.typedArray(i.only,Le.string))}a(r,"is"),t.is=r})(Oe||(Oe={}));var wt;(function(t){function e(n,i,o){var c={title:n},l=!0;return typeof i=="string"?(l=!1,c.kind=i):Aa.is(i)?c.command=i:c.edit=i,l&&o!==void 0&&(c.kind=o),c}a(e,"create"),t.create=e;function r(n){var i=n;return i&&Le.string(i.title)&&(i.diagnostics===void 0||Le.typedArray(i.diagnostics,Ts.is))&&(i.kind===void 0||Le.string(i.kind))&&(i.edit!==void 0||i.command!==void 0)&&(i.command===void 0||Aa.is(i.command))&&(i.isPreferred===void 0||Le.boolean(i.isPreferred))&&(i.edit===void 0||As.is(i.edit))}a(r,"is"),t.is=r})(wt||(wt={}));var Kt;(function(t){function e(n,i){var o={range:n};return Le.defined(i)&&(o.data=i),o}a(e,"create"),t.create=e;function r(n){var i=n;return Le.defined(i)&&rr.is(i.range)&&(Le.undefined(i.command)||Aa.is(i.command))}a(r,"is"),t.is=r})(Kt||(Kt={}));var lr;(function(t){function e(n,i){return{tabSize:n,insertSpaces:i}}a(e,"create"),t.create=e;function r(n){var i=n;return Le.defined(i)&&Le.uinteger(i.tabSize)&&Le.boolean(i.insertSpaces)}a(r,"is"),t.is=r})(lr||(lr={}));var gr;(function(t){function e(n,i,o){return{range:n,target:i,data:o}}a(e,"create"),t.create=e;function r(n){var i=n;return Le.defined(i)&&rr.is(i.range)&&(Le.undefined(i.target)||Le.string(i.target))}a(r,"is"),t.is=r})(gr||(gr={}));var Vt;(function(t){function e(n,i){return{range:n,parent:i}}a(e,"create"),t.create=e;function r(n){var i=n;return i!==void 0&&rr.is(i.range)&&(i.parent===void 0||t.is(i.parent))}a(r,"is"),t.is=r})(Vt||(Vt={}));var Er=null,xn;(function(t){function e(o,c,l,d){return new Cn(o,c,l,d)}a(e,"create"),t.create=e;function r(o){var c=o;return!!(Le.defined(c)&&Le.string(c.uri)&&(Le.undefined(c.languageId)||Le.string(c.languageId))&&Le.uinteger(c.lineCount)&&Le.func(c.getText)&&Le.func(c.positionAt)&&Le.func(c.offsetAt))}a(r,"is"),t.is=r;function n(o,c){for(var l=o.getText(),d=i(c,function(F,N){var U=F.range.start.line-N.range.start.line;return U===0?F.range.start.character-N.range.start.character:U}),p=l.length,S=d.length-1;S>=0;S--){var P=d[S],I=o.offsetAt(P.range.start),O=o.offsetAt(P.range.end);if(O<=p)l=l.substring(0,I)+P.newText+l.substring(O,l.length);else throw new Error("Overlapping edit");p=I}return l}a(n,"applyEdits"),t.applyEdits=n;function i(o,c){if(o.length<=1)return o;var l=o.length/2|0,d=o.slice(0,l),p=o.slice(l);i(d,c),i(p,c);for(var S=0,P=0,I=0;S<d.length&&P<p.length;){var O=c(d[S],p[P]);O<=0?o[I++]=d[S++]:o[I++]=p[P++]}for(;S<d.length;)o[I++]=d[S++];for(;P<p.length;)o[I++]=p[P++];return o}a(i,"mergeSort")})(xn||(xn={}));var Cn=function(){function t(e,r,n,i){this._uri=e,this._languageId=r,this._version=n,this._content=i,this._lineOffsets=void 0}return a(t,"FullTextDocument"),Object.defineProperty(t.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),t.prototype.getText=function(e){if(e){var r=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(r,n)}return this._content},t.prototype.update=function(e,r){this._content=e.text,this._version=r,this._lineOffsets=void 0},t.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var e=[],r=this._content,n=!0,i=0;i<r.length;i++){n&&(e.push(i),n=!1);var o=r.charAt(i);n=o==="\r"||o===`
`,o==="\r"&&i+1<r.length&&r.charAt(i+1)===`
`&&i++}n&&r.length>0&&e.push(r.length),this._lineOffsets=e}return this._lineOffsets},t.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var r=this.getLineOffsets(),n=0,i=r.length;if(i===0)return _r.create(0,e);for(;n<i;){var o=Math.floor((n+i)/2);r[o]>e?i=o:n=o+1}var c=n-1;return _r.create(c,e-r[c])},t.prototype.offsetAt=function(e){var r=this.getLineOffsets();if(e.line>=r.length)return this._content.length;if(e.line<0)return 0;var n=r[e.line],i=e.line+1<r.length?r[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,i),n)},Object.defineProperty(t.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),t}(),Le;(function(t){var e=Object.prototype.toString;function r(O){return typeof O!="undefined"}a(r,"defined"),t.defined=r;function n(O){return typeof O=="undefined"}a(n,"undefined"),t.undefined=n;function i(O){return O===!0||O===!1}a(i,"boolean"),t.boolean=i;function o(O){return e.call(O)==="[object String]"}a(o,"string"),t.string=o;function c(O){return e.call(O)==="[object Number]"}a(c,"number"),t.number=c;function l(O,F,N){return e.call(O)==="[object Number]"&&F<=O&&O<=N}a(l,"numberRange"),t.numberRange=l;function d(O){return e.call(O)==="[object Number]"&&-2147483648<=O&&O<=2147483647}a(d,"integer"),t.integer=d;function p(O){return e.call(O)==="[object Number]"&&0<=O&&O<=2147483647}a(p,"uinteger"),t.uinteger=p;function S(O){return e.call(O)==="[object Function]"}a(S,"func"),t.func=S;function P(O){return O!==null&&typeof O=="object"}a(P,"objectLiteral"),t.objectLiteral=P;function I(O,F){return Array.isArray(O)&&O.every(F)}a(I,"typedArray"),t.typedArray=I})(Le||(Le={}));var ho;(function(t){function e(n){return typeof n=="string"||n instanceof String}a(e,"string"),t.string=e;function r(n){return typeof n=="number"||n instanceof Number}a(r,"number"),t.number=r})(ho||(ho={}));var Ia;(function(t){function e(r){const n=r;return n!=null&&(ho.number(n.value)||ho.string(n.value))&&ho.string(n.target)}a(e,"is"),t.is=e})(Ia||(Ia={}));class Pc extends m.Diagnostic{constructor(e,r,n,i){super(e,r,n);this.data=i,this.hasDiagnosticCode=!1}}a(Pc,"ProtocolDiagnostic");var Ki;(function(t){const e=Object.prototype.toString;function r(S){return typeof S!="undefined"}a(r,"defined"),t.defined=r;function n(S){return S===!0||S===!1}a(n,"boolean"),t.boolean=n;function i(S){return e.call(S)==="[object String]"}a(i,"string"),t.string=i;function o(S){return e.call(S)==="[object Number]"}a(o,"number"),t.number=o;function c(S){return S!==null&&typeof S=="object"}a(c,"objectLiteral"),t.objectLiteral=c;function l(S){return Array.isArray(S)}a(l,"array"),t.array=l;function d(S){return l(S)&&S.every(P=>i(P))}a(d,"stringArray"),t.stringArray=d;function p(S,P){return Array.isArray(S)&&S.every(P)}a(p,"typedArray"),t.typedArray=p})(Ki||(Ki={}));var Ul;(function(t){function e(r){const n=r;return n&&Ki.string(n.language)&&Ki.string(n.value)}a(e,"is"),t.is=e})(Ul||(Ul={}));function qp(t){const e=a(ae=>m.Uri.parse(ae),"nullConverter"),r=t!=null?t:e;function n(ae){return r(ae)}a(n,"asUri");function i(ae){return ae.map(o)}a(i,"asDiagnostics");function o(ae){const it=new Pc(P(ae.range),ae.message,O(ae.severity),ae.data);return ae.code!==void 0&&(Tc.is(ae.codeDescription)?it.code={value:ae.code,target:n(ae.codeDescription.href)}:Ia.is(ae.code)?(it.hasDiagnosticCode=!0,it.code={value:ae.code.value,target:n(ae.code.target)}):it.code=ae.code),ae.source&&(it.source=ae.source),ae.relatedInformation&&(it.relatedInformation=c(ae.relatedInformation)),Array.isArray(ae.tags)&&(it.tags=d(ae.tags)),it}a(o,"asDiagnostic");function c(ae){return ae.map(l)}a(c,"asRelatedInformation");function l(ae){return new m.DiagnosticRelatedInformation(Ie(ae.location),ae.message)}a(l,"asDiagnosticRelatedInformation");function d(ae){if(!ae)return;const it=[];for(const Ht of ae){const un=p(Ht);un!==void 0&&it.push(un)}return it.length>0?it:void 0}a(d,"asDiagnosticTags");function p(ae){switch(ae){case Cs.Unnecessary:return m.DiagnosticTag.Unnecessary;case Cs.Deprecated:return m.DiagnosticTag.Deprecated;default:return}}a(p,"asDiagnosticTag");function S(ae){if(!!ae)return new m.Position(ae.line,ae.character)}a(S,"asPosition");function P(ae){if(!!ae)return new m.Range(S(ae.start),S(ae.end))}a(P,"asRange");function I(ae){return ae.map(it=>P(it))}a(I,"asRanges");function O(ae){if(ae==null)return m.DiagnosticSeverity.Error;switch(ae){case Ho.Error:return m.DiagnosticSeverity.Error;case Ho.Warning:return m.DiagnosticSeverity.Warning;case Ho.Information:return m.DiagnosticSeverity.Information;case Ho.Hint:return m.DiagnosticSeverity.Hint}return m.DiagnosticSeverity.Error}a(O,"asDiagnosticSeverity");function F(ae){if(Ki.string(ae))return new m.MarkdownString(ae);if(Ul.is(ae))return new m.MarkdownString().appendCodeblock(ae.value,ae.language);if(Array.isArray(ae)){const Ht=[];for(const un of ae){const ul=new m.MarkdownString;Ul.is(un)?ul.appendCodeblock(un.value,un.language):ul.appendMarkdown(un),Ht.push(ul)}return Ht}let it;switch(ae.kind){case Ln.Markdown:return new m.MarkdownString(ae.value);case Ln.PlainText:return it=new m.MarkdownString,it.appendText(ae.value),it;default:return it=new m.MarkdownString,it.appendText(`Unsupported Markup content received. Kind is: ${ae.kind}`),it}}a(F,"asHoverContent");function N(ae){if(Ki.string(ae))return ae;switch(ae.kind){case Ln.Markdown:return new m.MarkdownString(ae.value);case Ln.PlainText:return ae.value;default:return`Unsupported Markup content received. Kind is: ${ae.kind}`}}a(N,"asDocumentation");function U(ae){if(!!ae)return new m.Hover(F(ae.contents),P(ae.range))}a(U,"asHover");function W(ae){if(!!ae)return new m.TextEdit(P(ae.range),ae.newText)}a(W,"asTextEdit");function V(ae){if(!!ae)return ae.map(W)}a(V,"asTextEdits");function ie(ae){if(!ae)return;const it=new m.SignatureHelp;return Ki.number(ae.activeSignature)?it.activeSignature=ae.activeSignature:it.activeSignature=0,Ki.number(ae.activeParameter)?it.activeParameter=ae.activeParameter:it.activeParameter=0,ae.signatures&&(it.signatures=oe(ae.signatures)),it}a(ie,"asSignatureHelp");function oe(ae){return ae.map(ge)}a(oe,"asSignatureInformations");function ge(ae){const it=new m.SignatureInformation(ae.label);return ae.documentation!==void 0&&(it.documentation=N(ae.documentation)),ae.parameters!==void 0&&(it.parameters=ke(ae.parameters)),ae.activeParameter!==void 0&&(it.activeParameter=ae.activeParameter),it}a(ge,"asSignatureInformation");function ke(ae){return ae.map(Re)}a(ke,"asParameterInformations");function Re(ae){const it=new m.ParameterInformation(ae.label);return ae.documentation&&(it.documentation=N(ae.documentation)),it}a(Re,"asParameterInformation");function Ie(ae){if(!!ae)return new m.Location(r(ae.uri),P(ae.range))}a(Ie,"asLocation");function Ye(ae){if(!!ae)return at(ae)}a(Ye,"asDeclarationResult");function $e(ae){if(!!ae)return at(ae)}a($e,"asDefinitionResult");function ze(ae){if(!ae)return;const it={targetUri:r(ae.targetUri),targetRange:P(ae.targetSelectionRange),originSelectionRange:P(ae.originSelectionRange),targetSelectionRange:P(ae.targetSelectionRange)};if(!it.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return it}a(ze,"asLocationLink");function at(ae){if(!!ae)return Ki.array(ae)?ae.length===0?[]:Es.is(ae[0])?ae.map(un=>ze(un)):ae.map(Ht=>Ie(Ht)):Es.is(ae)?[ze(ae)]:Ie(ae)}a(at,"asLocationResult");function kt(ae){if(!!ae)return ae.map(it=>Ie(it))}a(kt,"asReferences");function rn(ae){if(!!ae)return ae.map(Hn)}a(rn,"asDocumentHighlights");function Hn(ae){const it=new m.DocumentHighlight(P(ae.range));return Ki.number(ae.kind)&&(it.kind=Zn(ae.kind)),it}a(Hn,"asDocumentHighlight");function Zn(ae){switch(ae){case Wo.Text:return m.DocumentHighlightKind.Text;case Wo.Read:return m.DocumentHighlightKind.Read;case Wo.Write:return m.DocumentHighlightKind.Write}return m.DocumentHighlightKind.Text}a(Zn,"asDocumentHighlightKind");function Ii(ae,it){if(!!ae)return ae.map(Ht=>Mp(Ht,it))}a(Ii,"asSymbolInformations");function Oi(ae){return ae<=Oc.TypeParameter?ae-1:m.SymbolKind.Property}a(Oi,"asSymbolKind");function Xs(ae){switch(ae){case Ns.Deprecated:return m.SymbolTag.Deprecated;default:return}}a(Xs,"asSymbolTag");function wu(ae){if(ae==null)return;const it=[];for(const Ht of ae){const un=Xs(Ht);un!==void 0&&it.push(un)}return it.length===0?void 0:it}a(wu,"asSymbolTags");function Mp(ae,it){const Ht=new m.SymbolInformation(ae.name,Oi(ae.kind),P(ae.location.range),ae.location.uri?r(ae.location.uri):it);return Lp(Ht,ae),ae.containerName&&(Ht.containerName=ae.containerName),Ht}a(Mp,"asSymbolInformation");function yy(ae){if(ae!=null)return ae.map(rh)}a(yy,"asDocumentSymbols");function rh(ae){var it;const Ht=new m.DocumentSymbol(ae.name,(it=ae.detail)!=null?it:"",Oi(ae.kind),P(ae.range),P(ae.selectionRange));if(Lp(Ht,ae),ae.children!==void 0&&ae.children.length>0){const un=[];for(const ul of ae.children)un.push(rh(ul));Ht.children=un}return Ht}a(rh,"asDocumentSymbol");function Lp(ae,it){ae.tags=wu(it.tags),it.deprecated&&(ae.tags?ae.tags.includes(m.SymbolTag.Deprecated)||(ae.tags=ae.tags.concat(m.SymbolTag.Deprecated)):ae.tags=[m.SymbolTag.Deprecated])}a(Lp,"fillTags");function nh(ae){const it={title:ae.title,command:ae.command};return ae.arguments&&(it.arguments=ae.arguments),it}a(nh,"asCommand");function _y(ae){if(!!ae)return ae.map(nh)}a(_y,"asCommands");const bo=new Map;bo.set(ve.Empty,m.CodeActionKind.Empty),bo.set(ve.QuickFix,m.CodeActionKind.QuickFix),bo.set(ve.Refactor,m.CodeActionKind.Refactor),bo.set(ve.RefactorExtract,m.CodeActionKind.RefactorExtract),bo.set(ve.RefactorInline,m.CodeActionKind.RefactorInline),bo.set(ve.RefactorRewrite,m.CodeActionKind.RefactorRewrite),bo.set(ve.Source,m.CodeActionKind.Source),bo.set(ve.SourceOrganizeImports,m.CodeActionKind.SourceOrganizeImports);function ih(ae){if(ae==null)return;let it=bo.get(ae);if(it)return it;const Ht=ae.split(".");it=m.CodeActionKind.Empty;for(const un of Ht)it=it.append(un);return it}a(ih,"asCodeActionKind");function wy(ae){if(ae!=null)return ae.map(it=>ih(it))}a(wy,"asCodeActionKinds");function by(ae){if(ae==null)return;const it=new m.CodeAction(ae.title);return ae.kind!==void 0&&(it.kind=ih(ae.kind)),ae.diagnostics&&(it.diagnostics=i(ae.diagnostics)),ae.edit&&(it.edit=$p(ae.edit)),ae.command&&(it.command=nh(ae.command)),ae.isPreferred!==void 0&&(it.isPreferred=ae.isPreferred),it}a(by,"asCodeAction");function $p(ae){if(!ae)return;const it=new m.WorkspaceEdit;return ae.documentChanges?ae.documentChanges.forEach(Ht=>{if(jo.is(Ht))it.createFile(r(Ht.uri),Ht.options);else if(qo.is(Ht))it.renameFile(r(Ht.oldUri),r(Ht.newUri),Ht.options);else if(zo.is(Ht))it.deleteFile(r(Ht.uri),Ht.options);else if(Uo.is(Ht))it.set(r(Ht.textDocument.uri),V(Ht.edits));else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(Ht,void 0,4)}`)}):ae.changes&&Object.keys(ae.changes).forEach(Ht=>{it.set(r(Ht),V(ae.changes[Ht]))}),it}a($p,"asWorkspaceEdit");function Fp(ae){return new m.Color(ae.red,ae.green,ae.blue,ae.alpha)}a(Fp,"asColor");function Bp(ae){return new m.ColorInformation(P(ae.range),Fp(ae.color))}a(Bp,"asColorInformation");function Sy(ae){if(Array.isArray(ae))return ae.map(Bp)}a(Sy,"asColorInformations");function Hp(ae){const it=new m.ColorPresentation(ae.label);return it.additionalTextEdits=V(ae.additionalTextEdits),ae.textEdit&&(it.textEdit=W(ae.textEdit)),it}a(Hp,"asColorPresentation");function Ey(ae){if(Array.isArray(ae))return ae.map(Hp)}a(Ey,"asColorPresentations");function Up(ae){if(ae)switch(ae){case Ta.Comment:return m.FoldingRangeKind.Comment;case Ta.Imports:return m.FoldingRangeKind.Imports;case Ta.Region:return m.FoldingRangeKind.Region}}a(Up,"asFoldingRangeKind");function jp(ae){return new m.FoldingRange(ae.startLine,ae.endLine,Up(ae.kind))}a(jp,"asFoldingRange");function xy(ae){if(Array.isArray(ae))return ae.map(jp)}a(xy,"asFoldingRanges");function oh(ae){return new m.SelectionRange(P(ae.range),ae.parent?oh(ae.parent):void 0)}a(oh,"asSelectionRange");function Cy(ae){if(!Array.isArray(ae))return[];const it=[];for(const Ht of ae)it.push(oh(Ht));return it}return a(Cy,"asSelectionRanges"),{asUri:n,asDiagnostics:i,asDiagnostic:o,asRange:P,asRanges:I,asPosition:S,asDiagnosticSeverity:O,asDiagnosticTag:p,asHover:U,asTextEdit:W,asTextEdits:V,asSignatureHelp:ie,asSignatureInformations:oe,asSignatureInformation:ge,asParameterInformations:ke,asParameterInformation:Re,asDeclarationResult:Ye,asDefinitionResult:$e,asLocation:Ie,asReferences:kt,asDocumentHighlights:rn,asDocumentHighlight:Hn,asDocumentHighlightKind:Zn,asSymbolKind:Oi,asSymbolTag:Xs,asSymbolTags:wu,asSymbolInformations:Ii,asSymbolInformation:Mp,asDocumentSymbols:yy,asDocumentSymbol:rh,asCommand:nh,asCommands:_y,asCodeAction:by,asCodeActionKind:ih,asCodeActionKinds:wy,asWorkspaceEdit:$p,asFoldingRangeKind:Up,asFoldingRange:jp,asFoldingRanges:xy,asColor:Fp,asColorInformation:Bp,asColorInformations:Sy,asColorPresentation:Hp,asColorPresentations:Ey,asSelectionRange:oh,asSelectionRanges:Cy}}a(qp,"createConverter");const Hr=(0,zr.loadMessageBundle)();var Xi;(function(t){function e(n,i){const{provider:o,repo:c}=i instanceof m.Uri?n.getVirtualUriMetadata(i):i;return n.getRemoteUri(o.id,{repo:c})}a(e,"externalUri"),t.externalUri=e;function r(n,i){const{provider:o,repo:c}=i instanceof m.Uri?n.getVirtualUriMetadata(i):i;return n.getRemoteUri(o.id,{repo:c})}a(r,"externalIndexUri"),t.externalIndexUri=r})(Xi||(Xi={}));var Go;(function(t){function e(i){if(i.HEAD.type===De.Branch||i.HEAD.type===De.RemoteBranch)return i.HEAD.name}a(e,"getBranchName"),t.getBranchName=e;function r(i){if(i.HEAD.type!==De.Branch)return;if(i.pullRequest!==void 0)return i.HEAD.name;const o=i.HEAD.name;return o===void 0||o.startsWith("refs/heads/")?o:`refs/heads/${o}`}a(r,"getIndexBranchName"),t.getIndexBranchName=r;async function n(i,o,c=Wr.timeout){const l=await i.getMetadata(o),d=Xi.externalIndexUri(i,l),p=t.getIndexBranchName(l);if(!(d===void 0||p===void 0))return Wr.getIndexedTip(d,p,{authentication:i.getAuthentication(o)},c)}a(n,"getIndexedTip"),t.getIndexedTip=n})(Go||(Go={}));var Dc;(function(t){const e=new Kn(1024);function r(c,l,d){let p=e.get(d);return p!==void 0||(p=c.getCommit(l,d),e.set(d,p)),p}a(r,"get"),t.get=r;async function n(c,l,d){const p=[];for(const P of d)p.push(r(c,l,P));const S=[];for(const P of await Promise.all(p))P!==void 0&&S.push(P);return S}a(n,"all"),t.all=n;function i(c,l){const d=c.commitDate,p=l.commitDate;return d===void 0&&p===void 0?0:d===void 0?1:p===void 0?-1:d<p?1:d>p?-1:0}a(i,"sort"),t.sort=i;function o(c){const l=c.authorName!==void 0?`  \u2022  ${c.authorName}`:"",d=c.commitDate!==void 0?`  \u2022  ${uo(c.commitDate,{ago:!0})}`:"",p=c.branchName!==void 0?` - ${c.branchName}`:"",S=c.tags!==void 0?typeof c.tags=="string"?`  \u2022  ${c.tags}`:`  \u2022  ${c.tags.join(" ")}`:"";return{author:l,date:d,branch:p,tag:S}}a(o,"getCommitInfo"),t.getCommitInfo=o})(Dc||(Dc={}));var sh;(function(t){t[t.Unknown=0]="Unknown",t[t.New=1]="New",t[t.Failed=2]="Failed",t[t.Partial=3]="Partial",t[t.InProgress=4]="InProgress",t[t.Complete=5]="Complete",t[t.PartialIndex=6]="PartialIndex",t[t.CompleteIndex=7]="CompleteIndex"})(sh||(sh={}));var jl;(function(t){function e(n){return{workspaceId:n.WorkspaceId,snapshotId:n.SnapshotId,state:n.State,commitId:n.commitId.toLowerCase(),branchName:r(n.BranchName),creationDate:new Date(n._ts*1e3)}}a(e,"asWorkspaceSnapshot"),t.asWorkspaceSnapshot=e;function r(n){if(n!==null)return n.startsWith("refs/heads/")?n.substr(11):n}a(r,"getBranchName")})(jl||(jl={}));var Wr;(function(t){t.timeout=5*60*1e3;const e=new Kn(32),r=new Kn(32);async function n(S,P,I,O=t.timeout){const F=await i(S,P,I,O);if(!(F===void 0||F.length===0))return F[0]}a(n,"getIndexedTip"),t.getIndexedTip=n;async function i(S,P,I,O=t.timeout){const F=c(S,P);let N=e.get(F);if(N===void 0||N!==void 0&&Date.now()-N.time>O){const U=li.getAllWorkspaceSnapshots(S,I,P);N={time:Date.now(),promise:U,snapshots:void 0},e.set(F,N)}if(N.snapshots!==null){if(N.snapshots===void 0){let U=await N.promise;if(U===void 0){N.snapshots=null;return}U.sort((W,V)=>V.creationDate.getTime()-W.creationDate.getTime()),U=U.filter(W=>W.state===5||W.state===3),N.snapshots=U}return N.snapshots}}a(i,"all"),t.all=i;async function o(S,P,I,O,F=t.timeout){const N=S.toString();let U=r.get(N);if(U===null)return;if(U!==void 0)return U;const W=c(S,I),V=e.get(W);if(V!==void 0&&Date.now()-V.time<=F){if(V.snapshots===null)return;const ie=V.snapshots!==void 0?V.snapshots:await i(S,I,O);if(ie!==void 0){for(const oe of ie)if(oe.commitId===P)return oe}return}if(U=await li.getWorkspaceSnapshot(P,O),U===void 0){r.set(N,null);return}return r.set(N,U),U}a(o,"single"),t.single=o;function c(S,P){return P!==void 0?`${P}\\${S.toString()}`:S.toString()}a(c,"getAllCacheKey");async function l(S,P,I,O=t.timeout){return await o(S,P,void 0,I,O)!==void 0}a(l,"exists"),t.exists=l;async function d(S,P,I,O=t.timeout){return await i(S,P,I,O)!==void 0}a(d,"branch"),t.branch=d;async function p(S,P,I){const O=new Map(I.map(U=>[U.commitId,U])),F=await Dc.all(S,P.uri,I.map(U=>U.commitId));if(F.length===0)return;const N=[];for(const U of F){const W=O.get(U.hash);W!==void 0&&N.push({...W,commit:U})}if(N.length!==0)return N}a(p,"resolve"),t.resolve=p})(Wr||(Wr={}));var Qi;(function(t){function e(r=!1){return{hoverProvider:r,declarationProvider:r,definitionProvider:r,typeDefinitionProvider:r,referencesProvider:r,documentSymbolProvider:r,foldingRangeProvider:r,diagnosticProvider:r}}a(e,"create"),t.create=e})(Qi||(Qi={}));var li;(function(t){const e="v0.1",r="https://prod.richnav.vsengsaas.visualstudio.com/api";async function n(W,V,ie){var oe;const ge=await Mt(W,{method:"POST",body:JSON.stringify(V),headers:{"Content-Type":"application/json",...(await ie.authentication).getRichNavigationHeaders(),"x-correlation-id":(oe=ie.correlationId)!=null?oe:vc()}});if(!!ge.ok)return ge.json()}a(n,"postRequest");async function i(W,V,ie){const oe=await Mt(W,{method:"POST",body:V,headers:(await ie.authentication).getRichNavigationHeaders()});if(!!oe.ok)return await oe.json()}a(i,"postForm");function o(W,V){return`${r}/${e}/HttpLanguageService/${W}/${V}`}a(o,"makeRequestUrl");async function c(W,V){const ie=await Mt(`${r}/${e}/WorkspaceSnapshot?commitId=${W}`,{headers:(await V.authentication).getRichNavigationHeaders()});if(ie.ok){const oe=await ie.json();return{workspaceId:oe.workspaceId,snapshotId:oe.snapshotId,state:oe.state,commitId:W.toLowerCase(),branchName:void 0,creationDate:new Date}}}a(c,"getWorkspaceSnapshot"),t.getWorkspaceSnapshot=c;async function l(W,V,ie){const oe=new ji;oe.append("uriString",W.toString(!0)),ie!==void 0&&oe.append("branchName",ie);try{const ge=await i(`${r}/${e}/WorkspaceSnapshot/all`,oe,V);return ge===void 0?void 0:ge.map(jl.asWorkspaceSnapshot)}catch(ge){L.error(ge);return}}a(l,"getAllWorkspaceSnapshots"),t.getAllWorkspaceSnapshots=l;async function d(W,V,ie){const oe=new ji;oe.append("uriString",W.toString(!0)),ie!==void 0&&oe.append("branchName",ie);try{const ge=await i(`${r}/${e}/WorkspaceSnapshot/latest`,oe,V);return ge===void 0?void 0:jl.asWorkspaceSnapshot(ge)}catch(ge){L.error(ge);return}}a(d,"getLatestWorkspaceSnapshot"),t.getLatestWorkspaceSnapshot=d;async function p(W,V,ie){try{return n(o(W,"textDocument/capabilities"),V,ie)}catch(oe){L.error(oe);return}}a(p,"capabilities"),t.capabilities=p;async function S(W,V,ie){try{return n(o(W,"textDocument/hover"),V,ie)}catch(oe){L.error(oe);return}}a(S,"provideHover"),t.provideHover=S;async function P(W,V,ie){try{return n(o(W,"textDocument/definition"),V,ie)}catch(oe){L.error(oe);return}}a(P,"provideDefinition"),t.provideDefinition=P;async function I(W,V,ie){try{return n(o(W,"textDocument/declaration"),V,ie)}catch(oe){L.error(oe);return}}a(I,"provideDeclaration"),t.provideDeclaration=I;async function O(W,V,ie){try{return n(o(W,"textDocument/typeDefinition"),V,ie)}catch(oe){L.error(oe);return}}a(O,"provideTypeDefinition"),t.provideTypeDefinition=O;async function F(W,V,ie){try{return n(o(W,"textDocument/references"),V,ie)}catch(oe){L.error(oe);return}}a(F,"provideReferences"),t.provideReferences=F;async function N(W,V,ie){try{return n(o(W,"textDocument/foldingRange"),V,ie)}catch(oe){L.error(oe);return}}a(N,"providerFoldingRanges"),t.providerFoldingRanges=N;async function U(W,V,ie){const oe=m.Uri.from({scheme:"https",authority:"prod.richnav.vsengsaas.visualstudio.com",path:`/api/${e}/Workspace/${W}/${V}/assets/designtime`,query:`id=${ie}`});try{const ge=await Mt(oe.toString().replace("?id%3D","?id="),{method:"GET",headers:{accept:"text/plain"}});return ge.ok?ge.text():void 0}catch(ge){L.error(ge);return}}a(U,"getDesignTimeFileContent"),t.getDesignTimeFileContent=U})(li||(li={}));class ch{constructor(e,r){this.providerService=e,this.telemetryService=r,this.metadata=new Map,this.providerService.onDidChangeRepositories(n=>{var i;for(const o of n.added){const c=o.uri,l=Y.getIndexMemento(c);if(l!==void 0){const d=Xi.externalIndexUri(this.providerService,c);d!==void 0&&(typeof((i=l.branch)==null?void 0:i.name)=="string"?Wr.all(d,l.branch.name,{authentication:this.providerService.getAuthentication(c)}).catch(void 0):typeof l.ref=="string"&&Ur(l.ref)&&Wr.single(d,l.ref,void 0,{authentication:this.providerService.getAuthentication(c)}).catch(void 0))}this.providerService.getMetadata(c).then(d=>{const p={},S=d.pullRequest===void 0?Go.getIndexBranchName(d):void 0;S!==void 0?p.branch={name:S}:p.ref=d.HEAD.sha,Y.setIndexMemento(c,p).then(void 0,void 0)},void 0)}}),this.providerService.onDidChangeRepository(n=>{const i=n.repository.uri,o=te(i);this.metadata.delete(o),this.getIndexMetadata(i).catch(void 0)})}async resolveIndexRef(e,r){const n=await this.providerService.getModeRefType(e),i=Jt.decode(e);if(i!==void 0){if(i.type===er.Latest)return n===ne.Branch?this.getIndexedTip(e,r?0:Wr.timeout):void 0;if(i.type===er.SHA){const c=Xi.externalIndexUri(this.providerService,e);return c===void 0?void 0:await Wr.exists(c,i.sha,{authentication:this.providerService.getAuthentication(e)},r?0:Wr.timeout)?i.sha:void 0}}if(this.providerService.getModeConfig(e,n).index===q.Latest)return this.getIndexedTip(e,r?0:Wr.timeout)}refresh(e){for(const r of e)this.metadata.delete(r.toString())}getIndexMetadata(e){const r=this.providerService.getVirtualRootUri(e),n=te(r);let i=this.metadata.get(n);return i!==void 0||(i=this.createIndexMetadata(e),this.metadata.set(n,i)),i}async getIndexedTip(e,r=Wr.timeout){const n=await Go.getIndexedTip(this.providerService,e,r);return n!==void 0?n.commitId:void 0}async createIndexMetadata(e){const r=new lt(`RichNavIndexProvider.createIndexMetadata(${e.toString()})`);try{const n=Xi.externalIndexUri(this.providerService,e);if(n===void 0)return;r.logStep("Getting metadata");const i=this.providerService.getMetadata(e),o=this.providerService.getModeRefType(e,i),c=await i;r.logStep("Getting snapshot",{suffix:" \u2022 Getting snapshot..."});const l=this.providerService.getAuthentication(e),d=c.pullRequest===void 0?Go.getIndexBranchName(c):void 0,p=await Wr.single(n,c.HEAD.sha,d,{authentication:this.providerService.getAuthentication(e)});if(c.HEAD.type===De.Branch||c.HEAD.type===De.RemoteBranch){const O=Jt.decode(e);if(O!==void 0)return r.logStep("Handle legacy encoding",{suffix:" \u2022 Handle legacy encoding..."}),p===void 0?O.type===er.Latest?(r.logStep("Getting branch snapshot",{suffix:" \u2022 Getting branch snapshot..."}),d!==void 0&&await Wr.branch(n,d,{authentication:this.providerService.getAuthentication(e)})?{type:ft.Indexed}:{type:ft.NotIndexed}):{type:ft.NotIndexed}:O.type===er.Latest||O.type===er.SHA?{type:ft.Active,sha:Promise.resolve(p.commitId),branch:{name:p.branchName}}:{type:ft.Match,sha:Promise.resolve(p.commitId),branch:{name:p.branchName}}}r.logStep("Getting mode config",{suffix:" \u2022 Getting mode config..."});const P=this.providerService.getModeConfig(e,await o),I=this.providerService.getVirtualUriMetadata(e);if((P.index===q.Latest||P.index===q.Match)&&p!==void 0)return{type:ft.Active,sha:Promise.resolve(p.commitId),branch:{name:p.branchName}};if(P.index===q.TipPlusLatest&&I.provider.id==="github"){if(p!==void 0&&p.commitId===c.HEAD.sha)return{type:ft.Active,sha:Promise.resolve(p.commitId),branch:{name:p.branchName}};if(c.HEAD.type===De.Branch&&d!==void 0){r.logStep("Getting closest index",{suffix:" \u2022 Getting closest index..."});const O=await Wr.all(n,d,{authentication:l});if(O!==void 0&&O.length>0)return{type:ft.Active,sha:this.computeClosestIndex(e,c.HEAD.sha,O),branch:{name:d}}}}return p!==void 0?{type:ft.Indexed}:c.HEAD.type===De.Branch&&(r.logStep("Getting branch snapshot",{suffix:" \u2022 Getting branch snapshot..."}),d!==void 0&&await Wr.branch(n,d,{authentication:l}))?{type:ft.Indexed}:{type:ft.NotIndexed}}finally{r.stop()}}async computeClosestIndex(e,r,n){if(n.length===0)throw new Error("At least on snapshot should exist");const i=new Set(n.map(S=>S.commitId)),o=await this.providerService.getCommits(e,{ref:r,limit:100});if(o===void 0)return;let c;for(const S of o.commits)if(S.hash===r){c=S;break}if(c===void 0)return;const l=new Map(o.commits.map(S=>[S.hash,S])),d=[c];let p;for(;d.length>0;){for(p=d.shift();p!==void 0&&!i.has(p.hash);)if(p.parents.length>0){for(let S=1;S<p.parents.length;S++){const P=l.get(p.parents[S]);P!==void 0&&d.push(P)}p=l.get(p.parents[0])}if(p!==void 0)break}return p!==void 0?p.hash:void 0}async getSnapshots(e,r){const n=Xi.externalIndexUri(this.providerService,e);if(n===void 0)return[];const i=await Wr.all(n,void 0,{authentication:this.providerService.getAuthentication(e)});if(i===void 0)return[];const o=[];for(const c of i)c.branchName!==void 0&&o.push({workspaceId:c.workspaceId,snapshotId:c.snapshotId,hash:c.commitId,branch:{name:c.branchName}});return o}async getStatusBarContributions(e){const r=await this.providerService.getMetadata(e),[n,i]=await Promise.all([this.getIndexMetadata(e),this.providerService.getModeRefType(e,r)]),o=this.providerService.getModeConfig(e,i);if(n===void 0)return[];const{HEAD:c}=r,l=[];if(n!==void 0){let d;const p=[`${yt(c.sha)}`];if(n.type===ft.Active){const S=await n.sha;o.index===q.Latest||o.index===q.Match?(d=o.display===j.Browse?"$(layers-active)\u2009\u2009$(lock)":"$(layers-active)",p.push(Hr("statusbar.active",`The commit is indexed and rich code navigation features are enabled.
The files in the workspace are readonly.`))):o.index===q.TipPlusLatest&&(d="$(layers-dot)",S!==r.HEAD.sha?p.push(Hr("statusbar.tipPlusLatest","The commit is not indexed. Rich code navigation features are enabled using a former indexed commit which might lead to fuzzy results.")):p.push(Hr("statusbar.tipPlusLatest","The commit is indexed. Rich code navigation features are enabled. Files in the workspace can be modified which might lead to fuzzy results.")))}else n.type===ft.Match?(d="$(layers)",p.push(Hr("statusbar.match",`The commit you are on is indexed, but rich navigation is not enabled.
Click the status bar item to enable it.`))):n.type===ft.Indexed&&(d="$(layers)",p.push(Hr("statusbar.indexed",`The branch you are on is indexed, but rich navigation is not enabled.
Click the status bar item to enable it.`)));d&&l.push(Gn({command:"remoteHub.indexMode.select",title:d,tooltip:p.join(`
`),arguments:[{uri:e}]}))}return l}}a(ch,"RichNavIndexProvider");var Oa;(function(t){let e;function r(){return e=m.window.createStatusBarItem(m.StatusBarAlignment.Right),e.text="$(compass)",e.command="remoteHub.indexMode.select",e.hide(),[e,m.window.onDidChangeActiveTextEditor(()=>{d()}),m.commands.registerCommand("remoteHub.indexMode.select",S=>{p(S).catch(P=>L.log("Selecting index mode failed.",P))})]}a(r,"create"),t.create=r;const n=new Map;function i(S){n.set(S.key(),S)}a(i,"addService"),t.addService=i;function o(S){n.delete(S.key())}a(o,"removeService"),t.removeService=o;function c(S){return n.get(te(S))}a(c,"getService");async function l(S){for(const P of n.values())if(await P.handles(S))return P}a(l,"getServiceForDocument");async function d(){try{let S=a(function(F){const N=F.lastIndexOf("/");return N<=0?F:F.substr(N+1)},"basename");const P=m.window.activeTextEditor;if(P===void 0){e.hide();return}const I=await l(P.document);if(I===void 0){e.hide();return}const O=await I.isDocumentIndexed(P.document);O===ql.Indexed?(e.text="$(compass)",e.tooltip=new m.MarkdownString(Hr("isIndexed","The source file '{0}' is indexed and provides rich code navigation features like Go to Declaration and Find all References.",S(P.document.uri.path))),e.show()):O===ql.IndexMapped?(e.text="$(compass-dot)",e.tooltip=new m.MarkdownString(Hr("isIndexed","The source file '{0}' provides rich code navigation features using an earlier indexed commit. Navigation results might be fuzzy.",S(P.document.uri.path))),e.show()):e.hide()}catch(S){e.hide()}}a(d,"updateStatusBarItem"),t.updateStatusBarItem=d;async function p(S){const P=S.uri,I=c(P);if(I===void 0)return;const[O,F,N,U]=await Promise.all([I.getBranchName(),I.getMetadata(),I.getIndexMetadata(),I.getModeRefType(P)]);if(N===void 0||!ft.hasIndex(N.type))return;let W,V=!1;const ie=Jt.decode(P);(ie==null?void 0:ie.type)===er.Latest||(ie==null?void 0:ie.type)===er.SHA?(V=!0,W={display:j.Browse,index:ie.type===er.Latest?q.Latest:q.Match}):W=I.getModeConfig(P,U);const oe=I.getUriMetadata(),ge=Hr("current item","{0} current","$(check)"),ke={kind:"disable",label:Hr("RichNavStatus.disable.label","Disable"),description:W.index===q.None?`  \u2022  ${ge}`:void 0,detail:Hr("RichNavStatus.disable.detail","Disable rich navigation. {0}",oe.provider.id==="github"?"Files will be writable.":"Files will be read-only.")};let Re,Ie;if(U===ne.PullRequestBranch||U===ne.PullRequestRemoteBranch||U===ne.Commit||U===ne.Tag){const Ye={kind:"match",label:Hr("RichNavStatus.match.label","Current indexed commit - readonly"),description:W.index===q.Match&&W.display===j.Browse?`  \u2022  ${ge}`:void 0,detail:Hr("RichNavStatus.match.detail","Enable rich navigation only if the current commit is indexed. Files will be read-only.")},$e={kind:"match+writeable",label:Hr("RichNavStatus.matchWritable.label","Current indexed commit - writable"),description:W.index===q.Match&&W.display===j.Edit?`  \u2022  ${ge}`:void 0,detail:Hr("RichNavStatus.match.detail","Enable rich navigation only if the current commit is indexed. Files will be writable.")};let ze=oe.provider.id==="github";ze&&(ze=F.HEAD.type===De.RemoteBranch?F.HEAD.branch.remote.accessLevel>=Ne.Write:!0);const at=ze?[Ye,$e,ke]:[Ye,ke];Ie=await m.window.showQuickPick(at,{placeHolder:"Pick a rich navigation mode"})}else if(U===ne.Branch||U===ne.RemoteBranch){const Ye={kind:"latest",label:Hr("RichNavStatus.latestIndexed.label","Latest indexed commit"),description:W.index===q.Latest?`  \u2022  ${ge}`:void 0,detail:Hr("RichNavStatus.latestIndexed.detail","Enable rich navigation on the latest indexed commit. Files will be read-only.")},$e={kind:"tip+latest",label:Hr("RichNavStatus.matchLatestIndexed.label","Current commit & latest index"),description:W.index===q.TipPlusLatest?`  \u2022  ${ge}`:void 0,detail:Hr("RichNavStatus.matchLatestIndexed.detail","Enable rich navigation on the current commit using the latest index. Files will be writeable.")},ze=oe.provider.id==="github"?[Ye,$e,ke]:[Ye,ke];Ie=await m.window.showQuickPick(ze,{placeHolder:Hr("RichNavStatus.placeHolder","Pick a rich navigation mode for branch {0}",O)})}if(Ie!==void 0&&(Ie.kind==="disable"?Re={display:j.Edit,index:q.None}:Ie.kind==="match"?Re={display:j.Browse,index:q.Match}:Ie.kind==="match+writeable"?Re={display:j.Edit,index:q.Match}:Ie.kind==="tip+latest"?Re={display:j.Edit,index:q.TipPlusLatest}:Ie.kind==="latest"&&(Re={display:j.Browse,index:q.Latest}),Re!==void 0&&!se.equals(W,Re))){if(await I.hasChanges()&&Re.display===j.Browse){await m.window.showInformationMessage("The repository has outgoing changes. Commit them first before switching to browse mode.",{modal:!0,useCustom:!0});return}if(Re.index===q.Latest){const Ye=await I.getIndexedTip();if(Ye===void 0)return;await I.sync(Ye.hash)}else Re.index===q.TipPlusLatest&&await I.sync();if(await Y.setMode(P,Re),V){const Ye=await I.getNonIndexedWorkspaceDescriptor();Ye!==void 0&&bn(Ye)}else I.refresh()}}a(p,"toggleIndexMode")})(Oa||(Oa={}));class Ku{constructor(e){this.telemetryService=e}static createStatus(){return Oa.create()}async createNavigationService(e,r,n){const i=await e.getIndexMetadata(r.uri);if(!(i===void 0||i.type===ft.NotIndexed))return()=>new Qu(e,r,n,this.telemetryService)}}a(Ku,"RichNavServiceProvider");var kc;(function(t){const e=new RegExp("^vsck:\\/\\/([a-fA-F0-9]+)\\/(latest|[a-fA-F0-9]{15})\\/designtime\\/([a-fA-F0-9]+)(\\/?.*)$");function r(i){const o=e.exec(i);if(o===null||o.length!==5)return;const c={v:1,w:o[1],s:o[2],a:o[3]};return m.Uri.from({scheme:fo.scheme,authority:no(JSON.stringify(c)),path:o[4]})}a(r,"toVSCode"),t.toVSCode=r;function n(i){if(i.scheme!==fo.scheme)return;let o;try{return o=JSON.parse(Eo(i.authority)),o===void 0?void 0:{workspaceId:o.w,snapshotId:o.s,assetId:`${o.a}${i.path}`}}catch{return}}a(n,"toRichNavComponents"),t.toRichNavComponents=n})(kc||(kc={}));const Xu=a(class{constructor(){this._onDidChangeFile=new m.EventEmitter,this.cache=new Kn(64),this.textEncoder=new TextEncoder}get onDidChangeFile(){return this._onDidChangeFile.event}watch(t,e){return Xu.emptyDisposable}async stat(t){const e=await this.getFile(t);if(e===void 0)throw m.FileSystemError.FileNotFound();return{type:m.FileType.File,mtime:e.time,ctime:e.time,size:e.content.length,permissions:m.FilePermission.Readonly}}readDirectory(t){return[]}createDirectory(t){throw m.FileSystemError.NoPermissions()}async readFile(t){const e=await this.getFile(t);if(e===void 0)throw m.FileSystemError.FileNotFound();return e.content}writeFile(t,e,r){throw m.FileSystemError.NoPermissions()}delete(t,e){throw m.FileSystemError.NoPermissions()}rename(t,e,r){throw m.FileSystemError.NoPermissions()}async getFile(t){let e=this.cache.get(t.toString());if(e!==void 0)return e;if(t.scheme!==Xu.scheme)return;const r=kc.toRichNavComponents(t);if(r===void 0)return;const n=await li.getDesignTimeFileContent(r.workspaceId,r.snapshotId,r.assetId);if(n!==void 0)return e={content:this.textEncoder.encode(n),time:Date.now()},this.cache.set(t.toString(),e),e}},"_RichNavFileSystemProvider");let fo=Xu;fo.scheme="vsck-fs",fo.emptyDisposable={dispose:()=>{}};var ql;(function(t){t[t.NotIndexed=0]="NotIndexed",t[t.IndexMapped=1]="IndexMapped",t[t.Indexed=2]="Indexed"})(ql||(ql={}));const Yi=a(class{static registerCapability(t,e,r){var n;const i=this.disabledCapabilities.get(t);if(i==null?void 0:i[e])return!1;const o=this.localCapabilities.get(t);return(o==null?void 0:o[e])?!1:(n=r[e])!=null?n:!1}constructor(t,e,r,n){this.providerService=t,this.repository=e,this.changeStore=r,this.telemetryService=n,this.repositoryRoot=`${e.uri.toString()}/`;const i=a((c=!1)=>{const l=this.repository.uri;c||(this.metadata=this.providerService.getMetadata(l),this.indexMetadata=this.providerService.getIndexMetadata(l)),Promise.all([this.metadata,this.indexMetadata,this.providerService.getModeRefType(l,this.metadata)]).then(async d=>{var p,S;const[P,I,O]=this.currentlyResolved,[F,N,U]=d,W=this.providerService.getModeConfig(l,U);if(P!==void 0&&I!==void 0&&O!==void 0&&P.HEAD.sha===F.HEAD.sha&&N!==void 0&&I.type===N.type&&O.index===W.index&&O.display===W.display){const ie=(I==null?void 0:I.type)===ft.Active?await I.sha:void 0,oe=(N==null?void 0:N.type)===ft.Active?await N.sha:void 0;if(ie===oe)return}const V={newDisplayMode:W.display,newIndexMode:W.index,newIndexType:(N==null?void 0:N.type)===void 0?"undefined":ft[N==null?void 0:N.type],currentDisplayMode:(p=O==null?void 0:O.display)!=null?p:"undefined",currentIndexMode:(S=O==null?void 0:O.index)!=null?S:"undefined",currentIndexType:(I==null?void 0:I.type)===void 0?"undefined":ft[I==null?void 0:I.type]};this.telemetryService.publicLog2("codex.handleRepositoryChanged",V),this.currentlyResolved=[F,N,W];for(const ie of this.registeredFeatures.values())ie.dispose();if(this.registeredFeatures.clear(),this.pendingCapabilitiesRequests.clear(),this.documentListeners!==void 0&&this.documentListeners.dispose(),this.workspaceSnapshot=void 0,this.mapper=void 0,Zt.isActive(N)){const ie=Xi.externalIndexUri(this.providerService,F),oe=await N.sha;if(ie!==void 0&&oe!==void 0){const ge=await Wr.single(ie,oe,Go.getIndexBranchName(F),{authentication:this.providerService.getAuthentication(l)});ge!==void 0&&(this.telemetryService.publicLog2("codex.foundSnapshot",{snapshotId:ge.snapshotId}),this.workspaceSnapshot=ge,this.documentListeners=this.installDocumentListeners(),((W==null?void 0:W.display)===j.Edit||F.HEAD.sha!==oe)&&(this.mapper=new Et(this.providerService,l,oe,F.HEAD.sha)))}}await Oa.updateStatusBarItem()}).then(void 0,void 0)},"handleRepositoryChanged");this.metadata=this.providerService.getMetadata(this.repository.uri),this.indexMetadata=this.providerService.getIndexMetadata(this.repository.uri),this.currentlyResolved=[void 0,void 0,void 0],this.registeredFeatures=new Map,this.pendingCapabilitiesRequests=new Map,this.capabilitiesCache=new Kn(2048),this.knownDesignTimeFiles=new Set;const o=[];o.push(this.providerService.onDidChangeRepository(c=>{te(c.repository.uri)===te(this.repository.uri)&&i()})),o.push(this.providerService.onDidRefresh(c=>{for(const l of c)if(te(l)===te(this.repository.uri)){i();break}})),o.push(Y.onDidChange(c=>{c.affectsConfiguration("remoteHub.richNavigation.indexMode",this.repository.uri)&&this.providerService.refresh()})),this.environmentListeners=m.Disposable.from(...o),i(!0),Oa.addService(this),this.indexMetadata.then(async c=>{const l=this.repository.uri;let d=!1;const p=Jt.decode(this.repository.uri);if(p!==void 0&&c!==void 0&&(p.type===er.Latest&&c.type!==ft.Active||p.type===er.SHA&&(c.type!==ft.Active||await c.sha!==p.sha))&&(d=!0),!d){const S=this.providerService.getModeConfig(l,await this.providerService.getModeRefType(l,this.metadata),!0);S!==void 0&&S.display===j.Browse&&c!==void 0&&S.index!==q.None&&c.type!==ft.Active?d=!0:(c==null?void 0:c.type)===ft.Active&&await c.sha===void 0&&((S==null?void 0:S.display)===j.Browse,d=!0)}d&&m.window.showWarningMessage(Hr("RichNavService.latest.notIndexed","The repository got opened in rich code navigation mode but no corresponding index is available. Rich code navigation features are disabled.")).then(void 0,void 0)},void 0),Yi.fileSystemProvider===void 0&&(Yi.fileSystemProvider=new fo,m.workspace.registerFileSystemProvider(fo.scheme,Yi.fileSystemProvider))}key(){return te(this.repository.uri)}dispose(){for(const t of this.registeredFeatures.values())t.dispose();this.registeredFeatures.clear(),Oa.removeService(this),this.documentListeners!==void 0&&(this.documentListeners.dispose(),this.documentListeners=void 0),this.environmentListeners!==void 0&&(this.environmentListeners.dispose(),this.environmentListeners=void 0)}handles(t){return t.uri.scheme!==Xt.scheme?Promise.resolve(!1):Promise.resolve(t.uri.toString().startsWith(this.repositoryRoot))}async getBranchName(){return Go.getBranchName(await this.metadata)}async getMetadata(){return this.metadata}async getIndexMetadata(){return this.indexMetadata}getUriMetadata(){return this.providerService.getVirtualUriMetadata(this.repository.uri)}getModeConfig(t,e){return this.providerService.getModeConfig(t,e)}getModeRefType(t){return this.providerService.getModeRefType(t)}refresh(){return this.providerService.refresh()}async getNonIndexedWorkspaceDescriptor(){const{name:t,repo:e}=await this.metadata,{ref:r}=this.providerService.getVirtualUriMetadata(this.repository.uri);return{name:t,uri:this.providerService.createVirtualUri(this.repository.uri,{repo:e,ref:r}),location:tr.CurrentWindow}}async isDocumentIndexed(t){await this.metadata;const e=await this.indexMetadata;if(e===void 0||e.type===ft.NotIndexed||this.workspaceSnapshot===void 0)return 0;const r=this.pendingCapabilitiesRequests.get(t.uri.toString());return r!==void 0&&await r,this.registeredFeatures.has(t.uri.toString())?this.mapper===void 0?2:await this.mapper.needsMapping(t)?1:2:0}async getIndexedTip(){const t=await this.metadata,e=Xi.externalIndexUri(this.providerService,t),r=Go.getIndexBranchName(t);if(e===void 0||r===void 0)return;const n=await Wr.getIndexedTip(e,r,{authentication:this.providerService.getAuthentication(this.repository.uri)});if(n===void 0)return;const i=await Dc.get(this.providerService,this.repository.uri,n.commitId);if(i!==void 0)return{...i,branchName:r}}hasChanges(){return this.changeStore.hasChanges(this.repository.uri)}sync(t){return this.providerService.sync(this.repository.uri,this.changeStore,{to:t,reason:"user"})}async getCommit(t){const e=await this.metadata,r=Xi.externalIndexUri(this.providerService,e);if(r===void 0)return;const[n,i]=await Promise.all([Dc.get(this.providerService,this.repository.uri,t),Wr.single(r,t,void 0,{authentication:this.providerService.getAuthentication(this.repository.uri)})]);if(!(n===void 0||i===void 0))return{...n,branchName:i.branchName}}installDocumentListeners(){const t=[],e=a(async r=>{const n=r.uri.scheme;if(Xt.scheme!==n&&fo.scheme!==n)return;const i=r.uri.toString();if(n===Xt.scheme&&!i.startsWith(this.repositoryRoot)||n===fo.scheme&&!this.knownDesignTimeFiles.has(i)||this.pendingCapabilitiesRequests.has(i))return;const o=this.workspaceSnapshot!==void 0?this.workspaceSnapshot.commitId:void 0;if(o===void 0)return;let c=this.capabilitiesCache.get(i);if(c!==null){if(c===void 0){const l=this.capabilities(r.uri);this.pendingCapabilitiesRequests.set(i,l),c=await l,this.pendingCapabilitiesRequests.delete(i),this.capabilitiesCache.set(i,c===void 0?null:c)}c===void 0||!m.workspace.textDocuments.some(l=>l===r)||this.registerProviders(r,c,o)}},"openHandler");return t.push(m.workspace.onDidOpenTextDocument(e)),m.workspace.textDocuments.forEach(e),t.push(m.workspace.onDidCloseTextDocument(r=>{const n=r.uri.toString(),i=this.registeredFeatures.get(n);i!==void 0&&(this.registeredFeatures.delete(r.uri.toString()),i.dispose()),this.pendingCapabilitiesRequests.delete(n)})),m.Disposable.from(...t)}registerProviders(t,e,r){if(this.workspaceSnapshot===void 0)return;const n=this.workspaceSnapshot,i=t.languageId,c=[{scheme:this.repository.uri.scheme,pattern:t.uri.fsPath,language:t.languageId,exclusive:!0}],l=[],d=new Promise((N,U)=>{const W=`/${n.snapshotId}/source/`;this.metadata.then(V=>{N(qp(ie=>{const oe=m.Uri.parse(ie);if(V===void 0)return oe;try{if(oe.scheme==="vsck"&&oe.authority===n.workspaceId&&oe.path.startsWith(W))return this.repository.createRelativeUri(oe.path.substr(W.length));const ge=kc.toVSCode(ie);return ge!==void 0?(this.knownDesignTimeFiles.add(ge.toString()),ge):oe}catch(ge){return oe}}))},U)}),p=new RegExp(`^vsck:\\/\\/${n.workspaceId}\\/(?:latest|[a-fA-F0-9]{15})\\/designtime\\/(?:[a-fA-F0-9]+)(\\/?.*)$`);function S(N){const U=p.exec(N);return U===null||U.length===2}a(S,"designTimeFilter");function P(N){if(N==null)return N;if(Array.isArray(N)){if(N.length===0)return[];const U=N[0];return typeof U.uri=="string"?N.filter(ie=>S(ie.uri)):typeof U.targetUri=="string"?N.filter(ie=>S(ie.targetUri)):[]}return p.exec(N.uri)===null?N:void 0}a(P,"filterDesignTimeFiles");async function I(N,U,W){var V,ie,oe;if(W==null||N===void 0)return W;const ge=new Map(m.workspace.textDocuments.map(Re=>[Re.uri.toString(!0),Re]));if(Array.isArray(W)){const Re=[],Ie=[];if(W.length===0)return[];for(const Ye of W){const $e=Ye;if($e.uri instanceof m.Uri){const ze=await N.mapRangeFromIndexToCode((V=ge.get($e.uri.toString()))!=null?V:$e.uri,$e.range);ze!==void 0&&Re.push(new m.Location($e.uri,ze))}else{const ze=Ye,at=(ie=ge.get(ze.targetUri.toString()))!=null?ie:ze.targetUri,kt=ze.originSelectionRange?await N.mapRangeFromIndexToCode(U,ze.originSelectionRange):void 0;if(kt!==void 0||ze.originSelectionRange===void 0){const rn=await N.mapRangeFromIndexToCode(at,ze.targetRange);if(rn!==void 0){const Hn=ze.targetSelectionRange?await N.mapRangeFromIndexToCode(at,ze.targetSelectionRange):void 0;(Hn!==void 0||ze.targetSelectionRange===void 0)&&Ie.push({targetUri:ze.targetUri,targetRange:rn,targetSelectionRange:Hn,originSelectionRange:kt})}}}}return Re.length>0?Re:Ie}const ke=await N.mapRangeFromIndexToCode((oe=ge.get(W.uri.toString()))!=null?oe:W.uri,W.range);if(ke!==void 0)return new m.Location(W.uri,ke)}a(I,"mapLocations");const O=a(N=>({authentication:this.providerService.getAuthentication(N.uri),correlationId:vc()}),"getRestApiOptions"),F=a((N,U)=>{const W={method:N,correlationId:U.correlationId};this.telemetryService.publicLog2("codex.restAPICall",W)},"sendTelemetry");Yi.registerCapability(i,"hoverProvider",e)&&l.push(m.languages.registerHoverProvider(c,{provideHover:async(N,U)=>{const W=await this.createTextDocumentPositionParams(N,U);if(W===void 0)return;const V=O(N);return F("codex.provideHover",V),(await d).asHover(await li.provideHover(r,W,V))}})),Yi.registerCapability(i,"definitionProvider",e)&&l.push(m.languages.registerDefinitionProvider(c,{provideDefinition:async(N,U)=>{const W=await this.createTextDocumentPositionParams(N,U);if(W===void 0)return;const V=O(N);return F("codex.provideDefinition",V),I(this.mapper,N,(await d).asDefinitionResult(P(await li.provideDefinition(r,W,V))))}})),Yi.registerCapability(i,"declarationProvider",e)&&l.push(m.languages.registerDeclarationProvider(c,{provideDeclaration:async(N,U)=>{const W=await this.createTextDocumentPositionParams(N,U);if(W===void 0)return;const V=O(N);return F("codex.provideDeclaration",V),I(this.mapper,N,(await d).asDeclarationResult(P(await li.provideDeclaration(r,W,V))))}})),Yi.registerCapability(i,"typeDefinitionProvider",e)&&l.push(m.languages.registerTypeDefinitionProvider(c,{provideTypeDefinition:async(N,U)=>{const W=await this.createTextDocumentPositionParams(N,U);if(W===void 0)return;const V=O(N);return F("codex.provideTypeDefinition",V),I(this.mapper,N,(await d).asDefinitionResult(P(await li.provideTypeDefinition(r,W,V))))}})),Yi.registerCapability(i,"referencesProvider",e)&&l.push(m.languages.registerReferenceProvider(c,{provideReferences:async(N,U,W)=>{const V=this.mapper!==void 0?await this.mapper.mapPositionFromCodeToIndex(N,U):U;if(V===void 0)return;const ie={position:{line:V.line,character:V.character},textDocument:{uri:this.createRichNavDocumentUri(N.uri).toString(!0)},context:{includeDeclaration:W.includeDeclaration}},oe=O(N);return F("codex.provideReferences",oe),I(this.mapper,N,(await d).asReferences(P(await li.provideReferences(r,ie,oe))))}})),Yi.registerCapability(i,"foldingRangeProvider",e)&&l.push(m.languages.registerFoldingRangeProvider(c,{provideFoldingRanges:async N=>{if(this.mapper!==void 0&&await this.mapper.needsMapping(N))return;const U=O(N);return F("codex.provideFoldingRanges",U),(await d).asFoldingRanges(await li.providerFoldingRanges(r,this.createTextDocumentParams(N.uri),U))}})),this.registeredFeatures.set(t.uri.toString(),m.Disposable.from(...l)),Oa.updateStatusBarItem()}async capabilities(t){var e;const r=this.workspaceSnapshot!==void 0?this.workspaceSnapshot.commitId:void 0;if(r!==void 0)return(e=await li.capabilities(r,this.createTextDocumentParams(t),{authentication:this.providerService.getAuthentication(t)}))!=null?e:void 0}createTextDocumentParams(t){return{textDocument:{uri:this.createRichNavDocumentUri(t).toString(!0)}}}async createTextDocumentPositionParams(t,e){const r=this.mapper!==void 0?await this.mapper.mapPositionFromCodeToIndex(t,e):e;if(r!==void 0)return{position:{line:r.line,character:r.character},textDocument:{uri:this.createRichNavDocumentUri(t.uri).toString(!0)}}}createRichNavDocumentUri(t){if(t.scheme===fo.scheme){const n=kc.toRichNavComponents(t);return n===void 0?t:m.Uri.file(n.assetId)}const e=this.repository.uri.toString(!0),r=t.toString(!0);return m.Uri.file(r.substr(e.length))}},"_RichNavService");let Qu=Yi;Qu.localCapabilities=new Map([["javascript",Object.assign(Qi.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["javascriptreact",Object.assign(Qi.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescript",Object.assign(Qi.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})],["typescriptreact",Object.assign(Qi.create(),{documentSymbolProvider:!0,foldingRangeProvider:!0})]]),Qu.disabledCapabilities=new Map([["javascript",Object.assign(Qi.create(),{declarationProvider:!0})],["javascriptreact",Object.assign(Qi.create(),{declarationProvider:!0})],["typescript",Object.assign(Qi.create(),{declarationProvider:!0})],["typescriptreact",Object.assign(Qi.create(),{declarationProvider:!0})]]);var lh=a((t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)},"__accessCheck"),Yn=a((t,e,r)=>(lh(t,e,"read from private field"),r?r.call(t):e.get(t)),"__privateGet"),uh=a((t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},"__privateAdd"),dh=a((t,e,r,n)=>(lh(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),"__privateSet"),$n,Nc;class hh{constructor(e,r){uh(this,$n,void 0),uh(this,Nc,void 0),dh(this,$n,e),dh(this,Nc,r)}async hasWorkspaceContents(e){if(e.scheme!=="vscode-vfs"||Yn(this,$n).getProviderRootUri(e).scheme!=="github")return!1;const n=await Yn(this,$n).getMetadata(e);return await Yn(this,Nc).getCachedTar(e,n.HEAD.sha)!==void 0}async loadWorkspaceContents(e){if(e.scheme!=="vscode-vfs")return!1;const r=Yn(this,$n).getProviderRootUri(e);if(r.scheme!=="github")return!1;try{return await Yn(this,Nc).getTar(r),!0}catch(n){return L.error(n),!1}}async getMetadata(e){const r=Yn(this,$n).getVirtualUriMetadata(e);if(r===void 0)return;const{provider:n,repo:i}=r;return{provider:{id:n.id,name:n.name},repo:i,getRevision:async()=>{const{HEAD:o}=await Yn(this,$n).getMetadata(e);return{type:o.type,name:o.name,revision:o.sha}}}}getProvider(e){return Yn(this,$n).getRegisteredProvider(e)}getProviderUri(e){return Yn(this,$n).getProviderUri(e)}getProviderRootUri(e){return Yn(this,$n).getProviderRootUri(e)}isProviderUri(e,r){return e.scheme!==Xt.scheme&&Yn(this,$n).hasProvider(e,r)}getVirtualUri(e){return Yn(this,$n).getVirtualUri(e)}getVirtualWorkspaceUri(e){return Yn(this,$n).getVirtualWorkspaceUri(e)}}a(hh,"ExtensionApi"),$n=new WeakMap,Nc=new WeakMap;var zp=Object.defineProperty,Wp=Object.getOwnPropertyDescriptor,Yu=a((t,e,r,n)=>{for(var i=n>1?void 0:n?Wp(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&zp(e,r,i),i},"src_fs_decorateClass");const Zu=m.FileSystemError.FileNotFound().code;class Mc{constructor(e,r){this.providerService=e,this.changeStore=r,this._onDidChangeFile=new m.EventEmitter,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.disposable=m.Disposable.from(m.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0}),m.workspace.registerFileSearchProvider(this.scheme,this),m.workspace.registerTextSearchProvider(this.scheme,this),e.onDidChangeRepository(n=>{n.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([n.repository.uri])}),e.onDidRefresh(n=>this.onRefreshOrRepositoryChanged(n)),r.onDidChange(n=>{const i=n.map(o=>{switch(o.type){case Dt.Created:return{type:m.FileChangeType.Created,uri:o.uri};case Dt.Changed:return{type:m.FileChangeType.Changed,uri:o.uri};case Dt.Deleted:return{type:m.FileChangeType.Deleted,uri:o.uri}}});setTimeout(()=>this._onDidChangeFile.fire(i),0)}))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return Xt.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){e=e.filter(r=>r.scheme===this.scheme),e.length!==0&&(L.log(`fs.onRefreshOrRepositoryChanged(${e.map(r=>r.toString()).join(", ")})`),this.updateOpenOrWatchedUris(e))}updateOpenOrWatchedUris(e){const r=this.providerService.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(c=>ye(o,c))&&(this.implicitlyWatchedUris.delete(i),r.set(i,o));L.debug(`fs.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${r.size}`);for(const i of e)r.set(te(i),i);const n=[...r.values()].map(i=>({type:m.FileChangeType.Changed,uri:i}));setTimeout(()=>{L.debug(`fs.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,r){const n=te(e);this.watchedUris.set(n,e);const i=this.providerService.watch(this.providerService.getProviderUri(e),r);return{dispose:()=>{this.watchedUris.delete(n),i.dispose()}}}async stat(e){const r=new lt(`fs.stat(${e.toString()})`);let n;try{if(this.changeStore.maybeHasChanges(this.providerService.getVirtualRootUri(e),e)!==!1){if(r.logStep("ChangeStore query"),n=await this.changeStore.stat(e),n!==void 0)return n;r.logStep("Provider query",{message:": Not found \u2022",suffix:" \u2022 Querying provider..."})}else r.logStep("Provider query"),this.implicitlyWatchedUris.set(te(e),e);return n=await this.providerService.stat(this.providerService.getProviderUri(e)),n}finally{n===void 0&&this.implicitlyWatchedUris.delete(te(e)),r.stop()}}async readDirectory(e){const r=new lt(`fs.readDirectory(${e.toString()})`);this.implicitlyWatchedUris.set(te(e),e);try{r.logStep("Provider query");let n=await this.providerService.readDirectory(this.providerService.getProviderUri(e));return this.changeStore.maybeHasChanges(this.providerService.getVirtualRootUri(e))!==!1&&(r.logStep("Applying changes",{suffix:" \u2022 Applying changes..."}),n=await this.changeStore.updateDirectoryEntries(e,n)),n}finally{r.stop()}}async createDirectory(e){const r=new lt(`fs.createDirectory(${e.toString()})`);try{await this.changeStore.createDirectory(e)}catch(n){throw L.error(n,r.context),n}finally{r.stop()}}async readFile(e){const r=new lt(`fs.readFile(${e.toString()})`),n=te(e);let i;try{if(this.changeStore.maybeHasChanges(this.providerService.getVirtualRootUri(e),e)!==!1){r.logStep("ChangeStore query");const o=await this.changeStore.readFile(e);if(o!==void 0)return o;r.logStep("Provider query",{message:": Not found \u2022",suffix:" \u2022 Querying provider..."})}else r.logStep("Provider query"),this.implicitlyWatchedUris.set(n,e);return i=await this.providerService.readFile(this.providerService.getProviderUri(e)),i}finally{i===void 0&&this.implicitlyWatchedUris.delete(n),r.stop()}}async writeFile(e,r,n){const i=new lt(`fs.writeFile(${e.toString()})`,{},r.length,n);try{let o;try{if(o=await this.stat(e),!n.overwrite)throw m.FileSystemError.FileExists()}catch(c){if(c instanceof m.FileSystemError&&c.code===Zu){if(!n.create)throw m.FileSystemError.FileNotFound(e)}else throw c}try{if(o===void 0)await this.changeStore.createFile(e,r);else{i.logStep("Provider original query");let c;try{c=await this.providerService.readFile(this.providerService.getProviderUri(e))}catch(l){if(l instanceof m.FileSystemError&&l.code===Zu)c=new Uint8Array;else throw l}i.logStep("Writing file",{suffix:" \u2022 Writing file to Change Store..."}),await this.changeStore.writeFile(e,r,c)}}catch(c){throw L.error(c,i.context),c}}finally{i.stop()}}async delete(e,r){const n=new lt(`fs.delete(${e.toString()})`,{},r);try{switch((await this.stat(e)).type){case m.FileType.File:await this.changeStore.deleteFile(e);break;case m.FileType.Directory:{await this.deleteDirectory(e,r);break}default:throw m.FileSystemError.NoPermissions()}}catch(i){throw L.error(i,n.context),i}finally{n.stop()}}async deleteDirectory(e,r){const n=new lt(`fs.deleteDirectory(${e.toString()})`,{},r);try{const i=await this.readDirectory(e);if(i.length!==0){if(!r.recursive&&i.some(([,o])=>o===m.FileType.Directory))throw m.FileSystemError.NoPermissions();for(const[o,c]of i)c===m.FileType.Directory?await this.deleteDirectory(m.Uri.joinPath(e,o),r):await this.changeStore.deleteFile(m.Uri.joinPath(e,o))}await this.changeStore.deleteDirectory(e)}catch(i){throw L.error(i,n.context),i}finally{n.stop()}}async rename(e,r,n){const i=new lt(`fs.rename(${e.toString()} -> ${r.toString()})`,{},n);try{switch((await this.stat(e)).type){case m.FileType.File:{const c=await this.readFile(e);await this.writeFile(r,c,{create:!0,overwrite:n.overwrite}),await this.delete(e,{recursive:!1});break}case m.FileType.Directory:{await this.renameDirectory(e,r,n);break}default:throw m.FileSystemError.NoPermissions()}}catch(o){throw L.error(o,i.context),o}finally{i.stop()}}async renameDirectory(e,r,n){const i=new lt(`fs.renameDirectory(${e.toString()} -> ${r.toString()})`,{},n);try{await this.copyDirectory(e,r,n),await this.delete(e,{recursive:!0})}catch(o){throw L.error(o,i.context),o}finally{i.stop()}}async copy(e,r,n){const i=new lt(`fs.copy(${e.toString()} -> ${r.toString()})`,{},n);try{switch((await this.stat(e)).type){case m.FileType.File:{const c=await this.readFile(e);await this.writeFile(r,c,{create:!0,overwrite:n.overwrite});break}case m.FileType.Directory:{await this.copyDirectory(e,r,n);break}default:throw m.FileSystemError.NoPermissions()}}catch(o){throw L.error(o,i.context),o}finally{i.stop()}}async copyDirectory(e,r,n){const i=new lt(`fs.copyDirectory(${e.toString()} -> ${r.toString()})`,{},n);try{if(await this.exists(r))throw m.FileSystemError.FileExists();try{await this.createDirectory(r);const o=await this.readDirectory(e);for(const[c,l]of o)l===m.FileType.Directory?await this.copyDirectory(m.Uri.joinPath(e,c),m.Uri.joinPath(r,c),n):await this.copy(m.Uri.joinPath(e,c),m.Uri.joinPath(r,c),n)}catch(o){throw L.error(o,i.context),o}}finally{i.stop()}}async exists(e){try{return await this.stat(e),!0}catch(r){if(r instanceof m.FileSystemError&&r.code===Zu)return!1;throw r}}async provideFileSearchResults(e,r,n){var i;const o=new lt(`fs.provideFileSearchResults(${e.pattern}, ${r.folder.toString()})`,{logLevel:qe.Debug});let c;try{return c=await this.providerService.provideFileSearchResults(e,{...r,folder:this.providerService.getProviderUri(r.folder)},n),c==null?void 0:c.map(l=>this.providerService.getVirtualUri(l))}catch(l){throw L.error(l,o.context),l}finally{o.stop({suffix:` \u2022 ${(i=c==null?void 0:c.length)!=null?i:0} results found`})}}provideTextSearchResults(e,r,n,i){return this.providerService.provideTextSearchResults(e,{...r,folder:this.providerService.getProviderUri(r.folder)},{report:o=>n.report({...o,uri:this.providerService.getVirtualUri(o.uri)})},i)}}a(Mc,"ChangeTrackingFileSystem"),Yu([Lr()],Mc.prototype,"stat",1),Yu([Lr()],Mc.prototype,"readDirectory",1),Yu([Lr()],Mc.prototype,"readFile",1);function Gp(t){return t.replace(/[\\{}*+?|^$.[\]()]/g,"\\$&")}a(Gp,"escapeRegExpCharacters");function Vp(t,e,r={}){if(!t)throw new Error("Cannot create regex from empty string");e||(t=Gp(t)),r.wholeWord&&(/\B/.test(t.charAt(0))||(t=`\\b${t}`),/\B/.test(t.charAt(t.length-1))||(t=`${t}\\b`));let n="gmu";return r.matchCase||(n+="i"),new RegExp(t,n)}a(Vp,"createRegExp");let fh,ph,Ju;const Kp=a((t,e,r,n)=>{const i=`${e.join("--")};;;;${r.join("--")}`,o=t.map(l=>l.path).join("::");if(fh===o&&i==ph&&Ju)return Ju;const c=_a((n?t.filter(l=>l.size<n):t).map(l=>l.path),e,r);return fh=o,ph=i,Ju=c,c},"generateIncludeSet"),Xp=a((t,e,r,n)=>{var i;const o=[];let c;if(typeof t=="string")c=t;else{const S=t;if(S[0]==255&&S[1]==254)c=new TextDecoder("utf-16le").decode(S);else if(S[0]==254&&S[1]==255)c=new TextDecoder("utf-16be").decode(S);else if(c=new TextDecoder("utf8").decode(S),c.slice(0,1e3).includes("\uFFFD")&&S.includes(0))return[]}const l=[];let d=null,p=n.remainingResultQuota;for(;(p===void 0||p>=0)&&(d=r.exec(c));)l.push({matchStartIndex:d.index,matchedText:d[0]}),p!==void 0&&p--;if(l.length){const S=new Set,P=new Set,I=[],O=a(V=>c.slice(I[V].start,I[V].end),"readLine");let F=0,N=null;const U=/\r?\n/g;for(;N=U.exec(c);)I.push({start:F,end:N.index}),F=N.index+N[0].length;F<c.length&&I.push({start:F,end:c.length});let W=0;for(const{matchStartIndex:V,matchedText:ie}of l){if(p!==void 0&&p<0)break;for(;Boolean(I[W+1])&&V>I[W].end;)W++;let oe=W;for(;Boolean(I[oe+1])&&V+ie.length>I[oe].end;)oe++;if(n.beforeContext)for(let $e=Math.max(0,W-n.beforeContext);$e<W;$e++)S.add($e);let ge="",ke=0;for(let $e=W;$e<=oe;$e++){let ze=O($e);((i=n.previewOptions)==null?void 0:i.charsPerLine)&&ze.length>n.previewOptions.charsPerLine&&(ke=Math.max(V-I[W].start-20,0),ze=ze.substr(ke,n.previewOptions.charsPerLine)),ge+=`${ze}
`,P.add($e)}const Re=new m.Range(W,V-I[W].start,oe,V+ie.length-I[oe].start),Ie=new m.Range(0,V-I[W].start-ke,oe-W,V+ie.length-I[oe].start-(oe===W?ke:0)),Ye={uri:m.Uri.file(e),ranges:Re,preview:{text:ge,matches:Ie}};if(o.push(Ye),n.afterContext)for(let $e=oe+1;$e<=Math.min(oe+n.afterContext,I.length-1);$e++)S.add($e)}for(const V of S)P.has(V)||o.push({uri:m.Uri.file(e),text:O(V),lineNumber:V+1})}return o},"getFileResults");var Qp=__webpack_require__(5790);/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Yp=4,gh=0,mh=1,Zp=2;function Ms(t){let e=t.length;for(;--e>=0;)t[e]=0}a(Ms,"zero$1");const Jp=0,vh=1,eg=2,tg=3,rg=258,ed=29,Lc=256,$c=Lc+1+ed,Ls=30,td=19,yh=2*$c+1,Pa=15,rd=16,ng=7,nd=256,_h=16,wh=17,bh=18,id=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),zl=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),ig=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Sh=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),og=512,po=new Array(($c+2)*2);Ms(po);const Fc=new Array(Ls*2);Ms(Fc);const Bc=new Array(og);Ms(Bc);const Hc=new Array(rg-tg+1);Ms(Hc);const od=new Array(ed);Ms(od);const Wl=new Array(Ls);Ms(Wl);function ad(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}a(ad,"StaticTreeDesc");let Eh,xh,Ch;function sd(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}a(sd,"TreeDesc");const Th=a(t=>t<256?Bc[t]:Bc[256+(t>>>7)],"d_code"),Uc=a((t,e)=>{t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255},"put_short"),Fn=a((t,e,r)=>{t.bi_valid>rd-r?(t.bi_buf|=e<<t.bi_valid&65535,Uc(t,t.bi_buf),t.bi_buf=e>>rd-t.bi_valid,t.bi_valid+=r-rd):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},"send_bits"),Zi=a((t,e,r)=>{Fn(t,r[e*2],r[e*2+1])},"send_code"),Ah=a((t,e)=>{let r=0;do r|=t&1,t>>>=1,r<<=1;while(--e>0);return r>>>1},"bi_reverse"),ag=a(t=>{t.bi_valid===16?(Uc(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},"bi_flush"),sg=a((t,e)=>{const r=e.dyn_tree,n=e.max_code,i=e.stat_desc.static_tree,o=e.stat_desc.has_stree,c=e.stat_desc.extra_bits,l=e.stat_desc.extra_base,d=e.stat_desc.max_length;let p,S,P,I,O,F,N=0;for(I=0;I<=Pa;I++)t.bl_count[I]=0;for(r[t.heap[t.heap_max]*2+1]=0,p=t.heap_max+1;p<yh;p++)S=t.heap[p],I=r[r[S*2+1]*2+1]+1,I>d&&(I=d,N++),r[S*2+1]=I,!(S>n)&&(t.bl_count[I]++,O=0,S>=l&&(O=c[S-l]),F=r[S*2],t.opt_len+=F*(I+O),o&&(t.static_len+=F*(i[S*2+1]+O)));if(N!==0){do{for(I=d-1;t.bl_count[I]===0;)I--;t.bl_count[I]--,t.bl_count[I+1]+=2,t.bl_count[d]--,N-=2}while(N>0);for(I=d;I!==0;I--)for(S=t.bl_count[I];S!==0;)P=t.heap[--p],!(P>n)&&(r[P*2+1]!==I&&(t.opt_len+=(I-r[P*2+1])*r[P*2],r[P*2+1]=I),S--)}},"gen_bitlen"),Rh=a((t,e,r)=>{const n=new Array(Pa+1);let i=0,o,c;for(o=1;o<=Pa;o++)n[o]=i=i+r[o-1]<<1;for(c=0;c<=e;c++){let l=t[c*2+1];l!==0&&(t[c*2]=Ah(n[l]++,l))}},"gen_codes"),cg=a(()=>{let t,e,r,n,i;const o=new Array(Pa+1);for(r=0,n=0;n<ed-1;n++)for(od[n]=r,t=0;t<1<<id[n];t++)Hc[r++]=n;for(Hc[r-1]=n,i=0,n=0;n<16;n++)for(Wl[n]=i,t=0;t<1<<zl[n];t++)Bc[i++]=n;for(i>>=7;n<Ls;n++)for(Wl[n]=i<<7,t=0;t<1<<zl[n]-7;t++)Bc[256+i++]=n;for(e=0;e<=Pa;e++)o[e]=0;for(t=0;t<=143;)po[t*2+1]=8,t++,o[8]++;for(;t<=255;)po[t*2+1]=9,t++,o[9]++;for(;t<=279;)po[t*2+1]=7,t++,o[7]++;for(;t<=287;)po[t*2+1]=8,t++,o[8]++;for(Rh(po,$c+1,o),t=0;t<Ls;t++)Fc[t*2+1]=5,Fc[t*2]=Ah(t,5);Eh=new ad(po,id,Lc+1,$c,Pa),xh=new ad(Fc,zl,0,Ls,Pa),Ch=new ad(new Array(0),ig,0,td,ng)},"tr_static_init"),Ih=a(t=>{let e;for(e=0;e<$c;e++)t.dyn_ltree[e*2]=0;for(e=0;e<Ls;e++)t.dyn_dtree[e*2]=0;for(e=0;e<td;e++)t.bl_tree[e*2]=0;t.dyn_ltree[nd*2]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},"init_block"),Oh=a(t=>{t.bi_valid>8?Uc(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},"bi_windup"),lg=a((t,e,r,n)=>{Oh(t),n&&(Uc(t,r),Uc(t,~r)),t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r},"copy_block"),Ph=a((t,e,r,n)=>{const i=e*2,o=r*2;return t[i]<t[o]||t[i]===t[o]&&n[e]<=n[r]},"smaller"),cd=a((t,e,r)=>{const n=t.heap[r];let i=r<<1;for(;i<=t.heap_len&&(i<t.heap_len&&Ph(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!Ph(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n},"pqdownheap"),Dh=a((t,e,r)=>{let n,i,o=0,c,l;if(t.last_lit!==0)do n=t.pending_buf[t.d_buf+o*2]<<8|t.pending_buf[t.d_buf+o*2+1],i=t.pending_buf[t.l_buf+o],o++,n===0?Zi(t,i,e):(c=Hc[i],Zi(t,c+Lc+1,e),l=id[c],l!==0&&(i-=od[c],Fn(t,i,l)),n--,c=Th(n),Zi(t,c,r),l=zl[c],l!==0&&(n-=Wl[c],Fn(t,n,l)));while(o<t.last_lit);Zi(t,nd,e)},"compress_block"),ld=a((t,e)=>{const r=e.dyn_tree,n=e.stat_desc.static_tree,i=e.stat_desc.has_stree,o=e.stat_desc.elems;let c,l,d=-1,p;for(t.heap_len=0,t.heap_max=yh,c=0;c<o;c++)r[c*2]!==0?(t.heap[++t.heap_len]=d=c,t.depth[c]=0):r[c*2+1]=0;for(;t.heap_len<2;)p=t.heap[++t.heap_len]=d<2?++d:0,r[p*2]=1,t.depth[p]=0,t.opt_len--,i&&(t.static_len-=n[p*2+1]);for(e.max_code=d,c=t.heap_len>>1;c>=1;c--)cd(t,r,c);p=o;do c=t.heap[1],t.heap[1]=t.heap[t.heap_len--],cd(t,r,1),l=t.heap[1],t.heap[--t.heap_max]=c,t.heap[--t.heap_max]=l,r[p*2]=r[c*2]+r[l*2],t.depth[p]=(t.depth[c]>=t.depth[l]?t.depth[c]:t.depth[l])+1,r[c*2+1]=r[l*2+1]=p,t.heap[1]=p++,cd(t,r,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],sg(t,e),Rh(r,d,t.bl_count)},"build_tree"),kh=a((t,e,r)=>{let n,i=-1,o,c=e[0*2+1],l=0,d=7,p=4;for(c===0&&(d=138,p=3),e[(r+1)*2+1]=65535,n=0;n<=r;n++)o=c,c=e[(n+1)*2+1],!(++l<d&&o===c)&&(l<p?t.bl_tree[o*2]+=l:o!==0?(o!==i&&t.bl_tree[o*2]++,t.bl_tree[_h*2]++):l<=10?t.bl_tree[wh*2]++:t.bl_tree[bh*2]++,l=0,i=o,c===0?(d=138,p=3):o===c?(d=6,p=3):(d=7,p=4))},"scan_tree"),Nh=a((t,e,r)=>{let n,i=-1,o,c=e[0*2+1],l=0,d=7,p=4;for(c===0&&(d=138,p=3),n=0;n<=r;n++)if(o=c,c=e[(n+1)*2+1],!(++l<d&&o===c)){if(l<p)do Zi(t,o,t.bl_tree);while(--l!=0);else o!==0?(o!==i&&(Zi(t,o,t.bl_tree),l--),Zi(t,_h,t.bl_tree),Fn(t,l-3,2)):l<=10?(Zi(t,wh,t.bl_tree),Fn(t,l-3,3)):(Zi(t,bh,t.bl_tree),Fn(t,l-11,7));l=0,i=o,c===0?(d=138,p=3):o===c?(d=6,p=3):(d=7,p=4)}},"send_tree"),ug=a(t=>{let e;for(kh(t,t.dyn_ltree,t.l_desc.max_code),kh(t,t.dyn_dtree,t.d_desc.max_code),ld(t,t.bl_desc),e=td-1;e>=3&&t.bl_tree[Sh[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e},"build_bl_tree"),dg=a((t,e,r,n)=>{let i;for(Fn(t,e-257,5),Fn(t,r-1,5),Fn(t,n-4,4),i=0;i<n;i++)Fn(t,t.bl_tree[Sh[i]*2+1],3);Nh(t,t.dyn_ltree,e-1),Nh(t,t.dyn_dtree,r-1)},"send_all_trees"),hg=a(t=>{let e=4093624447,r;for(r=0;r<=31;r++,e>>>=1)if(e&1&&t.dyn_ltree[r*2]!==0)return gh;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return mh;for(r=32;r<Lc;r++)if(t.dyn_ltree[r*2]!==0)return mh;return gh},"detect_data_type");let Mh=!1;const fg=a(t=>{Mh||(cg(),Mh=!0),t.l_desc=new sd(t.dyn_ltree,Eh),t.d_desc=new sd(t.dyn_dtree,xh),t.bl_desc=new sd(t.bl_tree,Ch),t.bi_buf=0,t.bi_valid=0,Ih(t)},"_tr_init$1"),Lh=a((t,e,r,n)=>{Fn(t,(Jp<<1)+(n?1:0),3),lg(t,e,r,!0)},"_tr_stored_block$1"),pg=a(t=>{Fn(t,vh<<1,3),Zi(t,nd,po),ag(t)},"_tr_align$1"),gg=a((t,e,r,n)=>{let i,o,c=0;t.level>0?(t.strm.data_type===Zp&&(t.strm.data_type=hg(t)),ld(t,t.l_desc),ld(t,t.d_desc),c=ug(t),i=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=i&&(i=o)):i=o=r+5,r+4<=i&&e!==-1?Lh(t,e,r,n):t.strategy===Yp||o===i?(Fn(t,(vh<<1)+(n?1:0),3),Dh(t,po,Fc)):(Fn(t,(eg<<1)+(n?1:0),3),dg(t,t.l_desc.max_code+1,t.d_desc.max_code+1,c+1),Dh(t,t.dyn_ltree,t.dyn_dtree)),Ih(t),n&&Oh(t)},"_tr_flush_block$1"),mg=a((t,e,r)=>(t.pending_buf[t.d_buf+t.last_lit*2]=e>>>8&255,t.pending_buf[t.d_buf+t.last_lit*2+1]=e&255,t.pending_buf[t.l_buf+t.last_lit]=r&255,t.last_lit++,e===0?t.dyn_ltree[r*2]++:(t.matches++,e--,t.dyn_ltree[(Hc[r]+Lc+1)*2]++,t.dyn_dtree[Th(e)*2]++),t.last_lit===t.lit_bufsize-1),"_tr_tally$1");var vg=fg,yg=Lh,_g=gg,wg=mg,bg=pg,Sg={_tr_init:vg,_tr_stored_block:yg,_tr_flush_block:_g,_tr_tally:wg,_tr_align:bg},jc=a((t,e,r,n)=>{let i=t&65535|0,o=t>>>16&65535|0,c=0;for(;r!==0;){c=r>2e3?2e3:r,r-=c;do i=i+e[n++]|0,o=o+i|0;while(--c);i%=65521,o%=65521}return i|o<<16|0},"adler32");const Eg=a(()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},"makeTable"),xg=new Uint32Array(Eg());var en=a((t,e,r,n)=>{const i=xg,o=n+r;t^=-1;for(let c=n;c<o;c++)t=t>>>8^i[(t^e[c])&255];return t^-1},"crc32"),Da={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ka={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Cg,_tr_stored_block:Tg,_tr_flush_block:Ag,_tr_tally:Vo,_tr_align:Rg}=Sg,{Z_NO_FLUSH:Na,Z_PARTIAL_FLUSH:Ig,Z_FULL_FLUSH:Og,Z_FINISH:Ko,Z_BLOCK:$h,Z_OK:Ji,Z_STREAM_END:Fh,Z_STREAM_ERROR:ui,Z_DATA_ERROR:Pg,Z_BUF_ERROR:ud,Z_DEFAULT_COMPRESSION:Dg,Z_FILTERED:kg,Z_HUFFMAN_ONLY:Gl,Z_RLE:Ng,Z_FIXED:Mg,Z_DEFAULT_STRATEGY:Lg,Z_UNKNOWN:$g,Z_DEFLATED:Vl}=ka,Fg=9,Bg=15,Hg=8,Ug=29,dd=256+1+Ug,jg=30,qg=19,zg=2*dd+1,Wg=15,Yt=3,Xo=258,Ai=Xo+Yt+1,Gg=32,Kl=42,hd=69,Xl=73,Ql=91,Yl=103,Ma=113,qc=666,Gr=1,zc=2,La=3,$s=4,Vg=3,Qo=a((t,e)=>(t.msg=Da[e],e),"err"),Bh=a(t=>(t<<1)-(t>4?9:0),"rank"),Yo=a(t=>{let e=t.length;for(;--e>=0;)t[e]=0},"zero");let Zo=a((t,e,r)=>(e<<t.hash_shift^r)&t.hash_mask,"HASH_ZLIB");const Jo=a(t=>{const e=t.state;let r=e.pending;r>t.avail_out&&(r=t.avail_out),r!==0&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,e.pending===0&&(e.pending_out=0))},"flush_pending"),ln=a((t,e)=>{Ag(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Jo(t.strm)},"flush_block_only"),or=a((t,e)=>{t.pending_buf[t.pending++]=e},"put_byte"),Wc=a((t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255},"putShortMSB"),Kg=a((t,e,r,n)=>{let i=t.avail_in;return i>n&&(i=n),i===0?0:(t.avail_in-=i,e.set(t.input.subarray(t.next_in,t.next_in+i),r),t.state.wrap===1?t.adler=jc(t.adler,e,i,r):t.state.wrap===2&&(t.adler=en(t.adler,e,i,r)),t.next_in+=i,t.total_in+=i,i)},"read_buf"),Hh=a((t,e)=>{let r=t.max_chain_length,n=t.strstart,i,o,c=t.prev_length,l=t.nice_match;const d=t.strstart>t.w_size-Ai?t.strstart-(t.w_size-Ai):0,p=t.window,S=t.w_mask,P=t.prev,I=t.strstart+Xo;let O=p[n+c-1],F=p[n+c];t.prev_length>=t.good_match&&(r>>=2),l>t.lookahead&&(l=t.lookahead);do if(i=e,!(p[i+c]!==F||p[i+c-1]!==O||p[i]!==p[n]||p[++i]!==p[n+1])){n+=2,i++;do;while(p[++n]===p[++i]&&p[++n]===p[++i]&&p[++n]===p[++i]&&p[++n]===p[++i]&&p[++n]===p[++i]&&p[++n]===p[++i]&&p[++n]===p[++i]&&p[++n]===p[++i]&&n<I);if(o=Xo-(I-n),n=I-Xo,o>c){if(t.match_start=e,c=o,o>=l)break;O=p[n+c-1],F=p[n+c]}}while((e=P[e&S])>d&&--r!=0);return c<=t.lookahead?c:t.lookahead},"longest_match"),$a=a(t=>{const e=t.w_size;let r,n,i,o,c;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Ai)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,n=t.hash_size,r=n;do i=t.head[--r],t.head[r]=i>=e?i-e:0;while(--n);n=e,r=n;do i=t.prev[--r],t.prev[r]=i>=e?i-e:0;while(--n);o+=e}if(t.strm.avail_in===0)break;if(n=Kg(t.strm,t.window,t.strstart+t.lookahead,o),t.lookahead+=n,t.lookahead+t.insert>=Yt)for(c=t.strstart-t.insert,t.ins_h=t.window[c],t.ins_h=Zo(t,t.ins_h,t.window[c+1]);t.insert&&(t.ins_h=Zo(t,t.ins_h,t.window[c+Yt-1]),t.prev[c&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=c,c++,t.insert--,!(t.lookahead+t.insert<Yt)););}while(t.lookahead<Ai&&t.strm.avail_in!==0)},"fill_window"),Xg=a((t,e)=>{let r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if($a(t),t.lookahead===0&&e===Na)return Gr;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;const n=t.block_start+r;if((t.strstart===0||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,ln(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-Ai&&(ln(t,!1),t.strm.avail_out===0))return Gr}return t.insert=0,e===Ko?(ln(t,!0),t.strm.avail_out===0?La:$s):(t.strstart>t.block_start&&(ln(t,!1),t.strm.avail_out===0),Gr)},"deflate_stored"),fd=a((t,e)=>{let r,n;for(;;){if(t.lookahead<Ai){if($a(t),t.lookahead<Ai&&e===Na)return Gr;if(t.lookahead===0)break}if(r=0,t.lookahead>=Yt&&(t.ins_h=Zo(t,t.ins_h,t.window[t.strstart+Yt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),r!==0&&t.strstart-r<=t.w_size-Ai&&(t.match_length=Hh(t,r)),t.match_length>=Yt)if(n=Vo(t,t.strstart-t.match_start,t.match_length-Yt),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=Yt){t.match_length--;do t.strstart++,t.ins_h=Zo(t,t.ins_h,t.window[t.strstart+Yt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!=0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Zo(t,t.ins_h,t.window[t.strstart+1]);else n=Vo(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(ln(t,!1),t.strm.avail_out===0))return Gr}return t.insert=t.strstart<Yt-1?t.strstart:Yt-1,e===Ko?(ln(t,!0),t.strm.avail_out===0?La:$s):t.last_lit&&(ln(t,!1),t.strm.avail_out===0)?Gr:zc},"deflate_fast"),Fs=a((t,e)=>{let r,n,i;for(;;){if(t.lookahead<Ai){if($a(t),t.lookahead<Ai&&e===Na)return Gr;if(t.lookahead===0)break}if(r=0,t.lookahead>=Yt&&(t.ins_h=Zo(t,t.ins_h,t.window[t.strstart+Yt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=Yt-1,r!==0&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Ai&&(t.match_length=Hh(t,r),t.match_length<=5&&(t.strategy===kg||t.match_length===Yt&&t.strstart-t.match_start>4096)&&(t.match_length=Yt-1)),t.prev_length>=Yt&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-Yt,n=Vo(t,t.strstart-1-t.prev_match,t.prev_length-Yt),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=i&&(t.ins_h=Zo(t,t.ins_h,t.window[t.strstart+Yt-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!=0);if(t.match_available=0,t.match_length=Yt-1,t.strstart++,n&&(ln(t,!1),t.strm.avail_out===0))return Gr}else if(t.match_available){if(n=Vo(t,0,t.window[t.strstart-1]),n&&ln(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return Gr}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=Vo(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<Yt-1?t.strstart:Yt-1,e===Ko?(ln(t,!0),t.strm.avail_out===0?La:$s):t.last_lit&&(ln(t,!1),t.strm.avail_out===0)?Gr:zc},"deflate_slow"),Qg=a((t,e)=>{let r,n,i,o;const c=t.window;for(;;){if(t.lookahead<=Xo){if($a(t),t.lookahead<=Xo&&e===Na)return Gr;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=Yt&&t.strstart>0&&(i=t.strstart-1,n=c[i],n===c[++i]&&n===c[++i]&&n===c[++i])){o=t.strstart+Xo;do;while(n===c[++i]&&n===c[++i]&&n===c[++i]&&n===c[++i]&&n===c[++i]&&n===c[++i]&&n===c[++i]&&n===c[++i]&&i<o);t.match_length=Xo-(o-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=Yt?(r=Vo(t,1,t.match_length-Yt),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=Vo(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(ln(t,!1),t.strm.avail_out===0))return Gr}return t.insert=0,e===Ko?(ln(t,!0),t.strm.avail_out===0?La:$s):t.last_lit&&(ln(t,!1),t.strm.avail_out===0)?Gr:zc},"deflate_rle"),Yg=a((t,e)=>{let r;for(;;){if(t.lookahead===0&&($a(t),t.lookahead===0)){if(e===Na)return Gr;break}if(t.match_length=0,r=Vo(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(ln(t,!1),t.strm.avail_out===0))return Gr}return t.insert=0,e===Ko?(ln(t,!0),t.strm.avail_out===0?La:$s):t.last_lit&&(ln(t,!1),t.strm.avail_out===0)?Gr:zc},"deflate_huff");function eo(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}a(eo,"Config");const Gc=[new eo(0,0,0,0,Xg),new eo(4,4,8,4,fd),new eo(4,5,16,8,fd),new eo(4,6,32,32,fd),new eo(4,4,16,16,Fs),new eo(8,16,32,32,Fs),new eo(8,16,128,128,Fs),new eo(8,32,128,256,Fs),new eo(32,128,258,1024,Fs),new eo(32,258,258,4096,Fs)],Zg=a(t=>{t.window_size=2*t.w_size,Yo(t.head),t.max_lazy_match=Gc[t.level].max_lazy,t.good_match=Gc[t.level].good_length,t.nice_match=Gc[t.level].nice_length,t.max_chain_length=Gc[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Yt-1,t.match_available=0,t.ins_h=0},"lm_init");function Jg(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Vl,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(zg*2),this.dyn_dtree=new Uint16Array((2*jg+1)*2),this.bl_tree=new Uint16Array((2*qg+1)*2),Yo(this.dyn_ltree),Yo(this.dyn_dtree),Yo(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Wg+1),this.heap=new Uint16Array(2*dd+1),Yo(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*dd+1),Yo(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}a(Jg,"DeflateState");const Uh=a(t=>{if(!t||!t.state)return Qo(t,ui);t.total_in=t.total_out=0,t.data_type=$g;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?Kl:Ma,t.adler=e.wrap===2?0:1,e.last_flush=Na,Cg(e),Ji},"deflateResetKeep"),jh=a(t=>{const e=Uh(t);return e===Ji&&Zg(t.state),e},"deflateReset"),em=a((t,e)=>!t||!t.state||t.state.wrap!==2?ui:(t.state.gzhead=e,Ji),"deflateSetHeader"),qh=a((t,e,r,n,i,o)=>{if(!t)return ui;let c=1;if(e===Dg&&(e=6),n<0?(c=0,n=-n):n>15&&(c=2,n-=16),i<1||i>Fg||r!==Vl||n<8||n>15||e<0||e>9||o<0||o>Mg)return Qo(t,ui);n===8&&(n=9);const l=new Jg;return t.state=l,l.strm=t,l.wrap=c,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=i+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+Yt-1)/Yt),l.window=new Uint8Array(l.w_size*2),l.head=new Uint16Array(l.hash_size),l.prev=new Uint16Array(l.w_size),l.lit_bufsize=1<<i+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new Uint8Array(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=(1+2)*l.lit_bufsize,l.level=e,l.strategy=o,l.method=r,jh(t)},"deflateInit2"),tm=a((t,e)=>qh(t,e,Vl,Bg,Hg,Lg),"deflateInit"),rm=a((t,e)=>{let r,n;if(!t||!t.state||e>$h||e<0)return t?Qo(t,ui):ui;const i=t.state;if(!t.output||!t.input&&t.avail_in!==0||i.status===qc&&e!==Ko)return Qo(t,t.avail_out===0?ud:ui);i.strm=t;const o=i.last_flush;if(i.last_flush=e,i.status===Kl)if(i.wrap===2)t.adler=0,or(i,31),or(i,139),or(i,8),i.gzhead?(or(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),or(i,i.gzhead.time&255),or(i,i.gzhead.time>>8&255),or(i,i.gzhead.time>>16&255),or(i,i.gzhead.time>>24&255),or(i,i.level===9?2:i.strategy>=Gl||i.level<2?4:0),or(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(or(i,i.gzhead.extra.length&255),or(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=en(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=hd):(or(i,0),or(i,0),or(i,0),or(i,0),or(i,0),or(i,i.level===9?2:i.strategy>=Gl||i.level<2?4:0),or(i,Vg),i.status=Ma);else{let c=Vl+(i.w_bits-8<<4)<<8,l=-1;i.strategy>=Gl||i.level<2?l=0:i.level<6?l=1:i.level===6?l=2:l=3,c|=l<<6,i.strstart!==0&&(c|=Gg),c+=31-c%31,i.status=Ma,Wc(i,c),i.strstart!==0&&(Wc(i,t.adler>>>16),Wc(i,t.adler&65535)),t.adler=1}if(i.status===hd)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=en(t.adler,i.pending_buf,i.pending-r,r)),Jo(t),r=i.pending,i.pending===i.pending_buf_size));)or(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>r&&(t.adler=en(t.adler,i.pending_buf,i.pending-r,r)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=Xl)}else i.status=Xl;if(i.status===Xl)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=en(t.adler,i.pending_buf,i.pending-r,r)),Jo(t),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.name.length?n=i.gzhead.name.charCodeAt(i.gzindex++)&255:n=0,or(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(t.adler=en(t.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.gzindex=0,i.status=Ql)}else i.status=Ql;if(i.status===Ql)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=en(t.adler,i.pending_buf,i.pending-r,r)),Jo(t),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.comment.length?n=i.gzhead.comment.charCodeAt(i.gzindex++)&255:n=0,or(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(t.adler=en(t.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.status=Yl)}else i.status=Yl;if(i.status===Yl&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&Jo(t),i.pending+2<=i.pending_buf_size&&(or(i,t.adler&255),or(i,t.adler>>8&255),t.adler=0,i.status=Ma)):i.status=Ma),i.pending!==0){if(Jo(t),t.avail_out===0)return i.last_flush=-1,Ji}else if(t.avail_in===0&&Bh(e)<=Bh(o)&&e!==Ko)return Qo(t,ud);if(i.status===qc&&t.avail_in!==0)return Qo(t,ud);if(t.avail_in!==0||i.lookahead!==0||e!==Na&&i.status!==qc){let c=i.strategy===Gl?Yg(i,e):i.strategy===Ng?Qg(i,e):Gc[i.level].func(i,e);if((c===La||c===$s)&&(i.status=qc),c===Gr||c===La)return t.avail_out===0&&(i.last_flush=-1),Ji;if(c===zc&&(e===Ig?Rg(i):e!==$h&&(Tg(i,0,0,!1),e===Og&&(Yo(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Jo(t),t.avail_out===0))return i.last_flush=-1,Ji}return e!==Ko?Ji:i.wrap<=0?Fh:(i.wrap===2?(or(i,t.adler&255),or(i,t.adler>>8&255),or(i,t.adler>>16&255),or(i,t.adler>>24&255),or(i,t.total_in&255),or(i,t.total_in>>8&255),or(i,t.total_in>>16&255),or(i,t.total_in>>24&255)):(Wc(i,t.adler>>>16),Wc(i,t.adler&65535)),Jo(t),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Ji:Fh)},"deflate$2"),nm=a(t=>{if(!t||!t.state)return ui;const e=t.state.status;return e!==Kl&&e!==hd&&e!==Xl&&e!==Ql&&e!==Yl&&e!==Ma&&e!==qc?Qo(t,ui):(t.state=null,e===Ma?Qo(t,Pg):Ji)},"deflateEnd"),im=a((t,e)=>{let r=e.length;if(!t||!t.state)return ui;const n=t.state,i=n.wrap;if(i===2||i===1&&n.status!==Kl||n.lookahead)return ui;if(i===1&&(t.adler=jc(t.adler,e,r,0)),n.wrap=0,r>=n.w_size){i===0&&(Yo(n.head),n.strstart=0,n.block_start=0,n.insert=0);let d=new Uint8Array(n.w_size);d.set(e.subarray(r-n.w_size,r),0),e=d,r=n.w_size}const o=t.avail_in,c=t.next_in,l=t.input;for(t.avail_in=r,t.next_in=0,t.input=e,$a(n);n.lookahead>=Yt;){let d=n.strstart,p=n.lookahead-(Yt-1);do n.ins_h=Zo(n,n.ins_h,n.window[d+Yt-1]),n.prev[d&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=d,d++;while(--p);n.strstart=d,n.lookahead=Yt-1,$a(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Yt-1,n.match_available=0,t.next_in=c,t.input=l,t.avail_in=o,n.wrap=i,Ji},"deflateSetDictionary");var om=tm,am=qh,sm=jh,cm=Uh,lm=em,um=rm,dm=nm,hm=im,fm="pako deflate (from Nodeca project)",Vc={deflateInit:om,deflateInit2:am,deflateReset:sm,deflateResetKeep:cm,deflateSetHeader:lm,deflate:um,deflateEnd:dm,deflateSetDictionary:hm,deflateInfo:fm};const pm=a((t,e)=>Object.prototype.hasOwnProperty.call(t,e),"_has");var gm=a(function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(!!r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)pm(r,n)&&(t[n]=r[n])}}return t},"pako_esm_assign"),mm=a(t=>{let e=0;for(let n=0,i=t.length;n<i;n++)e+=t[n].length;const r=new Uint8Array(e);for(let n=0,i=0,o=t.length;n<o;n++){let c=t[n];r.set(c,i),i+=c.length}return r},"flattenChunks"),Zl={assign:gm,flattenChunks:mm};let zh=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){zh=!1}const Kc=new Uint8Array(256);for(let t=0;t<256;t++)Kc[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Kc[254]=Kc[254]=1;var vm=a(t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,i,o,c=t.length,l=0;for(i=0;i<c;i++)r=t.charCodeAt(i),(r&64512)==55296&&i+1<c&&(n=t.charCodeAt(i+1),(n&64512)==56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(l),o=0,i=0;o<l;i++)r=t.charCodeAt(i),(r&64512)==55296&&i+1<c&&(n=t.charCodeAt(i+1),(n&64512)==56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?e[o++]=r:r<2048?(e[o++]=192|r>>>6,e[o++]=128|r&63):r<65536?(e[o++]=224|r>>>12,e[o++]=128|r>>>6&63,e[o++]=128|r&63):(e[o++]=240|r>>>18,e[o++]=128|r>>>12&63,e[o++]=128|r>>>6&63,e[o++]=128|r&63);return e},"string2buf");const ym=a((t,e)=>{if(e<65534&&t.subarray&&zh)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r},"buf2binstring");var _m=a((t,e)=>{const r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,i;const o=new Array(r*2);for(i=0,n=0;n<r;){let c=t[n++];if(c<128){o[i++]=c;continue}let l=Kc[c];if(l>4){o[i++]=65533,n+=l-1;continue}for(c&=l===2?31:l===3?15:7;l>1&&n<r;)c=c<<6|t[n++]&63,l--;if(l>1){o[i++]=65533;continue}c<65536?o[i++]=c:(c-=65536,o[i++]=55296|c>>10&1023,o[i++]=56320|c&1023)}return ym(o,i)},"buf2string"),wm=a((t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)==128;)r--;return r<0||r===0?e:r+Kc[t[r]]>e?r:e},"utf8border"),Xc={string2buf:vm,buf2string:_m,utf8border:wm};function bm(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}a(bm,"ZStream");var Wh=bm;const Gh=Object.prototype.toString,{Z_NO_FLUSH:Sm,Z_SYNC_FLUSH:Em,Z_FULL_FLUSH:xm,Z_FINISH:Cm,Z_OK:Jl,Z_STREAM_END:Tm,Z_DEFAULT_COMPRESSION:Am,Z_DEFAULT_STRATEGY:Rm,Z_DEFLATED:Im}=ka;function Qc(t){this.options=Zl.assign({level:Am,method:Im,chunkSize:16384,windowBits:15,memLevel:8,strategy:Rm},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Wh,this.strm.avail_out=0;let r=Vc.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==Jl)throw new Error(Da[r]);if(e.header&&Vc.deflateSetHeader(this.strm,e.header),e.dictionary){let n;if(typeof e.dictionary=="string"?n=Xc.string2buf(e.dictionary):Gh.call(e.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(e.dictionary):n=e.dictionary,r=Vc.deflateSetDictionary(this.strm,n),r!==Jl)throw new Error(Da[r]);this._dict_set=!0}}a(Qc,"Deflate$1"),Qc.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize;let i,o;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?Cm:Sm,typeof t=="string"?r.input=Xc.string2buf(t):Gh.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===Em||o===xm)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(i=Vc.deflate(r,o),i===Tm)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=Vc.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Jl;if(r.avail_out===0){this.onData(r.output);continue}if(o>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0},Qc.prototype.onData=function(t){this.chunks.push(t)},Qc.prototype.onEnd=function(t){t===Jl&&(this.result=Zl.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function pd(t,e){const r=new Qc(e);if(r.push(t,!0),r.err)throw r.msg||Da[r.err];return r.result}a(pd,"deflate$1");function Om(t,e){return e=e||{},e.raw=!0,pd(t,e)}a(Om,"deflateRaw$1");function Pm(t,e){return e=e||{},e.gzip=!0,pd(t,e)}a(Pm,"gzip$1");var Dm=Qc,km=pd,Nm=Om,Mm=Pm,Lm=ka,$m={Deflate:Dm,deflate:km,deflateRaw:Nm,gzip:Mm,constants:Lm};const eu=30,Fm=12;var Bm=a(function(e,r){let n,i,o,c,l,d,p,S,P,I,O,F,N,U,W,V,ie,oe,ge,ke,Re,Ie,Ye,$e;const ze=e.state;n=e.next_in,Ye=e.input,i=n+(e.avail_in-5),o=e.next_out,$e=e.output,c=o-(r-e.avail_out),l=o+(e.avail_out-257),d=ze.dmax,p=ze.wsize,S=ze.whave,P=ze.wnext,I=ze.window,O=ze.hold,F=ze.bits,N=ze.lencode,U=ze.distcode,W=(1<<ze.lenbits)-1,V=(1<<ze.distbits)-1;e:do{F<15&&(O+=Ye[n++]<<F,F+=8,O+=Ye[n++]<<F,F+=8),ie=N[O&W];t:for(;;){if(oe=ie>>>24,O>>>=oe,F-=oe,oe=ie>>>16&255,oe===0)$e[o++]=ie&65535;else if(oe&16){ge=ie&65535,oe&=15,oe&&(F<oe&&(O+=Ye[n++]<<F,F+=8),ge+=O&(1<<oe)-1,O>>>=oe,F-=oe),F<15&&(O+=Ye[n++]<<F,F+=8,O+=Ye[n++]<<F,F+=8),ie=U[O&V];r:for(;;){if(oe=ie>>>24,O>>>=oe,F-=oe,oe=ie>>>16&255,oe&16){if(ke=ie&65535,oe&=15,F<oe&&(O+=Ye[n++]<<F,F+=8,F<oe&&(O+=Ye[n++]<<F,F+=8)),ke+=O&(1<<oe)-1,ke>d){e.msg="invalid distance too far back",ze.mode=eu;break e}if(O>>>=oe,F-=oe,oe=o-c,ke>oe){if(oe=ke-oe,oe>S&&ze.sane){e.msg="invalid distance too far back",ze.mode=eu;break e}if(Re=0,Ie=I,P===0){if(Re+=p-oe,oe<ge){ge-=oe;do $e[o++]=I[Re++];while(--oe);Re=o-ke,Ie=$e}}else if(P<oe){if(Re+=p+P-oe,oe-=P,oe<ge){ge-=oe;do $e[o++]=I[Re++];while(--oe);if(Re=0,P<ge){oe=P,ge-=oe;do $e[o++]=I[Re++];while(--oe);Re=o-ke,Ie=$e}}}else if(Re+=P-oe,oe<ge){ge-=oe;do $e[o++]=I[Re++];while(--oe);Re=o-ke,Ie=$e}for(;ge>2;)$e[o++]=Ie[Re++],$e[o++]=Ie[Re++],$e[o++]=Ie[Re++],ge-=3;ge&&($e[o++]=Ie[Re++],ge>1&&($e[o++]=Ie[Re++]))}else{Re=o-ke;do $e[o++]=$e[Re++],$e[o++]=$e[Re++],$e[o++]=$e[Re++],ge-=3;while(ge>2);ge&&($e[o++]=$e[Re++],ge>1&&($e[o++]=$e[Re++]))}}else if((oe&64)==0){ie=U[(ie&65535)+(O&(1<<oe)-1)];continue r}else{e.msg="invalid distance code",ze.mode=eu;break e}break}}else if((oe&64)==0){ie=N[(ie&65535)+(O&(1<<oe)-1)];continue t}else if(oe&32){ze.mode=Fm;break e}else{e.msg="invalid literal/length code",ze.mode=eu;break e}break}}while(n<i&&o<l);ge=F>>3,n-=ge,F-=ge<<3,O&=(1<<F)-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?5+(i-n):5-(n-i),e.avail_out=o<l?257+(l-o):257-(o-l),ze.hold=O,ze.bits=F},"inflate_fast");const Bs=15,Vh=852,Kh=592,Xh=0,gd=1,Qh=2,Hm=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Um=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),jm=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),qm=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Yc=a((t,e,r,n,i,o,c,l)=>{const d=l.bits;let p=0,S=0,P=0,I=0,O=0,F=0,N=0,U=0,W=0,V=0,ie,oe,ge,ke,Re,Ie=null,Ye=0,$e;const ze=new Uint16Array(Bs+1),at=new Uint16Array(Bs+1);let kt=null,rn=0,Hn,Zn,Ii;for(p=0;p<=Bs;p++)ze[p]=0;for(S=0;S<n;S++)ze[e[r+S]]++;for(O=d,I=Bs;I>=1&&ze[I]===0;I--);if(O>I&&(O=I),I===0)return i[o++]=1<<24|64<<16|0,i[o++]=1<<24|64<<16|0,l.bits=1,0;for(P=1;P<I&&ze[P]===0;P++);for(O<P&&(O=P),U=1,p=1;p<=Bs;p++)if(U<<=1,U-=ze[p],U<0)return-1;if(U>0&&(t===Xh||I!==1))return-1;for(at[1]=0,p=1;p<Bs;p++)at[p+1]=at[p]+ze[p];for(S=0;S<n;S++)e[r+S]!==0&&(c[at[e[r+S]]++]=S);if(t===Xh?(Ie=kt=c,$e=19):t===gd?(Ie=Hm,Ye-=257,kt=Um,rn-=257,$e=256):(Ie=jm,kt=qm,$e=-1),V=0,S=0,p=P,Re=o,F=O,N=0,ge=-1,W=1<<O,ke=W-1,t===gd&&W>Vh||t===Qh&&W>Kh)return 1;for(;;){Hn=p-N,c[S]<$e?(Zn=0,Ii=c[S]):c[S]>$e?(Zn=kt[rn+c[S]],Ii=Ie[Ye+c[S]]):(Zn=32+64,Ii=0),ie=1<<p-N,oe=1<<F,P=oe;do oe-=ie,i[Re+(V>>N)+oe]=Hn<<24|Zn<<16|Ii|0;while(oe!==0);for(ie=1<<p-1;V&ie;)ie>>=1;if(ie!==0?(V&=ie-1,V+=ie):V=0,S++,--ze[p]==0){if(p===I)break;p=e[r+c[S]]}if(p>O&&(V&ke)!==ge){for(N===0&&(N=O),Re+=P,F=p-N,U=1<<F;F+N<I&&(U-=ze[F+N],!(U<=0));)F++,U<<=1;if(W+=1<<F,t===gd&&W>Vh||t===Qh&&W>Kh)return 1;ge=V&ke,i[ge]=O<<24|F<<16|Re-o|0}}return V!==0&&(i[Re+V]=p-N<<24|64<<16|0),l.bits=O,0},"inflate_table");const zm=0,Yh=1,Zh=2,{Z_FINISH:Jh,Z_BLOCK:Wm,Z_TREES:tu,Z_OK:Fa,Z_STREAM_END:Gm,Z_NEED_DICT:Vm,Z_STREAM_ERROR:di,Z_DATA_ERROR:ef,Z_MEM_ERROR:tf,Z_BUF_ERROR:Km,Z_DEFLATED:rf}=ka,nf=1,of=2,af=3,sf=4,cf=5,lf=6,uf=7,df=8,hf=9,ff=10,ru=11,go=12,md=13,pf=14,vd=15,gf=16,mf=17,vf=18,yf=19,nu=20,iu=21,_f=22,wf=23,bf=24,Sf=25,Ef=26,yd=27,xf=28,Cf=29,Ar=30,Tf=31,Xm=32,Qm=852,Ym=592,Zm=15,Af=a(t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24),"zswap32");function Jm(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}a(Jm,"InflateState");const Rf=a(t=>{if(!t||!t.state)return di;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=nf,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(Qm),e.distcode=e.distdyn=new Int32Array(Ym),e.sane=1,e.back=-1,Fa},"inflateResetKeep"),If=a(t=>{if(!t||!t.state)return di;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Rf(t)},"inflateReset"),Of=a((t,e)=>{let r;if(!t||!t.state)return di;const n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15)?di:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,If(t))},"inflateReset2"),Pf=a((t,e)=>{if(!t)return di;const r=new Jm;t.state=r,r.window=null;const n=Of(t,e);return n!==Fa&&(t.state=null),n},"inflateInit2"),ev=a(t=>Pf(t,Zm),"inflateInit");let Df=!0,_d,wd;const tv=a(t=>{if(Df){_d=new Int32Array(512),wd=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Yc(Yh,t.lens,0,288,_d,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Yc(Zh,t.lens,0,32,wd,0,t.work,{bits:5}),Df=!1}t.lencode=_d,t.lenbits=9,t.distcode=wd,t.distbits=5},"fixedtables"),kf=a((t,e,r,n)=>{let i;const o=t.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(e.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(e.subarray(r-n,r-n+i),o.wnext),n-=i,n?(o.window.set(e.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0},"updatewindow"),rv=a((t,e)=>{let r,n,i,o,c,l,d,p,S,P,I,O,F,N,U=0,W,V,ie,oe,ge,ke,Re,Ie;const Ye=new Uint8Array(4);let $e,ze;const at=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0)return di;r=t.state,r.mode===go&&(r.mode=md),c=t.next_out,i=t.output,d=t.avail_out,o=t.next_in,n=t.input,l=t.avail_in,p=r.hold,S=r.bits,P=l,I=d,Ie=Fa;e:for(;;)switch(r.mode){case nf:if(r.wrap===0){r.mode=md;break}for(;S<16;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}if(r.wrap&2&&p===35615){r.check=0,Ye[0]=p&255,Ye[1]=p>>>8&255,r.check=en(r.check,Ye,2,0),p=0,S=0,r.mode=of;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((p&255)<<8)+(p>>8))%31){t.msg="incorrect header check",r.mode=Ar;break}if((p&15)!==rf){t.msg="unknown compression method",r.mode=Ar;break}if(p>>>=4,S-=4,Re=(p&15)+8,r.wbits===0)r.wbits=Re;else if(Re>r.wbits){t.msg="invalid window size",r.mode=Ar;break}r.dmax=1<<r.wbits,t.adler=r.check=1,r.mode=p&512?ff:go,p=0,S=0;break;case of:for(;S<16;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}if(r.flags=p,(r.flags&255)!==rf){t.msg="unknown compression method",r.mode=Ar;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=Ar;break}r.head&&(r.head.text=p>>8&1),r.flags&512&&(Ye[0]=p&255,Ye[1]=p>>>8&255,r.check=en(r.check,Ye,2,0)),p=0,S=0,r.mode=af;case af:for(;S<32;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}r.head&&(r.head.time=p),r.flags&512&&(Ye[0]=p&255,Ye[1]=p>>>8&255,Ye[2]=p>>>16&255,Ye[3]=p>>>24&255,r.check=en(r.check,Ye,4,0)),p=0,S=0,r.mode=sf;case sf:for(;S<16;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}r.head&&(r.head.xflags=p&255,r.head.os=p>>8),r.flags&512&&(Ye[0]=p&255,Ye[1]=p>>>8&255,r.check=en(r.check,Ye,2,0)),p=0,S=0,r.mode=cf;case cf:if(r.flags&1024){for(;S<16;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}r.length=p,r.head&&(r.head.extra_len=p),r.flags&512&&(Ye[0]=p&255,Ye[1]=p>>>8&255,r.check=en(r.check,Ye,2,0)),p=0,S=0}else r.head&&(r.head.extra=null);r.mode=lf;case lf:if(r.flags&1024&&(O=r.length,O>l&&(O=l),O&&(r.head&&(Re=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+O),Re)),r.flags&512&&(r.check=en(r.check,n,O,o)),l-=O,o+=O,r.length-=O),r.length))break e;r.length=0,r.mode=uf;case uf:if(r.flags&2048){if(l===0)break e;O=0;do Re=n[o+O++],r.head&&Re&&r.length<65536&&(r.head.name+=String.fromCharCode(Re));while(Re&&O<l);if(r.flags&512&&(r.check=en(r.check,n,O,o)),l-=O,o+=O,Re)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=df;case df:if(r.flags&4096){if(l===0)break e;O=0;do Re=n[o+O++],r.head&&Re&&r.length<65536&&(r.head.comment+=String.fromCharCode(Re));while(Re&&O<l);if(r.flags&512&&(r.check=en(r.check,n,O,o)),l-=O,o+=O,Re)break e}else r.head&&(r.head.comment=null);r.mode=hf;case hf:if(r.flags&512){for(;S<16;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}if(p!==(r.check&65535)){t.msg="header crc mismatch",r.mode=Ar;break}p=0,S=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=go;break;case ff:for(;S<32;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}t.adler=r.check=Af(p),p=0,S=0,r.mode=ru;case ru:if(r.havedict===0)return t.next_out=c,t.avail_out=d,t.next_in=o,t.avail_in=l,r.hold=p,r.bits=S,Vm;t.adler=r.check=1,r.mode=go;case go:if(e===Wm||e===tu)break e;case md:if(r.last){p>>>=S&7,S-=S&7,r.mode=yd;break}for(;S<3;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}switch(r.last=p&1,p>>>=1,S-=1,p&3){case 0:r.mode=pf;break;case 1:if(tv(r),r.mode=nu,e===tu){p>>>=2,S-=2;break e}break;case 2:r.mode=mf;break;case 3:t.msg="invalid block type",r.mode=Ar}p>>>=2,S-=2;break;case pf:for(p>>>=S&7,S-=S&7;S<32;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}if((p&65535)!=(p>>>16^65535)){t.msg="invalid stored block lengths",r.mode=Ar;break}if(r.length=p&65535,p=0,S=0,r.mode=vd,e===tu)break e;case vd:r.mode=gf;case gf:if(O=r.length,O){if(O>l&&(O=l),O>d&&(O=d),O===0)break e;i.set(n.subarray(o,o+O),c),l-=O,o+=O,d-=O,c+=O,r.length-=O;break}r.mode=go;break;case mf:for(;S<14;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}if(r.nlen=(p&31)+257,p>>>=5,S-=5,r.ndist=(p&31)+1,p>>>=5,S-=5,r.ncode=(p&15)+4,p>>>=4,S-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=Ar;break}r.have=0,r.mode=vf;case vf:for(;r.have<r.ncode;){for(;S<3;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}r.lens[at[r.have++]]=p&7,p>>>=3,S-=3}for(;r.have<19;)r.lens[at[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,$e={bits:r.lenbits},Ie=Yc(zm,r.lens,0,19,r.lencode,0,r.work,$e),r.lenbits=$e.bits,Ie){t.msg="invalid code lengths set",r.mode=Ar;break}r.have=0,r.mode=yf;case yf:for(;r.have<r.nlen+r.ndist;){for(;U=r.lencode[p&(1<<r.lenbits)-1],W=U>>>24,V=U>>>16&255,ie=U&65535,!(W<=S);){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}if(ie<16)p>>>=W,S-=W,r.lens[r.have++]=ie;else{if(ie===16){for(ze=W+2;S<ze;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}if(p>>>=W,S-=W,r.have===0){t.msg="invalid bit length repeat",r.mode=Ar;break}Re=r.lens[r.have-1],O=3+(p&3),p>>>=2,S-=2}else if(ie===17){for(ze=W+3;S<ze;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}p>>>=W,S-=W,Re=0,O=3+(p&7),p>>>=3,S-=3}else{for(ze=W+7;S<ze;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}p>>>=W,S-=W,Re=0,O=11+(p&127),p>>>=7,S-=7}if(r.have+O>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=Ar;break}for(;O--;)r.lens[r.have++]=Re}}if(r.mode===Ar)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=Ar;break}if(r.lenbits=9,$e={bits:r.lenbits},Ie=Yc(Yh,r.lens,0,r.nlen,r.lencode,0,r.work,$e),r.lenbits=$e.bits,Ie){t.msg="invalid literal/lengths set",r.mode=Ar;break}if(r.distbits=6,r.distcode=r.distdyn,$e={bits:r.distbits},Ie=Yc(Zh,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,$e),r.distbits=$e.bits,Ie){t.msg="invalid distances set",r.mode=Ar;break}if(r.mode=nu,e===tu)break e;case nu:r.mode=iu;case iu:if(l>=6&&d>=258){t.next_out=c,t.avail_out=d,t.next_in=o,t.avail_in=l,r.hold=p,r.bits=S,Bm(t,I),c=t.next_out,i=t.output,d=t.avail_out,o=t.next_in,n=t.input,l=t.avail_in,p=r.hold,S=r.bits,r.mode===go&&(r.back=-1);break}for(r.back=0;U=r.lencode[p&(1<<r.lenbits)-1],W=U>>>24,V=U>>>16&255,ie=U&65535,!(W<=S);){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}if(V&&(V&240)==0){for(oe=W,ge=V,ke=ie;U=r.lencode[ke+((p&(1<<oe+ge)-1)>>oe)],W=U>>>24,V=U>>>16&255,ie=U&65535,!(oe+W<=S);){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}p>>>=oe,S-=oe,r.back+=oe}if(p>>>=W,S-=W,r.back+=W,r.length=ie,V===0){r.mode=Ef;break}if(V&32){r.back=-1,r.mode=go;break}if(V&64){t.msg="invalid literal/length code",r.mode=Ar;break}r.extra=V&15,r.mode=_f;case _f:if(r.extra){for(ze=r.extra;S<ze;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}r.length+=p&(1<<r.extra)-1,p>>>=r.extra,S-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=wf;case wf:for(;U=r.distcode[p&(1<<r.distbits)-1],W=U>>>24,V=U>>>16&255,ie=U&65535,!(W<=S);){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}if((V&240)==0){for(oe=W,ge=V,ke=ie;U=r.distcode[ke+((p&(1<<oe+ge)-1)>>oe)],W=U>>>24,V=U>>>16&255,ie=U&65535,!(oe+W<=S);){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}p>>>=oe,S-=oe,r.back+=oe}if(p>>>=W,S-=W,r.back+=W,V&64){t.msg="invalid distance code",r.mode=Ar;break}r.offset=ie,r.extra=V&15,r.mode=bf;case bf:if(r.extra){for(ze=r.extra;S<ze;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}r.offset+=p&(1<<r.extra)-1,p>>>=r.extra,S-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=Ar;break}r.mode=Sf;case Sf:if(d===0)break e;if(O=I-d,r.offset>O){if(O=r.offset-O,O>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=Ar;break}O>r.wnext?(O-=r.wnext,F=r.wsize-O):F=r.wnext-O,O>r.length&&(O=r.length),N=r.window}else N=i,F=c-r.offset,O=r.length;O>d&&(O=d),d-=O,r.length-=O;do i[c++]=N[F++];while(--O);r.length===0&&(r.mode=iu);break;case Ef:if(d===0)break e;i[c++]=r.length,d--,r.mode=iu;break;case yd:if(r.wrap){for(;S<32;){if(l===0)break e;l--,p|=n[o++]<<S,S+=8}if(I-=d,t.total_out+=I,r.total+=I,I&&(t.adler=r.check=r.flags?en(r.check,i,I,c-I):jc(r.check,i,I,c-I)),I=d,(r.flags?p:Af(p))!==r.check){t.msg="incorrect data check",r.mode=Ar;break}p=0,S=0}r.mode=xf;case xf:if(r.wrap&&r.flags){for(;S<32;){if(l===0)break e;l--,p+=n[o++]<<S,S+=8}if(p!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=Ar;break}p=0,S=0}r.mode=Cf;case Cf:Ie=Gm;break e;case Ar:Ie=ef;break e;case Tf:return tf;case Xm:default:return di}return t.next_out=c,t.avail_out=d,t.next_in=o,t.avail_in=l,r.hold=p,r.bits=S,(r.wsize||I!==t.avail_out&&r.mode<Ar&&(r.mode<yd||e!==Jh))&&kf(t,t.output,t.next_out,I-t.avail_out),P-=t.avail_in,I-=t.avail_out,t.total_in+=P,t.total_out+=I,r.total+=I,r.wrap&&I&&(t.adler=r.check=r.flags?en(r.check,i,I,t.next_out-I):jc(r.check,i,I,t.next_out-I)),t.data_type=r.bits+(r.last?64:0)+(r.mode===go?128:0)+(r.mode===nu||r.mode===vd?256:0),(P===0&&I===0||e===Jh)&&Ie===Fa&&(Ie=Km),Ie},"inflate$2"),nv=a(t=>{if(!t||!t.state)return di;let e=t.state;return e.window&&(e.window=null),t.state=null,Fa},"inflateEnd"),iv=a((t,e)=>{if(!t||!t.state)return di;const r=t.state;return(r.wrap&2)==0?di:(r.head=e,e.done=!1,Fa)},"inflateGetHeader"),ov=a((t,e)=>{const r=e.length;let n,i,o;return!t||!t.state||(n=t.state,n.wrap!==0&&n.mode!==ru)?di:n.mode===ru&&(i=1,i=jc(i,e,r,0),i!==n.check)?ef:(o=kf(t,e,r,r),o?(n.mode=Tf,tf):(n.havedict=1,Fa))},"inflateSetDictionary");var av=If,sv=Of,cv=Rf,lv=ev,uv=Pf,dv=rv,hv=nv,fv=iv,pv=ov,gv="pako inflate (from Nodeca project)",mo={inflateReset:av,inflateReset2:sv,inflateResetKeep:cv,inflateInit:lv,inflateInit2:uv,inflate:dv,inflateEnd:hv,inflateGetHeader:fv,inflateSetDictionary:pv,inflateInfo:gv};function mv(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}a(mv,"GZheader");var vv=mv;const Nf=Object.prototype.toString,{Z_NO_FLUSH:yv,Z_FINISH:_v,Z_OK:Zc,Z_STREAM_END:bd,Z_NEED_DICT:Sd,Z_STREAM_ERROR:wv,Z_DATA_ERROR:Mf,Z_MEM_ERROR:bv}=ka;function Jc(t){this.options=Zl.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)==0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Wh,this.strm.avail_out=0;let r=mo.inflateInit2(this.strm,e.windowBits);if(r!==Zc)throw new Error(Da[r]);if(this.header=new vv,mo.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=Xc.string2buf(e.dictionary):Nf.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=mo.inflateSetDictionary(this.strm,e.dictionary),r!==Zc)))throw new Error(Da[r])}a(Jc,"Inflate$1"),Jc.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let o,c,l;if(this.ended)return!1;for(e===~~e?c=e:c=e===!0?_v:yv,Nf.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=mo.inflate(r,c),o===Sd&&i&&(o=mo.inflateSetDictionary(r,i),o===Zc?o=mo.inflate(r,c):o===Mf&&(o=Sd));r.avail_in>0&&o===bd&&r.state.wrap>0&&t[r.next_in]!==0;)mo.inflateReset(r),o=mo.inflate(r,c);switch(o){case wv:case Mf:case Sd:case bv:return this.onEnd(o),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||o===bd))if(this.options.to==="string"){let d=Xc.utf8border(r.output,r.next_out),p=r.next_out-d,S=Xc.buf2string(r.output,d);r.next_out=p,r.avail_out=n-p,p&&r.output.set(r.output.subarray(d,d+p),0),this.onData(S)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(o===Zc&&l===0)){if(o===bd)return o=mo.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(r.avail_in===0)break}}return!0},Jc.prototype.onData=function(t){this.chunks.push(t)},Jc.prototype.onEnd=function(t){t===Zc&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Zl.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Ed(t,e){const r=new Jc(e);if(r.push(t),r.err)throw r.msg||Da[r.err];return r.result}a(Ed,"inflate$1");function Sv(t,e){return e=e||{},e.raw=!0,Ed(t,e)}a(Sv,"inflateRaw$1");var Ev=Jc,xv=Ed,Cv=Sv,Tv=Ed,Av=ka,Rv={Inflate:Ev,inflate:xv,inflateRaw:Cv,ungzip:Tv,constants:Av};const{Deflate:Iv,deflate:Ov,deflateRaw:Pv,gzip:Dv}=$m,{Inflate:kv,inflate:Nv,inflateRaw:Mv,ungzip:Lv}=Rv;var $v=Iv,Fv=Ov,Bv=Pv,Hv=Dv,Uv=kv,jv=Nv,qv=Mv,Lf=Lv,zv=ka,ky={Deflate:$v,deflate:Fv,deflateRaw:Bv,gzip:Hv,Inflate:Uv,inflate:jv,inflateRaw:qv,ungzip:Lf,constants:zv};const Ba=(0,B.loadMessageBundle)(),ou=new TextDecoder,au=new TextEncoder;class $f{constructor(e,r=0){this.retainFor=r;try{this.weakRef=new WeakRef(e)}catch{}this.retain(e)}retain(e){this.retainTimeout&&clearTimeout(this.retainTimeout),this.strongRef=e,this.retainTimeout=setTimeout(()=>{this.strongRef=void 0,this.retainTimeout=void 0},this.retainFor)}deref(){var e,r;const n=(r=this.strongRef)!=null?r:(e=this.weakRef)==null?void 0:e.deref();return n&&this.retain(n),n}}a($f,"TimedRetainingRef");class Ff{constructor(e,r){this.root=e,this.providerService=r,this._onDidChangeIndexingEnablement=new m.EventEmitter,this._onDidDownloadTar=new m.EventEmitter,this.ongoingRequests=new Map,this.indexingDisabled=!1,this.usageFile=m.Uri.joinPath(this.root,"usageHistory.json"),this.indexingAllowanceFile=m.Uri.joinPath(this.root,"indexAllowances.json"),this._disposable=m.Disposable.from(...this.registerCommands()),this.updateContext()}get onDidChangeIndexingEnablement(){return this._onDidChangeIndexingEnablement.event}get onDidDownloadTar(){return this._onDidDownloadTar.event}async updateContext(){await oi(ii.HasSearchIndexes,(await this.listTars()).length>0);const e=this.providerService.repositories.map(i=>i.name),r=await this.getIndexingEnabledRepos(),n=r.has("*")||e.every(i=>r.has(i));await oi(ii.EnabledSomeSearchIndexes,r.size>0),await oi(ii.EnabledAllSearchIndexes,n)}dispose(){this._disposable.dispose()}registerCommands(){return[m.commands.registerCommand("remoteHub.configureIndexingAllowedRepos",async()=>{await this.configureIndexingAllowedRepos()}),m.commands.registerCommand("remoteHub.disableIndexingForSession",()=>(this.temporarilyDisableIndexing(),{triggerSearch:!0})),m.commands.registerCommand("remoteHub.enableIndexing",async()=>{const e={title:Ba("search download prompt enable","Enable")},r={title:Ba("search download prompt enable always","Always Enable")},n={title:Ba("search download prompt configure","Configure")},i={title:Ba("search download prompt cancel","Cancel"),isCloseAffordance:!0},o=await m.window.showInformationMessage(Ba("search download prompt",`Indexing creates a copy of this repository in your browser's storage in order to provide enhanced text searches.

Without indexing, searches will use GitHub's text search, which is imprecise.

Do you want to enable creating local indexes for this repository on this browser? You should only enable indexing on machines you trust.`),{modal:!0,useCustom:!0},e,r,n,i);if(o===n&&await m.commands.executeCommand("workbench.action.openSettings","remoteHub.search.download"),o===e)return await this.markIndexingEnabledForRepos(...this.providerService.repositories.map(c=>c.name)),{triggerSearch:!0};if(o===r)return await this.markIndexingEnabledForRepos("*"),{triggerSearch:!0}}),m.commands.registerCommand("remoteHub.deleteLocalRepositoryData",async()=>{const e=a(i=>{const o=[{power:9,name:"GB"},{power:6,name:"MB"},{power:3,name:"kB"},{power:0,name:"B"}];for(const c of o)if(i>10**c.power)return`${Math.round(i/10**c.power)} ${c.name}`;return"Unknown size"},"humanReadableSize"),r=await this.listTars();if(r.length===0){await m.window.showInformationMessage("No Search Indexes Found");return}const n=m.window.createQuickPick();n.canSelectMany=!0,n.items=r.map(({name:i,size:o,path:c})=>({label:i,path:c,description:o?e(o):void 0})),n.show(),n.onDidAccept(async()=>{n.hide();for(const{label:i,path:o}of n.selectedItems){const c=m.workspace.fs.delete(o),l=m.window.setStatusBarMessage(`$(loading) Deleting ${i}`,c);await c,l.dispose()}this.updateContext()}),n.onDidHide(()=>n.dispose())}),m.commands.registerCommand("remoteHub.deleteAllLocalRepositoryData",()=>m.window.withProgress({location:m.ProgressLocation.Notification,title:"Deleting Search Indexes..."},async()=>{this.lastReadKey=void 0,this.lastReadValue=void 0,await Promise.all([m.workspace.fs.delete(this.root,{recursive:!0})]),this.updateContext()}))]}getTarFromMemory(e){var r;if(e===this.lastReadKey){const n=(r=this.lastReadValue)==null?void 0:r.deref();if(n)return n;L.log("Weakref deallocated.")}}async getTarFromDisk(e){try{const r=await m.workspace.fs.readFile(e);return!r||!r.length?void 0:r}catch(r){if(r.code!=="FileNotFound")throw r;return}}async getTarFromNetwork(e){try{if(!await this.isIndexingEnabledForRepo(e))throw Error("Unable to search without indexing allowed");const r=await this.providerService.getTarGz(e);if(r===void 0)throw Error("Unable to retrieve search index from provider");return r}finally{this.updateContext()}}async getTar(e,r){r===void 0&&({HEAD:{sha:r}}=await this.providerService.getMetadata(e)),e=this.providerService.getCanonicalUri(e);const n=this.getTarStorageUri(e,r),i=n.toString();try{let o=this.ongoingRequests.get(i);return o===void 0&&(o=this.getTarCore(e,r,n),this.ongoingRequests.set(i,o)),await o}finally{this.ongoingRequests.delete(i)}}async getCachedTar(e,r){return e=this.providerService.getCanonicalUri(e),this.getTarCore(e,r,this.getTarStorageUri(e,r),{skipDownload:!0})}async getTarCore(e,r,n,i){var o;const c=`${le(e,{excludeScheme:!0})}/${r}`,l=new lt(`TarPit.getTar(${c})`),d=n.toString(),p=Date.now();let S,P;try{if(l.logStep("Getting .tar from memory",{suffix:" \u2022 Getting .tar from memory..."}),P=this.getTarFromMemory(d),P)return S=" \u2022 Got .tar from memory",P;l.logStep("Getting .tar from disk",{message:": Not found \u2022",suffix:" \u2022 Getting .tar from disk..."});let I=!1,O=await this.getTarFromDisk(n);if(O==null?void 0:O.length)S=" \u2022 Got .tar from disk";else{if(i==null?void 0:i.skipDownload){S=" \u2022 Skipped download";return}l.logStep("Getting .tar from network",{message:": Not found \u2022",suffix:" \u2022 Getting .tar from network..."}),O=await this.getTarFromNetwork(e),I=!0,S=" \u2022 Got .tar from network",m.workspace.fs.writeFile(n,O).then(()=>L.debug(`Sucessfully wrote tarball to disk in ${Date.now()-p}ms`),U=>L.error(U,`Error writing tarball to disk in ${Date.now()-p}ms`))}if(!(O==null?void 0:O.length))throw new Error("Internal Error: Invalid search index. Try deleting repository data and running search again: `GitHub Repositories: Delete Local Repository Data...`");l.logStep("Unzipping .tar",{suffix:" \u2022 Unzipping .tar..."});const F=Lf(O);l.logStep("Parsing .tar",{suffix:" \u2022 Parsing .tar..."}),P=(0,Qp.t9)(F),l.logStep("Fixing up .tar entries",{suffix:" \u2022 Fixing up .tar entries..."});const N=[];for(const U of P.entries)((o=U.header.typeFlag)==null?void 0:o.name)==="Normal"&&(U.header.fullFileName=U.header.fullFileName.replace(/^[^/]+\/?/,""),N.push(U));return P.entries=N,this.lastReadValue=new $f(P,Date.now()-p),this.lastReadKey=d,I&&setTimeout(()=>this._onDidDownloadTar.fire({rootUri:e,sha:r}),0),P}catch(I){throw S=` \u2022 Failed; ${String(I)}`,I}finally{P&&(this.markCacheEntryUsed(`${c}`).catch(I=>L.log(`Error marking entry used: ${I}`)),this.cleanUpCache().catch(I=>L.log(`Error cleaning cache: ${I}`))),l.stop(S?{suffix:S}:void 0)}}getTarStorageUri(e,r){return m.Uri.joinPath(this.root,"tars",le(e,{excludeScheme:!0}),r)}async readDir(e){try{return(await m.workspace.fs.readDirectory(e)).map(r=>m.Uri.joinPath(e,r[0]))}catch{return[]}}temporarilyDisableIndexing(){this.indexingDisabled=!0}async isIndexingEnabledForRepo(e){if(this.indexingDisabled)return!1;const r=await this.getIndexingEnabledRepos();if(r.has("*"))return!0;const{name:n}=this.providerService.getVirtualUriMetadata(e);return n?r.has(n):!1}async configureIndexingAllowedRepos(){const e=[...(await this.getIndexingEnabledRepos()).values()],r=await m.window.showQuickPick(e.map(n=>({picked:!0,description:n==="*"?Ba("all","All Repositories"):"",label:n})),{canPickMany:!0,title:Ba("select repos where indexing is allowed","Select repositories that should be indexed")});r&&await this.resetIndexingAllowedRepos(r.map(n=>n.label))}async getIndexingEnabledRepos(){let e;try{e=JSON.parse(ou.decode(await m.workspace.fs.readFile(this.indexingAllowanceFile)))}catch(r){r instanceof m.FileSystemError&&r.code!==m.FileSystemError.FileNotFound().code&&L.error(r,"Error reading index allowance data."),e=[]}return new Set(e)}async listTars(){const e=await this.readDir(m.Uri.joinPath(this.root,"tars")).catch(()=>[]),r=(await Promise.all(e.map(o=>this.readDir(o)))).flat(),n=(await Promise.all(r.map(o=>this.readDir(o)))).flat(),i=(await Promise.all(n.map(o=>this.readDir(o)))).flat();return Promise.all(i.map(async o=>({name:o.path.replace(/^.*\/tars\//,""),path:o,size:(await m.workspace.fs.stat(o)).size})))}async resetIndexingAllowedRepos(e){await m.workspace.fs.writeFile(this.indexingAllowanceFile,au.encode(JSON.stringify(e))),await this.updateContext(),setTimeout(()=>this._onDidChangeIndexingEnablement.fire(),0)}async markIndexingEnabledForRepos(...e){let r;try{r=JSON.parse(ou.decode(await m.workspace.fs.readFile(this.indexingAllowanceFile)))}catch(n){n instanceof m.FileSystemError&&n.code!==m.FileSystemError.FileNotFound().code&&L.error(n,"Error reading index allowance data."),r=[]}for(const n of e)r.includes(n)||r.push(n);this.indexingDisabled=!1,await m.workspace.fs.writeFile(this.indexingAllowanceFile,au.encode(JSON.stringify(r))),await this.updateContext(),setTimeout(()=>this._onDidChangeIndexingEnablement.fire(),0)}async markCacheEntryUsed(e){let r;try{r=JSON.parse(ou.decode(await m.workspace.fs.readFile(this.usageFile)))}catch(n){n instanceof m.FileSystemError&&n.code!==m.FileSystemError.FileNotFound().code&&L.error(n,"Error reading usage data."),r={}}r[e]=Number(Date.now()),await m.workspace.fs.writeFile(this.usageFile,au.encode(JSON.stringify(r)))}async cleanUpCache(){var e,r;L.log("Cleaning up search cache...");const n=await this.listTars();let i;try{i=JSON.parse(ou.decode(await m.workspace.fs.readFile(this.usageFile)))}catch(P){P instanceof m.FileSystemError&&P.code!==m.FileSystemError.FileNotFound().code&&L.error(P,"Error reading usage data. All existing indexes will be discarded."),i={}}const o=[];n.forEach(P=>{var I;const O=/^([^/]*\/[^/]*)\//.exec(P.name);if(!O)throw Error("Unexpected repo entry");const F=O[1],N=(I=i[P.name])!=null?I:0;o.push({...P,lastUsed:N,repo:F})}),o.sort((P,I)=>I.lastUsed-P.lastUsed);let c=0;const l=[],d=new Map,p=((e=Y.get("search.download.sizeLimit"))!=null?e:100)*1024*1024,S=(r=Y.get("search.download.repoLimit"))!=null?r:4;o.forEach(P=>{var I,O;(P.lastUsed===0||c>p||((I=d.get(P.repo))!=null?I:0)>S)&&l.push(P),c+=P.size,d.set(P.repo,((O=d.get(P.repo))!=null?O:0)+1)}),await Promise.all(l.map(async P=>{try{await m.workspace.fs.delete(P.path,{recursive:!0}),delete i[P.name],L.log(`Deleted cache entry for ${P.name}`)}catch(I){L.log(`Deleting cache entry for ${P.name} failed; ${String(I)}`)}})),await m.workspace.fs.writeFile(this.usageFile,au.encode(JSON.stringify(i))),await this.updateContext()}}a(Ff,"TarPit");const Wv=(0,B.loadMessageBundle)();async function Gv(t,e,r,n,i,o,c){return xd("provideTextSearchResults",async()=>{const l=Vp(n.pattern,Boolean(n.isRegExp),{matchCase:n.isCaseSensitive,wholeWord:n.isWordMatch,multiline:n.isMultiline,global:!0});let d;try{d=await xd("fetch tarball",()=>r.getTar(i.folder))}catch(U){return{limitHit:!1,message:{type:m.TextSearchCompleteMessageType.Warning,trusted:!0,text:Wv("indexNotAvailable","Search index not available. [Retry with indexing disabled]({0}).","command:remoteHub.disableIndexingForSession")}}}if(c.isCancellationRequested)return{limitHit:!1};const{maxResults:p,maxFileSize:S,includes:P,excludes:I}=i,O=await Vv(i.folder,t,d,e);if(c.isCancellationRequested)return{limitHit:!0};let F=p;const N=Kp(O,P,I,S);return xd("searchFiles",async()=>{var U,W;let V=0;for(const ie of O){if(!N.has(ie.path))continue;const oe=Xp(ie.contents,ie.path,l,{beforeContext:(U=i.beforeContext)!=null?U:0,afterContext:(W=i.afterContext)!=null?W:0,previewOptions:i.previewOptions,remainingResultQuota:F});for(const ge of oe)o.report({...ge,uri:m.Uri.joinPath(i.folder,ge.uri.path)});if(F!==void 0&&(F-=oe.length,F<=0))return{limitHit:!0};if(V++,V%1e4==0&&(await new Promise(ge=>setTimeout(ge,0)),c.isCancellationRequested))return{limitHit:!1}}return{limitHit:!1}})})}a(Gv,"provideTextSearchResults");async function Vv(t,e,r,n){const i=r.entries,o=e.getVirtualRootUri(t),c=await n.getChanges(o,{predicate:P=>P.fileType===m.FileType.File});if(c.length===0)return i.map(P=>({contents:P.dataAsBytes,path:P.header.fullFileName,size:P.dataAsBytes.byteLength}));const l=await Promise.all(on(c,P=>{if(P.type===Dt.Created)return n.getContent(P.uri).then(I=>({path:e.getRelativeFilePath(o,P.uri),size:I.length,contents:I}))})),d=await Promise.all(on(c,P=>{if(P.type===Dt.Changed)return n.getContent(P.uri).then(I=>({path:e.getRelativeFilePath(o,P.uri),size:I.length,contents:I}))})),p=new Set(Di(ro(d,P=>P.path),on(c,P=>{if(P.type===Dt.Deleted)return e.getRelativeFilePath(o,P.uri)})));return[...on(i,P=>{if(!p.has(P.header.fullFileName))return{contents:P.dataAsBytes,path:P.header.fullFileName,size:P.dataAsBytes.byteLength}}),...l,...d]}a(Vv,"listAllFiles");function Ny(t,e){const r=Date.now(),n=e();return Logger.log(`${t} time: ${Date.now()-r}`),n}a(Ny,"timeSync");async function xd(t,e){const r=Date.now(),n=await e();return L.log(`${t} time: ${Date.now()-r}`),n}a(xd,"time");var Kv=Object.defineProperty,Xv=Object.getOwnPropertyDescriptor,Cd=a((t,e,r,n)=>{for(var i=n>1?void 0:n?Xv(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&Kv(e,r,i),i},"github_fs_decorateClass");const Td=(0,B.loadMessageBundle)(),Qv=m.FileSystemError.FileNotFound().code,Yv=/(\/|\\)/g,Bf=".vscode/.github-pull-request.rec";class el{constructor(e,r,n,i){this.providerService=e,this.github=r,this.changeStore=n,this.tarPit=i,this._onDidChangeFile=new m.EventEmitter,this.fileSearchCache=new Map,this.pendingUriRequests=new Map,this.pendingUriRequestsEventDelay=10,this.implicitlyWatchedUris=new Map,this.watchedUris=new Map,this.disposable=m.Disposable.from(m.workspace.registerFileSystemProvider(this.scheme,this,{isCaseSensitive:!0,isReadonly:!0}),m.workspace.registerFileSearchProvider(this.scheme,this),m.workspace.registerTextSearchProvider(this.scheme,this),e.onDidChangeRepository(o=>{o.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([o.repository.uri])}),e.onDidRefresh(o=>this.onRefreshOrRepositoryChanged(o)))}get onDidChangeFile(){return this._onDidChangeFile.event}get scheme(){return this.github.scheme}dispose(){var e;(e=this.disposable)==null||e.dispose()}onRefreshOrRepositoryChanged(e){if(e=e.filter(r=>Xt.getProviderId(r)===this.scheme).map(r=>this.providerService.getProviderUri(r)),e.length!==0){L.log(`GitHubFS.onRefreshOrRepositoryChanged(${e.map(r=>r.toString()).join(", ")})`),this.fileSearchCache.clear();for(const[r,n]of[...this.pendingUriRequests])e.some(i=>ye(n.uri,i))&&(this.pendingUriRequests.delete(r),n.outdated=!0);this.updateOpenOrWatchedUris(e)}}updateOpenOrWatchedUris(e){const r=this.providerService.getOpenUris(this.scheme,e);for(const[i,o]of[...this.watchedUris,...this.implicitlyWatchedUris])e.some(c=>ye(o,c))&&(this.implicitlyWatchedUris.delete(i),r.set(i,o));L.debug(`GitHubFS.updateOpenOrWatchedUris(${e.map(i=>i.toString()).join(", ")}): uris=${r.size}`);for(const i of e)r.set(te(i),i);const n=[...r.values()].map(i=>({type:m.FileChangeType.Changed,uri:i}));setTimeout(()=>{L.debug(`GitHubFS.updateOpenOrWatchedUris: Firing events=${n.map(i=>i.uri.toString()).join(", ")}`),this._onDidChangeFile.fire(n)},0)}watch(e,r){const n=te(e);return this.watchedUris.set(n,e),{dispose:()=>{this.watchedUris.delete(n)}}}async stat(e){var r,n;const i=te(e);this.implicitlyWatchedUris.set(i,e);const o=this.providerService.getRelativeFilePath(e),c={uri:e,outdated:!1};try{this.pendingUriRequests.set(`stat:${i}`,c);const l=await this.github.getFileTree(e),d=await l.get(o);if(d==null?void 0:d.stat)return d==null?void 0:d.stat;if(this.implicitlyWatchedUris.delete(i),e.query==="~")return{type:m.FileType.File,size:0,ctime:0,mtime:(r=l.timestamp)!=null?r:Date.now(),permissions:m.FilePermission.Readonly};if(o===Bf){const{ref:p}=this.providerService.getVirtualUriMetadata(e);if((p==null?void 0:p.type)===et.PullRequest)return{type:m.FileType.File,size:0,ctime:0,mtime:(n=l.timestamp)!=null?n:Date.now(),permissions:m.FilePermission.Readonly}}throw m.FileSystemError.FileNotFound(e)}finally{this.pendingUriRequests.delete(`stat:${i}`),(c==null?void 0:c.outdated)&&setTimeout(()=>{L.log(`GitHubFS.stat(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:m.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}async readDirectory(e,r){this.implicitlyWatchedUris.set(te(e),e);const n=await this.github.getFileTree(e),i=this.providerService.getRelativeFilePath(e),o=(await n.getChildren(i,r)).map(([c,{stat:{type:l}}])=>[c,l]);return i===""&&lt.stop("Time to root directory"),o}createDirectory(e){throw m.FileSystemError.NoPermissions()}async readFile(e){const r=te(e);this.implicitlyWatchedUris.set(r,e);const n={uri:e,outdated:!1};try{return this.pendingUriRequests.set(r,n),await this.github.getFileContent(e)}catch(i){if(this.implicitlyWatchedUris.delete(r),i instanceof m.FileSystemError&&i.code===Qv){if(e.query==="~")return new Uint8Array(0);if(this.providerService.getRelativeFilePath(e)===Bf){const{ref:c}=this.providerService.getVirtualUriMetadata(e);if((c==null?void 0:c.type)===et.PullRequest)return new Uint8Array(0)}}throw i}finally{this.pendingUriRequests.delete(r),(n==null?void 0:n.outdated)&&setTimeout(()=>{L.log(`GitHubFS.readFile(${e.toString()}): Repository changed; firing change event...`),this._onDidChangeFile.fire([{type:m.FileChangeType.Changed,uri:e}])},this.pendingUriRequestsEventDelay)}}writeFile(e,r,n){throw m.FileSystemError.NoPermissions()}delete(e,r){throw m.FileSystemError.NoPermissions()}rename(e,r,n){throw m.FileSystemError.NoPermissions()}copy(e,r,n){throw m.FileSystemError.NoPermissions()}async provideFileSearchResults(e,{folder:r,maxResults:n,includes:i,excludes:o},c){const l=`${te(r)}|${JSON.stringify({includes:i,excludes:o})}`;let d=this.fileSearchCache.get(l);if(d===void 0){const S=this.providerService.getRelativeFilePath(r);let P;await this.github.hasFileTree(r)&&(P=await this.github.getFileTree(r));let I;if(P===void 0||P.loading||!P.hasEntireTree?I=await this.github.getFileList(r,S):I=(await P.getChildren(S,{filter:m.FileType.File,recursive:!0})).map(([O])=>O),I.length===0||c.isCancellationRequested)return[];((i==null?void 0:i.length)||(o==null?void 0:o.length))&&(I=[..._a(I,i,o)]),d=I.map(O=>At.prepareSlow(O)),this.fileSearchCache.set(l,d)}let p;return e.pattern===""?p=d.map(S=>m.Uri.joinPath(r,S.target)):(p=At.go(e.pattern.replace(Yv,"/"),d,{allowTypo:!0,limit:n}).map(S=>m.Uri.joinPath(r,S.target)),At.cleanup()),n!==void 0&&n!==0&&n<p.length&&(p=p.slice(0,n)),p}async provideTextSearchResults(e,r,n,i){const o=[];if(await this.tarPit.isIndexingEnabledForRepo(r.folder))try{return Gv(this.providerService,this.changeStore,this.tarPit,e,r,n,i)}catch{o.push({text:Td("index error","Error searching index, falling back to GitHub search. Try [deleting this repo's data]({0}) or [deleting all local data]({1}) to rebuild the index.","command:remoteHub.deleteLocalRepositoryData","command:remoteHub.deleteAllLocalRepositoryData"),type:m.TextSearchCompleteMessageType.Warning})}e.isCaseSensitive||e.isRegExp||e.isWordMatch?o.push({text:Td("flags not supported","Search flags are not supported by GitHub search. [Enable indexing]({0}) for full search features and exact text searches.","command:remoteHub.enableIndexing"),type:m.TextSearchCompleteMessageType.Warning,trusted:!0}):o.push({text:Td("enable index","Currently using GitHub text search. [Enable indexing]({0}) for exact text searches.","command:remoteHub.enableIndexing"),type:m.TextSearchCompleteMessageType.Information,trusted:!0});const c=await this.github.searchCodeQuery(e.pattern,r.folder,{maxResults:r.maxResults,context:{before:r.beforeContext,after:r.afterContext}});if(c.warnings&&c.warnings.forEach(d=>{o.push({text:d,trusted:!0,type:m.TextSearchCompleteMessageType.Warning})}),c===void 0)return{limitHit:!0,message:o};let l;for(const d of c.matches)l=m.Uri.joinPath(r.folder,d.path),n.report({uri:l,ranges:d.ranges,preview:{text:d.preview,matches:d.matches}});return{limitHit:!1,message:o}}}a(el,"GitHubFS"),Cd([Lr()],el.prototype,"stat",1),Cd([Lr()],el.prototype,"readDirectory",1),Cd([Lr()],el.prototype,"readFile",1);var Zv=__webpack_require__(1017);function su(){return typeof navigator=="object"&&"userAgent"in navigator?navigator.userAgent:typeof process=="object"&&"version"in process?`Node.js/${process.version.substr(1)} (${process.platform}; ${process.arch})`:"<environment undetectable>"}a(su,"getUserAgent");var Jv=__webpack_require__(5186);/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function Hf(t){return Object.prototype.toString.call(t)==="[object Object]"}a(Hf,"isObject");function Uf(t){var e,r;return Hf(t)===!1?!1:(e=t.constructor,e===void 0?!0:(r=e.prototype,!(Hf(r)===!1||r.hasOwnProperty("isPrototypeOf")===!1)))}a(Uf,"isPlainObject");function e0(t){return t?Object.keys(t).reduce((e,r)=>(e[r.toLowerCase()]=t[r],e),{}):{}}a(e0,"lowercaseKeys");function jf(t,e){const r=Object.assign({},t);return Object.keys(e).forEach(n=>{Uf(e[n])?n in t?r[n]=jf(t[n],e[n]):Object.assign(r,{[n]:e[n]}):Object.assign(r,{[n]:e[n]})}),r}a(jf,"mergeDeep");function qf(t){for(const e in t)t[e]===void 0&&delete t[e];return t}a(qf,"removeUndefinedProperties");function Ad(t,e,r){if(typeof e=="string"){let[i,o]=e.split(" ");r=Object.assign(o?{method:i,url:o}:{url:i},r)}else r=Object.assign({},e);r.headers=e0(r.headers),qf(r),qf(r.headers);const n=jf(t||{},r);return t&&t.mediaType.previews.length&&(n.mediaType.previews=t.mediaType.previews.filter(i=>!n.mediaType.previews.includes(i)).concat(n.mediaType.previews)),n.mediaType.previews=n.mediaType.previews.map(i=>i.replace(/-preview/,"")),n}a(Ad,"dist_web_merge");function t0(t,e){const r=/\?/.test(t)?"&":"?",n=Object.keys(e);return n.length===0?t:t+r+n.map(i=>i==="q"?"q="+e.q.split("+").map(encodeURIComponent).join("+"):`${i}=${encodeURIComponent(e[i])}`).join("&")}a(t0,"addQueryParameters");const r0=/\{[^}]+\}/g;function n0(t){return t.replace(/^\W+|\W+$/g,"").split(/,/)}a(n0,"removeNonChars");function i0(t){const e=t.match(r0);return e?e.map(n0).reduce((r,n)=>r.concat(n),[]):[]}a(i0,"extractUrlVariableNames");function zf(t,e){return Object.keys(t).filter(r=>!e.includes(r)).reduce((r,n)=>(r[n]=t[n],r),{})}a(zf,"omit");function Wf(t){return t.split(/(%[0-9A-Fa-f]{2})/g).map(function(e){return/%[0-9A-Fa-f]/.test(e)||(e=encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]")),e}).join("")}a(Wf,"encodeReserved");function Hs(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}a(Hs,"encodeUnreserved");function tl(t,e,r){return e=t==="+"||t==="#"?Wf(e):Hs(e),r?Hs(r)+"="+e:e}a(tl,"encodeValue");function Us(t){return t!=null}a(Us,"isDefined");function Rd(t){return t===";"||t==="&"||t==="?"}a(Rd,"isKeyOperator");function o0(t,e,r,n){var i=t[r],o=[];if(Us(i)&&i!=="")if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")i=i.toString(),n&&n!=="*"&&(i=i.substring(0,parseInt(n,10))),o.push(tl(e,i,Rd(e)?r:""));else if(n==="*")Array.isArray(i)?i.filter(Us).forEach(function(c){o.push(tl(e,c,Rd(e)?r:""))}):Object.keys(i).forEach(function(c){Us(i[c])&&o.push(tl(e,i[c],c))});else{const c=[];Array.isArray(i)?i.filter(Us).forEach(function(l){c.push(tl(e,l))}):Object.keys(i).forEach(function(l){Us(i[l])&&(c.push(Hs(l)),c.push(tl(e,i[l].toString())))}),Rd(e)?o.push(Hs(r)+"="+c.join(",")):c.length!==0&&o.push(c.join(","))}else e===";"?Us(i)&&o.push(Hs(r)):i===""&&(e==="&"||e==="?")?o.push(Hs(r)+"="):i===""&&o.push("");return o}a(o0,"getValues");function a0(t){return{expand:s0.bind(null,t)}}a(a0,"parseUrl");function s0(t,e){var r=["+","#",".","/",";","?","&"];return t.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(n,i,o){if(i){let l="";const d=[];if(r.indexOf(i.charAt(0))!==-1&&(l=i.charAt(0),i=i.substr(1)),i.split(/,/g).forEach(function(p){var S=/([^:\*]*)(?::(\d+)|(\*))?/.exec(p);d.push(o0(e,l,S[1],S[2]||S[3]))}),l&&l!=="+"){var c=",";return l==="?"?c="&":l!=="#"&&(c=l),(d.length!==0?l:"")+d.join(c)}else return d.join(",")}else return Wf(o)})}a(s0,"expand");function Gf(t){let e=t.method.toUpperCase(),r=(t.url||"/").replace(/:([a-z]\w+)/g,"{$1}"),n=Object.assign({},t.headers),i,o=zf(t,["method","baseUrl","url","headers","request","mediaType"]);const c=i0(r);r=a0(r).expand(o),/^http/.test(r)||(r=t.baseUrl+r);const l=Object.keys(t).filter(S=>c.includes(S)).concat("baseUrl"),d=zf(o,l);if(!/application\/octet-stream/i.test(n.accept)&&(t.mediaType.format&&(n.accept=n.accept.split(/,/).map(S=>S.replace(/application\/vnd(\.\w+)(\.v3)?(\.\w+)?(\+json)?$/,`application/vnd$1$2.${t.mediaType.format}`)).join(",")),t.mediaType.previews.length)){const S=n.accept.match(/[\w-]+(?=-preview)/g)||[];n.accept=S.concat(t.mediaType.previews).map(P=>{const I=t.mediaType.format?`.${t.mediaType.format}`:"+json";return`application/vnd.github.${P}-preview${I}`}).join(",")}return["GET","HEAD"].includes(e)?r=t0(r,d):"data"in d?i=d.data:Object.keys(d).length?i=d:n["content-length"]=0,!n["content-type"]&&typeof i!="undefined"&&(n["content-type"]="application/json; charset=utf-8"),["PATCH","PUT"].includes(e)&&typeof i=="undefined"&&(i=""),Object.assign({method:e,url:r,headers:n},typeof i!="undefined"?{body:i}:null,t.request?{request:t.request}:null)}a(Gf,"parse");function c0(t,e,r){return Gf(Ad(t,e,r))}a(c0,"endpointWithDefaults");function Vf(t,e){const r=Ad(t,e),n=c0.bind(null,r);return Object.assign(n,{DEFAULTS:r,defaults:Vf.bind(null,r),merge:Ad.bind(null,r),parse:Gf})}a(Vf,"withDefaults");const l0=`octokit-endpoint.js/6.0.12 ${su()}`,u0=Vf(null,{method:"GET",baseUrl:"https://api.github.com",headers:{accept:"application/vnd.github.v3+json","user-agent":l0},mediaType:{format:"",previews:[]}}),d0=Cr.Readable,vo=Symbol("buffer"),Id=Symbol("type");class Ha{constructor(){this[Id]="";const e=arguments[0],r=arguments[1],n=[];let i=0;if(e){const c=e,l=Number(c.length);for(let d=0;d<l;d++){const p=c[d];let S;p instanceof Buffer?S=p:ArrayBuffer.isView(p)?S=Buffer.from(p.buffer,p.byteOffset,p.byteLength):p instanceof ArrayBuffer?S=Buffer.from(p):p instanceof Ha?S=p[vo]:S=Buffer.from(typeof p=="string"?p:String(p)),i+=S.length,n.push(S)}}this[vo]=Buffer.concat(n);let o=r&&r.type!==void 0&&String(r.type).toLowerCase();o&&!/[^\u0020-\u007E]/.test(o)&&(this[Id]=o)}get size(){return this[vo].length}get type(){return this[Id]}text(){return Promise.resolve(this[vo].toString())}arrayBuffer(){const e=this[vo],r=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return Promise.resolve(r)}stream(){const e=new d0;return e._read=function(){},e.push(this[vo]),e.push(null),e}toString(){return"[object Blob]"}slice(){const e=this.size,r=arguments[0],n=arguments[1];let i,o;r===void 0?i=0:r<0?i=Math.max(e+r,0):i=Math.min(r,e),n===void 0?o=e:n<0?o=Math.max(e+n,0):o=Math.min(n,e);const c=Math.max(o-i,0),d=this[vo].slice(i,i+c),p=new Ha([],{type:arguments[2]});return p[vo]=d,p}}a(Ha,"lib_Blob"),Object.defineProperties(Ha.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(Ha.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0});function Tn(t,e,r){Error.call(this,t),this.message=t,this.type=e,r&&(this.code=this.errno=r.code),Error.captureStackTrace(this,this.constructor)}a(Tn,"lib_FetchError"),Tn.prototype=Object.create(Error.prototype),Tn.prototype.constructor=Tn,Tn.prototype.name="FetchError";let Od;try{Od=require("encoding").convert}catch(t){}const yo=Symbol("Body internals"),Kf=Cr.PassThrough;function tn(t){var e=this,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.size;let i=n===void 0?0:n;var o=r.timeout;let c=o===void 0?0:o;t==null?t=null:Xf(t)?t=Buffer.from(t.toString()):rl(t)||Buffer.isBuffer(t)||(Object.prototype.toString.call(t)==="[object ArrayBuffer]"?t=Buffer.from(t):ArrayBuffer.isView(t)?t=Buffer.from(t.buffer,t.byteOffset,t.byteLength):t instanceof Cr||(t=Buffer.from(String(t)))),this[yo]={body:t,disturbed:!1,error:null},this.size=i,this.timeout=c,t instanceof Cr&&t.on("error",function(l){const d=l.name==="AbortError"?l:new Tn(`Invalid response body while trying to fetch ${e.url}: ${l.message}`,"system",l);e[yo].error=d})}a(tn,"lib_Body"),tn.prototype={get body(){return this[yo].body},get bodyUsed(){return this[yo].disturbed},arrayBuffer(){return js.call(this).then(function(t){return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)})},blob(){let t=this.headers&&this.headers.get("content-type")||"";return js.call(this).then(function(e){return Object.assign(new Ha([],{type:t.toLowerCase()}),{[vo]:e})})},json(){var t=this;return js.call(this).then(function(e){try{return JSON.parse(e.toString())}catch(r){return tn.Promise.reject(new Tn(`invalid json response body at ${t.url} reason: ${r.message}`,"invalid-json"))}})},text(){return js.call(this).then(function(t){return t.toString()})},buffer(){return js.call(this)},textConverted(){var t=this;return js.call(this).then(function(e){return h0(e,t.headers)})}},Object.defineProperties(tn.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),tn.mixIn=function(t){for(const e of Object.getOwnPropertyNames(tn.prototype))if(!(e in t)){const r=Object.getOwnPropertyDescriptor(tn.prototype,e);Object.defineProperty(t,e,r)}};function js(){var t=this;if(this[yo].disturbed)return tn.Promise.reject(new TypeError(`body used already for: ${this.url}`));if(this[yo].disturbed=!0,this[yo].error)return tn.Promise.reject(this[yo].error);let e=this.body;if(e===null)return tn.Promise.resolve(Buffer.alloc(0));if(rl(e)&&(e=e.stream()),Buffer.isBuffer(e))return tn.Promise.resolve(e);if(!(e instanceof Cr))return tn.Promise.resolve(Buffer.alloc(0));let r=[],n=0,i=!1;return new tn.Promise(function(o,c){let l;t.timeout&&(l=setTimeout(function(){i=!0,c(new Tn(`Response timeout while trying to fetch ${t.url} (over ${t.timeout}ms)`,"body-timeout"))},t.timeout)),e.on("error",function(d){d.name==="AbortError"?(i=!0,c(d)):c(new Tn(`Invalid response body while trying to fetch ${t.url}: ${d.message}`,"system",d))}),e.on("data",function(d){if(!(i||d===null)){if(t.size&&n+d.length>t.size){i=!0,c(new Tn(`content size at ${t.url} over limit: ${t.size}`,"max-size"));return}n+=d.length,r.push(d)}}),e.on("end",function(){if(!i){clearTimeout(l);try{o(Buffer.concat(r,n))}catch(d){c(new Tn(`Could not create Buffer from response body for ${t.url}: ${d.message}`,"system",d))}}})})}a(js,"lib_consumeBody");function h0(t,e){if(typeof Od!="function")throw new Error("The package `encoding` must be installed to use the textConverted() function");const r=e.get("content-type");let n="utf-8",i,o;return r&&(i=/charset=([^;]*)/i.exec(r)),o=t.slice(0,1024).toString(),!i&&o&&(i=/<meta.+?charset=(['"])(.+?)\1/i.exec(o)),!i&&o&&(i=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(o),i||(i=/<meta[\s]+?content=(['"])(.+?)\1[\s]+?http-equiv=(['"])content-type\3/i.exec(o),i&&i.pop()),i&&(i=/charset=(.*)/i.exec(i.pop()))),!i&&o&&(i=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(o)),i&&(n=i.pop(),(n==="gb2312"||n==="gbk")&&(n="gb18030")),Od(t,"UTF-8",n).toString()}a(h0,"lib_convertBody");function Xf(t){return typeof t!="object"||typeof t.append!="function"||typeof t.delete!="function"||typeof t.get!="function"||typeof t.getAll!="function"||typeof t.has!="function"||typeof t.set!="function"?!1:t.constructor.name==="URLSearchParams"||Object.prototype.toString.call(t)==="[object URLSearchParams]"||typeof t.sort=="function"}a(Xf,"lib_isURLSearchParams");function rl(t){return typeof t=="object"&&typeof t.arrayBuffer=="function"&&typeof t.type=="string"&&typeof t.stream=="function"&&typeof t.constructor=="function"&&typeof t.constructor.name=="string"&&/^(Blob|File)$/.test(t.constructor.name)&&/^(Blob|File)$/.test(t[Symbol.toStringTag])}a(rl,"lib_isBlob");function Qf(t){let e,r,n=t.body;if(t.bodyUsed)throw new Error("cannot clone body after it is used");return n instanceof Cr&&typeof n.getBoundary!="function"&&(e=new Kf,r=new Kf,n.pipe(e),n.pipe(r),t[yo].body=e,n=r),n}a(Qf,"lib_clone");function Yf(t){return t===null?null:typeof t=="string"?"text/plain;charset=UTF-8":Xf(t)?"application/x-www-form-urlencoded;charset=UTF-8":rl(t)?t.type||null:Buffer.isBuffer(t)||Object.prototype.toString.call(t)==="[object ArrayBuffer]"||ArrayBuffer.isView(t)?null:typeof t.getBoundary=="function"?`multipart/form-data;boundary=${t.getBoundary()}`:t instanceof Cr?null:"text/plain;charset=UTF-8"}a(Yf,"lib_extractContentType");function Zf(t){const e=t.body;return e===null?0:rl(e)?e.size:Buffer.isBuffer(e)?e.length:e&&typeof e.getLengthSync=="function"&&(e._lengthRetrievers&&e._lengthRetrievers.length==0||e.hasKnownLength&&e.hasKnownLength())?e.getLengthSync():null}a(Zf,"lib_getTotalBytes");function f0(t,e){const r=e.body;r===null?t.end():rl(r)?r.stream().pipe(t):Buffer.isBuffer(r)?(t.write(r),t.end()):r.pipe(t)}a(f0,"lib_writeToStream"),tn.Promise=global.Promise;const Jf=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,Pd=/[^\t\x20-\x7e\x80-\xff]/;function nl(t){if(t=`${t}`,Jf.test(t)||t==="")throw new TypeError(`${t} is not a legal HTTP header name`)}a(nl,"lib_validateName");function ep(t){if(t=`${t}`,Pd.test(t))throw new TypeError(`${t} is not a legal HTTP header value`)}a(ep,"lib_validateValue");function qs(t,e){e=e.toLowerCase();for(const r in t)if(r.toLowerCase()===e)return r}a(qs,"node_fetch_lib_find");const Mr=Symbol("map");class hi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:void 0;if(this[Mr]=Object.create(null),e instanceof hi){const r=e.raw(),n=Object.keys(r);for(const i of n)for(const o of r[i])this.append(i,o);return}if(e!=null)if(typeof e=="object"){const r=e[Symbol.iterator];if(r!=null){if(typeof r!="function")throw new TypeError("Header pairs must be iterable");const n=[];for(const i of e){if(typeof i!="object"||typeof i[Symbol.iterator]!="function")throw new TypeError("Each header pair must be iterable");n.push(Array.from(i))}for(const i of n){if(i.length!==2)throw new TypeError("Each header pair must be a name/value tuple");this.append(i[0],i[1])}}else for(const n of Object.keys(e)){const i=e[n];this.append(n,i)}}else throw new TypeError("Provided initializer must be an object")}get(e){e=`${e}`,nl(e);const r=qs(this[Mr],e);return r===void 0?null:this[Mr][r].join(", ")}forEach(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,n=Dd(this),i=0;for(;i<n.length;){var o=n[i];const c=o[0],l=o[1];e.call(r,l,c,this),n=Dd(this),i++}}set(e,r){e=`${e}`,r=`${r}`,nl(e),ep(r);const n=qs(this[Mr],e);this[Mr][n!==void 0?n:e]=[r]}append(e,r){e=`${e}`,r=`${r}`,nl(e),ep(r);const n=qs(this[Mr],e);n!==void 0?this[Mr][n].push(r):this[Mr][e]=[r]}has(e){return e=`${e}`,nl(e),qs(this[Mr],e)!==void 0}delete(e){e=`${e}`,nl(e);const r=qs(this[Mr],e);r!==void 0&&delete this[Mr][r]}raw(){return this[Mr]}keys(){return Nd(this,"key")}values(){return Nd(this,"value")}[Symbol.iterator](){return Nd(this,"key+value")}}a(hi,"lib_Headers"),hi.prototype.entries=hi.prototype[Symbol.iterator],Object.defineProperty(hi.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(hi.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});function Dd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"key+value";return Object.keys(t[Mr]).sort().map(e==="key"?function(n){return n.toLowerCase()}:e==="value"?function(n){return t[Mr][n].join(", ")}:function(n){return[n.toLowerCase(),t[Mr][n].join(", ")]})}a(Dd,"lib_getHeaders");const kd=Symbol("internal");function Nd(t,e){const r=Object.create(Md);return r[kd]={target:t,kind:e,index:0},r}a(Nd,"lib_createHeadersIterator");const Md=Object.setPrototypeOf({next(){if(!this||Object.getPrototypeOf(this)!==Md)throw new TypeError("Value of `this` is not a HeadersIterator");var t=this[kd];const e=t.target,r=t.kind,n=t.index,i=Dd(e,r),o=i.length;return n>=o?{value:void 0,done:!0}:(this[kd].index=n+1,{value:i[n],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));Object.defineProperty(Md,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});function p0(t){const e=Object.assign({__proto__:null},t[Mr]),r=qs(t[Mr],"Host");return r!==void 0&&(e[r]=e[r][0]),e}a(p0,"lib_exportNodeCompatibleHeaders");function g0(t){const e=new hi;for(const r of Object.keys(t))if(!Jf.test(r))if(Array.isArray(t[r]))for(const n of t[r])Pd.test(n)||(e[Mr][r]===void 0?e[Mr][r]=[n]:e[Mr][r].push(n));else Pd.test(t[r])||(e[Mr][r]=[t[r]]);return e}a(g0,"lib_createHeadersLenient");const ea=Symbol("Response internals"),m0=ps.STATUS_CODES;class Ri{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};tn.call(this,e,r);const n=r.status||200,i=new hi(r.headers);if(e!=null&&!i.has("Content-Type")){const o=Yf(e);o&&i.append("Content-Type",o)}this[ea]={url:r.url,status:n,statusText:r.statusText||m0[n],headers:i,counter:r.counter}}get url(){return this[ea].url||""}get status(){return this[ea].status}get ok(){return this[ea].status>=200&&this[ea].status<300}get redirected(){return this[ea].counter>0}get statusText(){return this[ea].statusText}get headers(){return this[ea].headers}clone(){return new Ri(Qf(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok,redirected:this.redirected})}}a(Ri,"lib_Response"),tn.mixIn(Ri.prototype),Object.defineProperties(Ri.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(Ri.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});const _o=Symbol("Request internals"),Ld=$o.parse,v0=$o.format,y0="destroy"in Cr.Readable.prototype;function cu(t){return typeof t=="object"&&typeof t[_o]=="object"}a(cu,"lib_isRequest");function _0(t){const e=t&&typeof t=="object"&&Object.getPrototypeOf(t);return!!(e&&e.constructor.name==="AbortSignal")}a(_0,"lib_isAbortSignal");class ta{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;cu(e)?n=Ld(e.url):(e&&e.href?n=Ld(e.href):n=Ld(`${e}`),e={});let i=r.method||e.method||"GET";if(i=i.toUpperCase(),(r.body!=null||cu(e)&&e.body!==null)&&(i==="GET"||i==="HEAD"))throw new TypeError("Request with GET/HEAD method cannot have body");let o=r.body!=null?r.body:cu(e)&&e.body!==null?Qf(e):null;tn.call(this,o,{timeout:r.timeout||e.timeout||0,size:r.size||e.size||0});const c=new hi(r.headers||e.headers||{});if(o!=null&&!c.has("Content-Type")){const d=Yf(o);d&&c.append("Content-Type",d)}let l=cu(e)?e.signal:null;if("signal"in r&&(l=r.signal),l!=null&&!_0(l))throw new TypeError("Expected signal to be an instanceof AbortSignal");this[_o]={method:i,redirect:r.redirect||e.redirect||"follow",headers:c,parsedURL:n,signal:l},this.follow=r.follow!==void 0?r.follow:e.follow!==void 0?e.follow:20,this.compress=r.compress!==void 0?r.compress:e.compress!==void 0?e.compress:!0,this.counter=r.counter||e.counter||0,this.agent=r.agent||e.agent}get method(){return this[_o].method}get url(){return v0(this[_o].parsedURL)}get headers(){return this[_o].headers}get redirect(){return this[_o].redirect}get signal(){return this[_o].signal}clone(){return new ta(this)}}a(ta,"lib_Request"),tn.mixIn(ta.prototype),Object.defineProperty(ta.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(ta.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});function w0(t){const e=t[_o].parsedURL,r=new hi(t[_o].headers);if(r.has("Accept")||r.set("Accept","*/*"),!e.protocol||!e.hostname)throw new TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(e.protocol))throw new TypeError("Only HTTP(S) protocols are supported");if(t.signal&&t.body instanceof Cr.Readable&&!y0)throw new Error("Cancellation of streamed requests with AbortSignal is not supported in node < 8");let n=null;if(t.body==null&&/^(POST|PUT)$/i.test(t.method)&&(n="0"),t.body!=null){const o=Zf(t);typeof o=="number"&&(n=String(o))}n&&r.set("Content-Length",n),r.has("User-Agent")||r.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),t.compress&&!r.has("Accept-Encoding")&&r.set("Accept-Encoding","gzip,deflate");let i=t.agent;return typeof i=="function"&&(i=i(e)),!r.has("Connection")&&!i&&r.set("Connection","close"),Object.assign({},e,{method:t.method,headers:p0(r),agent:i})}a(w0,"lib_getNodeRequestOptions");function il(t){Error.call(this,t),this.type="aborted",this.message=t,Error.captureStackTrace(this,this.constructor)}a(il,"lib_AbortError"),il.prototype=Object.create(Error.prototype),il.prototype.constructor=il,il.prototype.name="AbortError";const tp=Cr.PassThrough,b0=$o.resolve;function ra(t,e){if(!ra.Promise)throw new Error("native promise missing, set fetch.Promise to your favorite alternative");return tn.Promise=ra.Promise,new ra.Promise(function(r,n){const i=new ta(t,e),o=w0(i),c=(o.protocol==="https:"?Tl:ps).request,l=i.signal;let d=null;const p=a(function(){let N=new il("The user aborted a request.");n(N),i.body&&i.body instanceof Cr.Readable&&i.body.destroy(N),!(!d||!d.body)&&d.body.emit("error",N)},"abort");if(l&&l.aborted){p();return}const S=a(function(){p(),O()},"abortAndFinalize"),P=c(o);let I;l&&l.addEventListener("abort",S);function O(){P.abort(),l&&l.removeEventListener("abort",S),clearTimeout(I)}a(O,"finalize"),i.timeout&&P.once("socket",function(F){I=setTimeout(function(){n(new Tn(`network timeout at: ${i.url}`,"request-timeout")),O()},i.timeout)}),P.on("error",function(F){n(new Tn(`request to ${i.url} failed, reason: ${F.message}`,"system",F)),O()}),P.on("response",function(F){clearTimeout(I);const N=g0(F.headers);if(ra.isRedirect(F.statusCode)){const oe=N.get("Location"),ge=oe===null?null:b0(i.url,oe);switch(i.redirect){case"error":n(new Tn(`uri requested responds with a redirect, redirect mode is set to error: ${i.url}`,"no-redirect")),O();return;case"manual":if(ge!==null)try{N.set("Location",ge)}catch(Re){n(Re)}break;case"follow":if(ge===null)break;if(i.counter>=i.follow){n(new Tn(`maximum redirect reached at: ${i.url}`,"max-redirect")),O();return}const ke={headers:new hi(i.headers),follow:i.follow,counter:i.counter+1,agent:i.agent,compress:i.compress,method:i.method,body:i.body,signal:i.signal,timeout:i.timeout,size:i.size};if(F.statusCode!==303&&i.body&&Zf(i)===null){n(new Tn("Cannot follow redirect with body being a readable stream","unsupported-redirect")),O();return}(F.statusCode===303||(F.statusCode===301||F.statusCode===302)&&i.method==="POST")&&(ke.method="GET",ke.body=void 0,ke.headers.delete("content-length")),r(ra(new ta(ge,ke))),O();return}}F.once("end",function(){l&&l.removeEventListener("abort",S)});let U=F.pipe(new tp);const W={url:i.url,status:F.statusCode,statusText:F.statusMessage,headers:N,size:i.size,timeout:i.timeout,counter:i.counter},V=N.get("Content-Encoding");if(!i.compress||i.method==="HEAD"||V===null||F.statusCode===204||F.statusCode===304){d=new Ri(U,W),r(d);return}const ie={flush:gn.Z_SYNC_FLUSH,finishFlush:gn.Z_SYNC_FLUSH};if(V=="gzip"||V=="x-gzip"){U=U.pipe(gn.createGunzip(ie)),d=new Ri(U,W),r(d);return}if(V=="deflate"||V=="x-deflate"){F.pipe(new tp).once("data",function(ge){(ge[0]&15)==8?U=U.pipe(gn.createInflate()):U=U.pipe(gn.createInflateRaw()),d=new Ri(U,W),r(d)});return}if(V=="br"&&typeof gn.createBrotliDecompress=="function"){U=U.pipe(gn.createBrotliDecompress()),d=new Ri(U,W),r(d);return}d=new Ri(U,W),r(d)}),f0(P,i)})}a(ra,"lib_fetch"),ra.isRedirect=function(t){return t===301||t===302||t===303||t===307||t===308},ra.Promise=global.Promise;const S0=ra,E0="5.6.1";function x0(t){return t.arrayBuffer()}a(x0,"getBufferResponse");function rp(t){const e=t.request&&t.request.log?t.request.log:console;(Uf(t.body)||Array.isArray(t.body))&&(t.body=JSON.stringify(t.body));let r={},n,i;return(t.request&&t.request.fetch||S0)(t.url,Object.assign({method:t.method,body:t.body,headers:t.headers,redirect:t.redirect},t.request)).then(async c=>{i=c.url,n=c.status;for(const l of c.headers)r[l[0]]=l[1];if("deprecation"in r){const l=r.link&&r.link.match(/<([^>]+)>; rel="deprecation"/),d=l&&l.pop();e.warn(`[@octokit/request] "${t.method} ${t.url}" is deprecated. It is scheduled to be removed on ${r.sunset}${d?`. See ${d}`:""}`)}if(!(n===204||n===205)){if(t.method==="HEAD"){if(n<400)return;throw new jn(c.statusText,n,{response:{url:i,status:n,headers:r,data:void 0},request:t})}if(n===304)throw new jn("Not modified",n,{response:{url:i,status:n,headers:r,data:await $d(c)},request:t});if(n>=400){const l=await $d(c);throw new jn(C0(l),n,{response:{url:i,status:n,headers:r,data:l},request:t})}return $d(c)}}).then(c=>({status:n,url:i,headers:r,data:c})).catch(c=>{throw c instanceof jn?c:new jn(c.message,500,{request:t})})}a(rp,"fetchWrapper");async function $d(t){const e=t.headers.get("content-type");return/application\/json/.test(e)?t.json():!e||/^text\/|charset=utf-8$/.test(e)?t.text():x0(t)}a($d,"getResponseData");function C0(t){return typeof t=="string"?t:"message"in t?Array.isArray(t.errors)?`${t.message}: ${t.errors.map(JSON.stringify).join(", ")}`:t.message:`Unknown error: ${JSON.stringify(t)}`}a(C0,"toErrorMessage");function Fd(t,e){const r=t.defaults(e);return Object.assign(a(function(i,o){const c=r.merge(i,o);if(!c.request||!c.request.hook)return rp(r.parse(c));const l=a((d,p)=>rp(r.parse(r.merge(d,p))),"request");return Object.assign(l,{endpoint:r,defaults:Fd.bind(null,r)}),c.request.hook(l,c)},"newApi"),{endpoint:r,defaults:Fd.bind(null,r)})}a(Fd,"dist_web_withDefaults");const lu=Fd(u0,{headers:{"user-agent":`octokit-request.js/${E0} ${su()}`}}),T0="4.8.0";function A0(t){return`Request failed due to following response errors:
`+t.errors.map(e=>` - ${e.message}`).join(`
`)}a(A0,"_buildMessageForResponseErrors");class zs extends Error{constructor(e,r,n){super(A0(n));this.request=e,this.headers=r,this.response=n,this.name="GraphqlResponseError",this.errors=n.errors,this.data=n.data,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}a(zs,"GraphqlResponseError");const R0=["method","baseUrl","url","headers","request","query","mediaType"],I0=["query","method","url"],np=/\/api\/v3\/?$/;function O0(t,e,r){if(r){if(typeof e=="string"&&"query"in r)return Promise.reject(new Error('[@octokit/graphql] "query" cannot be used as variable name'));for(const c in r)if(!!I0.includes(c))return Promise.reject(new Error(`[@octokit/graphql] "${c}" cannot be used as variable name`))}const n=typeof e=="string"?Object.assign({query:e},r):e,i=Object.keys(n).reduce((c,l)=>R0.includes(l)?(c[l]=n[l],c):(c.variables||(c.variables={}),c.variables[l]=n[l],c),{}),o=n.baseUrl||t.endpoint.DEFAULTS.baseUrl;return np.test(o)&&(i.url=o.replace(np,"/api/graphql")),t(i).then(c=>{if(c.data.errors){const l={};for(const d of Object.keys(c.headers))l[d]=c.headers[d];throw new zs(i,l,c.data)}return c.data.data})}a(O0,"graphql");function Bd(t,e){const r=t.defaults(e);return Object.assign(a((i,o)=>O0(r,i,o),"newApi"),{defaults:Bd.bind(null,r),endpoint:lu.endpoint})}a(Bd,"graphql_dist_web_withDefaults");const $y=Bd(lu,{headers:{"user-agent":`octokit-graphql.js/${T0} ${su()}`},method:"POST",url:"/graphql"});function P0(t){return Bd(t,{method:"POST",url:"/graphql"})}a(P0,"withCustomRequest");const D0=/^v1\./,k0=/^ghs_/,N0=/^ghu_/;async function M0(t){const e=t.split(/\./).length===3,r=D0.test(t)||k0.test(t),n=N0.test(t);return{type:"token",token:t,tokenType:e?"app":r?"installation":n?"user-to-server":"oauth"}}a(M0,"auth");function L0(t){return t.split(/\./).length===3?`bearer ${t}`:`token ${t}`}a(L0,"withAuthorizationPrefix");async function $0(t,e,r,n){const i=e.endpoint.merge(r,n);return i.headers.authorization=L0(t),e(i)}a($0,"hook");const F0=a(function(e){if(!e)throw new Error("[@octokit/auth-token] No token passed to createTokenAuth");if(typeof e!="string")throw new Error("[@octokit/auth-token] Token passed to createTokenAuth is not a string");return e=e.replace(/^(token|bearer) +/i,""),Object.assign(M0.bind(null,e),{hook:$0.bind(null,e)})},"createTokenAuth"),ip="3.5.1";class ol{constructor(e={}){const r=new Jv.Collection,n={baseUrl:lu.endpoint.DEFAULTS.baseUrl,headers:{},request:Object.assign({},e.request,{hook:r.bind(null,"request")}),mediaType:{previews:[],format:""}};if(n.headers["user-agent"]=[e.userAgent,`octokit-core.js/${ip} ${su()}`].filter(Boolean).join(" "),e.baseUrl&&(n.baseUrl=e.baseUrl),e.previews&&(n.mediaType.previews=e.previews),e.timeZone&&(n.headers["time-zone"]=e.timeZone),this.request=lu.defaults(n),this.graphql=P0(this.request).defaults(n),this.log=Object.assign({debug:()=>{},info:()=>{},warn:console.warn.bind(console),error:console.error.bind(console)},e.log),this.hook=r,e.authStrategy){const{authStrategy:o,...c}=e,l=o(Object.assign({request:this.request,log:this.log,octokit:this,octokitOptions:c},e.auth));r.wrap("request",l.hook),this.auth=l}else if(!e.auth)this.auth=async()=>({type:"unauthenticated"});else{const o=F0(e.auth);r.wrap("request",o.hook),this.auth=o}this.constructor.plugins.forEach(o=>{Object.assign(this,o(this,e))})}static defaults(e){return a(class extends this{constructor(...n){const i=n[0]||{};if(typeof e=="function"){super(e(i));return}super(Object.assign({},e,i,i.userAgent&&e.userAgent?{userAgent:`${i.userAgent} ${e.userAgent}`}:null))}},"OctokitWithDefaults")}static plugin(...e){var r;const n=this.plugins;return r=a(class extends this{},"_a"),r.plugins=n.concat(e.filter(o=>!n.includes(o))),r}}a(ol,"Octokit"),ol.VERSION=ip,ol.plugins=[];function B0(t,e){return t.reduce((n,i)=>{const o=e(i),c=n.get(o);return c===void 0?n.set(o,[i]):c.push(i),n},new Map)}a(B0,"groupBy");function H0(t){let e=0;for(const r of t){if(r===0)return!0;if(e++,e>8e3)break}return!1}a(H0,"isBinary");function Hd(t,e,r=n=>n){return[...t.reduce((i,o)=>{const c=e(o),l=i.get(c);if(l===void 0)i.set(c,o);else{const d=r(l,o);d!==void 0&&i.set(c,d)}return i},new Map).values()]}a(Hd,"uniqueBy");function Ud(t){const e="$memoize$";return function(...r){return this.hasOwnProperty(e)||Object.defineProperty(this,e,{configurable:!1,enumerable:!1,writable:!1,value:t.apply(this,r)}),this[e]}}a(Ud,"memoize");class jd{constructor(e,r){this.path=e,this.relativePath=r}}a(jd,"TrieNode");class op{constructor(){this.root=new jd("","")}get(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;for(const i of e.split("/")){const o=(r=n.children)==null?void 0:r.get(i);if(o===void 0)return;n=o}return n.path===e?n.data:void 0}getChildren(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;if(e)for(const i of e.split("/")){const o=(r=n.children)==null?void 0:r.get(i);if(o===void 0)return[];n=o}return n.children===void 0?[]:[...n.children.values()].map(i=>[i.relativePath,i.data])}getDescendants(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;const i=[];if(e)for(const o of e.split("/")){const c=(r=n.children)==null?void 0:r.get(o);if(c===void 0)return i;n=c}if(n.children!==void 0){let o=a(function(c,l,d){for(const p of c.values()){const S=`${l?`${l}/`:""}${p.relativePath}`;p.data&&d.push([S,p.data]),p.children!==void 0&&o(p.children,S,d)}},"getDescendantsCore");o(n.children,"",i)}return i}has(e){var r;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let n=this.root;for(const i of e.split("/")){const o=(r=n.children)==null?void 0:r.get(i);if(o===void 0)return!1;n=o}return n.path===e}set(e,r){var n;e.startsWith("/")?e=e.slice(1,e.endsWith("/")?-1:void 0):e.endsWith("/")&&(e=e.slice(0,-1));let i=this.root,o="";for(const c of e.split("/")){let l=(n=i.children)==null?void 0:n.get(c);o=`${o?`${o}/`:""}${c}`,l===void 0&&(i.children===void 0&&(i.children=new Map),l=new jd(o,c),i.children.set(c,l)),i=l}i.data=r}}a(op,"Trie");class qd{constructor(e,r,n,i,o){if(this.rootUri=e,this.sha=r,this.timestamp=n,this.provider=i,this.trie=new op,this._hasEntireTree=!1,this._isContentCached=!1,i===void 0)return;const c=[i];i.onDidTriggerContentCaching!==void 0&&i.tryCachingContent!==void 0&&c.push(i.onDidTriggerContentCaching(l=>{(!l||te(l.rootUri)===te(this.rootUri)&&l.sha===this.sha)&&!this.loading&&this.hasEntireTree&&!this.isContentCached&&i.tryCachingContent(this.trie.get.bind(this.trie)).then(d=>this._isContentCached=d,()=>this._isContentCached=!0)})),this._loading=this.load(o==null?void 0:o.path,o==null?void 0:o.recursive).then(l=>(this._hasEntireTree=(l==null?void 0:l.success)?l.recursive:!1,this._hasEntireTree&&setTimeout(()=>{var d;return void((d=i.tryCachingContent)==null?void 0:d.call(i,this.trie.get.bind(this.trie)).then(p=>this._isContentCached=p,()=>this._isContentCached=!0))},0),pn("_codespaces.webeditor.connectWorkspace",{result:(l==null?void 0:l.success)?"Success":"Failure",errorMessage:this._hasEntireTree?"":"Unable to load entire tree",errorDetail:(l==null?void 0:l.success)===!1?l.error:void 0}),this._loading=void 0,this.preloading=void 0,this.treeSha=(l==null?void 0:l.success)?l.sha:void 0,this.treeSha)),(o==null?void 0:o.preload)&&(this.preloading=new Map([["",this.load("")],[".vscode",this.load(".vscode")]])),this.disposable=m.Disposable.from(...c)}get hasEntireTree(){return this._hasEntireTree}get isContentCached(){return this._isContentCached}get loading(){return this._loading!==void 0}get permissions(){var e;return(e=this.provider)==null?void 0:e.permissions}dispose(){var e;(e=this.disposable)==null||e.dispose()}async get(e){var r;if(e==="")return{mode:"040000",sha:this.treeSha,stat:{type:m.FileType.Directory,size:0,ctime:0,mtime:(r=this.timestamp)!=null?r:Date.now(),permissions:await this.permissions},getContent:void 0};let n=this.trie.get(e);return n!==void 0||(await this.ensureLoaded(e),n=this.trie.get(e)),n}async getChildren(e,r){await this.ensureLoaded(e,!0);const n=(r==null?void 0:r.recursive)?this.trie.getDescendants(e):this.trie.getChildren(e);return(r==null?void 0:r.filter)===void 0?n:n.filter(([,i])=>i.stat.type===r.filter)}async getTreeSha(){return await this.waitUntilLoaded(),this.treeSha}async waitUntilLoaded(){this._loading!==void 0&&await this._loading}async ensureLoaded(e,r=!1){if(this._loading!==void 0){let i;if(this.preloading!==void 0)if(r)i=this.preloading.get(e);else{const o=za(this.preloading,([c])=>e.startsWith(c)&&e.lastIndexOf("/")===(c?c.length:-1));i=o==null?void 0:o[1]}await(i!=null?i:this._loading)}if(this.hasEntireTree||e==="")return;let n=this.trie.get(e);if(n)return r&&(n==null?void 0:n.loadChildren)?n.loadChildren():void 0;if(await this.ensureLoaded(e.substr(0,e.lastIndexOf("/")),!0),n=this.trie.get(e),r&&(n==null?void 0:n.loadChildren))return n.loadChildren()}async load(e,r=!1){var n;if(((n=this.provider)==null?void 0:n.getTree)===void 0)return;const i=new lt(`FileTree.load(${this.sha}:${e})`);let o;try{i.logStep("Tree query");const c=await this.provider.getTree(e,r);if(c.truncated){L.warn(`Loading file tree for path=${e} was truncated`),i.logStep("Fixing directories",{message:`: Tree=${c.sha};`,suffix:" \u2022 Fixing directories..."});for(const[d,p]of this.trie.getDescendants(""))p.stat.type===m.FileType.Directory&&(p.loadChildren=Ud(()=>this.load(d).then(()=>p.loadChildren=void 0)));return o=` \u2022 Tree=${c.sha} \u2022 Truncated`,{sha:c.sha,recursive:!1,success:!0}}let l;this.permissions!==void 0&&(i.logStep("Permissions query",{message:`: Tree=${c.sha};`,suffix:" \u2022 Waiting for permissions..."}),l=await this.permissions),i.logStep("Filling trie",{suffix:" \u2022 Filling trie..."});for(let{path:d,item:p}of c.tree)if(d!==void 0){switch(d=e?`${e}/${d}`:d,p.stat.permissions=l,p.stat.type){case m.FileType.File:p.getContent=Ud(()=>this.provider.getContent(p));break;case m.FileType.Directory:r||(p.loadChildren=Ud(()=>this.load(d).then(()=>p.loadChildren=void 0)));break}this.trie.set(d,p)}return o=` \u2022 Tree=${c.sha}`,{sha:c.sha,recursive:r,success:!0}}catch(c){return o=`\u2022 Loading for path=${e} failed; ${String(c)}`,{error:c,success:!1}}finally{i.stop(o?{suffix:o}:void 0)}}}a(qd,"FileTree");var U0=__webpack_require__(7769);const j0="github-pr-owner-number";function q0(t){return`branch.${t}.${j0}`}a(q0,"getMetadataKeyForBranch");const z0=(0,B.loadMessageBundle)(),ap=new TextDecoder;class sp{constructor(e,r,n,i,o,c){this.providerService=e,this.rootUri=r,this.sourceControl=n,this.metadata=i,this.changeStore=o,this.github=c,this._onDidChangeSelection=new m.EventEmitter,this._onDidChangeState=new m.EventEmitter,this._objects=new Map,this.disposable=m.Disposable.from(this.sourceControl.onDidChangeSelection(()=>this._onDidChangeSelection.fire()),this.providerService.onDidRefresh(p=>{const S=te(this.rootUri);!p.some(P=>te(P)===S)||this.updateState(this.metadata)}),this.providerService.onDidChangeRepository(async({repository:p})=>{te(this.rootUri)===te(p.uri)&&this.updateState(await p.getMetadata())}),this.changeStore.onDidChange(()=>this.updateState(this.metadata)),this._onDidChangeSelection,this._onDidChangeState),this._inputBox={get value(){return n.inputBox.value},set value(p){n.inputBox.value=p}},this._ui={get selected(){return n.selected},onDidChange:this._onDidChangeSelection.event};const{repo:{owner:l,name:d}}=i;this.remote={name:"origin",fetchUrl:`https://github.com/${l}/${d}.git`,isReadOnly:i.accessLevel<Ne.Write},this.remotes=[this.remote],this._state={HEAD:this.getHEADFromMetadata(i),mergeChanges:[],indexChanges:[],workingTreeChanges:[],onDidChange:this._onDidChangeState.event,rebaseCommit:void 0,refs:[],remotes:this.remotes,submodules:[]},this.updateState(i)}dispose(){this.disposable.dispose()}get inputBox(){return this._inputBox}get state(){return this._state}get ui(){return this._ui}getHEADFromMetadata(e){switch(e.HEAD.type){case De.Branch:return{type:Sn.Head,commit:e.HEAD.sha,name:e.HEAD.branch.name,upstream:{name:e.HEAD.branch.name,remote:this.remote.name}};case De.RemoteBranch:{const r=e.HEAD.branch.remote.repo.owner,n=e.HEAD.branch.remote.accessLevel<Ne.Write,i=this.remotes.findIndex(o=>o.name===r);return this.remotes.splice(i===-1?this.remotes.length:i,i===-1?0:1,{name:r,fetchUrl:`https://github.com/${e.HEAD.branch.remote.repo.owner}/${e.HEAD.branch.remote.repo.name}.git`,pushUrl:n?void 0:`https://github.com/${e.HEAD.branch.remote.repo.owner}/${e.HEAD.branch.remote.repo.name}.git`,isReadOnly:n}),{type:Sn.RemoteHead,commit:e.HEAD.sha,name:e.HEAD.branch.name,upstream:{name:e.HEAD.branch.name,remote:e.HEAD.branch.remote.repo.owner}}}case De.Tag:return{type:Sn.Tag,name:e.HEAD.detached.name,commit:e.HEAD.sha};case De.Commit:return{type:Sn.Head,commit:e.HEAD.sha}}}async updateState(e){this.metadata=e;const r=await this.changeStore.getGroupedChanges(this.rootUri,{predicate:l=>l.fileType===m.FileType.File}),n=r.conflicts.map(l=>({uri:l.uri,status:zd(l.type),originalUri:l.uri,renameUri:l.uri})),i=r.staged.map(l=>({uri:l.uri,status:zd(l.type),originalUri:l.uri,renameUri:l.uri})),o=r.working.map(l=>({uri:l.uri,status:zd(l.type),originalUri:l.uri,renameUri:l.uri})),c=Y.get("staging.enabled");this._state={...this._state,HEAD:this.getHEADFromMetadata(e),mergeChanges:n,indexChanges:c?i:[],workingTreeChanges:c?o:[...i,...o]},this._onDidChangeState.fire()}getConfigs(){return Promise.resolve([])}getConfig(e){return this.metadata.HEAD.branch&&this.metadata.pullRequest&&e===q0(this.metadata.HEAD.branch.name)?Promise.resolve(`${this.metadata.repo.owner}#${this.metadata.repo.name}#${this.metadata.pullRequest.id}`):Promise.resolve("")}setConfig(e,r){return Promise.resolve("")}getGlobalConfig(e){throw new Error("Method not implemented.")}async getObjectDetails(e,r){const n=new lt(`IGit.getObjectDetails(${e}, ${r})`);try{return await this.github.getObjectDetails(this.rootUri,e,this.pathToRelativePath(r))}finally{n.stop()}}async detectObjectType(e){var r;const n=new lt(`IGit.detectObjectType(${e})`);try{const i=await this.github.getBlobContent(this.metadata.repo,e);if(!H0(i))return{mimetype:"text/plain"};const c=await(0,U0.fromBuffer)(i);return{mimetype:(r=c==null?void 0:c.mime)!=null?r:"application/octet-stream"}}finally{n.stop()}}async buffer(e,r){const n=new lt(`IGit.buffer(${e}, ${r})`);try{return await this.github.getFileContent(this.rootUri,e,this.pathToRelativePath(r))}finally{n.stop()}}async show(e,r){const n=new lt(`IGit.show(${e}, ${r})`);try{const i=await this.github.getFileContent(this.rootUri,e,this.pathToRelativePath(r));return ap.decode(i)}finally{n.stop()}}async getCommit(e){const r=new lt(`IGit.getCommit(${e})`);try{const n=await this.github.getCommit(this.rootUri,e);if(n===void 0)throw new Error(`Unable to find commit for ref "${e}"`);return n}finally{r.stop()}}clean(e){return this._objects.clear(),Promise.resolve()}async apply(e,r){const n=new lt(`IGit.apply(reverse=${r})`);try{return await this.changeStore.applyPatch(this.rootUri,e,r?{reverse:!0}:void 0)}finally{n.stop()}}async diff(e){const r=new lt(`IGit.diff(${e})`);try{return await this.changeStore.createPatch(this.rootUri,void 0,e?{staged:!0}:void 0)}finally{r.stop()}}diffWithHEAD(e){return e?this.diffBetween("","HEAD",e):this.diffBetween("","HEAD")}diffWith(e,r){return r?this.diffBetween("",e,r):this.diffBetween("",e)}diffIndexWithHEAD(e){return e?this.diffBetween("~","HEAD",e):this.diffBetween("~","HEAD")}diffIndexWith(e,r){return r?this.diffBetween("~",e,r):this.diffBetween("~",e)}async diffBetween(e,r,n){if(!n)throw new Error("Method not implemented.");const i=new lt(`IGit.diffBetween(${e}, ${r}, ${n})`);try{const[o,c]=await Promise.all([this.getContent(e,n),this.getContent(r,n)]);return Co(n,o,c)}finally{i.stop()}}async diffBlobs(e,r){const n=new lt(`IGit.diffBlobs(${e}, ${r})`);try{const i=await this.getBlobContent(e),o=await this.getBlobContent(r),c=Co("untitled",i,o);return Promise.resolve(c)}finally{n.stop()}}async getBlobContent(e){const r=new lt(`IGit.getBlobContent(${e})`);try{const n=this._objects.get(e);if(n)return this._objects.delete(e),n;const{repo:i}=this.providerService.getVirtualUriMetadata(this.rootUri),o=await this.github.getBlobContent(i,e);return ap.decode(o)}finally{r.stop()}}async getContent(e,r){const n=new lt(`IGit.getContent(${e}, ${r})`);try{const i=this.pathToRelativeUri(r);if(e===""||e==="~"){const o=await this.changeStore.getChange(i);if(o!==void 0&&(e===""||o.staged))return this.changeStore.getContent(i);e="HEAD"}return await this.show(e==="HEAD"?this.metadata.HEAD.sha:e,r)}finally{n.stop()}}async hashObject(e){const r=new lt("IGit.hashObject");try{const n=no(await ri(e));return this._objects.set(n,e),n}finally{r.stop()}}async createBranch(e,r,n){const i=new lt(`IGit.createBranch(${e}, ${r}, ${n})`);try{n||(n=this.metadata.HEAD.sha);const o=await this.github.createBranch(this.rootUri,e,n);r&&await this.checkout(o)}finally{i.stop()}}deleteBranch(e,r){throw new Error("Method not implemented.")}async getBranch(e){const r=new lt(`IGit.getBranch(${e})`);try{const{branches:n}=await this.github.getBranches(this.rootUri,{query:e,limit:1}),[i]=n;if(i===void 0)throw new Error(`Unable to find branch named "${e}"`);return{type:i.type,name:i.name,commit:i.commit,remote:this.remote.name,upstream:{name:i.name,remote:i.commitUrl}}}finally{r.stop()}}async getBranches(e){var r,n;const i=(n=(r=e.contains)!=null?r:e.pattern)!=null?n:"",o=new lt(`IGit.getBranches(${i})`);try{const{branches:c}=await this.github.getBranches(this.rootUri,{query:i,limit:e.count});if(c.length===0)throw new Error(`Unable to find branches for "${i}"`);return c.map(l=>({type:l.type,name:l.name,commit:l.commit}))}finally{o.stop()}}setBranchUpstream(e,r){throw new Error("Method not implemented.")}getMergeBase(e,r){throw new Error("Method not implemented.")}async status(){}async checkout(e){const r=new lt(`IGit.checkout(${e})`);try{if(await this.github.repositoryObjectExists(this.rootUri,e)){const i=await this.github.switchTo(this.rootUri,e,{openInNewWindow:!1});throw i!==void 0&&await bn(i),new Error("User aborted")}const n=/pr\/(?<remote>.+)\/(?<num>\d+)/.exec(e);if(n==null?void 0:n.groups){const{num:i}=n.groups,{provider:o,repo:c}=this.providerService.getVirtualUriMetadata(this.rootUri),l=this.providerService.getRemoteUri(o.id,{repo:c,pullRequest:{id:i}});if(l!==void 0){const d=await this.providerService.createWorkspaceForRemoteUrl(l.toString());d!==void 0&&await bn(d)}}throw new Error("User aborted")}finally{r.stop()}}addRemote(e,r){var n;let i;const o=this.remotes.findIndex(c=>c.name===e);return o!==-1&&([i]=this.remotes.splice(o,1)),this.remotes.push({name:e,fetchUrl:r,isReadOnly:(n=i==null?void 0:i.isReadOnly)!=null?n:!1}),Promise.resolve()}removeRemote(e){const r=this.remotes.findIndex(n=>n.name===e);return r!==-1&&this.remotes.splice(r,1),Promise.resolve()}renameRemote(e,r){const n=this.remotes.findIndex(o=>o.name===e);if(n===-1)return Promise.resolve();const[i]=this.remotes.splice(n,1);return this.remotes.push({...i,name:r}),Promise.resolve()}async fetch(e,r,n){const i=new lt("IGit.fetch");try{return this.github.fetch(this.rootUri)}finally{i.stop()}}async pull(e){const r=new lt("IGit.pull");try{return this.github.sync(this.rootUri,this.changeStore,{conflictResolution:an.Merge})}finally{r.stop()}}push(e,r,n){return Promise.resolve()}blame(e){throw new Error("Method not implemented.")}async log(e){if((e==null?void 0:e.maxEntries)!==1||(e==null?void 0:e.path)!==void 0)throw new Error("The specified log options are not yet supported.");return[await this.getCommit(this.metadata.HEAD.sha)]}async commit(e,r){const n=new lt("IGit.commit");try{if((r==null?void 0:r.amend)!==void 0||(r==null?void 0:r.empty)!==void 0||(r==null?void 0:r.signCommit)!==void 0||(r==null?void 0:r.signoff)!==void 0)throw new Error("The specified commit options are not yet supported.");const i=(await this.providerService.getCommitOperations(this.rootUri,this.changeStore,{staged:(r==null?void 0:r.all)===!1})).filter(o=>o.fileType===m.FileType.File);if(!i.length){m.window.showInformationMessage(z0("no changes to commit","There are no changes to commit."));return}if(Y.getUseNewCommitApi())await this.github.createAndPushCommit(this.rootUri,e,i,void 0);else{const o=await this.github.createCommit(this.rootUri,e,i);await this.github.pushCommit(this.rootUri,o)}}finally{n.stop()}}pathToRelativePath(e){return this.providerService.getRelativeFilePath(this.rootUri,this.pathToRelativeUri(e))}pathToRelativeUri(e){return We(this.rootUri,V0(e))}}a(sp,"GitHubRepository");const W0=/^\/?([a-zA-Z])(?::\/)(.*)$/,G0=/\\/g;function V0(t){t=m.Uri.file(t).fsPath.replace(G0,"/");const e=W0.exec(t);return e!==null&&([,,t]=e),t.startsWith("/")?t:`/${t}`}a(V0,"normalizePath");function zd(t){switch(t){case Dt.Changed:return Bi.MODIFIED;case Dt.Created:return Bi.INTENT_TO_ADD;case Dt.Deleted:return Bi.DELETED}}a(zd,"opTypeToStatus");var K0=Object.defineProperty,X0=Object.getOwnPropertyDescriptor,cp=a((t,e,r,n)=>{for(var i=n>1?void 0:n?X0(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&K0(e,r,i),i},"github_provider_decorateClass");const Ws=(0,B.loadMessageBundle)(),lp=/^(?:https?:\/\/)?github\.(?:com|dev)\/(?<owner>[^/]+)\/(?<repo>[^/?#]+)(?:|\.git|\/tree\/(?<tree>[^?#]+)|\/blob\/(?<blob>[^?#]+)|\/commit\/(?<commit>[0-9a-f]{40})|\/pull\/(?<pull>[0-9]+))?(?<extra>[^?#]*)(?:\?(?<query>[^#]*))?(?:#(?<fragment>.*))?$/i,up=/(?<remoteOwner>[^/:]+)\/?(?<remoteRepo>[^/:]+)?:(?<remoteRef>.*)/,uu=["repo","workflow"],du=1,dp=Object.freeze({id:"github",name:"GitHub"});function Gs(t){const{scheme:e,metadata:r}=Xt.decodeAuthority(t,c=>{if(c.v!==void 0)return c;if(typeof c.pr=="string")return{v:du,ref:{type:et.PullRequest,id:c.pr},idx:c.idx};if(typeof c.ref=="string")return{v:du,ref:{type:et.Tree,id:c.ref},idx:c.idx}}),[,n,i,...o]=t.path.split("/");return{scheme:e,provider:dp,name:`${n}/${i}`,repo:{owner:n,name:i},path:o.join("/")||"",ref:r==null?void 0:r.ref,idx:r==null?void 0:r.idx}}a(Gs,"getGitHubMetadata");function Q0(t,e){const{repo:r}=e!=null?e:Gs(t);return t.with({path:`/${r.owner}/${r.name}`,query:"",fragment:""})}a(Q0,"getGitHubRootUri");function Wd(t,e,r){const{repo:{owner:n,name:i}}=t instanceof m.Uri?Gs(t):t;return m.Uri.parse(`github://${Xt.encodeAuthority("github",{v:du,ref:{type:et.Commit,id:e}})}/${n}/${i}/${r}`)}a(Wd,"getGitHubRevisionUri");class hu{constructor(e,r){this.providerService=e,this.tarPit=r,this.fileTreeCache=new Map,this.disposable=m.Disposable.from(e.onDidChangeRepository(n=>{n.reason==="HEAD"&&this.onRefreshOrRepositoryChanged([n.repository.uri])}),e.onDidRefresh(n=>this.onRefreshOrRepositoryChanged(n))),this.tarballProxyEndpoint=m.commands.executeCommand("_workbench.getTarballProxyEndpoints").then(n=>n==null?void 0:n["github.com"])}get isReadonly(){return!1}get scheme(){return"github"}dispose(){this.disposable.dispose()}onRefreshOrRepositoryChanged(e){e=e.filter(r=>Xt.getProviderId(r)===this.scheme),e.length!==0&&(this.fileTreeCache.forEach(r=>r.dispose()),this.fileTreeCache.clear())}async ensureAuthenticated(e=!1){const r=new lt("GitHub.ensureAuthenticated");try{if(this._session===void 0){async function n(){try{return e?await m.authentication.getSession("github",uu,{forceNewSession:e}):await m.authentication.getSession("github",uu,{createIfNone:!0})}catch(o){L.error(o);try{const c=await m.authentication.getSession("github",uu,{createIfNone:!1});if(c!==void 0)return c}catch{}return new Promise(c=>{async function l(){const p=await m.authentication.getSession("github",uu,{createIfNone:!0});p!==void 0&&c(p)}a(l,"getSession");const d=m.authentication.onDidChangeSessions(async p=>{p.provider.id==="github"&&(d.dispose(),await l())})})}}a(n,"waitUntilAuthenticated"),this._session=await n();const i=m.authentication.onDidChangeSessions(o=>{if(this._session===void 0){i.dispose();return}o.provider.id==="github"&&(this.clearAuthenticationSession(),i.dispose())})}return this._session}finally{r.stop()}}async getAuthentication(e){const r=await this.ensureAuthenticated();return{provider:dp,session:r,getRichNavigationHeaders:()=>({"X-Git-GitHub":`Bearer ${r.accessToken}`})}}clearAuthenticationSession(){this._session=void 0,this._octokit=void 0,this._octokitDefaults=void 0}async reauthenticate(){this.clearAuthenticationSession(),await this.ensureAuthenticated(!0)}async octokit(e){if(this._octokitDefaults===void 0){const n=await this.ensureAuthenticated();if(qn){async function i(o,c){if(c.headers!==void 0){const{"user-agent":l,...d}=c.headers;l&&(c.headers=d)}return Mt(o,c)}a(i,"fetchCore"),this._octokitDefaults=ol.defaults({auth:`token ${n.accessToken}`,request:{fetch:i}})}else this._octokitDefaults=ol.defaults({auth:`token ${n.accessToken}`})}const r=new this._octokitDefaults(e);return(L.logLevel===qe.Debug||L.isDebugging)&&r.hook.wrap("request",async(n,i)=>{var o;const c=new lt(`[GITHUB] ${i.method} ${i.url}`,{log:!1});try{return await n(i)}finally{let l;try{if(typeof i.query=="string"){const d=/(^[^({\n]+)/.exec(i.query);l=` ${(o=d==null?void 0:d[1].trim())!=null?o:i.query}`}}catch{}c.stop({message:l})}}),r}async graphql(e,r){this._octokit===void 0&&(this._octokit=await this.octokit());try{return await this._octokit.graphql(e,r)}catch(n){throw this.handleRequestErrors(n),n}}async request(e,r){this._octokit===void 0&&(this._octokit=await this.octokit());try{return await this._octokit.request(e,r)}catch(n){throw this.handleRequestErrors(n),n}}handleRequestErrors(e){var r,n;if(e instanceof jn)switch(e.status){case 500:return e.response&&Yr.showGitHubStatus500Message(),!0;case 401:return Yr.showStatus401Message(()=>void this.reauthenticate()),!0;case 403:return Yr.showStatus403Message(()=>void this.reauthenticate()),!0}else if(e instanceof zs&&((n=(r=e.errors)==null?void 0:r[0])==null?void 0:n.type)==="FORBIDDEN")return Yr.showStatus403Message(()=>void this.reauthenticate()),!0;return!1}createIGitRepository(e,r,n,i){return new sp(this.providerService,e,r,n,i,this)}async createMetadata(e,r){var n,i,o,c,l,d;const p=new lt(`GitHub.createMetadata(${e.toString()}, ${r})`);let S;try{let{provider:P,name:I,repo:{owner:O,name:F},ref:N}=Gs(e);(!N||N.type===et.Commit&&/HEAD/i.test(N.id))&&(N={type:et.Commit,id:"HEAD"});const U=this.providerService.isInWorkspace(e);let W,V;Y.get("experimental.prefetch")&&U&&(r?W=r:(N.type===et.Commit||N.type===et.Tree)&&(W=N.id),W&&(p.log({suffix:` \u2022 Prefetching tree for ${W}...`}),this.getFileTree(e,void 0,{cache:!0,recursive:!0,prefetched:{metadata:new Promise(Re=>V=Re),repo:{owner:O,name:F},HEAD:{sha:W},timestamp:Date.now()}})));const ie=await this.getRepositoryInfo(O,F,U,N.type===et.PullRequest?{pr:Number(N.id)}:{ref:N.id});if(ie===void 0)throw S=" \u2022 Aborted; Unable to get repository info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository info`);let oe;if(r)oe=r;else if(N.type===et.Commit||N.type===et.Tree&&ie.ref===void 0)oe=N.id;else if(oe=(i=(n=ie.ref)==null?void 0:n.sha)!=null?i:ie.defaultBranch.sha,oe===void 0)throw S=" \u2022 Aborted; Unable to get repository revision",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get repository revision`);let ge;if(((o=ie.ref)==null?void 0:o.prefix)==="refs/heads/")ge={type:De.Branch,name:ie.ref.name,sha:oe,branch:{name:ie.ref.name,sha:ie.ref.sha}};else if(((c=ie.ref)==null?void 0:c.prefix)==="refs/remotes/"){if(!ie.ref.remote)throw S=" \u2022 Aborted; Unable to get remote info",new Error(`Cannot get metadata for Uri(${e.toString()}); Unable to get remote info`);ge={type:De.RemoteBranch,name:`${ie.ref.remote.repo.owner}${ie.ref.remote.repo.name!==F?`/${ie.ref.remote.repo.name}`:""}:${ie.ref.name}`,sha:oe,branch:{name:ie.ref.name,sha:ie.ref.sha,remote:ie.ref.remote}}}else((l=ie.ref)==null?void 0:l.prefix)==="refs/tags/"?ge={type:De.Tag,name:ie.ref.name,sha:oe,detached:{type:De.Tag,name:ie.ref.name}}:ge={type:De.Commit,name:yt(oe),sha:oe,detached:{type:De.Commit,name:yt(oe)}};if(W!==void 0&&W!==ge.sha){const Re=this.asFileTreeKey(e,W),Ie=this.fileTreeCache.get(Re);Ie&&!Ur(W)&&ge.sha===((d=ge.branch)==null?void 0:d.sha)?(p.log({suffix:` \u2022 Updating prefetched tree for ${W}, since HEAD was resolved; HEAD=${ge.sha}`}),this.fileTreeCache.set(this.asFileTreeKey(e,ge.sha),Ie),this.fileTreeCache.delete(Re)):(p.log({suffix:` \u2022 Removing prefetched tree for ${W}, since the HEAD changed; HEAD=${ge.sha}`}),this.fileTreeCache.delete(Re),Ie==null||Ie.dispose())}const ke={version:Ke.schemaVersion,timestamp:Date.now(),provider:P,name:I,repo:ie.repo,user:ie.user,accessLevel:ie.accessLevel,HEAD:ge,defaultBranch:ie.defaultBranch,pullRequest:ie.pullRequest};return S=` \u2022 HEAD=${ge.sha}`,V==null||V(ke),ke}finally{p.stop(S?{suffix:S}:void 0)}}getMetadata(e){return this.providerService.getMetadata(e)}getRemoteWorkspaceSourceProviders(){return[{name:"GitHub",icon:"$(github)",label:Ws("open repo from","Open Repository from {0}","GitHub"),placeholder:Ws("pick repo","Choose a repository"),provideSources:async(e,r,n,i)=>{n=n!=null?n:"";let o;const c=n==null?void 0:n.indexOf("/");return c!==-1&&(o=n.substring(0,c),n=n.substr(c+1)),(await this.searchRepositoriesQuery(n,{...i,user:o})).map(d=>({providerId:"github",name:d.repoWithOwner,icon:"$(repo)",description:`${d.fork?`$(repo-forked) ${d.fork}`:""}${d.stars>0?`${d.fork?" \u2022 ":""}$(star-full) ${d.stars}`:""}`,detail:d.description,url:d.url}))}},{name:"GitHub",icon:"$(github)",label:Ws("open pr from","Open Pull Request from {0}","GitHub"),placeholder:Ws("pick pr","Choose a pull request"),provideSources:async(e,r,n,i)=>{n=n!=null?n:"";let o;const c=n==null?void 0:n.indexOf("/");return c!==-1&&(o=n.substring(0,c),n=n.substr(c+1)),(await this.searchPullRequestsQuery(n,{user:o})).map(d=>({providerId:"azurerepos",name:d.title,icon:"$(git-pull-request)",description:d.reasons.length!==0?d.reasons.sort().join(", "):void 0,detail:`${d.repoWithOwner} #${d.number}`,url:d.url}))}}]}canOpenRemoteUrl(e){const r=lp.exec(e);if((r==null?void 0:r.groups)===void 0)return;const{blob:n,commit:i,pull:o,tree:c}=r.groups;return o?st.PullRequest:i?st.Commit:c?st.Branch:n?st.File:st.Repository}async createWorkspaceForRemoteUrl(e,r=tr.CurrentWindow){const n=lp.exec(e);if((n==null?void 0:n.groups)===void 0)return;let{owner:i,repo:o,blob:c,commit:l,pull:d,tree:p,fragment:S}=n.groups;const P=await this.validateOwnerAndRepoAndSplitRefFromPath(i,o,p!=null?p:c);if(P===void 0)return;let I,O;if({owner:i,repo:o,ref:O,path:I}=P,p||c){if(I&&S&&c){const U=/L(?<start>\d+)(?:-L(?<end>\d+))?/.exec(S);if(U==null?void 0:U.groups){const{start:W,end:V}=U.groups;I+=`:${W}${V!==void 0?`-${V}`:""}`}}}else l?O={type:et.Commit,id:l}:d&&(O={type:et.PullRequest,id:d});const F=this.providerService.createVirtualUri("github",{repo:{owner:i,name:o},ref:O});return{name:(await this.getMetadata(F)).name,uri:F,location:r,filesToOpen:I?[I]:void 0}}createVirtualUri(e,{repo:r,ref:n,idx:i},o){const c=n!==void 0||i!==void 0?{v:du}:void 0;return c&&(n&&(c.ref={...n,type:n.type===et.Branch||n.type===et.Tag?et.Tree:n.type}),i&&(c.idx=i)),e.with({authority:Xt.encodeAuthority("github",c),path:`/${r.owner}/${r.name}${(o==null?void 0:o.startsWith("/"))?o:o?`/${o}`:""}`})}getRemoteUri(e){const r=`https://github.com/${e.repo.owner}/${e.repo.name}`;return e.pullRequest?m.Uri.parse(`${r}/pull/${e.pullRequest.id}`):e.sha?m.Uri.parse(`${r}/commit/${e.sha}`):e.branch?m.Uri.parse(`${r}/tree/${e.branch}`):e.tag?m.Uri.parse(`${r}/tree/${e.tag}`):e.clone?m.Uri.parse(`${r}.git`):m.Uri.parse(r)}getProviderRootUri(e){return Q0(e)}getRelativeFilePath(e,r){const{path:n}=Gs(e),{path:i}=Gs(We(e,r));return n.length!==0&&i!==n&&i.startsWith(n)?i.slice(n.length+1):i}getVirtualUriMetadata(e){const{provider:r,name:n,repo:i,ref:o}=Gs(e);return{provider:r,name:n,repo:i,ref:o}}async getModeRefType(e,r){const{HEAD:n,pullRequest:i}=await(r!=null?r:this.getMetadata(e));switch(n.type){case De.Branch:return i!==void 0?ne.PullRequestBranch:ne.Branch;case De.RemoteBranch:return i!==void 0?ne.PullRequestRemoteBranch:ne.RemoteBranch;case De.Tag:return ne.Tag;case De.Commit:return ne.Commit}}async createBranch(e,r,n,i){try{const{repo:{owner:o,name:c}}=i!=null?i:await this.getMetadata(e);return r.startsWith("refs/heads/")||(r=`refs/heads/${r}`),(await this.request("POST /repos/{owner}/{repo}/git/refs",{owner:o,repo:c,ref:r,sha:n})).data.ref.substr(11)}catch(o){throw o instanceof jn&&o.status===422?o.message==="Reference already exists"?new Be(o,!0):new Be(o,!1):(L.error(o),o)}}async createAndPushCommit(e,r,n,i,o){var c;const l=new lt(`GitHub.createAndPushCommit(${e.toString()}${o?`, fork=${o.repo.owner}/${o.repo.name}`:""})`);if(n=n.filter(p=>p.fileType===m.FileType.File),n.length===0)throw l.stop({message:"Aborted; No changes to commit"}),new vt("No changes to commit");let d;try{const p=await this.getMetadata(e);let S;if(i!==void 0)S=i;else{if(p.HEAD.detached&&!p.HEAD.branch)throw new It("Unable to commit; no current branch");S=p.HEAD.branch.name}let P;if(o)P=`${o.repo.owner}/${o.repo.name}`;else if(p.HEAD.type===De.RemoteBranch&&p.HEAD.branch.remote.accessLevel>=Ne.Write){const{owner:W,name:V}=p.HEAD.branch.remote.repo;P=`${W}/${V}`}else P=`${p.repo.owner}/${p.repo.name}`;const I=[],O=[];for(const W of n)switch(W.type){case Dt.Created:case Dt.Changed:I.push({path:W.path,contents:xi(await W.content)});break;case Dt.Deleted:O.push({path:W.path});break}const F={branch:{branchName:S,repositoryNameWithOwner:P},message:{headline:r},fileChanges:{additions:I,deletions:O},expectedHeadOid:p.HEAD.sha},N=`mutation($commitInput: CreateCommitOnBranchInput!) {
	createCommitOnBranch(input: $commitInput) {
		commit {
			oid
		}
		ref {
			name
		}
	}
}`,U=await this.graphql(N,{commitInput:F});if(d=U==null?void 0:U.createCommitOnBranch.commit.oid,!d)throw new wr;return i===void 0&&!p.HEAD.detached&&d!==void 0&&await this.fastForwardTo(e,d,p),d}catch(p){if(p instanceof zs){const S=(c=p.errors)==null?void 0:c[0];if((S==null?void 0:S.type)==="STALE_DATA"&&S.message.includes("Pull and try again"))throw new Me(p)}throw L.error(p),p}finally{l.stop(d?{message:`: Created and pushed commit ${d}`}:void 0)}}async createCommit(e,r,n,i){const o=new lt(`GitHub.createCommit(${e.toString()}${i?`, fork=${i.repo.owner}/${i.repo.name}`:""})`);if(n=n.filter(l=>l.fileType===m.FileType.File),n.length===0)throw o.stop({message:"Aborted; No changes to commit"}),new vt("No changes to commit");let c;try{const l=await this.getMetadata(e);let d,p,S;i?({repo:{owner:d,name:p}}=i,S=await this.getFileTree(this.createVirtualUri(e,i),l.HEAD.sha)):l.HEAD.type===De.RemoteBranch&&l.HEAD.branch.remote.accessLevel>=Ne.Write?({owner:d,name:p}=l.HEAD.branch.remote.accessLevel===Ne.WriteToPullRequest?l.repo:l.HEAD.branch.remote.repo,S=await this.getFileTree(this.createVirtualUri(e,{repo:l.HEAD.branch.remote.repo}),l.HEAD.sha)):({repo:{owner:d,name:p}}=l,S=await this.getFileTree(e,l.HEAD.sha));const P=await S.getTreeSha();if(!Ur(P))throw new Error(`Unable to create commit based on tree sha ${P}`);o.logStep("Creating Blobs",{message:`: Committing ${n.length} changes onto commit ${l.HEAD.sha} based on tree ${P}`,suffix:" \u2022 Creating blobs..."});const I=[];async function O(W){var V;try{const ie=await this.request("POST /repos/{owner}/{repo}/git/blobs",{owner:d,repo:p,encoding:"base64",content:xi(await W.content),mediaType:{format:"raw"}});let oe;if(W.type===Dt.Changed){const ge=await S.get(W.path);oe=(V=ge==null?void 0:ge.mode)!=null?V:"100644"}else oe="100644";I.push({path:W.path,mode:oe,type:"blob",sha:ie.data.sha})}catch(ie){throw L.error(ie,`Failed to create blob for ${W.path}`),ie}}a(O,"createOrUpdateBlob");const F=[];for(const W of n)switch(W.type){case Dt.Created:case Dt.Changed:{F.push(O.call(this,W));break}case Dt.Deleted:{I.push({path:W.path,mode:"100644",type:"blob",sha:null});break}}await Promise.all(F),o.logStep("Creating tree",{message:`: Created ${F.length} blobs;`,suffix:` \u2022 Creating tree based on ${P}...`});const N=await this.request("POST /repos/{owner}/{repo}/git/trees",{owner:d,repo:p,base_tree:P,tree:I});return o.logStep("Creating commit",{message:`: Created tree ${N.data.sha};`,suffix:" \u2022 Creating commit..."}),c=(await this.request("POST /repos/{owner}/{repo}/git/commits",{owner:d,repo:p,message:r,tree:N.data.sha,parents:[l.HEAD.sha]})).data.sha,c}catch(l){throw L.error(l),l}finally{o.stop(c?{message:`: Created commit ${c}`}:void 0)}}async createPullRequest(e,r,n,i,o){var c,l,d;const p=new lt(`GitHub.createPullRequest(${e.toString()}, ${r}${o?`, fork=${o.repo.owner}/${o.repo.name}`:""})`);try{const{repo:{owner:S,name:P},HEAD:{branch:I},defaultBranch:O}=await this.getMetadata(e),F=await this.request("POST /repos/{owner}/{repo}/pulls",{owner:S,repo:P,base:`refs/heads/${(c=I==null?void 0:I.name)!=null?c:O.name}`,head:o?`${o.repo.owner}:${r}`:r,title:n,draft:(l=i==null?void 0:i.draft)!=null?l:!1,maintainer_can_modify:(d=i==null?void 0:i.canMaintainerModify)!=null?d:!0});return{id:F.data.number.toString(),uri:m.Uri.parse(F.data.html_url)}}catch(S){throw L.error(S),S}finally{p.stop()}}async fetch(e,r){const{fetched:n,metadata:i}=await this.fetchCore(e,!1,r);n&&await this.providerService.updateMetadata(e,i)}async fetchCore(e,r,n){var i,o,c,l,d,p,S,P,I;const{force:O,to:F}={...n,force:r||(n==null?void 0:n.force)},N=new lt(`GitHub.fetch(${e.toString()}, force=${O}, to=${F})`);let U;try{const W=await this.getMetadata(e);if(W.HEAD.detached)return U=" \u2022 Skipped; detached HEAD",{fetched:!1,metadata:W};const V=await this.getBranchTips(e);if(!V)throw U=" \u2022 Unable to fetch branch tips",new Ct(r);if(!O&&!F&&((i=V.defaultBranch)==null?void 0:i.sha)!==void 0&&V.defaultBranch.sha===W.defaultBranch.sha&&((o=V.branch)==null?void 0:o.sha)!==void 0&&V.branch.sha===W.HEAD.branch.sha&&(W.HEAD.sha===W.HEAD.branch.sha||W.state!==void 0))return U=" \u2022 No changes detected",{fetched:!1,metadata:W};let ie;if(((c=V.defaultBranch)==null?void 0:c.sha)!==void 0&&V.defaultBranch.sha!==W.defaultBranch.sha&&(ie={defaultBranch:{...W.defaultBranch,sha:V.defaultBranch.sha}}),((l=V.branch)==null?void 0:l.sha)===void 0){if(U=" \u2022 Unable to find branch tip",O)throw new Ct(r);return ie!==void 0?{fetched:!0,metadata:{...W,...ie}}:{fetched:!1,metadata:W}}if(V.branch.sha!==W.HEAD.branch.sha&&(ie={...ie,HEAD:{...W.HEAD,branch:{...W.HEAD.branch,sha:V.branch.sha},detached:void 0}}),V.branch.sha===((d=n==null?void 0:n.to)!=null?d:W.HEAD.sha))return U=" \u2022 Up to date",W.state!==void 0||ie!==void 0?{fetched:!0,metadata:{...W,...ie,state:void 0}}:{fetched:!1,metadata:W};N.logStep("Fetching upstream changes");try{const oe=await this.getAheadBehindState(e,W,{base:(p=n==null?void 0:n.to)!=null?p:W.HEAD.sha,head:(I=(P=(S=ie==null?void 0:ie.HEAD)==null?void 0:S.branch)==null?void 0:P.sha)!=null?I:W.HEAD.branch.sha});return U=` \u2022 Changes detected; ${oe==null?void 0:oe.behind} commits behind`,{fetched:!0,metadata:{...W,...ie,state:oe?{ahead:oe.ahead,behind:oe.behind,incomingChanges:oe.incomingChanges}:void 0}}}catch(oe){if(U=` \u2022 Failed fetching upstream changes; ${String(oe)}`,O)throw new Ct(r);return ie!==void 0?{fetched:!0,metadata:{...W,...ie}}:{fetched:!1,metadata:W}}}finally{N.stop(U?{suffix:U}:void 0)}}async fork(e){try{const{repo:{owner:r,name:n}}=await this.getMetadata(e),i=await this.request("POST /repos/{owner}/{repo}/forks",{owner:r,repo:n});let o;for(;;){try{if(o=await this.getRepositoryInfo(i.data.owner.login,i.data.name,!1),o!==void 0)break}catch{}await new Promise(c=>setTimeout(c,250))}return{name:`${i.data.owner.login}/${i.data.name}`,repo:{owner:i.data.owner.login,name:i.data.name},url:i.data.url}}catch(r){throw L.error(r),r}}async getBranches(e,r){var n,i,o;try{const{repo:{owner:c,name:l}}=await this.getMetadata(e),d=`query getBranches(
	$owner: String!
	$repo: String!
	$branchQuery: String!
	$cursor: String
	$limit: Int = 100
) {
	repository(owner: $owner, name: $repo) {
		refs(query: $branchQuery, refPrefix: "refs/heads/", first: $limit, after: $cursor) {
			pageInfo {
				endCursor
				hasNextPage
			}
			nodes {
				name
				target {
					oid
				}
			}
		}
	}
}`,p=await this.graphql(d,{owner:c,repo:l,branchQuery:(n=r==null?void 0:r.query)!=null?n:"",cursor:r==null?void 0:r.cursor,limit:Math.min(100,(i=r==null?void 0:r.limit)!=null?i:100)});if(p===void 0)return{branches:[]};const S=(o=p.repository)==null?void 0:o.refs;if(S===void 0)return{branches:[]};const P=S.nodes.map(I=>({type:Sn.Head,name:I.name,commit:I.target.oid,commitUrl:I.target.commitUrl}));return{paging:{cursor:S.pageInfo.endCursor,more:S.pageInfo.hasNextPage},branches:P}}catch(c){return{branches:[]}}}async getCommit(e,r){var n;try{const{HEAD:i,repo:{owner:o,name:c}}=await this.getMetadata(e),l=`query getCommit(
	$owner: String!
	$repo: String!
	$ref: GitObjectID!
) {
	repository(name: $repo owner: $owner) {
		object(oid: $ref) {
			...on Commit {
				oid
				message
				parents(first: 100) {
					nodes {
						oid
					}
				}
				author {
					date
					email
					name
				}
				committer {
					date
				}
			}
		}
	}
}`;r.toUpperCase()==="HEAD"&&(r=i.sha);const d=await this.graphql(l,{owner:o,repo:c,ref:r});if(d===void 0)return;const p=(n=d.repository)==null?void 0:n.object;return p===void 0?void 0:{hash:p.oid,message:p.message,parents:p.parents.nodes.map(S=>S.oid),authorDate:new Date(p.author.date),authorEmail:p.author.email,authorName:p.author.name,commitDate:new Date(p.committer.date)}}catch(i){return}}async getCommits(e,r){var n,i,o;try{const{HEAD:c,repo:{owner:l,name:d}}=await this.getMetadata(e),p=`query getCommits(
	$owner: String!
	$repo: String!
	$ref: GitObjectID!
	$path: String
	$cursor: String
	$limit: Int = 100
) {
	repository(name: $repo, owner: $owner) {
		object(oid: $ref) {
			... on Commit {
				history(first: $limit, path: $path, after: $cursor) {
					pageInfo {
						endCursor
						hasNextPage
					}
					nodes {
						... on Commit {
							...commit
						}
					}
				}
			}
		}
	}
}

fragment commit on Commit {
	oid
	message
	parents(first: 100) {
		nodes {
			oid
		}
	}
	author {
		date
		email
		name
	}
	committer {
		date
	}
}
`;let S=r==null?void 0:r.ref;(S==null?void 0:S.toUpperCase())==="HEAD"&&(S=c.sha);const P=await this.graphql(p,{owner:l,repo:d,ref:S,cursor:r==null?void 0:r.cursor,path:r==null?void 0:r.path,limit:Math.min(100,(n=r==null?void 0:r.limit)!=null?n:100)});if(P===void 0)return;const I=(o=(i=P.repository)==null?void 0:i.object)==null?void 0:o.history;if(I===void 0)return;const O=I.nodes.map(F=>({hash:F.oid,message:F.message,parents:F.parents.nodes.map(N=>N.oid),authorDate:new Date(F.author.date),authorEmail:F.author.email,authorName:F.author.name,commitDate:new Date(F.committer.date)}));return{paging:{cursor:I.pageInfo.endCursor,more:I.pageInfo.hasNextPage},commits:O}}catch(c){return}}async getBlobContent(e,r){try{const n=await this.request("GET /repos/{owner}/{repo}/git/blobs/{file_sha}",{owner:e.owner,repo:e.name,file_sha:r});return xc(n.data.content)}catch(n){throw L.logLevel===qe.Debug&&L.error(n),n}}async getFileContent(e,r,n){try{let i;if(r&&n&&!this.hasFileTree(e,r)){const o=this.providerService.getProviderRootUri(e);n.startsWith("/")&&(n=n.slice(1));let c=(0,Zv.dirname)(n);(c==="."||c==="/")&&(c=""),i=await(await this.getFileTree(o,r,{path:c,cache:!1,recursive:!1})).get(n)}else{const[o,{path:c}]=await Promise.all([this.getFileTree(e,r),n?{path:void 0}:this.providerService.getMetadata(e)]);i=await o.get(n!=null?n:c)}if((i==null?void 0:i.sha)===void 0)throw m.FileSystemError.FileNotFound(e);return await i.getContent()}catch(i){throw L.logLevel===qe.Debug&&L.error(i),i}}async getFileList(e,r,n){const i=new lt(`GitHub.getFileList(${e.toString()}${n?`, ${n}`:""})`);try{const{repo:{owner:o,name:c},HEAD:{sha:l}}=await this.getMetadata(e),d=await this.request("GET /repos/{owner}/{repo}/git/tree-file-list/{treeish}",{owner:o,repo:c,treeish:`${n!=null?n:l}${r?`:${r}`:""}`});return d.status!==200?[]:d.data}catch(o){return L.error(o),[]}finally{i.stop()}}hasFileTree(e,r){return r?this.fileTreeCache.has(this.asFileTreeKey(e,r)):this.getMetadata(e).then(n=>this.fileTreeCache.has(this.asFileTreeKey(e,n.HEAD.sha)))}async getFileTree(e,r,n){var i,o,c,l,d;const p=this.providerService.isInWorkspace(e);let S=(i=n==null?void 0:n.cache)!=null?i:p,P,I,O;if(S||!r){const W=(c=(o=n==null?void 0:n.prefetched)==null?void 0:o.metadata)!=null?c:this.getMetadata(e);P=p?this.getFileTreePermissions(e,W):void 0;let V;({repo:I,HEAD:{sha:V},timestamp:O}=(l=n==null?void 0:n.prefetched)!=null?l:await W),r&&V!==r?(S=!1,O=Date.now()):r=V}else({repo:I}=(d=n==null?void 0:n.prefetched)!=null?d:this.providerService.getVirtualUriMetadata(e)),O=Date.now();const F=this.asFileTreeKey(e,r),N=this.providerService.getProviderRootUri(e),U=new lt(`GitHub.getFileTree(${F}): ${e.toString()}`,{log:!1,logLevel:qe.Debug});try{let W=a(function(){var ie;const oe=new lt(`GitHub.createFileTree(${F})`);let ge,ke;S&&p&&(ge=new m.EventEmitter,ke=m.Disposable.from(this.tarPit.onDidChangeIndexingEnablement(()=>ge.fire()),this.tarPit.onDidDownloadTar(Ie=>ge.fire({rootUri:this.providerService.getProviderRootUri(Ie.rootUri),sha:Ie.sha}))));const Re={dispose:()=>ke==null?void 0:ke.dispose(),permissions:P,getContent:Ie=>this.getBlobContent(I,Ie.sha),getTree:async(Ie,Ye)=>{const $e=await this.request("GET /repos/{owner}/{repo}/git/trees/{tree_sha}",{owner:I.owner,repo:I.name,recursive:Ye?"1":void 0,tree_sha:`${r}${Ie?`:${Ie}`:""}`});return $e.data.truncated?{sha:$e.data.sha,truncated:!0}:{sha:$e.data.sha,truncated:!1,tree:ro($e.data.tree,ze=>{var at;return{path:ze.path,item:{mode:ze.mode,sha:ze.sha,stat:{type:Z0(ze.type),size:(at=ze.size)!=null?at:0,ctime:0,mtime:O,permissions:void 0}}}})}},onDidTriggerContentCaching:ge==null?void 0:ge.event,tryCachingContent:S&&p?async Ie=>{const Ye=Y.get("experimental.fs.useTars");if(Ye!=="always"&&Ye!=="ifAvailable")return!1;const $e=new lt(`FileTree.loadAllContent(${r})`);let ze;try{let at;if(Ye==="ifAvailable"){if($e.logStep("Tar cache query"),at=await this.tarPit.getCachedTar(N,r),at===void 0)return ze=" \u2022 No cached Tar",!1}else $e.logStep("Tar query"),at=await this.tarPit.getTar(N,r);$e.logStep("Updating content",{suffix:" \u2022 Updating content..."});for(const kt of at.entries){const rn=Ie(kt.header.fullFileName);if(rn===void 0)continue;const Hn=kt.dataAsBytes;rn.getContent=()=>Hn}return!0}catch(at){return ze=` \u2022 Failed ${String(at)}`,!1}finally{$e.stop(ze?{suffix:ze}:void 0)}}:void 0};try{return new qd(N,r,O,Re,{path:n==null?void 0:n.path,recursive:(ie=n==null?void 0:n.recursive)!=null?ie:S,preload:S||(n==null?void 0:n.recursive)})}catch(Ie){return L.error(Ie),new qd(N,r,O,void 0)}finally{oe.stop()}},"createFileTree"),V=this.fileTreeCache.get(F);return V!==void 0||(V=W.call(this),S&&this.fileTreeCache.set(F,V)),V}finally{U.stop()}}async getFileTreePermissions(e,r){if(this.providerService.getModeConfig(e,await this.getModeRefType(e,r)).display===j.Edit)return;const i=await this.providerService.getIndexMetadata(e);return Zt.isActive(i)?m.FilePermission.Readonly:void 0}async getFork(e){var r,n,i;try{const{repo:{owner:o,name:c}}=await this.getMetadata(e),l=`query getFork(
	$owner: String!
	$repo: String!
) {
	repository(owner: $owner, name: $repo) {
		forks(affiliations: OWNER, first: 1) {
			nodes {
				owner {
					login
				}
				name
				url
			}
		}
	}
}`,d=await this.graphql(l,{owner:o,repo:c});if(d===void 0)return;const[p]=(i=(n=(r=d.repository)==null?void 0:r.forks)==null?void 0:n.nodes)!=null?i:[];return p===void 0?void 0:{name:`${p.owner.login}/${p.name}`,repo:{owner:p.owner.login,name:p.name},url:p.url}}catch(o){return}}async getIncomingChanges(e){var r,n;return(n=(r=(await this.getMetadata(e)).state)==null?void 0:r.incomingChanges)!=null?n:[]}async compareCommits(e,r){const n=await this.getMetadata(e),i=await this.getAheadBehindState(e,n,{base:r.base,head:r.compare});return i==null?void 0:i.incomingChanges}async getAheadBehindState(e,r,n){var i,o,c,l,d;const{base:p,head:S}={base:r.HEAD.sha,head:(i=r.HEAD.branch)==null?void 0:i.sha,...n},P=new lt(`GitHub.getAheadBehindState(${e.toString()}, base=${p}, head=${S})`);let I,O;try{if(!S){I=` \u2022 Skipped; Unsupported HEAD type (${r.HEAD.type})`;return}const F=await this.request("GET /repos/{owner}/{repo}/compare/{base}...{head}",{owner:r.repo.owner,repo:r.repo.name,base:p,head:S}),N=[];for(const U of(o=F.data.files)!=null?o:[])switch(U.status){case"added":case"copied":N.push({uri:m.Uri.joinPath(e,U.filename),type:Dt.Created});break;case"removed":N.push({uri:m.Uri.joinPath(e,U.filename),type:Dt.Deleted});break;case"modified":N.push({uri:m.Uri.joinPath(e,U.filename),type:Dt.Changed});break;case"renamed":N.push({uri:m.Uri.joinPath(e,U.filename),type:Dt.Created}),N.push({uri:m.Uri.joinPath(e,U.previous_filename),type:Dt.Deleted});break;default:L.warn(`GitHub.getAheadBehindState(${e.toString()}, base=${p}, head=${S}): Unknown file status encountered '${U.status}'`);break}return O={ahead:(c=F.data.behind_by)!=null?c:0,behind:(l=F.data.ahead_by)!=null?l:0,incomingChanges:N},O}catch(F){throw I=` \u2022 Failed; ${String(F)}`,L.error(F),F}finally{P.stop({suffix:I!=null?I:` \u2022 ${(d=O==null?void 0:O.behind)!=null?d:0} commits behind`})}}async getObjectDetails(e,r,n){var i;try{const o=await this.getFileTree(e,r);n?n=this.providerService.getRelativeFilePath(e,this.providerService.createRelativeUri(e,n)):{path:n}=await this.providerService.getMetadata(e);const c=await o.get(n);if((c==null?void 0:c.mode)===void 0||(c==null?void 0:c.sha)===void 0)throw new Error(`Cannot get details of ${n} in ${r}`);return{mode:c.mode,object:c.sha,size:(i=c.stat.size)!=null?i:0}}catch(o){throw L.error(o),o}}async getPullRequest(e,r){const{repo:{owner:n,name:i}}=await this.getMetadata(e);return this.getPullRequestCore(n,i,r)}async getPullRequestCore(e,r,n){var i,o,c,l,d,p,S;try{const P=`query getPullRequest(
	$owner: String!
	$repo: String!
	$pr: Int!
) {
	repository(name: $repo, owner: $owner) {
		pullRequest(number: $pr) {
			author {
				login
				avatarUrl
				url
			}
			permalink
			number
			title
			state
			updatedAt
			closedAt
			mergedAt
			repository {
				name
				owner {
					login
				}
			}
			baseRef {
				name
			}
			baseRefName
			baseRefOid
			baseRepository {
				name
				owner {
					login
				}
			}
			headRef {
				name
			}
			headRefName
			headRefOid
			headRepository {
				name
				owner {
					login
				}
			}
			headRepositoryOwner {
				login
			}
		}
	}
}`,I=await this.graphql(P,{owner:e,repo:r,number:Number(n)}),O=(i=I==null?void 0:I.repository)==null?void 0:i.pullRequest;return O?{author:{name:O.author.login,avatarUrl:O.author.avatarUrl,url:O.author.url},closedAt:O.closedAt?new Date(O.closedAt):void 0,mergedAt:O.mergedAt?new Date(O.mergedAt):void 0,id:O.number.toString(),repo:{name:O.repository.name,owner:O.repository.owner.login},state:Gd(O.state),title:O.title,updatedAt:new Date(O.updatedAt),url:O.permalink,refs:{base:{owner:O.baseRepository.owner.login,repo:O.baseRepository.name,branch:O.baseRefName,sha:O.baseRefOid,exists:O.baseRef!=null},head:{owner:(d=(l=(o=O.headRepository)==null?void 0:o.owner.login)!=null?l:(c=O.headRepositoryOwner)==null?void 0:c.login)!=null?d:"<unknown>",repo:(S=(p=O.headRepository)==null?void 0:p.name)!=null?S:O.baseRepository.name,branch:O.headRefName,sha:O.headRefOid,exists:O.headRef!=null}}}:void 0}catch(P){L.error(P);return}}async getPullRequestForBranch(e,r,n){var i,o,c,l,d;try{const{repo:{owner:p,name:S}}=await this.getMetadata(e),P=`query getPullRequestForBranch(
	$owner: String!
	$repo: String!
	$branch: String!
	$maxCount: Int!
	$states: [PullRequestState!]
) {
	repository(name: $repo, owner: $owner) {
		refs(query: $branch, refPrefix: "refs/heads/", first: 1) {
			nodes {
				associatedPullRequests(first: $maxCount, orderBy: {field: UPDATED_AT, direction: DESC}, states: $states) {
					nodes {
						author {
							login
							avatarUrl
							url
						}
						permalink
						number
						title
						state
						updatedAt
						closedAt
						mergedAt
						repository {
							isFork
							name
							owner {
								login
							}
						}
					}
				}
			}
		}
	}
}`,I=await this.graphql(P,{owner:p,repo:S,branch:r,maxCount:(i=n==null?void 0:n.maxCount)!=null?i:1,states:Y0(n==null?void 0:n.include)}),O=(d=(l=(c=(o=I==null?void 0:I.repository)==null?void 0:o.refs.nodes[0])==null?void 0:c.associatedPullRequests)==null?void 0:l.nodes)==null?void 0:d.filter(N=>!N.repository.isFork||N.repository.owner.login===p);if(O==null||O.length===0)return;O.length>1&&O.sort((N,U)=>(N.repository.owner.login===p?-1:1)-(U.repository.owner.login===p?-1:1)||(N.state==="OPEN"?-1:1)-(U.state==="OPEN"?-1:1)||new Date(U.updatedAt).getTime()-new Date(N.updatedAt).getTime());const[F]=O;return{author:{name:F.author.login,avatarUrl:F.author.avatarUrl,url:F.author.url},closedAt:F.closedAt?new Date(F.closedAt):void 0,mergedAt:F.mergedAt?new Date(F.mergedAt):void 0,id:F.number.toString(),repo:{name:F.repository.name,owner:F.repository.owner.login},state:Gd(F.state),title:F.title,updatedAt:new Date(F.updatedAt),url:F.permalink}}catch(p){L.error(p);return}}async getTags(e,r){var n,i,o;try{const{repo:{owner:c,name:l}}=await this.getMetadata(e),d=`query getTags(
	$owner: String!
	$repo: String!
	$tagQuery: String!
	$cursor: String
	$limit: Int = 100
) {
	repository(owner: $owner, name: $repo) {
		refs(query: $tagQuery, refPrefix: "refs/tags/", first: $limit, after: $cursor, orderBy: { field: TAG_COMMIT_DATE, direction: DESC }) {
			pageInfo {
				endCursor
				hasNextPage
			}
			nodes {
				name
				target {
					oid
				}
			}
		}
	}
}`,p=await this.graphql(d,{owner:c,repo:l,tagQuery:(n=r==null?void 0:r.query)!=null?n:"",cursor:r==null?void 0:r.cursor,limit:Math.min(100,(i=r==null?void 0:r.limit)!=null?i:100)});if(p===void 0)return{tags:[]};const S=(o=p.repository)==null?void 0:o.refs;if(S===void 0)return{tags:[]};const P=S.nodes.map(I=>({type:Sn.Tag,name:I.name,commit:I.target.oid,commitUrl:I.target.commitUrl}));return{paging:{cursor:S.pageInfo.endCursor,more:S.pageInfo.hasNextPage},tags:P}}catch(c){return{tags:[]}}}async getTarGz(e){const{repo:{owner:r,name:n},HEAD:{sha:i}}=await this.getMetadata(e),o=await this.ensureAuthenticated();return m.window.withProgress({location:m.ProgressLocation.Notification,cancellable:!0,title:Ws("fetching index","Fetching search index...")},async(c,l)=>{try{if(qn){let S=`https://vscode.dev/indexes/github2/${r}/${n}/${i}`;try{const F=await this.tarballProxyEndpoint;F!==void 0&&(S=F.replace("{owner}",r).replace("{repo}",n).replace("{sha}",i))}catch{}const I=await(await Ze(S,{headers:{"x-proxy-authorization":`Bearer ${o.accessToken}`},credentials:"include"},l)).text(),O=await Ze(I,{},l);return new Uint8Array(await O.arrayBuffer())}const d=`https://api.github.com/repos/${r}/${n}/tarball/${i}`,p=await Ze(d,{headers:{Authorization:`Bearer ${o.accessToken}`}},l);return new Uint8Array(await p.arrayBuffer())}catch(d){throw L.error(d),d}})}async pushCommit(e,r,n,i){const o=new lt(`GitHub.pushCommit(${e.toString()}, sha=${r}${n?`, ref=${n}`:""}${i?`, fork=${i.repo.owner}/${i.repo.name}`:""})`);let c;try{const l=await this.getMetadata(e);let d,p;if(i?{repo:{owner:d,name:p}}=i:l.HEAD.type===De.RemoteBranch&&l.HEAD.branch.remote.accessLevel>=Ne.Write?{owner:d,name:p}=l.HEAD.branch.remote.repo:{repo:{owner:d,name:p}}=l,n===void 0&&l.HEAD.detached)throw new It("Unable to commit; no current branch");(n==null?void 0:n.startsWith("refs/heads/"))&&(n=n.substr(11));const S=await this.request("PATCH /repos/{owner}/{repo}/git/refs/{ref}",{owner:d,repo:p,ref:`heads/${n!=null?n:l.HEAD.branch.name}`,sha:r});return n===void 0&&!l.HEAD.detached&&await this.fastForwardTo(e,r,l),c=S.data.ref,c}catch(l){throw l instanceof jn&&l.status===422&&l.message.includes("Update is not a fast forward")?new Me(l):(L.error(l),l)}finally{o.stop(c?{message:`: Pushed commit to ${c}`}:void 0)}}async queryRepositoryObject(e,r,n,i){var o,c;try{const{repo:{owner:l,name:d},HEAD:{sha:p},path:S}=await this.providerService.getMetadata(e),P=`query ${r}(
	$owner: String!
	$repo: String!
	$expression: String
) {
	repository(owner: $owner, name: $repo) {
		object(expression: $expression) {
			${n}
		}
	}
}`,I=await this.graphql(P,{owner:l,repo:d,expression:i!=null?i:`${p}:${S}`});return(c=(o=I==null?void 0:I.repository)==null?void 0:o.object)!=null?c:void 0}catch(l){L.error(l);return}}async repositoryObjectExists(e,r){return await this.queryRepositoryObject(e,"exists","			__typename",r)!==void 0}async searchPullRequestsQuery(e,r){try{let n=a(function(l,d){return{number:l.number,title:l.title,repoWithOwner:l.repository.nameWithOwner,reasons:d?[d]:[],url:l.url}},"toResult");const i=`query searchPullRequests(
	$authored: String!
	$assigned: String!
	$reviewRequested: String!
	$mentioned: String!
) {
	viewer {
		repositories(first: 100, orderBy: { field: STARGAZERS, direction: DESC }) {
			nodes {
				pullRequests(first: 100, states: OPEN, orderBy: { field: UPDATED_AT, direction: DESC }) {
					nodes {
						number
						title
						url
						repository {
							nameWithOwner
						}
					}
				}
			}
		}
	}
	authored: search(first: 100, query: $authored, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	assigned: search(first: 100, query: $assigned, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	reviewRequested: search(first: 100, query: $reviewRequested, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
	mentioned: search(first: 100, query: $mentioned, type: ISSUE) {
		nodes {
			...on PullRequest {
				number
				title
				url
				repository {
					nameWithOwner
				}
			}
		}
	}
}`;e=e.trim(),(r==null?void 0:r.user)&&(e+=` user:${r.user}`);const o=await this.graphql(i,{authored:(e?`${e} is:pr is:open archived:false author:@me`:"is:pr is:open archived:false author:@me").trim(),assigned:(e?`${e} is:pr is:open archived:false assignee:@me`:"is:pr is:open archived:false assignee:@me").trim(),reviewRequested:(e?`${e} is:pr is:open archived:false review-requested:@me`:"is:pr is:open archived:false review-requested:@me").trim(),mentioned:(e?`${e} is:pr is:open archived:false mentions:@me`:"is:pr is:open archived:false mentions:@me").trim()});return o===void 0?[]:Hd([...o.assigned.nodes.map(l=>n(l,"assigned")),...o.reviewRequested.nodes.map(l=>n(l,"review requested")),...o.mentioned.nodes.map(l=>n(l,"mentioned")),...o.authored.nodes.map(l=>n(l,"authored")),...yn(o.viewer.repositories.nodes,l=>l.pullRequests.nodes.map(d=>n(d)))],l=>l.url,(l,d)=>(d.reasons.length!==0&&l.reasons.push(...d.reasons),l))}catch(n){return[]}}async searchRepositoriesQuery(e,r){try{const n=`query searchRepositories(
	$search: String!
) {
	viewer {
		repositories(first: 100, orderBy: { field: UPDATED_AT, direction: DESC }) {
			nodes {
				nameWithOwner
				description
				url
				parent {
					nameWithOwner
				}
				stargazerCount
			}
		}
	}
	search(first: 100, query: $search, type: REPOSITORY) {
		nodes {
			...on Repository {
				nameWithOwner
				description
				url
				parent {
					nameWithOwner
				}
				stargazerCount
			}
		}
	}
}`;(r==null?void 0:r.user)&&(e+=` user:${r.user}`),(r==null?void 0:r.sort)&&(e+=` sort:${r.sort}`),e+=" fork:true";const i=await this.graphql(n,{search:e.trim()});return i===void 0?[]:Hd((r==null?void 0:r.user)?[...i.search.nodes,...i.viewer.repositories.nodes]:[...i.viewer.repositories.nodes,...i.search.nodes],c=>c.url).map(c=>{var l,d,p;return{repoWithOwner:c.nameWithOwner,description:(l=c.description)!=null?l:void 0,url:c.url,fork:(p=(d=c.parent)==null?void 0:d.nameWithOwner)!=null?p:void 0,stars:c.stargazerCount}})}catch(n){return[]}}async searchCodeQuery(e,r,n){var i,o,c;const{repo:{owner:l,name:d},HEAD:p,defaultBranch:S}=await this.getMetadata(r),P=[];((i=p.branch)==null?void 0:i.name)!==S.name&&P.push(Ws("Cant search branch","Unable to search {0} without index, falling back to {1}.",(c=(o=p.branch)==null?void 0:o.name)!=null?c:p.detached.name,S.name));try{const O=await(await this.octokit({request:{headers:{authorization:`Bearer ${(await this.ensureAuthenticated()).accessToken}`,accept:"application/vnd.github.v3.text-match+json"}}})).request("GET /search/code",{q:`${e} repo:${l}/${d}`}),F=new m.Range(0,0,0,0),N=[];let U=0,W;for(const V of O.data.items)for(const ie of V.text_matches){if(U++,n.maxResults!==void 0&&U>n.maxResults)return{matches:N,limitHit:!0};W={path:V.path,ranges:[],preview:ie.fragment,matches:[]};for(const oe of ie.matches){let ge=0,ke=0,Re=0;for(let Ie=0;Ie<oe.indices[1];Ie++)Ie===oe.indices[0]&&(ke=Re),ie.fragment[Ie]===`
`?(ge++,Re=0):Re++;W.ranges.push(F),W.matches.push(new m.Range(ge,ke,ge,Re))}N.push(W)}return{matches:N,limitHit:!1,warnings:P}}catch(I){return{matches:[],limitHit:!0}}}async switchTo(e,r,n){const{name:i,repo:o,HEAD:{branch:c}}=await this.getMetadata(e);let l;if(!(r!==void 0&&(typeof r=="string"?(r==null?void 0:r.startsWith("refs/heads/"))?(l={type:et.Tree,id:r.substr(11)},r=r.substr(11)):(r==null?void 0:r.startsWith("refs/tags/"))?l={type:et.Tree,id:r.substr(10)}:l={type:et.Tree,id:r}:l={...r,type:r.type===et.Branch||r.type===et.Tag?et.Tree:r.type},(c==null?void 0:c.name)===l.id)))return{name:i,uri:this.providerService.createVirtualUri(e,{repo:o,ref:l}),location:(n==null?void 0:n.openInNewWindow)?tr.NewWindow:tr.CurrentWindow}}async sync(e,r,n){var i,o,c,l,d,p;const S=new lt(`GitHub.sync(${e.toString()}, resolution=${n.conflictResolution}, to=${n.to})`);let P;try{const{metadata:I}=await this.fetchCore(e,!0,{to:n.to});if(I.HEAD.detached){P=" \u2022 Skipped; detached HEAD";return}if(((o=(i=I==null?void 0:I.state)==null?void 0:i.behind)!=null?o:0)>0&&await r.hasChanges(e)){S.logStep("Fetching upstream changes");const O=[],F=(l=(c=I.state)==null?void 0:c.incomingChanges)!=null?l:[];if(F.length>0){const N=await r.getChanges(e);for(const U of N){const W=this.providerService.getRelativeFilePath(e,U.uri),V=F.find(ie=>ie.uri.path===W);if(V!==void 0){O.push({path:W,current:U,incomingType:V.type});break}}}if(O.length>0)switch(n.conflictResolution){case an.KeepCurrent:S.logStep("Syncing (keep) upstream changes",{message:`: ${O.length} conflicts; \u2022`,suffix:" \u2022 Syncing (keep) upstream changes..."});for(const N of O)await r.keep(N.current.uri,{type:N.incomingType,providerUri:Wd(I,I.HEAD.branch.sha,N.path)});break;case an.DiscardCurrent:S.logStep("Syncing (discard) upstream changes",{message:`: ${O.length} conflicts; \u2022`,suffix:" \u2022 Syncing (discard) upstream changes..."});for(const N of O)await r.discard(N.current.uri);break;case an.Merge:S.logStep("Syncing (merge) upstream changes",{message:`: ${O.length} conflicts; \u2022`,suffix:" \u2022 Syncing (merge) upstream changes..."});for(const N of O)await r.merge(N.current.uri,{type:N.incomingType,providerUri:Wd(I,I.HEAD.branch.sha,N.path)},{providerUri:Wd(I,I.HEAD.sha,N.path)});break;case an.Abort:default:throw S.logStep("Syncing (abort) upstream changes",{message:`: ${O.length} conflicts; \u2022`,suffix:" \u2022 Syncing (abort) upstream changes..."}),await this.providerService.updateMetadata(e,I),new Ut}}P=` \u2022 to=${(d=n.to)!=null?d:I.HEAD.branch.sha}`,await this.fastForwardTo(e,(p=n.to)!=null?p:I.HEAD.branch.sha,I)}finally{S.stop(P?{suffix:P}:void 0)}}async fastForwardTo(e,r,n){if(n.HEAD.detached)throw new It("Unable to fast-forward; no current branch");if(n.HEAD.sha===r&&n.state===void 0)return;const i=this.asFileTreeKey(e,n.HEAD.sha),o=this.fileTreeCache.get(i);this.fileTreeCache.delete(i),o==null||o.dispose(),L.log(`Fast forward to ${r}; rootUri=${e.toString()}`),await this.providerService.updateMetadata(e,{...n,HEAD:{...n.HEAD,detached:void 0,sha:r},state:r!==n.HEAD.branch.sha?n.state:void 0,timestamp:Date.now()}),r!==n.HEAD.branch.sha&&n.state===void 0&&await this.fetchCore(e,!1,{to:r})}async getBranchTips(e,r){try{const{repo:{owner:n,name:i},HEAD:o}=await this.getMetadata(e);r===void 0&&(o.type===De.RemoteBranch?r=`${o.branch.remote.repo.owner}/${o.branch.remote.repo.name}:refs/heads/${o.branch.name}`:r=o.branch?`refs/heads/${o.branch.name}`:"");const c=up.exec(r);if(c==null?void 0:c.groups)return this.getRemoteBranchTips(n,i,r);const l=`query getBranchTips(
	$owner: String!
	$repo: String!
	$ref: String!
) {
	repository(owner: $owner, name: $repo) {
		defaultBranchRef {
			target {
				oid
			}
		}
		ref(qualifiedName: $ref) {
			target {
				oid
			}
		}
	}
}`,d=await this.graphql(l,{owner:n,repo:i,ref:r});if((d==null?void 0:d.repository)==null)return;const{defaultBranchRef:p,ref:S}=d.repository;return!p&&!S?void 0:{defaultBranch:p?{sha:p.target.oid}:void 0,branch:S?{sha:S.target.oid}:void 0}}catch(n){return}}async getRemoteBranchTips(e,r,n){try{const i=up.exec(n);if((i==null?void 0:i.groups)==null)return;let{remoteOwner:o,remoteRepo:c,remoteRef:l}=i.groups;c||(c=r);const d=`query getRemoteBranchTips(
	$owner: String!
	$repo: String!
	$remoteOwner: String!
	$remoteRepo: String!
	$remoteRef: String!
) {
	repository(owner: $owner, name: $repo) {
		defaultBranchRef {
			target {
				oid
			}
		}
	}
	remote: repository(owner: $remoteOwner, name: $remoteRepo) {
		ref(qualifiedName: $remoteRef) {
			target {
				oid
			}
		}
	}
}`,p=await this.graphql(d,{owner:e,repo:r,remoteOwner:o,remoteRepo:c,remoteRef:l});if((p==null?void 0:p.repository)==null||(p==null?void 0:p.remote)==null)return;const{repository:{defaultBranchRef:S},remote:{ref:P}}=p;return!S&&!P?void 0:{defaultBranch:S?{sha:S.target.oid}:void 0,branch:P?{sha:P.target.oid}:void 0}}catch(i){return}}async getRepositoryInfo(e,r,n,i){var o,c,l,d,p,S,P,I,O,F,N,U,W,V,ie,oe;try{const ge=`number
title
state
maintainerCanModify
baseRef { name }
baseRefName
baseRefOid
baseRepository {
	name
	owner { login }
	defaultBranchRef {
		name
		target { oid }
	}
	viewerPermission
}
headRef { name }
headRefName
headRefOid
headRepository {
	name
	owner { login }
	defaultBranchRef {
		name
		target { oid }
	}
	viewerPermission
}
mergeCommit { oid }
`,ke=`query getRepository(
	$owner: String!
	$repo: String!
	$ref: String = ""
	$has_pr: Boolean!
	$pr: Int = 0
) {
	viewer { login }
	repository(owner: $owner, name: $repo) {
		name
		owner { login }
		defaultBranchRef {
			name
			target { oid }
		}
		ref(qualifiedName: $ref) {
			name
			prefix
			target { oid }
		}
		viewerPermission
		pullRequest(number: $pr) @include(if: $has_pr) {
			${ge}
		}
	}
}`;let Re,Ie;try{const at=await this.graphql(ke,{owner:e,repo:r,ref:(i==null?void 0:i.ref)!=="HEAD"?i==null?void 0:i.ref:void 0,has_pr:Boolean(i==null?void 0:i.pr),pr:(o=i==null?void 0:i.pr)!=null?o:0});if((at==null?void 0:at.repository)==null)return;({repository:Ie,viewer:{login:Re}}=at)}catch(at){if((i==null?void 0:i.pr)&&at instanceof zs&&((l=(c=at.errors)==null?void 0:c[0])==null?void 0:l.type)==="NOT_FOUND"&&((d=at.errors[0])==null?void 0:d.message.includes("Could not resolve to a PullRequest"))){({repository:Ie,viewer:{login:Re}}=at.data);try{const kt=await this.graphql(`query getPullRequestFromParentRepository(
	$owner: String!
	$repo: String!
	$pr: Int!
) {
	repository(owner: $owner, name: $repo) {
		parent {
			pullRequest(number: $pr) {
				${ge}
			}
		}
	}
}`,{owner:e,repo:r,pr:i==null?void 0:i.pr});if(((S=(p=kt==null?void 0:kt.repository)==null?void 0:p.parent)==null?void 0:S.pullRequest)==null)throw at;Ie.pullRequest=kt.repository.parent.pullRequest}catch{throw at}}else throw at}const Ye=(P=Ie.defaultBranchRef)!=null?P:void 0;if((Ye==null?void 0:Ye.name)==null)return;const $e=Ie.pullRequest;let ze;if(Ie==null?void 0:Ie.ref)ze={prefix:Ie.ref.prefix,name:Ie.ref.name,sha:Ie.ref.target.oid};else if($e==null?void 0:$e.headRef){let at=Vd($e.headRepository.viewerPermission);at<Ne.Write&&$e.maintainerCanModify&&Vd(Ie.viewerPermission)>=Ne.Write&&(at=Ne.WriteToPullRequest),ze=$e.headRepository.owner.login===e?{prefix:"refs/heads/",name:$e==null?void 0:$e.headRef.name,sha:(O=(I=$e.mergeCommit)==null?void 0:I.oid)!=null?O:$e==null?void 0:$e.headRefOid}:{prefix:"refs/remotes/",name:$e==null?void 0:$e.headRef.name,sha:(N=(F=$e.mergeCommit)==null?void 0:F.oid)!=null?N:$e==null?void 0:$e.headRefOid,remote:{name:`${$e.headRepository.owner.login}/${$e.headRepository.name}`,accessLevel:at,repo:{owner:$e.headRepository.owner.login,name:$e.headRepository.name}}}}else($e==null?void 0:$e.baseRef)?(ze={prefix:"refs/heads/",name:$e==null?void 0:$e.baseRef.name,sha:(W=(U=$e.mergeCommit)==null?void 0:U.oid)!=null?W:$e==null?void 0:$e.baseRefOid},n&&(L.log("Did not find a headRef for PR, falling back to baseRef",$e.baseRef),Yr.showPullRequestHeadNotFoundMessage(`${e}/${r}`,`#${i==null?void 0:i.pr}`))):(i==null?void 0:i.ref)==="HEAD"&&(ze={prefix:"refs/heads/",name:Ye.name,sha:Ye.target.oid});return{user:Re,repo:{owner:Ie.owner.login,name:Ie.name},accessLevel:Vd(Ie.viewerPermission),ref:ze,defaultBranch:{name:Ye.name,sha:Ye.target.oid},pullRequest:$e?{id:$e.number.toString(),state:Gd($e.state),title:$e.title}:void 0}}catch(ge){if(ge instanceof zs)switch((ie=(V=ge.errors)==null?void 0:V[0])==null?void 0:ie.type){case"NOT_FOUND":{if((i==null?void 0:i.pr)&&((oe=ge.errors[0])==null?void 0:oe.message.includes("Could not resolve to a PullRequest"))){const Re=new Rt(ge,`${e}/${r}`,`#${i==null?void 0:i.pr}`);throw n&&Yr.showPullRequestNotFoundMessage(Re.name,Re.id),Re}const ke=new Pt(ge,`${e}/${r}`);throw n&&Yr.showRepositoryNotFoundMessage(ke.name),ke}case"FORBIDDEN":{const ke=new xe(ge,`${e}/${r}`);throw n&&Yr.showRepositoryForbiddenMessage(ke.name),ke}}L.error(ge,`Failed to get repository info for '${e}/${r}'`),!this.handleRequestErrors(ge)&&n&&Yr.showUnableToOpenRepositoryMessage(ge);return}}async validateOwnerAndRepoAndSplitRefFromPath(e,r,n){try{const i=await this.request(`GET /repos/{owner}/{repo}/git/extract-ref/${n!=null?n:"HEAD"}`,{owner:e,repo:r});return[e,r]=i.data.name_with_owner.split("/"),n?{owner:e,repo:r,ref:{type:et.Tree,id:i.data.ref},path:i.data.path}:{owner:e,repo:r}}catch(i){if(i instanceof jn)switch(i.status){case 401:throw new pt(i,()=>void this.reauthenticate());case 403:throw new xe(i,`${e}/${r}`);case 404:throw new Pt(i,`${e}/${r}`);case 409:throw new ut(i,`${e}/${r}`)}return}}asFileTreeKey(e,r){return`${Ae(this.providerService.getProviderRootUri(e))}:${r}`}}a(hu,"GitHubRepositoryProvider"),cp([nr()],hu.prototype,"ensureAuthenticated",1),cp([nr()],hu.prototype,"octokit",1);function Gd(t){switch(t){case"OPEN":return nt.Open;case"CLOSED":return nt.Closed;case"MERGED":return nt.Merged}}a(Gd,"toPullRequestState");function Y0(t){if(t!==void 0)return t.map(e=>{switch(e){case nt.Open:return"OPEN";case nt.Closed:return"CLOSED";case nt.Merged:return"MERGED"}})}a(Y0,"fromPullRequestStates");var Ua;(function(t){t.ADMIN="ADMIN",t.MAINTAIN="MAINTAIN",t.WRITE="WRITE",t.TRIAGE="TRIAGE",t.READ="READ",t.NONE="NONE"})(Ua||(Ua={}));function Vd(t){switch(t){case Ua.ADMIN:return Ne.Admin;case Ua.MAINTAIN:return Ne.Maintain;case Ua.WRITE:return Ne.Write;case Ua.TRIAGE:return Ne.Triage;case Ua.READ:return Ne.Read;default:return Ne.None}}a(Vd,"permissionToAccessLevel");function Z0(t){switch(t&&(t=t.toLocaleLowerCase()),t){case"blob":return m.FileType.File;case"tree":return m.FileType.Directory;default:return m.FileType.Unknown}}a(Z0,"typenameToFileType");const hp=a(class{constructor(t,e,r){this.providerService=t,this.storageService=e,this.changeStore=r,this.lock=new wn("PendingRepositoryOpenActions"),this.disposable=m.Disposable.from(t.onDidChangeRepositories(n=>n.added.length&&this.onRepositoriesOpened(n.added)))}dispose(){this.disposable.dispose()}async onRepositoriesOpened(t){for(const e of t){const r=await this.getAndDelete(e);(r==null?void 0:r.applyChangeset)&&await this.applyPendingChangeset(e,r.applyChangeset),(r==null?void 0:r.filesToOpen)&&this.openPendingFiles(e.uri,r.filesToOpen),this.fetchOrSync(e)}}async fetchOrSync(t){await this.changeStore.hasChanges(t.uri)?await this.providerService.fetch(t.uri):await this.providerService.sync(t.uri,this.changeStore,{reason:"invoked"})}async get(t){return this.lock.synchronizeRead(()=>this.getCore(t.uri),"PendingRepositoryOpenActions.get")}async getAndDelete(t){L.debug(`RepositoryOpenActionsService.getAndDelete(${t.uri.toString()})`);try{return await this.lock.synchronizeWrite(async()=>{const r=await this.getCore(t.uri);if(r!==void 0)return await this.storeCore(t.uri,void 0),r},"PendingRepositoryOpenActions.getAndDelete")}catch(e){L.error(e,`Failed to get pending actions for ${t.uri.toString()}`);return}}async openPendingFiles(t,e){if(e.length!==0){L.log(`RepositoryOpenActionsService.openPendingFiles(${t.toString()})`,e.join(","));for(let r of e){const n=/:(?<start>\d+)(?:-(?<end>\d+))?$/.exec(r);let i,o;(n==null?void 0:n.groups)!==void 0&&(i=Number(n.groups.start),isNaN(i)&&(i=void 0),o=Number(n.groups.end),isNaN(o)&&(o=void 0),r=r.substring(0,n.index));const c=m.Uri.joinPath(t,r);let l;try{l=await m.workspace.fs.stat(c)}catch{}if((l==null?void 0:l.type)===m.FileType.Directory)m.commands.executeCommand("revealInExplorer",c);else{let d;i!==void 0&&(d={selection:new m.Range(Number(i)-1,0,o!=null?o:i,0)}),m.commands.executeCommand("vscode.open",c,d)}}}}setChangesetToApply(t,e){return L.log(`RepositoryOpenActionsService.setChangesetToApply(${t.toString()})`),this.lock.synchronizeWrite(async()=>{const r=await this.getCore(t);await this.storeCore(t,{...r,applyChangeset:e})},"PendingRepositoryOpenActions.setChangesetToApply")}setPendingFilesToOpen(t,e){return L.log(`RepositoryOpenActionsService.setPendingFilesToOpen(${t.toString()})`,e.length),this.lock.synchronizeWrite(async()=>{const r=await this.getCore(t);await this.storeCore(t,{...r,filesToOpen:e})},"PendingRepositoryOpenActions.setPendingFilesToOpen")}async applyPendingChangeset(t,e){L.log(`RepositoryOpenActionsService.applyPendingChangeset(${t.uri.toString()})`);try{await this.changeStore.applyChangeset(t.uri,e,{save:!0})}catch(r){L.error(r,`Failed to apply pending changeset for ${t.uri.toString()}`)}}async getCore(t){return this.fromStorage(await this.storageService.get(this.getStorageKey(t)))}storeCore(t,e){return e===void 0||e.applyChangeset===void 0&&(e.filesToOpen===void 0||e.filesToOpen.length===0)?this.storageService.delete(this.getStorageKey(t)):this.storageService.store(this.getStorageKey(t),this.toStorage(e))}getStorageKey(t){return`actions/${te(t)}`}fromStorage(t){if(!!t)try{const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&Ue(n)?m.Uri.from(n):n);return{filesToOpen:e.filesToOpen,applyChangeset:e.applyChangeset}}catch(e){return L.error(e,"Failed to deserialize pending repository actions"),{}}}toStorage(t){const e={schemaVersion:hp.storageSchemaVersion,...t};return JSON.stringify(e)}},"_RepositoryOpenActionsService");let fp=hp;fp.storageSchemaVersion=1;const fi=(0,B.loadMessageBundle)();class pp{constructor(e,r){this.providerService=e,this.changeStore=r,this._onDidChangeFileDecorations=new m.EventEmitter,this._decorations=new Map,this.disposable=m.Disposable.from(m.window.registerFileDecorationProvider(this),e.onDidChangeRepository(this.onRefresh,this),e.onDidRefresh(this.onRefresh,this),r.onDidChange(this.onUrisChanged,this))}get onDidChangeFileDecorations(){return this._onDidChangeFileDecorations.event}dispose(){this.disposable.dispose(),this._decorations.clear()}onRefresh(){this._decorations.clear(),setTimeout(()=>this._onDidChangeFileDecorations.fire(void 0),0)}onUrisChanged(e){const r=e.map(({uri:n})=>(this._decorations.delete(te(n)),n));setTimeout(()=>this._onDidChangeFileDecorations.fire(r),0)}async provideFileDecoration(e,r){if(e.scheme!==Xt.scheme)return;const n=te(e);let i=this._decorations.get(n);if(i!==void 0)return i!=null?i:void 0;const o=await this.providerService.getIncomingChanges(this.providerService.getVirtualRootUri(e));let c;o.length>0&&(c=o.find(d=>te(d.uri)===n));const l=await this.changeStore.getChange(e);if(l===void 0){if(c!==void 0)switch(c.type){case Dt.Created:i={badge:"\u2193A",color:new m.ThemeColor("remoteHub.decorations.incomingAddedForegroundColor"),tooltip:fi("decoration tooltip incoming change added","Pending Incoming Changes (Added)")};break;case Dt.Deleted:i={badge:"\u2193D",color:new m.ThemeColor("remoteHub.decorations.incomingDeletedForegroundColor"),tooltip:fi("decoration tooltip incoming change deleted","Pending Incoming Changes (Deleted)")};break;case Dt.Changed:i={badge:"\u2193M",color:new m.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:fi("decoration tooltip incoming change modified","Pending Incoming Changes (Modified)")};break;default:i={badge:"\u2193~",color:new m.ThemeColor("remoteHub.decorations.incomingModifiedForegroundColor"),tooltip:fi("decoration tooltip incoming change","Pending Incoming Changes")};break}return this._decorations.set(n,i!=null?i:null),i}if(l.conflicts)i={badge:"\u26A0",color:new m.ThemeColor("remoteHub.decorations.conflictForegroundColor"),tooltip:fi("decoration tooltip conflicts","Merge Conflicts ({0})",Cu(l.conflicts.status))};else if(c!==void 0)switch(c.type){case Dt.Created:i={badge:"\u26A0",color:new m.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:fi("decoration tooltip possible conflict added","Possible Merge Conflicts (Added)")};break;case Dt.Deleted:i={badge:"\u26A0",color:new m.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:fi("decoration tooltip possible conflict deleted","Possible Merge Conflicts (Deleted)")};break;case Dt.Changed:i={badge:"\u26A0",color:new m.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:fi("decoration tooltip possible conflict","Possible Merge Conflicts")};break;default:i={badge:"\u26A0",color:new m.ThemeColor("remoteHub.decorations.possibleConflictForegroundColor"),tooltip:fi("decoration tooltip possible conflict","Possible Merge Conflicts")}}else switch(l.type){case Dt.Created:i={badge:"A",color:new m.ThemeColor("remoteHub.decorations.addedForegroundColor"),tooltip:fi("decoration tooltip added","Added")};break;case Dt.Changed:i={badge:"M",color:new m.ThemeColor("remoteHub.decorations.modifiedForegroundColor"),tooltip:fi("decoration tooltip modified","Modified")};break;case Dt.Deleted:i={badge:"D",color:new m.ThemeColor("remoteHub.decorations.deletedForegroundColor"),tooltip:fi("decoration tooltip deleted","Deleted")};break}return this._decorations.set(n,i!=null?i:null),i}}a(pp,"ScmDecorationProvider");const J0=(0,B.loadMessageBundle)();class wo{constructor(e){this.command=e}get label(){return this.command.title}async execute(){var e;return void await m.commands.executeCommand(this.command.command,...(e=this.command.arguments)!=null?e:[])}}a(wo,"CommandQuickPickItem");var fu;(function(t){async function e(r,n,i,o,c,l){let d;Array.isArray(c)?d=c:l===void 0&&(d=[],l=c);const p=m.window.createQuickPick(),S=new ds(500),P=[S],{defaultBranch:I,HEAD:O}=await r.getMetadata(n);async function F(ie){var oe;const[ge,ke,Re]=await Promise.all([r.getBranches(n,{query:ie,limit:100}),r.getTags(n,{query:ie,limit:100}),r.getSnapshots(n)]),Ie=new Set,Ye=new Set;for(const kt of Re)Ie.add(kt.hash),Ye.add(kt.branch.name);const $e=((l==null?void 0:l.filterBranches)?ge.branches.filter(l==null?void 0:l.filterBranches):ge.branches).filter(kt=>kt.name!==I.name),ze=J0("indexedCommit","Open indexed commit"),at=[{iconPath:new m.ThemeIcon("layers-active"),tooltip:ze}];return[...d,...((oe=O.branch)==null?void 0:oe.name)!==I.name?[{label:`$(git-branch) ${I.name} (default)`,description:`\u2022$(git-commit) ${yt(I.sha)}${Ye.has(I.name)||Ie.has(I.sha)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,alwaysShow:!0,type:et.Branch,name:void 0,sha:I.sha,buttons:Ye.has(I.name)||Ie.has(I.sha)?at:void 0}]:[],...$e.map(kt=>({label:`$(git-branch) ${kt.name}`,description:`\u2022$(git-commit) ${yt(kt.commit)}${Ye.has(kt.name)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,type:et.Branch,name:kt.name,sha:kt.commit,buttons:Ye.has(kt.name)?at:void 0})),...ke.tags.map(kt=>({label:`$(tag) ${kt.name}`,description:`\u2022$(git-commit) ${yt(kt.commit)}${Ie.has(kt.commit)?"\xA0\xA0\u2022\xA0\xA0$(layers)":""}`,type:et.Tag,name:kt.name,sha:kt.commit,buttons:Ie.has(kt.commit)?at:void 0}))]}a(F,"getItems");const N=F(void 0);let U,W=!1;async function V(ie){U=void 0;const oe=p.activeItems;p.items=ie!=null?ie:await N,W&&oe.length!==0&&(p.activeItems=p.items.filter(ge=>oe.some(ke=>ke.label===ge.label))),p.busy=!1}a(V,"setItems");try{return await new Promise(oe=>{var ge;P.push(p.onDidHide(()=>oe(void 0)),p.onDidChangeValue(ke=>{if(W=!1,ke=ke.trim(),(l==null?void 0:l.allowResetToSha)&&O.branch&&Ur(ke)){V([{label:`Reset $(git-branch) ${O.branch.name} to $(git-commit) ${ke}`,name:O.branch.name,sha:ke,type:et.Branch}]);return}p.busy=!0;const Re=S.debounce(ke?()=>F(ke):()=>N);U===void 0&&(U=Re.then(async Ie=>V(Ie)))}),p.onDidAccept(()=>{if(p.activeItems.length!==0){const[ke]=p.activeItems;oe(ke)}}),p.onDidTriggerItemButton(ke=>{const Re=ke.item;Re instanceof wo||(Re.useIndex=!0),oe(Re)})),p.title=o,p.placeholder=i,p.matchOnDescription=!0,p.ignoreFocusOut=(ge=l==null?void 0:l.ignoreFocusOut)!=null?ge:!0,p.busy=!0,p.show(),U=S.debounce(async()=>N,0).then(ke=>V(ke))})}finally{p.dispose(),P.forEach(ie=>void ie.dispose())}}a(e,"show"),t.show=e})(fu||(fu={}));function Kd(t,e){switch(t){case De.Branch:case De.RemoteBranch:return e?"$(git-pull-request)":"$(git-branch)";case De.Tag:return"$(tag)";case De.Commit:return"$(git-commit)"}}a(Kd,"headTypeToCodicon");function ey(t){switch(t){case ft.Active:return"$(layers-active)";case ft.Match:return"$(layers-dot)";case ft.Indexed:return"$(layers)"}}a(ey,"indexTypeToCodicon");function ty(t,e){switch(t){case De.Branch:case De.RemoteBranch:return e?new m.ThemeIcon("git-pull-request"):new m.ThemeIcon("git-branch");case De.Tag:return new m.ThemeIcon("tag");case De.Commit:return new m.ThemeIcon("git-commit")}}a(ty,"headTypeToThemeIcon");const je=(0,B.loadMessageBundle)(),ry=new TextDecoder;class gp{constructor(e,r,n,i){this.providerService=e,this.changeStore=r,this.openActionsService=n,this.telemetryService=i,this._onDidCloseRepository=new m.EventEmitter,this._onDidOpenRepository=new m.EventEmitter,this._onDidChangeState=new m.EventEmitter,this._scmProviders=[],this._state="uninitialized",this.disposable=m.Disposable.from(Y.onDidChange(this.onConfigurationChanged,this),this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(async({repository:c})=>{const l=this.getScmProvider(this.providerService.getVirtualUri(c.uri));l!==void 0&&await this.updateStatusBarCommands(l,void 0)}),this.providerService.onDidSyncRepository(async({repository:c,syncing:l})=>{const d=this.getScmProvider(this.providerService.getVirtualUri(c.uri));d!==void 0&&await this.updateStatusBarCommands(d,{syncing:l})}),this.providerService.onDidRefresh(c=>{for(const l of c)this.update(l)}),this.changeStore.onDidChange(c=>this.update(c[0].rootUri)),...this.registerCommands());const o=this.providerService.repositories;this.onRepositoriesChanged({added:o,removed:[]})}get onDidCloseRepository(){return this._onDidCloseRepository.event}get onDidOpenRepository(){return this._onDidOpenRepository.event}get onDidChangeState(){return this._onDidChangeState.event}get repositories(){return this._scmProviders.map(e=>e.repository).filter(e=>Boolean(e))}dispose(){var e;(e=this.disposable)==null||e.dispose()}get staging(){return this._staging===void 0&&(this._staging=Y.get("staging")),this._staging}get state(){return this._state}refresh(){for(const e of this._scmProviders)this.update(e.sourceControl.rootUri)}onConfigurationChanged(e){Y.changed(e,"staging")&&(this._staging=void 0,Y.changed(e,"staging.enabled")&&this.refresh()),Y.changed(e,"commitDirectlyWarning")&&this.refresh()}async onRepositoriesChanged(e){if(e.added.length)for(const r of e.added){const n=await this.update(r.uri);(n==null?void 0:n.repository)&&this._onDidOpenRepository.fire(n.repository)}if(e.removed.length)for(const r of e.removed){const n=this._scmProviders.findIndex(i=>te(i.sourceControl.rootUri)===te(r.uri));if(n!==-1){const i=this._scmProviders[n];i.repository&&this._onDidCloseRepository.fire(i.repository),i.sourceControl.dispose(),this._scmProviders.splice(n,1)}}this._state!=="initialized"&&(this._state="initialized",this._onDidChangeState.fire(this._state)),oi(ii.HasWriteableScmProvider,this._scmProviders.some(r=>!r.isReadonly))}registerCommands(){return[m.commands.registerCommand("remoteHub.createPullRequest",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.createPullRequest"),void this.createPullRequest(e)}),m.commands.registerCommand("remoteHub.createDraftPullRequest",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.createDraftPullRequest"),void this.createPullRequest(e,{draft:!0})}),m.commands.registerCommand("remoteHub.commit",e=>{if(e=this.getSourceControlFrom(e),e!==void 0)return this.telemetryService.sendEvent("command.commit"),void this.commitChanges(e)}),m.commands.registerCommand("remoteHub.discardAllChanges",async e=>{if(mp(e)){const o=e.resourceStates.filter(al);if(o.length!==0){if(await Qd(o))for(const c of o)await this.changeStore.discard(c.resourceUri);else this.telemetryService.sendEvent("command.discardAllChanges.abort",{reason:"aborted"});return}}const r=this.getSourceControlFrom(e);if((r==null?void 0:r.rootUri)===void 0)return;this.telemetryService.sendEvent("command.discardAllChanges");const n=await this.changeStore.getChanges(r.rootUri);await Qd(n)?await this.changeStore.discardAll(r.rootUri):this.telemetryService.sendEvent("command.discardAllChanges.abort",{reason:"aborted"})}),m.commands.registerCommand("remoteHub.discardChanges",async e=>{!al(e)||(this.telemetryService.sendEvent("command.discardChanges"),await Qd([e])?await this.changeStore.discard(e.resourceUri):this.telemetryService.sendEvent("command.discardChanges.abort",{reason:"aborted"}))}),m.commands.registerCommand("remoteHub.stageAllChanges",async e=>{const r=this.getSourceControlFrom(e);(r==null?void 0:r.rootUri)!==void 0&&(this.telemetryService.sendEvent("command.stageAllChanges"),await this.changeStore.stageAll(r.rootUri))}),m.commands.registerCommand("remoteHub.stageChanges",e=>{if(!!al(e))return this.telemetryService.sendEvent("command.stageChanges"),void this.changeStore.stage(e.resourceUri)}),m.commands.registerCommand("remoteHub.unstageAllChanges",e=>{const r=this.getSourceControlFrom(e);if((r==null?void 0:r.rootUri)!==void 0)return this.telemetryService.sendEvent("command.unstageAllChanges"),void this.changeStore.unstageAll(r.rootUri)}),m.commands.registerCommand("remoteHub.unstageChanges",e=>{if(!!al(e))return this.telemetryService.sendEvent("command.unstageChanges"),void this.changeStore.unstage(e.resourceUri)}),m.commands.registerCommand("remoteHub.keepChanges",e=>{if(!!al(e))return this.telemetryService.sendEvent("command.keepChanges"),void this.changeStore.keep(e.resourceUri)}),m.commands.registerCommand("remoteHub.openChanges",e=>{var r;const{command:n}=e;if(!!n)return this.telemetryService.sendEvent("command.openChanges"),void m.commands.executeCommand(n.command,...(r=n.arguments)!=null?r:[])}),m.commands.registerCommand("remoteHub.openFile",e=>{var r;if(Xd(e)){const i=this.changeStore.resolveOpenCommand(e.resourceUri,{preserveFocus:!1,preview:!1,viewColumn:m.ViewColumn.Active});return this.telemetryService.sendEvent("command.openFile"),void m.commands.executeCommand(i.command,...(r=i.arguments)!=null?r:[])}const n=m.window.activeTextEditor;if(!!n)return this.telemetryService.sendEvent("command.openFile"),void m.window.showTextDocument(n.document)}),m.commands.registerCommand("remoteHub.createBranch",async e=>{await mc("remoteHub.createBranchFrom",{...e,fromSha:"HEAD"})}),m.commands.registerCommand("remoteHub.createBranchFrom",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await sl(this._scmProviders,je("choose repo for create branch placeholder","Choose which repository to create a new branch on"),je("choose repo for create branch title","Create Branch"));if(n===void 0)return;this.telemetryService.sendEvent("command.createBranchFrom");const i=await this.providerService.getMetadata(n);if(i.accessLevel<Ne.Write){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"no permissions"}),m.window.showErrorMessage(je("no permissions to create branch ","You don't have access to create branches on this repository."));return}let o,c=!1;if(e==null?void 0:e.fromSha)o=e.fromSha,o==="HEAD"&&(o=i.HEAD.sha);else{const O=await fu.show(this.providerService,n,je("choose branch for create placeholder","Choose which branch to create the new branch from"),je("choose branch for create title","Create Branch \u2022 {0}",i.name));if(!O){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"abandoned branch picker"});return}o=O.sha,c=Boolean(O.useIndex)}let l;try{l=await m.window.withProgress({location:m.ProgressLocation.SourceControl},()=>pu(this.providerService,n,o,je("create branch","Please provide a new branch name"),je("create branch placeholder","New branch name"),je("create branch title","Create Branch \u2022 {0}",i.name)))}catch(O){L.error(O),m.window.showErrorMessage(je("unable to create branch","Unable to create the new branch."));return}if(!l){this.telemetryService.sendEvent("command.createBranchFrom.abort",{reason:"abandoned branch name prompt"});return}const d=await this.providerService.switchTo(n,{type:et.Branch,id:l});if(!d)return;const p=await this.changeStore.createChangeset(n);p&&await this.openActionsService.setChangesetToApply(d.uri,p);const S=je("switch to branch prompt open","Switch to Branch"),P=je("switch to branch prompt open in new window","Open in New Window"),I=await m.window.showInformationMessage(je("switch to branch prompt",`Created new branch '{0}'.

Any uncommitted changes will be applied to the new branch.

Do you want to switch to the new branch?`,l),{modal:!0,useCustom:!0},S,P);!I||(d.location=I===P?tr.NewWindow:tr.CurrentWindow,c&&await Y.setMode(d.uri,ue.getIndexDefault(ne.Branch)),await bn(d,{skipChangesPrompt:!0}))}),m.commands.registerCommand("remoteHub.applyPatch",async e=>{if(e=this.getSourceControlFrom(e),(e==null?void 0:e.rootUri)===void 0)return;this.telemetryService.sendEvent("command.applyPatch");let r;const n=m.window.activeTextEditor;if((n==null?void 0:n.document.languageId)!=="diff"){const i=await m.window.showOpenDialog({openLabel:je("open patch","Open Patch"),title:je("open patch","Open Patch"),canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,filters:{Diff:["diff"],Patch:["*","patch"]}});if(i===void 0||i.length===0)return;r=ry.decode(await m.workspace.fs.readFile(i[0]))}else r=n.document.getText();try{await this.changeStore.applyPatch(e.rootUri,r)}catch{m.window.showErrorMessage(je("invalid patch file","Invalid patch file"))}}),m.commands.registerCommand("remoteHub.exportPatch",async e=>{const r=this.getSourceControlFrom(e);if((r==null?void 0:r.rootUri)===void 0)return;let n;Xd(e)&&(n=e.resourceUri),this.telemetryService.sendEvent("command.exportPatch");const i=await this.changeStore.createPatch(r.rootUri,n),o=await m.workspace.openTextDocument({language:"diff",content:i});await m.window.showTextDocument(o)}),m.commands.registerCommand("remoteHub.switchToBranch",async e=>{var r,n;const i=(r=e==null?void 0:e.uri)!=null?r:await sl(this._scmProviders,je("choose repo for switch branch placeholder","Choose which repository to switch branches on"),je("choose repo for switch branch title","Switch to Branch or Tag"));if(i===void 0)return;this.telemetryService.sendEvent("command.switchToBranch");const o=[],c=await this.providerService.getMetadata(i);if(e==null?void 0:e.commands)switch(c.accessLevel>=Ne.Write&&o.push(new wo(Gn({command:"remoteHub.createBranch",title:je("create branch command","$(add) Create New Branch..."),arguments:[{uri:i}]})),new wo(Gn({command:"remoteHub.createBranchFrom",title:je("create branch from command","$(add) Create New Branch from..."),arguments:[{uri:i}]}))),c.HEAD.type){case De.Branch:o.push(new wo(Gn({command:"remoteHub.openOnRemote",title:je("open branch on remote command","$(globe) Open Branch on {0}...",c.provider.name),arguments:[{provider:c.provider,repo:c.repo,branch:c.HEAD.branch.name}]})));break;case De.RemoteBranch:o.push(new wo(Gn({command:"remoteHub.openOnRemote",title:je("open remote branch on remote command","$(globe) Open Remote Branch on {0}...",c.provider.name),arguments:[{provider:c.provider,repo:c.HEAD.branch.remote.repo,branch:c.HEAD.branch.name}]})));break;case De.Tag:o.push(new wo(Gn({command:"remoteHub.openOnRemote",title:je("open tag on remote command","$(globe) Open Tag on {0}...",c.provider.name),arguments:[{provider:c.provider,repo:c.repo,tag:c.HEAD.detached.name}]})));break;case De.Commit:o.push(new wo(Gn({command:"remoteHub.openOnRemote",title:je("open commit on remote command","$(globe) Open Commit on {0}...",c.provider.name),arguments:[{provider:c.provider,repo:c.repo,sha:c.HEAD.sha}]})));break}const l=(n=c.HEAD.branch)==null?void 0:n.name,d=Boolean(l&&!await this.changeStore.hasChanges(i)),p=await fu.show(this.providerService,i,je("choose switch branch placeholder","Choose which branch to switch to"),je("choose switch branch title","Switch to Branch or Tag \u2022 {0}",c.name),o,{allowResetToSha:d,filterBranches:l?S=>S.name!==l:void 0,ignoreFocusOut:!1});if(!p){this.telemetryService.sendEvent("command.switchToBranch.abort",{reason:"abandoned branch picker"});return}return p instanceof wo?void p.execute():d&&p.type===et.Branch&&p.name===l&&p.sha?m.window.withProgress({location:m.ProgressLocation.SourceControl},async()=>{try{await this.providerService.sync(i,this.changeStore,{to:p.sha})}catch(S){L.error(S),m.window.showErrorMessage(je("reset failed","Unable to reset the repository to commit '{0}'.",yt(p.sha)))}}):void m.window.withProgress({location:m.ProgressLocation.SourceControl},async()=>{const S=await this.providerService.switchTo(i,p.name?{type:p.type,id:p.name}:void 0);if(S!==void 0){if(p.useIndex){const P=await this.providerService.getModeRefType(S.uri);await Y.setMode(S.uri,ue.getIndexDefault(P))}return bn(S)}})}),m.commands.registerCommand("remoteHub.fetch",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await sl(this._scmProviders,je("choose repo for fetch placeholder","Choose which repository to fetch"),je("choose repo for fetch title","Fetch Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.fetch");try{await m.window.withProgress({location:m.ProgressLocation.SourceControl},()=>this.providerService.fetch(n,{force:!0}))}catch(i){m.window.showErrorMessage(je("fetch failed","Unable to fetch repository"))}}}),m.commands.registerCommand("remoteHub.fetchAll",async e=>{const r=this.providerService.repositories;if(r.length===0)return;(e==null?void 0:e.automated)||this.telemetryService.sendEvent("command.fetchAll"),(await m.window.withProgress({location:m.ProgressLocation.SourceControl},async()=>{const i=[];for(const o of r)try{await this.providerService.fetch(o.uri)}catch(c){i.push(c)}return i})).length&&!(e==null?void 0:e.automated)&&m.window.showErrorMessage(r.length?je("fetch all failed","Unable to fetch repositories"):je("fetch failed","Unable to fetch repository"))}),m.commands.registerCommand("remoteHub.pull",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await sl(this._scmProviders,je("choose repo for pull placeholder","Choose which repository to pull"),je("choose repo for pull title","Pull Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.pull");try{await this.sync(n,{pull:!0})}catch{}}}),m.commands.registerCommand("remoteHub.sync",async e=>{var r;const n=(r=e==null?void 0:e.uri)!=null?r:await sl(this._scmProviders,je("choose repo for sync placeholder","Choose which repository to sync"),je("choose repo for sync title","Synchronize Repository"));if(n!==void 0){this.telemetryService.sendEvent("command.sync");try{await this.sync(n)}catch{}}}),m.commands.registerCommand("remoteHub.disableCommitDirectlyWarning",()=>{this.telemetryService.sendEvent("command.disableCommitDirectlyWarning"),Y.updateEffective("commitDirectlyWarning",K.Off)})]}async sync(e,{pull:r,...n}={pull:!1}){this.telemetryService.sendEvent("sync");try{await m.window.withProgress({location:m.ProgressLocation.SourceControl},()=>this.providerService.sync(e,this.changeStore,n))}catch(i){if(i instanceof Ut){const o={title:je("sync confirm","Continue")},c={title:je("sync cancel","Cancel"),isCloseAffordance:!0};await m.window.showWarningMessage(r?je("sync pull",`Pulling in changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue pulling in changes.`):je("sync",`Syncing changes may cause conflicts with your uncommitted changes as one of more of those files has changed since you started editing.

Do you want to continue syncing changes?`),{modal:!0,useCustom:!0},o,c)===o?await m.window.withProgress({location:m.ProgressLocation.SourceControl},()=>this.providerService.sync(e,this.changeStore,{conflictResolution:an.Merge})):this.telemetryService.sendEvent("sync.abort",{reason:"abandoned"})}else throw L.error(i),this.telemetryService.sendException(i),m.window.showErrorMessage(je("sync failed","Unable to sync the repository.")),i}}async commitChanges(e){try{await m.window.withProgress({location:m.ProgressLocation.SourceControl},()=>this.commitChangesCore(e))}catch(r){if(r instanceof vt){m.window.showInformationMessage(je("no changes to commit","There are no changes to commit."));return}L.error(r),m.window.showErrorMessage(je("commit unable","Unable to commit.")),this.telemetryService.sendException(r)}}async commitChangesCore(e){const r=e.rootUri;this.telemetryService.sendEvent("commit",{staging:String(this.staging.enabled)});const n=new lt(`VirtualSourceControl.commitChanges(${r.toString()})`);let i;try{const o=await this.providerService.getMetadata(r);let c,l;const d=this.staging.enabled?this.staging.smart?"auto":!0:!1;for(;;){const S=e.inputBox.value;if(await this.changeStore.hasMergeConflicts(r)){e.inputBox.showValidationMessage(je("commit resolve conflicts","You must resolve any pending conflicts before committing."),m.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("commit.abort",{reason:"aborted conflicts"}),i=": Aborted; Unresolved conflicts";return}const P=await this.providerService.getCommitOperations(r,this.changeStore,{staged:d});if(P.length===0){e.inputBox.showValidationMessage(this.staging.enabled?je("commit no staged changes","There are no staged changes to commit."):je("commit no changes","There are no changes to commit."),m.SourceControlInputBoxValidationType.Information),this.telemetryService.sendEvent("commit.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"}),i=`: Aborted; No ${this.staging.enabled?"staged ":""}changes`;return}if(!S){e.inputBox.showValidationMessage(je("specify commit message","You must specify a commit message before committing."),m.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("commit.abort",{reason:"aborted no message"}),i=": Aborted; No message";return}let I,O;if(o.HEAD.type===De.RemoteBranch?(O=o.HEAD.branch.remote.accessLevel<Ne.Write,I=O&&o.accessLevel<Ne.Write):(I=o.accessLevel<Ne.Write,O=I),l===void 0&&I&&(l=await this.providerService.getFork(r),l===void 0)){const F={title:je("fork confirm","Fork Repository")},N={title:je("cancel","Cancel"),isCloseAffordance:!0};if(await m.window.showInformationMessage(je("fork","You\u2019re trying to make changes in a project you don\u2019t have write access to. Do you want to create a fork of this project to commit your proposed changes to?"),{modal:!0,useCustom:!0},F,N)!==F){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned fork prompt"}),i=": Aborted; Abandoned fork prompt";return}if(l=await m.window.withProgress({location:m.ProgressLocation.Notification,title:je("fork progress","Forking {0}...",o.name)},()=>this.providerService.fork(r)),l===void 0){m.window.showErrorMessage(je("unable to fork","Unable to fork repository.")),this.telemetryService.sendEvent("commit.abort",{reason:"aborted fork failed"}),i=": Aborted; Fork failed";return}}if(l||O){if(l===void 0){const N={title:je("remote branch create branch prompt confirm","Commit to New Branch")},U={title:je("cancel","Cancel"),isCloseAffordance:!0};if(await m.window.showErrorMessage(je("remote branch create branch prompt",`You\u2019re trying to make changes to a branch you don\u2019t have write access to.

Do you want to commit your changes to a new branch?`),{modal:!0,useCustom:!0},N,U)!==N){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned remote branch prompt"}),i=": Aborted; Abandoned commit to new branch prompt";return}}let F=0;try{const N=await this.providerService.getBranches(l?this.providerService.createVirtualUri(r,l):r,{query:"patch-"});for(const U of N.branches){const W=/^patch-(?<num>\d+)$/.exec(U.name);if(W==null?void 0:W.groups){const V=Number(W.groups.num);V>F&&(F=V)}}}catch{}if(c=await pu(this.providerService,r,o.HEAD.sha,je("create new branch prompt","Create a new branch to commit your changes to"),je("create new branch placeholder","New branch name"),je("create new branch title","Commit \u2022 Create Branch \u2022 {0}",l?l.name:o.name),l,`patch-${F+1}`),!c){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned create branch prompt"}),i=": Aborted; Abandoned create branch prompt";return}}try{if(Y.getUseNewCommitApi())await this.providerService.createAndPushCommit(r,S,P,c,l);else{n.logStep("Creating commit");const F=await this.providerService.createCommit(r,S,P,l);n.logStep("Pushing",{message:`: Created commit ${F}`,suffix:" \u2022 Pushing..."}),await this.providerService.pushCommit(r,F,c,l)}}catch(F){if(F instanceof It){const N={title:je("detached head prompt confirm","Commit to New Branch")},U={title:je("cancel","Cancel"),isCloseAffordance:!0};if(await m.window.showErrorMessage(je("detached head prompt",`Unable to commit your changes because you are not currently on a branch.

Do you want to commit your changes to a new branch?`),{modal:!0},N,U)!==N){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned detached head prompt"}),i=": Aborted; Abandoned commit to new branch prompt (detached head)";return}if(c=await pu(this.providerService,r,o.HEAD.sha,je("create new branch prompt","Create a new branch to commit your changes to"),je("create new branch placeholder","New branch name"),je("create new branch title","Commit \u2022 Create Branch \u2022 {0}",l?l.name:o.name),l),!c){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned detached head create branch prompt"}),i=": Aborted; Abandoned create branch prompt (detached head)";return}continue}else if(F instanceof Me){const N={title:je("push conflicts prompt pull","Pull")},U={title:je("push conflicts prompt sync","Sync (Pull & Push)")},W={title:je("cancel","Cancel"),isCloseAffordance:!0},V=await m.window.showErrorMessage(je("push conflicts prompt",`Changes have been committed since you started editing, so you must merge those changes before you can commit.

Do you want to pull or sync (pull and automatically push) your changes?`),{modal:!0},N,U,W);if(V!==N&&V!==U){this.telemetryService.sendEvent("commit.abort",{reason:"abandoned conflicts prompt"}),i=": Aborted; Abandoned merge changes prompt";return}if(await this.sync(r,{pull:V===N,conflictResolution:an.Merge}),V===N){i=': Aborted; Chose "pull" from merge changes prompt';return}continue}else throw L.error(F),i=`: Aborted; ${String(F)}`,F}break}if(e.inputBox.value="",l?await this.changeStore.discardAll(r,{staged:d}):await this.changeStore.acceptAll(r,{staged:d}),th(qa.HasCommitted,!0),!l&&!c)return;async function p(){if(l){const O={title:je("commit to fork confirm","Switch to Fork")},F={title:je("cancel","Cancel"),isCloseAffordance:!0},N=await m.window.showInformationMessage(je("commit to fork","Committed changes to your fork of {0}. Do you want to switch to your fork to continue making changes?",o.name),{modal:!0,useCustom:!0},O,F);if(this.telemetryService.sendEvent("commit.switchToFork",{confirm:String(N===O)}),N===O){let U;c!==void 0?U={type:et.Branch,id:c}:o.HEAD.branch!==void 0&&(U={type:et.Branch,id:o.HEAD.branch.name}),bn({name:l.name,uri:this.providerService.createVirtualUri(r,{repo:l.repo,ref:U}),location:tr.CurrentWindow})}return}const S={title:je("commit to new branch confirm","Switch to Branch")},P={title:je("cancel","Cancel"),isCloseAffordance:!0},I=await m.window.showInformationMessage(je("commit to new branch","Committed changes to new branch '{0}'. Do you want to switch to the new branch to continue making changes?",c),{modal:!0,useCustom:!0},S,P);this.telemetryService.sendEvent("commit.switchToBranch",{confirm:String(I===S)}),I===S&&bn({name:o.name,uri:this.providerService.createVirtualUri(r,{repo:o.repo,ref:c?{type:et.Branch,id:c}:void 0}),location:tr.CurrentWindow})}a(p,"showSwitchToPrompt"),p.call(this)}finally{n.stop(i?{message:i}:void 0)}}async createPullRequest(e,r){try{await m.window.withProgress({location:m.ProgressLocation.SourceControl},()=>this.createPullRequestCore(e,r))}catch(n){if(n instanceof vt){m.window.showInformationMessage(je("no changes to commit","There are no changes to commit."));return}if(n instanceof wr){m.window.showErrorMessage(je("commit unable","Unable to commit."));return}L.error(n),m.window.showErrorMessage(je("unable to open pr","Unable to open a pull request.")),this.telemetryService.sendException(n)}}async createPullRequestCore(e,r){var n,i;const o=e.rootUri,c=(n=r==null?void 0:r.draft)!=null?n:!1;this.telemetryService.sendEvent("createPullRequest",{draft:String(c),staging:String(this.staging.enabled)});const l=new lt(`VirtualSourceControl.createPullRequest(${o.toString()})`);let d;try{let p=a(function(){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned branch prompt"}),d=": Aborted; Abandoned commit to new branch prompt"},"handleBranchNotCreated"),S;const P=this.staging.enabled?this.staging.smart?"auto":!0:!1;if(!(r==null?void 0:r.sha)){if(await this.changeStore.hasMergeConflicts(o)){e.inputBox.showValidationMessage(je("commit resolve conflicts","You must resolve any pending conflicts before committing."),m.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted conflicts"}),d=": Aborted; Unresolved conflicts";return}if(S=await this.providerService.getCommitOperations(o,this.changeStore,{staged:this.staging.enabled?this.staging.smart?"auto":!0:!1}),S.length===0){e.inputBox.showValidationMessage(this.staging.enabled?je("commit no staged changes","There are no staged changes to commit."):je("commit no changes","There are no changes to commit."),m.SourceControlInputBoxValidationType.Information),this.telemetryService.sendEvent("createPullRequest.abort",{reason:this.staging.enabled?"aborted no staged changes":"aborted no changes"}),d=`: Aborted; No ${this.staging.enabled?"staged ":""}changes`;return}}const I=e.inputBox.value;if(!I){e.inputBox.showValidationMessage(je("specify commit message","You must specify a commit message before committing."),m.SourceControlInputBoxValidationType.Error),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted no message"}),d=": Aborted; No message";return}const O=await this.providerService.getMetadata(o);let F,N;O.HEAD.type===De.RemoteBranch?(N=O.HEAD.branch.remote.accessLevel<Ne.Write,F=N&&O.accessLevel<Ne.Write):(F=O.accessLevel<Ne.Write,N=F);let U=r==null?void 0:r.fork;if(U===void 0&&F&&(U=await this.providerService.getFork(o),U===void 0)){const ke={title:je("fork confirm","Fork Repository")},Re={title:je("cancel","Cancel"),isCloseAffordance:!0};if(await m.window.showInformationMessage(je("fork",`You\u2019re trying to make changes in a project you don\u2019t have write access to.

Do you want to create a fork of this project to commit your proposed changes to?`),{modal:!0,useCustom:!0},ke,Re)!==ke){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned fork prompt"}),d=": Aborted; Abandoned fork prompt";return}if(U=await m.window.withProgress({location:m.ProgressLocation.Notification,title:je("fork progress","Forking {0}...",O.name)},()=>this.providerService.fork(o)),U===void 0){m.window.showErrorMessage(je("unable to fork","Unable to fork repository.")),this.telemetryService.sendEvent("createPullRequest.abort",{reason:"aborted fork failed"}),d=": Aborted; Fork failed";return}}const W=await m.window.showInputBox({ignoreFocusOut:!0,placeHolder:je("create pr placeholder","Pull request title"),prompt:je("create pr prompt","Enter a title for the new pull request"),title:je("create pr title","New Pull Request"),value:I});if(!W){this.telemetryService.sendEvent("createPullRequest.abort",{reason:"abandoned title prompt"}),d=": Aborted; Abandoned title prompt";return}async function V(ke){let Re=0;try{const Ie=await this.providerService.getBranches(U?this.providerService.createVirtualUri(o,U):o,{query:"patch-"});for(const Ye of Ie.branches){const $e=/^patch-(?<num>\d+)$/.exec(Ye.name);if($e==null?void 0:$e.groups){const ze=Number($e.groups.num);ze>Re&&(Re=ze)}}}catch{}return pu(this.providerService,o,ke,je("create pr branch prompt","Create a new branch for this pull request"),je("create pr branch placeholder","New branch name"),je("create pr branch title","New Pull Request \u2022 Create Branch \u2022 {0}",U?U.name:O.name),U,`patch-${Re+1}`)}a(V,"createBranch");let ie;if(Y.getUseNewCommitApi()){if(ie=await V.call(this,O.HEAD.sha),!ie){p.call(this);return}(S==null?void 0:S.length)&&await this.providerService.createAndPushCommit(o,I,S,ie,U)}else{let ke;if((S==null?void 0:S.length)?(ke=await this.providerService.createCommit(o,I,S,U),l.log({message:`: Created commit ${ke}`})):(ke=(i=r==null?void 0:r.sha)!=null?i:O.HEAD.sha,l.log({message:`: Using commit ${ke}`})),ie=await V.call(this,ke),!ie){p.call(this);return}}const oe=await this.providerService.createPullRequest(o,ie,W,{draft:c},U);e.inputBox.value="",(S==null?void 0:S.length)&&(U?await this.changeStore.discardAll(o,{staged:P}):await this.changeStore.acceptAll(o,{staged:P}));async function ge(){const ke={title:je("created pr notification confirm","Switch to Pull Request")},Re={title:je("cancel","Cancel"),isCloseAffordance:!0},Ie=await m.window.showInformationMessage(je("created pr notification",'Created [Pull Request #{0}]({1} "Open Pull Request #{0} on {2}") for {3}. Do you want to switch to the new pull request?',oe.id,oe.uri.toString(!0),O.provider.name,O.name),{modal:!0,useCustom:!0},ke,Re);this.telemetryService.sendEvent("createPullRequest.switchToPullRequest",{confirm:String(Ie===ke)}),Ie===ke&&bn({name:O.name,uri:this.providerService.createVirtualUri(o,{repo:O.repo,ref:{type:et.PullRequest,id:oe.id}}),location:tr.CurrentWindow})}a(ge,"showSwitchToPrompt"),ge.call(this)}finally{l.stop(d?{message:d}:void 0)}}async update(e){const r=m.workspace.getWorkspaceFolder(e);if(r===void 0)return;const n=await this.createOrUpdateScmProvider(e,r.name),i=await this.changeStore.getGroupedChanges(e,{predicate:d=>d.fileType===m.FileType.File}),o=await Promise.all(i.conflicts.map(async d=>({type:d.type,resourceUri:d.uri,command:await this.changeStore.resolveDiffCommand(d.uri,d.conflicts.incomingUri,je("diff title with conflicts","{0} (Incoming Changes \u2194 Current Changes)",de(d.uri)))}))),c=await Promise.all(i.staged.map(async d=>({type:d.type,resourceUri:d.uri,command:await this.changeStore.resolveDiffCommand(d.uri,this.providerService.getProviderUri(d.uri),je("diff title index","{0} (Index)",de(d.uri)))}))),l=await Promise.all(i.working.map(async d=>({type:d.type,resourceUri:d.uri,decorations:{strikeThrough:d.type===Dt.Deleted},command:await this.changeStore.resolveDiffCommand(d.uri,this.providerService.getProviderUri(d.uri),je("diff title working","{0} (Working Tree)",de(d.uri)))})));return this.ensureMergeConflictsGroup(n).resourceStates=o,this.ensureStagedChangesGroup(n).resourceStates=this.staging.enabled?c:[],this.ensureWorkingChangesGroup(n).resourceStates=this.staging.enabled?l:[...c,...l],n}async createOrUpdateScmProvider(e,r){const n=await this.providerService.getMetadata(e),i=this.providerService.isReadonly(e);let o;const c=n.HEAD.branch?n.HEAD.name:void 0;let l=this.getScmProvider(e);if(l===void 0){r=n.name,o=m.scm.createSourceControl(`remoteHub:${n.provider.id}`,r,e),o.quickDiffProvider={provideOriginalResource:p=>this.providerService.getProviderUri(p)};const d=this.providerService.createIGitRepository(e,o,n,this.changeStore);l={id:n.provider.id,name:n.provider.name,sourceControl:o,groups:[],repository:d,isReadonly:i},this.ensureMergeConflictsGroup(l),this.ensureStagedChangesGroup(l),this.ensureWorkingChangesGroup(l),this._scmProviders.push(l)}else o=l.sourceControl;return n.accessLevel>=Ne.Write?(o.acceptInputCommand={command:"remoteHub.commit",title:je("scm input accept command title commit","Commit"),arguments:[o]},c?o.inputBox.placeholder=je("scm input placeholder commit","Message (Ctrl+Enter to commit directly to '{0}' on {1})",c,n.provider.name):o.inputBox.placeholder=je("scm input placeholder commit","Message (Ctrl+Enter to commit directly to {0})",n.provider.name),Y.get("commitDirectlyWarning")===K.Off?o.inputBox.validateInput=void 0:o.inputBox.validateInput=d=>{if(Y.get("commitDirectlyWarning")===K.Auto&&Pp(qa.HasCommitted))return;const p=new m.MarkdownString(c?je("scm input validation commit branch directly","Your changes will be committed directly to the '{0}' branch on {1}.",c,n.provider.name):je("scm input validation commit directly","Your changes will be committed directly to {0}.",n.provider.name));return p.isTrusted=!0,p.appendMarkdown(`&nbsp; [${je("scm input validation action","Don't show again")}](command:remoteHub.disableCommitDirectlyWarning '${je("scm input validation action tip","Hide")}')`),{message:p,type:m.SourceControlInputBoxValidationType.Information}}):i?(o.acceptInputCommand=void 0,o.inputBox.placeholder=je("scm input readonly placeholder","Committing is not available for readonly repositories.")):(o.acceptInputCommand={command:"remoteHub.createPullRequest",title:je("scm input accept command title pr","Create a Pull Request"),arguments:[o]},o.inputBox.placeholder=je("scm input placeholder pr","Message (Ctrl+Enter to create a pull request for '{0}'",r)),await this.updateStatusBarCommands(l,{syncing:!1},n),l}async updateStatusBarCommands(e,r,n){var i,o,c;const l=e.sourceControl.rootUri;n=n!=null?n:await this.providerService.getMetadata(l);const{HEAD:d}=n,p=await this.providerService.getIndexMetadata(l),S=(p==null?void 0:p.type)===ft.Active,P=(p==null?void 0:p.type)===ft.Active,I=ft.hasIndex(p==null?void 0:p.type),O=await this.changeStore.hasChanges(l),F=Kd(d.type),N=[];if(N.push(Gn({command:"remoteHub.switchToBranch",title:`${F} ${d.name}${O?"*":""}`,tooltip:`${yt(d.sha)}`,arguments:[{uri:l,commands:!0}]})),d.detached||((r==null?void 0:r.syncing)?N.push(Gn({command:"",title:"$(sync~spin)",tooltip:je("sync command syncing","Syncing Changes..."),arguments:[]})):N.push(Gn({command:"remoteHub.sync",title:`$(sync)${((o=(i=n.state)==null?void 0:i.behind)!=null?o:0)>0?` ${(c=n.state)==null?void 0:c.behind}\u2193`:""}`,tooltip:S||P?je("sync index","Sync to latest indexed commit"):je("sync command","Sync (Pull & Push)"),arguments:[{uri:l}]}))),n.pullRequest&&N.push(Gn({command:"remoteHub.openOnRemote",title:`$(git-pull-request) ${n.pullRequest.id}`,tooltip:je("scm statusbar command open pr",`Open Pull Request #{0} on {1}

{2}`,n.pullRequest.id,n.provider.name,n.pullRequest.title),arguments:[{provider:n.provider,repo:n.repo,pullRequest:{id:n.pullRequest.id}}]})),I){const U=this.providerService.getIndexProvider(l);U&&N.push(...await U.getStatusBarContributions(l))}e.sourceControl.statusBarCommands=N}ensureMergeConflictsGroup(e){const r="conflicts";let n=e.groups.find(i=>i.id===r);return n===void 0&&(n=e.sourceControl.createResourceGroup(r,je("scm group conflicts","Merge Conflicts")),n.hideWhenEmpty=!0,e.groups.push(n)),n}ensureStagedChangesGroup(e){const r="staged";let n=e.groups.find(i=>i.id===r);return n===void 0&&(n=e.sourceControl.createResourceGroup(r,je("scm group staged","Staged Changes")),n.hideWhenEmpty=!0,e.groups.push(n)),n}ensureWorkingChangesGroup(e){const r="changes";let n=e.groups.find(i=>i.id===r);return n===void 0&&(n=e.sourceControl.createResourceGroup(r,je("scm group changes","Changes")),e.groups.push(n)),n}getScmProvider(e){const r=te(e);return this._scmProviders.find(n=>te(n.sourceControl.rootUri)===r)}getSourceControlFrom(e){if(e===void 0){if(this._scmProviders.length!==1)return;e=this._scmProviders[0].sourceControl}let r;if(ny(e))r=e;else if(mp(e)){const n=e,i=this._scmProviders.find(o=>o.groups.includes(n));r=i==null?void 0:i.sourceControl}else if(Xd(e)){const n=e,i=this._scmProviders.find(o=>o.groups.some(c=>c.resourceStates.includes(n)));r=i==null?void 0:i.sourceControl}else{if(this._scmProviders.length!==1)return;r=this._scmProviders[0].sourceControl}return r}}a(gp,"VirtualSourceControl");function ny(t){return"rootUri"in t&&"inputBox"in t}a(ny,"isSourceControl");function mp(t){return t!==void 0&&"id"in t&&"label"in t&&"resourceStates"in t&&Array.isArray(t.resourceStates)}a(mp,"isSourceControlResourceGroup");function Xd(t){return t!==void 0&&"resourceUri"in t&&t.resourceUri instanceof m.Uri}a(Xd,"isSourceControlResourceState");function al(t){return"type"in t}a(al,"isTrackedChange");async function Qd(t){var e,r,n;if(t.length===0)return!0;let i,o=je("discard","Discard Changes");if(t.length===1){const l=t[0];l.type===Dt.Created?(i=je("confirm delete",`Are you sure you want to DELETE {0}?
This is IRREVERSIBLE!
This file will be FOREVER LOST.`,de((e=l.resourceUri)!=null?e:l.uri)),o=je("delete file","Delete file")):l.type===Dt.Deleted?(o=je("restore file","Restore file"),i=je("confirm restore","Are you sure you want to restore {0}?",de((r=l.resourceUri)!=null?r:l.uri))):i=je("confirm discard","Are you sure you want to discard changes in {0}?",de((n=l.resourceUri)!=null?n:l.uri))}else t.every(l=>l.type===Dt.Created)?i=je("confirm delete multiple",`Are you sure you want to DELETE {0} files?
This is IRREVERSIBLE!
These files will be FOREVER LOST.`,t.length):t.every(l=>l.type===Dt.Deleted)?(o=je("restore files","Restore files"),i=je("confirm restore multiple","Are you sure you want to restore {0} files?",t.length)):i=je("confirm discard multiple","Are you sure you want to discard changes in {0} files?",t.length);return await m.window.showWarningMessage(i,{modal:!0,useCustom:!0},o)===o}a(Qd,"confirmDiscard");async function sl(t,e,r){if(t.length===0)return;if(t.length===1)return t[0].sourceControl.rootUri;const n=await m.window.showQuickPick(t.map(({sourceControl:i})=>({label:i.label,uri:i.rootUri})),{placeHolder:e,title:r});if(!!n)return n.uri}a(sl,"getOrPickRootUri");async function pu(t,e,r,n,i,o,c,l){const d=new Set;let p;const S=m.window.createInputBox();S.ignoreFocusOut=!0;try{return await new Promise((P,I)=>{p=m.Disposable.from(S.onDidHide(()=>P(void 0)),S.onDidChangeValue(O=>{if(O=O.trim(),!O){S.validationMessage=je("scm create branch prompt validation missing name","Please enter a valid branch name");return}if(d.has(O)){S.validationMessage=je("scm create branch prompt validation already exists","Branch '{0}' already exists",O);return}if(!kr(O)){S.validationMessage=je("scm create branch prompt validation invalid name","'{0}' isn't a valid branch name",O);return}S.validationMessage=void 0}),S.onDidAccept(async()=>{const O=S.value;try{S.enabled=!1,S.busy=!0;const F=await t.createBranch(e,O,r,c);P(F)}catch(F){if(F instanceof Be){S.enabled=!0,S.busy=!1,S.validationMessage=F.duplicate?je("scm create branch prompt validation already exists","Branch '{0}' already exists",O):je("scm create branch prompt validation invalid","Invalid branch name '{0}'",O),d.add(O);return}I(F)}})),S.prompt=n,S.placeholder=i,S.title=o,l&&(S.value=l),S.show()})}finally{S.dispose(),p==null||p.dispose()}}a(pu,"createBranchWithPrompt");class gu{constructor(e,r){this.memento=e,this.scope=r,this._onDidChange=new m.EventEmitter}get onDidChange(){return this._onDidChange.event}async get(e){const r=this.getScoped(e),n=new lt(`MementoStorage.get(${e}): scopedKey=${r}`,{logLevel:qe.Debug});try{return await Promise.resolve(this.memento.get(r))}finally{n.stop()}}async getKeys(e){const r=this.getScoped(e),n=new lt(`MementoStorage.getKeys(${e}): scopedPrefix=${r}`,{logLevel:qe.Debug});try{let i=this.getKeysCore(e);if(this.scope!==void 0){const o=this.scope.length+1;i=i.map(c=>c.substr(o))}return await Promise.resolve(i)}finally{n.stop()}}getKeysCore(e){let r=this.memento.keys();return e&&(r=r.filter(n=>n.startsWith(e))),r}async store(e,r){const n=this.getScoped(e),i=new lt(`MementoStorage.store(${e}): scopedKey=${n}`,{logLevel:qe.Debug});try{return await this.storeCore(e,n,r)}finally{i.stop()}}async storeCore(e,r,n){await this.memento.update(r,n),this._onDidChange.fire({key:e})}async delete(e){const r=this.getScoped(e),n=new lt(`MementoStorage.delete(${e}): scopedKey=${r}`,{logLevel:qe.Debug});try{return await this.storeCore(e,r,void 0)}finally{n.stop()}}async deleteKeys(e){const r=this.getScoped(e),n=new lt(`MementoStorage.deleteKeys(${e}): scopedPrefix=${r}`,{logLevel:qe.Debug});try{const i=[],o=this.scope!==void 0?this.scope.length+1:0,c=this.getKeysCore(r);for(const l of c){const d=o!==0?l.substr(o):l;L.debug(`MementoStorage.deleteKeys(${e}): Deleting key=${d}, scopedKey=${l}`);try{await this.storeCore(d,l,void 0)}catch(p){L.debug(`MementoStorage.deleteKeys(${e}): Failed to delete key=${d}, scopedKey=${l}`),i.push(d)}}if(i.length)throw new Error(`Failed to delete keys: ${i.join(", ")}`)}finally{n.stop()}}with(e){return new gu(this.memento,e)}getScoped(e){return`${this.scope!==void 0?`${this.scope}/`:""}${e!=null?e:""}`}}a(gu,"MementoStorageService");class mu{constructor(e,r){this.storageUri=e,this.scope=r,this._onDidChange=new m.EventEmitter}get onDidChange(){return this._onDidChange.event}async get(e){const r=this.getScoped(e),n=new lt(`ExtFileStorageService.get(${e}): scopedKey=${r}`,{logLevel:qe.Debug});try{return await m.workspace.fs.readFile(m.Uri.joinPath(this.storageUri,r))}catch(i){return}finally{n.stop()}}async store(e,r){const n=this.getScoped(e),i=new lt(`ExtFileStorageService.store(${e}): scopedKey=${n}`,{logLevel:qe.Debug});try{return await this.storeCore(e,n,r)}finally{i.stop()}}async storeCore(e,r,n){await m.workspace.fs.writeFile(m.Uri.joinPath(this.storageUri,r),n),this._onDidChange.fire({key:e})}async delete(e){const r=this.getScoped(e),n=new lt(`ExtFileStorageService.delete(${e}): scopedKey=${r}`,{logLevel:qe.Debug});try{return await m.workspace.fs.delete(m.Uri.joinPath(this.storageUri,r))}finally{n.stop()}}with(e){return new mu(this.storageUri,e)}getScoped(e){return`${this.scope!==void 0?`${this.scope}/`:""}${e}`}}a(mu,"ExtFileStorageService");const xr=(0,B.loadMessageBundle)();class to extends m.TimelineItem{static is(e){return e instanceof to}constructor(e,r,n,i,{dateType:o,showAuthor:c,dateFormatter:l}){var d;const p=n.message.indexOf(`
`),S=p!==-1?`${n.message.substring(0,p)} \u2026`:n.message,P=o==="authored"?n.authorDate:n.commitDate;super(S,(d=P==null?void 0:P.getTime())!=null?d:0);this.id=n.hash,this.contextValue=`vscode-vfs:${r}:file:commit`,this.command=i,c&&(this.description=n.authorName),this.detail=xr("timeline item detail",`{0} ({1}) \u2014 {2}
{3}

{4}`,n.authorName,n.authorEmail,yt(n.hash),l.format(P),n.message),this.iconPath=new m.ThemeIcon("git-commit"),this.rootUri=e,this.providerId=r,this.hash=n.hash,this.parents=n.parents,this.message=n.message}}a(to,"CommitTimelineItem");class ja extends m.TimelineItem{static is(e){return e instanceof ja}constructor(e,r,n,i,o,{dateFormatter:c,staged:l}){const d=l?xr("timeline staged changes","Staged Changes"):xr("timeline uncommitted changes","Uncommitted Changes");super(d,n.timestamp);this.id=l?"index":"working",this.contextValue=`vscode-vfs:${r}:file:${this.id}`,this.command=o,this.iconPath=new m.ThemeIcon("git-commit"),l?this.detail=xr("timeline index detail",`{0}  \u2014 {1}
{2}

{3}`,xr("timeline you","You"),xr("timeline index","Index"),c.format(new Date(n.timestamp)),_l(n.type)):this.detail=xr("timeline working detail",`{0}  \u2014 {1}
{2}

{3}`,xr("timeline you","You"),xr("timeline working","Working Tree"),c.format(new Date(n.timestamp)),_l(n.type)),this.rootUri=e,this.providerId=r,this.hash=l?"~":"",this.parents=i,this.message=d}}a(ja,"ChangeOperationTimelineItem");class vp{constructor(e,r){this.providerService=e,this.changeStore=r,this._onDidChange=new m.EventEmitter,this.id="github-file-history",this.label=xr("timeline.source","GitHub File History"),this.debouncer=new ds(500),this.disposable=m.Disposable.from(this.debouncer,e.onDidChangeProviders(this.onProvidersChanged,this),e.onDidChangeRepositories(this.onRepositoriesChanged,this),e.onDidChangeRepository(this.onRepositoryChanged,this),e.onDidRefresh(this.onRefresh,this),r.onDidChange(this.onUrisChanged,this),Y.onDidChangeAny(this.onConfigurationChanged,this),...this.registerCommands()),e.hasProviders&&this.ensureProviderRegistration()}get onDidChange(){return this._onDidChange.event}dispose(){var e;(e=this.providerDisposable)==null||e.dispose(),this.disposable.dispose()}onConfigurationChanged(e){(e.affectsConfiguration("git.timeline.date")||e.affectsConfiguration("git.timeline.showAuthor"))&&this.fireChanged()}onProvidersChanged(e){this.ensureProviderRegistration(),this.fireChanged()}onRefresh(e){if(this.rootUri===void 0)return;const r=te(this.rootUri);!e.some(n=>te(n)===r)||this.fireChanged()}onRepositoriesChanged(e){if(this.rootUri===void 0)return;const r=te(this.rootUri);(e.added.some(n=>te(n.uri)===r)||e.removed.some(n=>te(n.uri)===r))&&this.fireChanged()}onRepositoryChanged(e){this.rootUri===void 0||te(this.rootUri)!==te(e.repository.uri)||this.fireChanged()}onUrisChanged(e){if(this.rootUri===void 0)return;const r=te(this.rootUri);e.some(n=>te(n.rootUri)===r)&&this.fireChanged()}async provideTimeline(e,r,n){var i;try{this.rootUri=this.providerService.getVirtualRootUri(e);for(const F of this.providerService.repositories)if(F.uri.path===this.rootUri.path){this.rootUri=F.uri;break}const o=this.providerService.getRelativeFilePath(this.rootUri,e),c=await this.providerService.getMetadata(this.rootUri);if(!c||n.isCancellationRequested)return{items:[]};const l=await this.providerService.getCommits(this.rootUri,{ref:c.HEAD.sha,path:o||void 0,cursor:r.cursor,limit:typeof r.limit=="number"?r.limit:void 0});if(l===void 0||l.commits.length===0||n.isCancellationRequested)return{items:[]};const d=((i=l.paging)==null?void 0:i.more)?{cursor:l.paging.cursor}:void 0,p=new Intl.DateTimeFormat(m.env.language,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}),S=Y.getAny("git.timeline.date",void 0,"committed"),P=Y.getAny("git.timeline.showAuthor",void 0,!0),I=l.commits.map(F=>new to(this.rootUri,c.provider.id,F,this.resolveDiffCommand(F,c,e,o),{dateType:S,showAuthor:P,dateFormatter:p})),O=r.cursor===void 0?await this.changeStore.getChange(e):void 0;if(O){const F=Boolean(O.staged&&Y.get("staging.enabled")),N=new ja(this.rootUri,c.provider.id,O,[l.commits[0].hash],await this.changeStore.resolveDiffCommand(O.uri,this.providerService.getProviderUri(O.uri),F?xr("diff title index","{0} (Index)",de(O.uri)):xr("diff title working","{0} (Working Tree)",de(O.uri))),{dateFormatter:p,staged:F});I.splice(0,0,N)}return{items:I,paging:d}}catch(o){return L.error(o),{items:[]}}}ensureProviderRegistration(){this.providerDisposable===void 0&&(this.providerDisposable=m.workspace.registerTimelineProvider([Xt.scheme,...this.providerService.registeredProviders.map(e=>e.id)],this))}fireChanged(){this.debouncer.debounce(()=>this._onDidChange.fire(void 0))}registerCommands(){let e;return[m.commands.registerCommand("remoteHub.timeline.copyCommitId",(r,n,i)=>{!to.is(r)||m.env.clipboard.writeText(r.hash)}),m.commands.registerCommand("remoteHub.timeline.copyCommitMessage",(r,n,i)=>{!to.is(r)||m.env.clipboard.writeText(r.message)}),m.commands.registerCommand("remoteHub.timeline.openDiff",async(r,n,i)=>{var o;!to.is(r)&&!ja.is(r)||r.command!==void 0&&await m.commands.executeCommand(r.command.command,...(o=r.command.arguments)!=null?o:[])}),m.commands.registerCommand("remoteHub.timeline.openOnGitHub",async r=>{await this.openOnRemote(r)}),m.commands.registerCommand("remoteHub.timeline.openOnAzureRepos",async r=>{await this.openOnRemote(r)}),m.commands.registerCommand("remoteHub.timeline.selectForCompare",async(r,n,i)=>{!n||!to.is(r)&&!ja.is(r)||(e={uri:n,left:r},await m.commands.executeCommand("setContext","remoteHub.timeline.selectedForCompare",!0))}),m.commands.registerCommand("remoteHub.timeline.compareWithSelected",async(r,n,i)=>{if(!n||!e||!to.is(r)&&!ja.is(r)||te(n)!==te(e.uri))return;const{left:o}=e,c=this.providerService.getRelativeFilePath(r.rootUri,n),l=await this.providerService.getMetadata(r.rootUri),d=de(n),p=o.parents[0];let S;p===void 0?S=xr("timeline diff title ref","{0} ({1})",d,yt(r.hash)):o.hash===""?S=xr("timeline diff title working","{0} (Working Tree)",d):o.hash==="~"?S=xr("timeline diff title index","{0} (Index)",d):S=xr("timeline diff title ref","{0} ({1})",d,yt(o.hash));let P=o.hash===""||o.hash==="~"?n:this.providerService.createProviderUri(n,{repo:l.repo,ref:{type:et.Commit,id:p!=null?p:"0000000000000000000000000000000000000000"}},c);p===void 0&&(P=P.with({query:"~"}));const I=r.parents[0];let O;I===void 0?O=xr("timeline diff title ref","{0} ({1})",d,yt(r.hash)):I==="~"&&r.hash===""?O=xr("timeline diff title working","{0} (Working Tree)",d):r.hash==="~"?O=xr("timeline diff title index","{0} (Index)",d):O=xr("timeline diff title ref","{0} ({1})",d,yt(r.hash));const F=xr("timeline diff title","{0} \u27F7 {1}",S,O),N=r.hash===""||r.hash==="~"?n:this.providerService.createProviderUri(n,{repo:l.repo,ref:{type:et.Commit,id:r.hash}},c);await m.commands.executeCommand("vscode.diff",P,N,F)})]}resolveDiffCommand(e,r,n,i,o){const c=de(n),l=e.parents[0];let d;l===void 0?d=xr("timeline diff title ref","{0} ({1})",c,yt(e.hash)):e.hash===""?d=xr("timeline diff title working","{0} (Working Tree)",c):e.hash==="~"?d=xr("timeline diff title index","{0} (Index)",c):d=xr("timeline diff title refs","{0} ({1}) \u27F7  {0} ({2})",c,yt(l),yt(e.hash));let p=this.providerService.createProviderUri(n,{repo:r.repo,ref:{type:et.Commit,id:l!=null?l:"0000000000000000000000000000000000000000"}},i);l===void 0&&(p=p.with({query:"~"}));const S=e.hash===""||e.hash==="~"?n:this.providerService.createProviderUri(n,{repo:r.repo,ref:{type:et.Commit,id:e.hash}},i);return{command:"vscode.diff",title:"Open Comparison",arguments:[p,S,d,o]}}async openOnRemote(e){if(!to.is(e))return;const r=await this.providerService.getMetadata(e.rootUri);await mc("remoteHub.openOnRemote",{provider:r.provider,repo:r.repo,sha:e.hash})}}a(vp,"VirtualTimelineProvider");class yp{constructor(e,r){this.providerService=e,this.telemetryService=r,this.disposable=m.window.registerUriHandler(this)}dispose(){this.disposable.dispose()}async handleUri(e){var r;const n=new lt(`RemoteUriHandler.handleUri(${e.path}, ${e.toString()})`);try{switch(e.path){case"/open":{this.telemetryService.sendEvent("handleUri.open");let i,o;for(const l of e.query.split("&")){const[d,p]=l.split("=");switch(d){case"url":i=decodeURIComponent(p);break;case"location":o=p===tr.CurrentWindow?tr.CurrentWindow:tr.NewWindow;break}}if(!i){n.log({message:": Unable to find url parameter"}),this.telemetryService.sendEvent("handleUri.open.abort",{reason:"aborted url not found"});return}i=i.trim(),o=o!=null?o:tr.NewWindow;const c=await this.providerService.createWorkspaceForRemoteUrl(i,void 0,o);if(!c){n.log({message:`: Unable to open workspace for ${i}`}),this.telemetryService.sendEvent("handleUri.open.abort",{reason:"aborted invalid url"});return}n.log({message:`: Opening ${i} in ${o}`}),bn(c);break}case"/open-files":{let i;for(const c of e.query.split("&")){const[l,d]=c.split("=");if(l==="url"){i=decodeURIComponent(d);break}}if(!i){n.log({message:": Unable to find url parameter"});return}i=i.trim();const o=await this.providerService.createWorkspaceForRemoteUrl(i);if(!o){n.log({message:`: Unable to open files/folders for ${i}`});return}o.filesToOpen?(n.log({message:`: Opening files/folders for ${i}`}),await((r=_u())==null?void 0:r.openPendingFiles(o.uri,o.filesToOpen))):n.log({message:`: No files/folders found to open for ${i}`});break}case"/login":{Dr.fire(e);break}default:{n.log({message:`: Unknown Uri ${e.toString()}`});break}}}finally{n.stop()}}}a(yp,"RemoteUriHandler");const Bn=(0,B.loadMessageBundle)(),cl=a(class{constructor(t,e,r,n){this.providerService=t,this.storageService=e,this.changeStore=r,this.workspaceId=n,this._onDidChange=new m.EventEmitter,this.cache=new Map,this.lock=new wn("WorkspaceRepositories"),this.disposable=m.Disposable.from(this.providerService.onDidChangeRepositories(this.onRepositoriesChanged,this),this.providerService.onDidChangeRepository(this.onRepositoryChanged,this),this.changeStore.onDidChange(this.onChangeStoreChanged,this))}get onDidChange(){return this._onDidChange.event}dispose(){this.disposable.dispose()}async exportDebugInfo(){const t=await m.workspace.openTextDocument({language:"json",content:`Remote Repositories

${this.toStorage(await this.getCore())}`});return void m.window.showTextDocument(t)}onChangeStoreChanged(t){const e=Hd(t.map(r=>r.rootUri),r=>te(r)).map(r=>this.providerService.getRepository(r)).filter(r=>Boolean(r));this.addOrUpdate(e)}onRepositoriesChanged(t){this.addOrUpdate(t.added)}onRepositoryChanged(t){this.addOrUpdate([t.repository])}async get(t){let e=await this.lock.synchronizeRead(async()=>{let r=this.cache.get("workspaceRepositories");return r===void 0&&(r=[...(await this.getCore()).values()].sort((n,i)=>i.timestamp-n.timestamp),this.cache.set("workspaceRepositories",r)),r},"WorkspaceRepositories.get");if(t){const r=te(t);e=e.filter(n=>te(n.canonicalUri)===r)}return e}async getCore(){return this.fromStorage(await this.storageService.get(cl.storageKey))}async getByCanonicalUri(){let t=this.cache.get("groupedWorkspaceRepositories");return t===void 0&&(t=B0(await this.get(),e=>te(e.canonicalUri)),this.cache.set("groupedWorkspaceRepositories",t)),t}async getRecents(t=10){return(await this.get()).slice(0,t)}async getRemoteWorkspaceSourceProvider(){const t=await this.getRecents();if(t.length!==0)return{name:"Recents",label:"Open Recent Repository",icon:"$(history)",placeholder:Bn("pick","Choose a recent repository"),provideSources:function(e,r,n,i){return t.map(o=>({providerId:o.provider.id,name:o.name,icon:"$(repo)",description:uo(o.timestamp,{ago:!0}),detail:`${o.provider.name}${o.pullRequest?`\xA0\xA0\u2022\xA0\xA0$(git-pull-request) Pull Request #${o.pullRequest.id}`:""}${Xt.isCanonicalUri(o.uri)?"":`\xA0\xA0\u2022\xA0\xA0${Kd(o.ref.type)} ${o.ref.name}`}\xA0\xA0\u2022\xA0\xA0${wp(o.changes)}${o.idx?`\xA0\xA0\u2022\xA0\xA0${ey(o.idx.type)}`:""}`,workspace:{uri:o.uri,name:o.name,location:tr.CurrentWindow}}))}}}refresh(){this.cache.clear()}async remove(t){await this.lock.synchronizeWrite(async()=>{const e=await this.getCore(),r=`${t.workspaceId}/${te(t.uri)}`,n=e.get(r);if(n===void 0)return;const i=this.changeStore.getScopedChangeStore(n),o=await i.getChanges(n.uri);if(o.length!==0){const c={title:Bn("remove remote repo prompt confirm","Yes")},l={title:Bn("remove remote repo prompt cancel","No"),isCloseAffordance:!0};if(await m.window.showWarningMessage(o.length===1?Bn("remove remote repo prompt file changed",`This repository contains 1 file with uncommitted changes.

Removing it will cause those changes to be FOREVER LOST.
This is IRREVERSIBLE!

Are you sure you still want to remove it?`):Bn("remove remote repo prompt files changes",`This repository contains {0} files with uncommitted changes.

Removing it will cause those changes to be FOREVER LOST.
This is IRREVERSIBLE!

Are you sure you still want to remove it?`,o.length),{modal:!0,useCustom:!0},c,l)!==c)return;await i.discardAll(n.uri)}this.cache.clear(),e.delete(r);try{await this.storageService.store(cl.storageKey,this.toStorage(e))}catch(c){throw L.error(c,"Failed to save workspace repositories"),c}},"WorkspaceRepositories.remove"),this._onDidChange.fire()}async addOrUpdate(t){await this.lock.synchronizeWrite(async()=>{this.cache.clear();const e=await this.getCore();for(const r of t){const[{HEAD:n,pullRequest:i},o]=await Promise.all([r.getMetadata(),r.getIndexMetadata()]),c=await this.changeStore.getChanges(r.uri);e.set(`${this.workspaceId}/${te(r.uri)}`,{workspaceId:this.workspaceId,uri:r.uri,canonicalUri:r.canonicalUri,name:r.name,provider:r.provider,ref:{type:n.type,name:n.name},idx:(o==null?void 0:o.type)&&ft.hasIndex(o.type)?{type:o.type}:void 0,pullRequest:i?{id:i.id}:void 0,changes:oy(c),timestamp:Date.now()})}try{await this.storageService.store(cl.storageKey,this.toStorage(e)),oi(ii.HasRecentRepositories,e.size>0)}catch(r){throw L.error(r,"Failed to save workspace repositories"),r}},"WorkspaceRepositories.addOrUpdate"),this._onDidChange.fire()}fromStorage(t){if(!t)return new Map;try{const e=JSON.parse(t,(r,n)=>(r==="uri"||r.endsWith("Uri"))&&Ue(n)?m.Uri.from(n):n);return new Map(e.workspaceRepositories)}catch(e){return L.error(e,"Failed to deserialize workspace repositories"),new Map}}toStorage(t){const e={schemaVersion:cl.storageSchemaVersion,workspaceRepositories:[...t]};return JSON.stringify(e)}},"_WorkspaceRepositories");let Yd=cl;Yd.storageKey="workspaceRepositories",Yd.storageSchemaVersion=1;function _p(t){return t!==void 0&&(t.added!==0||t.changed!==0||t.deleted!==0)}a(_p,"hasChanges");function iy(t){return _p(t.changes)}a(iy,"hasUncommittedChanges");function oy(t){let e=0,r=0,n=0;for(const i of t)switch(i.type){case Dt.Created:e++;break;case Dt.Changed:r++;break;case Dt.Deleted:n++;break}return e||r||n?{added:e,changed:r,deleted:n,timestamp:Date.now()}:void 0}a(oy,"toChangesSummary");function wp(t,{compact:e=!0,preamble:r,separator:n=", ",short:i=!1,single:o=!1}={}){if(!_p(t))return Bn("no changes","Everything up to date");const{added:c,changed:l,deleted:d}=t;if(o){const S=c+l+d;return S===1?Bn("summary change","{0} change",S):Bn("changes changes","{0} changes",S)}let p=`${r!=null?r:""}`;return(c||!e)&&(p+=i?`+${c}`:c===1?Bn("file added","{0} file added",c):Bn("files added","{0} files added",c),(l||d||!e)&&(p+=n)),(l||!e)&&(p+=i?`~${l}`:l===1?Bn("file changed","{0} file changed",l):Bn("files changed","{0} files changed",l),(d||!e)&&(p+=n)),(d||!e)&&(p+=i?`-${d}`:d===1?Bn("file deleted","{0} file deleted",d):Bn("files deleted","{0} files deleted",d)),p}a(wp,"formatChangesSummary");var ay=Object.defineProperty,sy=Object.getOwnPropertyDescriptor,cy=a((t,e,r,n)=>{for(var i=n>1?void 0:n?sy(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&ay(e,r,i),i},"view_decorateClass"),Vs;(function(t){t.Change="remoteHub:viewItem:change",t.WorkspaceRepository="remoteHub:viewItem:workspaceRepository",t.WorkspaceRepositories="remoteHub:viewItem:workspaceRepositories",t.Message="remoteHub:viewItem:message"})(Vs||(Vs={}));const bp=a(class{constructor(t,e){this.view=t,this.parent=e,this.splatted=!1}static is(t){return t instanceof bp}get id(){}toString(){return`${L.toLoggableName(this)}${this.id!==void 0?`(${this.id})`:""}`}getParent(){var t,e;return((t=this.parent)==null?void 0:t.splatted)?(e=this.parent)==null?void 0:e.getParent():this.parent}triggerChange(t=!1,e=!1,r){return this.splatted&&this.parent!==void 0&&this.parent!==r?this.parent.triggerChange(t,e):this.view.refreshNode(this,t,e)}},"_ViewNode");let Ks=bp;cy([nr((t=!1,e=!1,r)=>JSON.stringify([t,e,r==null?void 0:r.toString()]))],Ks.prototype,"triggerChange",1);class Sp{constructor(e,r,n,i){this.id=e,this.name=r,this.providerService=n,this.telemetryService=i,this._onDidChangeTreeData=new m.EventEmitter,this.disposables=[];const o=!1;if(L.isDebugging&&o){const c=this.getTreeItem;this.getTreeItem=async function(l){var d;const p=await c.apply(this,[l]),S=l.getParent();return p.tooltip===void 0&&(p.tooltip=new m.MarkdownString(p.label!==void 0&&typeof p.label!="string"?p.label.label:(d=p.label)!=null?d:"")),typeof p.tooltip=="string"?p.tooltip=`${p.tooltip}

---
context: ${p.contextValue}
node: ${l.toString()}${S!==void 0?`
parent: ${S.toString()}`:""}`:p.tooltip.appendMarkdown(`

---

context: \`${p.contextValue}\`\\
node: \`${l.toString()}\`${S!==void 0?`\\
parent: \`${S.toString()}\``:""}`),p}}this.disposables.push(...this.registerCommands()),this.initialize({showCollapseAll:this.showCollapseAll}),setTimeout(()=>this.onConfigurationChanged(),0)}get onDidChangeTreeData(){return this._onDidChangeTreeData.event}get showCollapseAll(){return!0}filterConfigurationChanged(e){return!!Y.changed(e,`views.${this.configKey}`)}dispose(){m.Disposable.from(...this.disposables).dispose()}get title(){return this._title}set title(e){this._title=e,this.tree!==void 0&&(this.tree.title=e)}get description(){return this._description}set description(e){this._description=e,this.tree!==void 0&&(this.tree.description=e)}get message(){return this._message}set message(e){this._message=e,this.tree!==void 0&&(this.tree.message=e)}getQualifiedCommand(e){return`${this.id}.${e}`}onConfigurationChanged(e){e!==void 0&&this.root!==void 0&&this.refresh(!0)}initialize(e={}){this.tree=m.window.createTreeView(this.id,{...e,treeDataProvider:this}),this.disposables.push(Y.onDidChange(r=>{!this.filterConfigurationChanged(r)||(this._config=void 0,this.onConfigurationChanged(r))},this),this.tree),this._title=this.tree.title}ensureRoot(e=!1){return(this.root===void 0||e)&&(this.telemetryService.sendEvent("view.open",{view:this.id}),this.root=this.getRoot()),this.root}getChildren(e){return e!==void 0?e.getChildren():this.ensureRoot().getChildren()}getParent(e){return e.getParent()}getTreeItem(e){return e.getTreeItem()}get selection(){return this.tree===void 0||this.root===void 0?[]:this.tree.selection}get visible(){return this.tree!==void 0?this.tree.visible:!1}async refresh(e=!1){var r,n;await((n=(r=this.root)==null?void 0:r.refresh)==null?void 0:n.call(r,e)),this.triggerNodeChange()}async refreshNode(e,r=!1,n=!1){var i;const o=await((i=e.refresh)==null?void 0:i.call(e,r));!n&&o===!0||this.triggerNodeChange(e)}async reveal(e,r){if(this.tree!==void 0)try{await this.tree.reveal(e,r)}catch(n){L.error(n)}}async show(){try{await m.commands.executeCommand(`${this.id}.focus`)}catch(e){L.error(e)}}triggerNodeChange(e){this._onDidChangeTreeData.fire(e!==void 0&&e!==this.root?e:void 0)}get config(){return this._config===void 0&&(this._config=Y.get("views")[this.configKey]),this._config}}a(Sp,"View");class Ep extends Ks{constructor(e,r,n,i,o,c,l){super(e,r);this._message=n,this._description=i,this._tooltip=o,this._iconPath=c,this._contextValue=l}getChildren(){return[]}getTreeItem(){var e;const r=new m.TreeItem(this._message,m.TreeItemCollapsibleState.None);return r.contextValue=(e=this._contextValue)!=null?e:Vs.Message,r.description=this._description,r.tooltip=this._tooltip,r.iconPath=this._iconPath,r}}a(Ep,"MessageNode");var ly=Object.defineProperty,uy=Object.getOwnPropertyDescriptor,Zd=a((t,e,r,n)=>{for(var i=n>1?void 0:n?uy(e,r):e,o=t.length-1,c;o>=0;o--)(c=t[o])&&(i=(n?c(e,r,i):c(i))||i);return n&&i&&ly(e,r,i),i},"workspaceRepositoriesView_decorateClass");const Vr=(0,B.loadMessageBundle)(),xp=a(class extends Ks{constructor(t,e,r,n,i,o,c){super(t,e);this.changeStore=r,this.canonical=n,this.workspaceRepository=i,this.operation=o,this.canApplyChanges=c}static getId(t,e,r){return`${ll.getId(t,e)}:${this.key}(${r.uri.toString()})`}get id(){return xp.getId(this.canonical.uri,this.workspaceRepository,this.operation)}getChildren(){return[]}async getTreeItem(){const t=this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri),e=new m.TreeItem(t,m.TreeItemCollapsibleState.None);return e.id=this.id,e.contextValue=`${Vs.Change}${this.canApplyChanges?"+apply":""}`,e.resourceUri=this.view.changeStore.getScopedUri(this.operation.uri,this.workspaceRepository),e.command=await this.getDiffCommand(t,!0),e}async getDiffCommand(t,e=!1){if(e||this._command===void 0){const r=Boolean(this.operation.staged&&Y.get("staging.enabled"));if(this.workspaceRepository.workspaceId===this.view.workspaceId){const n=this.view.providerService.getProviderUri(this.operation.uri);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,n,r?Vr("diff title index","{0} (Index)",de(this.operation.uri),this.workspaceRepository.ref.name):Vr("diff title working","{0} (Working Tree)",de(this.operation.uri),this.workspaceRepository.ref.name))}else{const{repo:n}=this.view.providerService.getVirtualUriMetadata(this.workspaceRepository.uri),i=this.view.providerService.createProviderUri(this.operation.uri,{repo:n,ref:{type:et.Commit,id:this.operation.revision}},t);this._command=await this.changeStore.resolveDiffCommand(this.operation.uri,i,r?Vr("diff title changeset index","{0} (Index of {1})",de(this.operation.uri),this.workspaceRepository.ref.name):Vr("diff title changeset working","{0} (Working Tree of {1})",de(this.operation.uri),this.workspaceRepository.ref.name))}}return this._command}async openChanges(){var t;const e=await this.getDiffCommand(this.view.providerService.getRelativeFilePath(this.workspaceRepository.uri,this.operation.uri));await m.commands.executeCommand(e.command,...(t=e.arguments)!=null?t:[])}async openFile(){const t=this.view.changeStore.getScopedUri(this.operation.uri,this.workspaceRepository.workspaceId);await m.window.showTextDocument(t)}async applyChanges(){const t=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(t!==void 0)try{await this.view.changeStore.applyChangeset(t.uri,this.workspaceRepository,this.operation)}catch(e){m.window.showErrorMessage(String(e))}}},"_FileChangeNode");let Cp=xp;Cp.key=":changes";const Tp=a(class extends Ks{constructor(t,e,r,n,i){super(t,e);this.canonical=r,this.workspaceRepository=n,this.root=i}static getId(t,e){return`${vu.getId(t)}:${this.key}(${e.workspaceId}/${e.uri.toString()})`}get id(){return Tp.getId(this.canonical.uri,this.workspaceRepository)}get name(){return this.workspaceRepository.name}get uri(){return this.workspaceRepository.uri}canApplyChanges(){if(!this.canonical.hasActive||m.workspace.getWorkspaceFolder(this.workspaceRepository.uri)!==void 0)return!1;const{changes:e}=this.workspaceRepository;return e!==void 0&&(e.added!==0||e.changed!==0||e.deleted!==0)}async getChildren(){if(this._children===void 0){const t=this.view.changeStore.getScopedChangeStore(this.workspaceRepository),e=await t.getChanges(this.workspaceRepository.uri);this._children=e.map(r=>new Cp(this.view,this,t,this.canonical,this.workspaceRepository,r,this.canApplyChanges()))}return this._children}getTreeItem(){const t=this.workspaceRepository.workspaceId===this.view.workspaceId,e=iy(this.workspaceRepository),r=Xt.isCanonicalUri(this.workspaceRepository.uri)?Vr("repositories view repository default ref","{0} (default)",this.workspaceRepository.ref.name):this.workspaceRepository.ref.name,n=new m.TreeItem(this.root?this.canonical.name:r,e?m.TreeItemCollapsibleState.Collapsed:m.TreeItemCollapsibleState.None);return n.id=this.id,n.contextValue=`${Vs.WorkspaceRepository}${t?"+active":""}${this.canApplyChanges()?"+apply":""}`,n.description=`${this.root?`${this.workspaceRepository.ref.name}\xA0\xA0\u2022\xA0\xA0`:""}${uo(this.workspaceRepository.timestamp,{ago:!0})}`,n.iconPath=t?new m.ThemeIcon("check"):this.root?Ip(this.canonical.provider.id):ty(this.workspaceRepository.ref.type,this.workspaceRepository.pullRequest),n.tooltip=new m.MarkdownString(void 0,!0).appendMarkdown(Vr("repositories view repository tooltip",`{0}{1}\\
{2} {3} {4}{5}\\
Last accessed {6}

{7}
`,this.canonical.name,this.workspaceRepository.pullRequest?Vr("pull request",`\\
Pull request {0} #{1}`,"$(git-pull-request)",this.workspaceRepository.pullRequest.id):"",dy(this.workspaceRepository.ref.type),Kd(this.workspaceRepository.ref.type),r,t?` \u2014 _${Vr("repositories view repository tooltip active","Active")}_ `:"",uo(this.workspaceRepository.timestamp,{ago:!0}),wp(this.workspaceRepository.changes,{preamble:`${Vr("repositories view has changes","Has Uncommitted Changes")}\\
`}))),e&&(n.resourceUri=m.Uri.parse("remotehub-view://wsrepo/changes")),n}refresh(t=!1){t&&(this._children=void 0)}async applyAllChanges(){const t=await this.view.getRepositoryToApplyChangesetTo(this.workspaceRepository);if(t!==void 0)try{await this.view.changeStore.applyChangeset(t.uri,this.workspaceRepository)}catch(e){m.window.showErrorMessage(String(e))}}remove(){return this.view.workspaceRepositories.remove(this.workspaceRepository)}},"_WorkspaceRepositoryNode");let ll=Tp;ll.key=":wsrepo",Zd([nr()],ll.prototype,"refresh",1);const Ap=a(class extends Ks{constructor(t,e,r,n){super(t,e);this.canonical=r,this.workspaceRepositories=n}static getId(t){return`remoteHub${this.key}(${t.toString()})`}get id(){return Ap.getId(this.canonical.uri)}get name(){return this.canonical.name}get uri(){return this.canonical.uri}getChildren(){if(this.children===void 0){const t=this.workspaceRepositories;if(t.length===0)return this.view.message=void 0,[new Ep(this.view,this,Vr("repositories view message empty","No GitHub repositories could be found."))];this.view.message=void 0,this.children=t.map(e=>new ll(this.view,this,this.canonical,e,!1))}return this.children}getTreeItem(){const t=this.workspaceRepositories.some(r=>r.workspaceId===this.view.workspaceId),e=new m.TreeItem(this.canonical.name,t?m.TreeItemCollapsibleState.Expanded:m.TreeItemCollapsibleState.Collapsed);return e.contextValue=Vs.WorkspaceRepositories,e.iconPath=Ip(this.canonical.provider.id),e}refresh(t=!1){t&&(this.children=void 0)}},"_CanonicalWorkspaceRepositoryNode");let vu=Ap;vu.key=":wsrepos",Zd([nr()],vu.prototype,"refresh",1);class Jd extends Ks{constructor(e){super(e);this.splatted=!0}async getChildren(){if(this.children===void 0){const e=await this.view.workspaceRepositories.getByCanonicalUri();if(e.size===0)return[];this.view.message=void 0;const r=[];for(const[n,i]of e){const o=m.Uri.parse(n);try{const{name:c,provider:l}=this.view.providerService.getVirtualUriMetadata(o),d={uri:o,name:c,provider:l,hasActive:i.some(p=>p.workspaceId===this.view.workspaceId)};i.length===1?r.push(new ll(this.view,this,d,i[0],!0)):r.push(new vu(this.view,this,d,i))}catch(c){if(c instanceof Wt)continue;L.error(c)}}this.children=r}return this.children}getTreeItem(){return new m.TreeItem("Repositories",m.TreeItemCollapsibleState.Expanded)}refresh(e=!1){e&&(this.children=void 0)}}a(Jd,"WorkspaceRepositoriesViewNode"),Zd([nr()],Jd.prototype,"refresh",1);class Rp extends Sp{constructor(e,r,n,i,o){super("remoteHub.views.workspaceRepositories",Vr("remote view title","GitHub Repositories"),e,o);this.workspaceRepositories=r,this.changeStore=n,this.workspaceId=i,this.configKey="workspaceRepositories",this.disposables.push(this.workspaceRepositories.onDidChange(this.onRepositoriesChanged,this),m.window.registerFileDecorationProvider({provideFileDecoration:(c,l)=>{if(!(c.scheme!=="remotehub-view"||c.authority!=="wsrepo"||!c.path.includes("/changes")))return{badge:"\u25CF",color:new m.ThemeColor("remoteHub.decorations.workspaceRepositoriesView.hasUncommittedChangesForegroundColor"),tooltip:Vr("repositories view decoration has changes","Has Uncommitted Changes")}}}))}getRoot(){return new Jd(this)}onRepositoriesChanged(){this.refresh(!0)}registerCommands(){return[m.commands.registerCommand(this.getQualifiedCommand("refresh"),()=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.refresh"),this.workspaceRepositories.refresh(),void this.refresh(!0)),this),m.commands.registerCommand(this.getQualifiedCommand("open"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.open"),bn({name:e.name,uri:e.uri,location:tr.CurrentWindow})),this),m.commands.registerCommand(this.getQualifiedCommand("openInNewWindow"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openInNewWindow"),bn({name:e.name,uri:e.uri,location:tr.NewWindow})),this),m.commands.registerCommand(this.getQualifiedCommand("applyAllChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.applyAllChanges"),e.applyAllChanges()),this),m.commands.registerCommand(this.getQualifiedCommand("remove"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.remove"),e.remove()),this),m.commands.registerCommand(this.getQualifiedCommand("openChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openChanges"),e.openChanges()),this),m.commands.registerCommand(this.getQualifiedCommand("openFile"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.openFile"),e.openFile()),this),m.commands.registerCommand(this.getQualifiedCommand("applyChanges"),e=>(this.telemetryService.sendEvent("command.views.workspaceRepositories.applyChanges"),e.applyChanges()),this)]}async getRepositoryToApplyChangesetTo(e){const r=te(this.providerService.getVirtualCanonicalRootUri(e.uri)),n=this.providerService.repositories.filter(o=>te(o.canonicalUri)===r);return await hy(n,Vr("apply changeset pick repository placeholder","Choose a repository to apply the changeset to"))}}a(Rp,"WorkspaceRepositoriesView");function dy(t,e){switch(t){case De.Branch:return e?Vr("type pr branch","Pull Request #{0}",e.id):Vr("type branch","Branch");case De.RemoteBranch:return e?Vr("type pr remote branch","Pull Request #{0}",e.id):Vr("type remote branch","Remote Branch");case De.Tag:return Vr("type tag","Tag");case De.Commit:return Vr("type commit","Commit")}}a(dy,"headTypeToString");function Ip(t){switch(t){case"github":return new m.ThemeIcon("github");case"azurerepos":return new m.ThemeIcon("azure-devops");default:return new m.ThemeIcon("vm")}}a(Ip,"providerToIconPath");async function hy(t,e){if(t.length!==0){if(t.length>1){const r=await m.window.showQuickPick(t.map(n=>({label:n.name,description:n.provider.name,repository:n})),{placeHolder:e});return r?r.repository:void 0}return t[0]}}a(hy,"getRepository");const Op=(0,B.loadMessageBundle)();let yu;function _u(){return yu}a(_u,"getOpenActionsService");var qa;(function(t){t.HasCommitted="has:committed",t.Version="version"})(qa||(qa={}));let eh;function Pp(t){return eh.globalState.get(t)}a(Pp,"getState");async function th(t,e){return eh.globalState.update(t,e)}a(th,"updateState");let Dp=!1;function kp(){return Dp}a(kp,"isInsiders");async function fy(t){eh=t,$.configure(t),L.configure(t,Y.get("logLevel")),lt.start("Time to root directory",{log:!1});const e=t.extension.packageJSON.displayName;if(t.extension.id.toLowerCase()==="github.remotehub-insiders"){Dp=!0;const o=m.extensions.getExtension("GitHub.remotehub");if(o!==void 0){const c=o.packageJSON.displayName;L.warn(`${e} was NOT activated because ${c} is also enabled`),setTimeout(()=>void m.window.showErrorMessage(Op("more than one version enabled warning","{0} cannot be used while {1} is also enabled. Please ensure that only one version is enabled.",e,c),Op("ok","OK")),0);return}}const r=ya.configure(t),n=new ma(t),i=t.extension.packageJSON.version;await th(qa.Version,i),await t.workspaceState.update(qa.Version,i);try{const o=new gu(t.globalState),c=o.with(r),l=new mu(t.globalStorageUri,r),d=new Ke(c),p=new Xt(d,n),S=new ga(p,c,l,n,r);S.getWorkspacesWithChanges(),yu=new fp(p,o,S);const P=new gp(p,S,yu,n),I=new Ff(t.globalStorageUri,p),O=new hh(p,I),F=new Yd(p,o,S,r);return t.subscriptions.push(Y.onDidChange(N=>{!Y.changed(N,"logLevel")||(L.logLevel=Y.get("logLevel"))}),p.onDidChangeRepositories(async N=>{for(const U of N.added)try{const W=await U.getMetadata(),{HEAD:V,defaultBranch:ie,name:oe,provider:ge,pullRequest:ke}=W,Re=V.name.replace(/\//g,"\u2009\u2215\u2009");let Ie=" ";if(ke!==void 0)Ie=` (PR ${ke.id}) `;else if(V.type===De.Tag)Ie=` (${Re}) `;else if(V.type===De.Commit)Ie=` (${Re}) `;else if(V.type===De.Branch||V.type===De.RemoteBranch){const $e=V.branch.name.replace(/\//g,"\u2009\u2215\u2009");V.branch.name!==ie.name&&(Ie=` (${$e})`)}const Ye={uri:U.uri,type:"folder",label:`${oe}${Ie}[${ge.name}]`};m.commands.executeCommand("_workbench.addToRecentlyOpened",Ye)}catch(W){L.error(W,"Failed to add repository to recently opened")}}),new pp(p,S),new El,new Mc(p,S),new yp(p,n),...hs(p,S,F,t.extension.id,n),...vy(p,S,n),...py(p,S,P,I,t,n),new vp(p,S),new Rp(p,F,S,r,n),I,F,P,yu,S,p,n),n.sendEvent("activate"),Promise.resolve(O)}catch(o){throw L.error(o),o}}a(fy,"activate");function py(t,e,r,n,i,o){const c=Np()?new ch(t,o):void 0;return[gy(t,e,c,r,n),...Y.get("azureRepos.enabled")?[new Ot(i),my(t,e,c)]:[]]}a(py,"registerProviders");function gy(t,e,r,n,i){const o=new hu(t,i),c=new el(t,o,e,i);async function l(){var p;try{let S=(p=m.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?p:m.extensions.getExtension("GitHub.vscode-pull-request-github-insiders");S||(L.log("[ GHPR] Not currently installed or enabled; waiting..."),await new Promise(U=>{const W=m.extensions.onDidChange(()=>{var V;S=(V=m.extensions.getExtension("GitHub.vscode-pull-request-github"))!=null?V:m.extensions.getExtension("GitHub.vscode-pull-request-github-insiders"),S&&(W.dispose(),U())})})),L.log("[ GHPR] Registering..."),oi(ii.HasPullRequestExtension,!0);const P=await S.activate();if(!P)throw new Error("Unable to get registration api");const I=P.registerGitProvider(n),O=t.onDidChangeRepositories(U=>F(U));async function F(U){const W=U.added.filter(V=>V.provider.id==="github");if(W.length!==0){L.log("[ GHPR] Checking for opened PRs...");for(const V of W){const ie=await t.getBestRemoteUri(V.uri,Nt.PullRequest);if(!!ie){O.dispose(),L.log("[ GHPR] Opened PR found; preloading"),m.commands.executeCommand("github.api.preloadPullRequest",ie.toString());return}}L.log("[ GHPR] No opened PRs found")}}a(F,"onRepositoriesChanged"),L.log("[ GHPR] Registration complete");const N=t.repositories;return N.length&&F({added:N,removed:[]}),m.Disposable.from(I,O)}catch(S){return L.error(S,"[ GHPR] Registration failed;"),{dispose:()=>{}}}}a(l,"registerWithGHPR");const d=l();return m.Disposable.from(t.register("github","GitHub",o,c,r),o,c,{dispose:async()=>{var p;return void((p=await d)==null?void 0:p.dispose())}})}a(gy,"registerGitHub");function my(t,e,r){const n=new ci(t),i=new si(t,n,e);return m.Disposable.from(t.register("azurerepos","Azure Repos",n,i,r),n,i)}a(my,"registerAzDO");function vy(t,e,r){if(!Np())return[];r.publicLog2("codex.enableRichNav",{});const n=new pr(t,e);return[n,n.register(new Ku(r)),...Ku.createStatus()]}a(vy,"registerNavigationServiceProviders");function Np(){return m.env.uiKind===m.UIKind.Desktop||Y.get("richNavigation.enabled")===!0}a(Np,"isRichNavEnabled")})(),module.exports=__webpack_exports__})();
